<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Context-Type" content="text/html; charset=UTF-8"/>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>XDK API: SDK/xdk110/Libraries/BLEStack/3rd-party/Alpwise/ALPW-BLESDKCM3/BLESW_CoreStack/Interfaces/BleL2cap.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
	<div id="header">
		<table class="background-img">
			<tr>
				<td class="left">
					<img src="header_left.jpg" alt="" />
				</td>
				<td class="center">
					<img src="header_center.jpg" alt="" />
				</td>
				<td class="right">
					<img src="header_right.jpg" alt="" />
				</td>
			</tr>
		</table>
	</div>
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="XDK-Main-App-Icon-64.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">XDK API
   &#160;<span id="projectnumber">3.6.0</span>
   </div>
   <div id="projectbrief">Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<html><head></head><body></body></html><!-- Generated by Doxygen 1.8.8 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ec4762a68cf92b76e0cf6c3151395d91.html">SDK</a></li><li class="navelem"><a class="el" href="dir_3ad35e3a8069b84129d75940e36308b0.html">xdk110</a></li><li class="navelem"><a class="el" href="dir_eb47dd56e224277ceada86f918a18997.html">Libraries</a></li><li class="navelem"><a class="el" href="dir_80dcb6d64a243eab41e52bf9b16ff41a.html">BLEStack</a></li><li class="navelem"><a class="el" href="dir_032c0b262d8cd678af0b231d027f9425.html">3rd-party</a></li><li class="navelem"><a class="el" href="dir_078beabbff9f1bef3c1f56088e8b2bdd.html">Alpwise</a></li><li class="navelem"><a class="el" href="dir_3279a5641b82493790333db1285a71c5.html">ALPW-BLESDKCM3</a></li><li class="navelem"><a class="el" href="dir_a8a65f37c7e408e1a3d2fef48c36f9a9.html">BLESW_CoreStack</a></li><li class="navelem"><a class="el" href="dir_c36fc64b79ef3bfba17cd632cf7a4305.html">Interfaces</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a>  </div>
  <div class="headertitle">
<div class="title">BleL2cap.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="_ble_types_8h.html">BleTypes.h</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for BleL2cap.h:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="_ble_l2cap_8h__incl.png" border="0" usemap="#_s_d_k_2xdk110_2_libraries_2_b_l_e_stack_23rd-party_2_alpwise_2_a_l_p_w-_b_l_e_s_d_k_c_m3_2_b_l_e_s_w___core_stack_2_interfaces_2_ble_l2cap_8h" alt=""/></div>
<map name="_s_d_k_2xdk110_2_libraries_2_b_l_e_stack_23rd-party_2_alpwise_2_a_l_p_w-_b_l_e_s_d_k_c_m3_2_b_l_e_s_w___core_stack_2_interfaces_2_ble_l2cap_8h" id="_s_d_k_2xdk110_2_libraries_2_b_l_e_stack_23rd-party_2_alpwise_2_a_l_p_w-_b_l_e_s_d_k_c_m3_2_b_l_e_s_w___core_stack_2_interfaces_2_ble_l2cap_8h">
<area shape="rect" id="node2" href="_ble_types_8h.html" title="BleTypes.h" alt="" coords="95,124,182,151"/><area shape="rect" id="node3" href="_ble_config_8h.html" title="BleConfig.h" alt="" coords="95,199,183,225"/><area shape="rect" id="node4" href="_common_2config_2_b_l_e_custom_config_8h.html" title="BLECustomConfig.h" alt="" coords="69,273,208,300"/></map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:acbecddc9a7ca82071dfacf7ef090df68"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ble_l2cap_8h.html#acbecddc9a7ca82071dfacf7ef090df68">BLEL2CAP_MINIMUM_MTU</a>&#160;&#160;&#160;(0x17u)</td></tr>
<tr class="separator:acbecddc9a7ca82071dfacf7ef090df68"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:af7d18d007f92107efaa51e56a91cebc6"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="_ble_types_8h.html#a3cb25ca6f51f003950f9625ff05536fc">U8</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ble_l2cap_8h.html#af7d18d007f92107efaa51e56a91cebc6">BleL2capEvent</a></td></tr>
<tr class="separator:af7d18d007f92107efaa51e56a91cebc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h1><a class="anchor" id="BleL2cap"></a>
Connection Oriented channels Introduction</h1>
<p>The Bluetooth 4.1 specification brings the LE L2CAP connection oriented channels allowing two devices ( Through L2CAP Upper layer protocols or services) to exchange L2CAP frames. The LE L2CAP connection oriented Channels specification allows a device, called INITIATOR to create a LE L2CAP connection oriented to a remote device called RESPONDER. As INITIATOR, The LE L2CAP connection targets a remote LE L2CAP upper layer protocol/profile defined by the PSM (Protocol Service Multiplier). As RESPONDER, the LE L2CAP is listening for an incoming connection on a given PSM. During the connection the devices L2CAP capabilities are exchanged. An important remote device L2CAP capability information is the application MTU supported by the remote device. It defines the maximum length of the data packet that can be send to the remote device. Once connected, the device can exchange data packets ( with a length up to the remote device MTU size).</p>
<p>A device may act as both INITIATOR and RESPONDER at a same time.</p>
<h1><a class="anchor" id="BleL2cap"></a>
Connection Oriented channels Introduction</h1>
<h1><a class="anchor" id="Handlers"></a>
Handlers</h1>
<p>This implementation is using specific Handler of BleL2capHandler type, these handlers allow an Upper layer Protocol/ or Profile to provide its local capabilities to the LE l2CAP layer. The Handler shall be initiated and filled with local capabilities during when initiating a connection for the INITIATOR (BLEL2CAP_Connect) or when listening for an incoming connection as RESPONDER (BLEL2CAP_RegisterListenningHandler).</p>
<h1><a class="anchor" id="Initiating"></a>
connection</h1>
<p>As INITIATOR, The following fields are mandatory and shall be filled during BLEL2CAP_Connect for a connecting BleL2capHandler : bleL2capCallback: The Callback that will receive the LE L2CAP connection oriented channel event. connHandle: the physical connection handle identifying the remote device for which the LE L2CAP connection will be established. psm: The Protocol Service Multiplier (PSM) identifying the Upper layer/Upper protocol for which the local device is connecting t the remote device. rxBufferLen: The size of the Receiving buffer that may be allocated later using BLEL2CAP_AllocateReceiveBuffer, it will also be the local Maximum Payload Size (PSM) that a remote device will be able to send to the local device. If the local device is not able (or does not want) to receive data, it could set rxBufferLen to 0, otherwise the minimum allowed buffer length is BLEL2CAP_MINIMUM_MTU. (RxBufferLen == 0) or (RxBufferLen &gt;= BLEL2CAP_MINIMUM_MTU) hciTxCredits : The number of HCI TX DATA packet allowed to be used by this handler, depending of the number additional HCI TX DATA buffers allocated with the NUM_TX_DATA_PACKETS configuration. If multiple HciBuffer are allowed then the L2CAP will queue in HCI buffer, the packet to send. More HCI data buffers are allocated more the bit-rate will be high.</p>
<p>Once connected the BLEL2CAPEVENT_CONNECTED event is reported in the LE L2CAP callback given in the L2CAP handler. During this event the parms field is a pointer to the impacted BleL2capHandler, the remoteUpperLayerMTU field of the BleL2capHandler have been filled by the L2CAP layer and represent the maximum size of data (MTU) that the remote device is able to receive(i.e. the maximum size that the local device will be then allowed to send to the remote device using BLEL2CAP_SendData).</p>
<h1><a class="anchor" id="Listening"></a>
for an incoming connection</h1>
<p>As RESPONDER, The following fields are mandatory and shall be filled during BLEL2CAP_RegisterListenningHandler for a listening LE L2CAP handler: bleL2capCallback: The Callback that will receive the LE L2CAP connection oriented channel event. psm: The Protocol Service Multiplier (PSM) identifying the Upper layer/Upper protocol for which the local device is listening an incoming connection. rxBufferLen: The size of the Receiving buffer that may be allocated later using BLEL2CAP_AllocateReceiveBuffer, it will also be the local Maximum Payload Size (PSM) that a remote device will be able to send to the local device. If the local device is not able (or does not want) to receive data, it could set rxBufferLen to 0, otherwise the minimum allowed buffer length is BLEL2CAP_MINIMUM_MTU. (RxBufferLen == 0) or (RxBufferLen &gt;= BLEL2CAP_MINIMUM_MTU) hciTxCredits : The number of HCI TX DATA packet allowed to be used by this handler, depending of the number additional HCI TX DATA buffers allocated with the NUM_TX_DATA_PACKETS configuration. If multiple HciBuffer are allowed then the L2CAP will queue in HCI buffer, the packet to send. More HCI data buffers are allocated more the bit-rate will be high.</p>
<p>Once connected the BLEL2CAPEVENT_CONNECTED event is reported in the LE L2CAP callback given in the L2CAP handler. During this event the parms field is a pointer to the impacted BleL2capHandler, the remoteUpperLayerMTU field of the BleL2capHandler have been filled by the L2CAp layer and represent the maximum size of data (MTU) that the remote device is able to receive(i.e. the maximum size that the local device will be then allowed to send to the remote device using BLEL2CAP_SendData).</p>
<h1><a class="anchor" id="Receiving"></a>
Data.</h1>
<p>It is up to the LE L2CAP layer to reassemble the complete LE L2CAP upper layer protocol or profile packet (named SDU in the Bluetooth Specification). The layer protocol or profile just allocate and give buffers to the L2CAP layer, then the L2CAP layer is in charge of filling these buffers upon data reception. The buffer are allocated for a given handler thanks to the BLEL2CAP_AllocateReceiveBuffer API, all the buffer allocated have the same length, which is the length provided during Handler initialisation (Connecting or listening) trough the rxBufferLen handler field. Once a complete packet is received the BLEL2CAPEVENT_LEFRAME_RXCOMPLETE event is reported in the LE L2CAP callback given in the L2CAP handler. During this event the parms field is containing a pointer to the impacted BleL2capHandler and a pointer to the receive buffer which is containing the received data, the received data length is provided as well and is from 1 byte to rxBufferLen bytes. Note that a receive buffer length cannot be less than 23 bytes.</p>
<h1><a class="anchor" id="Sending"></a>
Data.</h1>
<p>Data are sent using the BLEL2CAP_SendData API, data are sent to a connected handler. The number of data bytes to send cannot exceed the remote device LE L2CAP MTU, provided in the remoteUpperLayerMTU field of the BleL2capHandler. It is up to the LE L2CAP layer to segment the complete LE L2CAP upper layer protocol or profile packet to send into several packet that could fill in the Bluetooth Low energy controllers. The segmentation is using HCI DATA transmit buffers and more HCI buffers are dedicated for the LE L2CAP upper layer protocol or profile, more segments can be sent to the Bluetooth Low energy controller, more the bit-rate will be high. Allocating HCI TX data buffer for this handler is done during handler initialisation. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="acbecddc9a7ca82071dfacf7ef090df68"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BLEL2CAP_MINIMUM_MTU&#160;&#160;&#160;(0x17u)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>BLEL2CAP_MINIMUM_MTU The minimum L2CAP MTU allowed by the Bluetooth Specification is 23 octets </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="af7d18d007f92107efaa51e56a91cebc6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="_ble_types_8h.html#a3cb25ca6f51f003950f9625ff05536fc">U8</a> <a class="el" href="_ble_l2cap_8h.html#af7d18d007f92107efaa51e56a91cebc6">BleL2capEvent</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>BleL2capEvent This type is used as event received in the BleL2capCallback callback registered during the call of BLEL2CAP_RegisterChannelHandler() function. The possible values are described below: </p>

</div>
</div>
</div><!-- contents -->
	<hr size="1" />
	All rights reserved. The use is subject to the XDK SDK EULA by Bosch Connected Devices and Solutions GmbH. 
	<hr size="1" />
	<address style="align: right;">
		<small>This documentation file has been automatically generated on Thu Mar 14 2019 19:12:41 by <a href="http://www.doxygen.org/index.html">doxygen</a> 1.8.8</small>
	</address>
</body>
</html>