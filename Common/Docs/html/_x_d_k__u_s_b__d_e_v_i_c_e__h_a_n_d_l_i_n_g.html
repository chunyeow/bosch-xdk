<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Context-Type" content="text/html; charset=UTF-8"/>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>XDK API: XDK USB Device Handling</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
	<div id="header">
		<table class="background-img">
			<tr>
				<td class="left">
					<img src="header_left.jpg" alt="" />
				</td>
				<td class="center">
					<img src="header_center.jpg" alt="" />
				</td>
				<td class="right">
					<img src="header_right.jpg" alt="" />
				</td>
			</tr>
		</table>
	</div>
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="XDK-Main-App-Icon-64.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">XDK API
   &#160;<span id="projectnumber">3.6.0</span>
   </div>
   <div id="projectbrief">Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<html><head></head><body></body></html><!-- Generated by Doxygen 1.8.8 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">XDK USB Device Handling </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Outlines XDKs behaviour when connected via USB</p>
<hr/>
<p>XDK is equipped with a micro USB port to connect it to the PC. This port is directly connected to the USB controller on the MCU of XDK and its function is hence dependant on the software running on XDK. XDK SDK defines a standard behaviour of the USB port and allows the user to send and receive data via USB.</p>
<h1><a class="anchor" id="XDK_USB_DEVICE_HANDLING_CDC_ACM"></a>
CDC ACM Device</h1>
<p>When connected to a PC, XDK is recognized as a CDC ACM Device. CDC stands for "communications device class", while ACM stands for "Abstract Control Model". Essentially, this means, that XDK emulates a serial port (so-called virtual serial port) over the USB connection. Operating Systems such as Mac OS X and Linux ship with standard drivers for such devices. For Windows, XDK Workbench automatically installs the necessary drivers. Windows assigns a port identifier "COMx" to XDK, where the number <code>x</code> is incremented when new devices are connected. Each XDK has a unique USB serial number. This ensures, that no matter which USB port of your PC you connect XDK to, the assigned port identifier will always be the same.</p>
<p>When running software on XDK, issuing a <code>printf</code> command will send data over the virtual serial port. This can be used for simple debugging purposes as well as for sending data over the virtual serial port. Furthermore, the XDK SDK offers a <a class="el" href="diskio_8c.html#a779bf099075a999d1074357fccbd466b">USB</a> Module that also allows to receive data over the serial port. Using the function <code>USB_callBackMapping</code>, you can easily register a callback that is called when data is received over the virtual serial port.</p>
<h1><a class="anchor" id="XDK_USB_DEVICE_HANDLING_RESET_REBOOT"></a>
Reset / Reboot XDK</h1>
<p>As outlined in <a class="el" href="_x_d_k__bootloader.html#XDK_Bootloader_Engage_1">Approach 1</a>, XDK can receive commands from XDK Workbench over the virtual serial port. Commands are parsed and executed by the URU module in XDK SDK. At the moment, XDK understands the following commands:</p>
<table class="doxtable">
<tr>
<th>Command </th><th>Meaning  </th></tr>
<tr>
<td>#reBoot$ </td><td>Reboot XDK and go into bootloader mode </td></tr>
<tr>
<td>#reSet$ </td><td>Reboot XDK and go into application mode </td></tr>
</table>
<p>Sending those commands to XDK via the virtual serial port will either get XDK into bootloader mode or restart XDK into application mode. When sending application data to XDK, please make sure not to use the reserved strings, as XDK might unexpectedly restart.</p>
<h1><a class="anchor" id="XDK_USB_DEVICE_HANDLING_Terminal"></a>
Using a Serial Terminal</h1>
<p>To communicate with XDK, a standard serial terminal application can be used. For example using the 3rd party <a href="http://ttssh2.osdn.jp/index.html.en">Tera Term</a> allows to open the virtual serial port of XDK and communicate with XDK. Please make sure, that XDK Workbench should not run, when you want to communicate with XDK with a 3rd party program as the two might interfere with one another. When working with XDK, please also pay close attention to the problem outlined in <a class="el" href="_x_d_k__u_s_b__d_e_v_i_c_e__h_a_n_d_l_i_n_g.html#XDK_USB_DEVICE_HANDLING_Driver">XDK Windows Driver</a>.</p>
<p>To figure out what the port identifier of your XDK is, simply hover with your mouse over your XDK in XDK Workbench. A mouseover as shown in the picture will show up and give you the "COMx" identifier of your XDK. </p><div class="image">
<img src="XDK_USB_CDC_ACM_Port.png" alt="XDK_USB_CDC_ACM_Port.png"/>
</div>
<h1><a class="anchor" id="XDK_USB_DEVICE_HANDLING_Driver"></a>
XDK Windows Driver</h1>
<p>Unfortunately, the driver for CDC ACM devices in Microsoft Windows (which is also used by XDK) misbehaves under certain circumstances. When a USB CDC ACM Device is connected and the respective port identifier is in use (by Tera Term for example) and then the device suddenly disappears, the drivers keeps the port identifier blocked. When the device reappears and the identifier is still in use, the device will not be usable. To work around this issue, the port as to be unused (e.g. by closing Tera Term) and the device has to be reconnected.</p>
<dl class="section note"><dt>Note</dt><dd>Due to the design of XDKs USB interface, reboot or resetting XDK as well as switching it off and on again make the device disappear from Windows' perspective.</dd></dl>
<p>XDK Workbench works around this issue by closing the port identifier, whenever XDK is disappearing. However, 3rd party applications usually will not do this. So, whenever XDK disappears, please close your terminal session and restart it once XDK is available again. </p>
</div></div><!-- contents -->
	<hr size="1" />
	All rights reserved. The use is subject to the XDK SDK EULA by Bosch Connected Devices and Solutions GmbH. 
	<hr size="1" />
	<address style="align: right;">
		<small>This documentation file has been automatically generated on Thu Mar 14 2019 19:12:49 by <a href="http://www.doxygen.org/index.html">doxygen</a> 1.8.8</small>
	</address>
</body>
</html>