<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.8">
  <compounddef id="ff_8c" kind="file">
    <compoundname>ff.c</compoundname>
    <includes refid="ff_8h" local="yes">ff.h</includes>
    <includes refid="diskio_8h" local="yes">diskio.h</includes>
    <includes local="no">stdarg.h</includes>
    <incdepgraph>
      <node id="29044">
        <label>stdbool.h</label>
      </node>
      <node id="29054">
        <label>stdarg.h</label>
      </node>
      <node id="29041">
        <label>BCDS_Assert.h</label>
        <link refid="_b_c_d_s___assert_8h"/>
        <childnode refid="29042" relation="include">
        </childnode>
      </node>
      <node id="29035">
        <label>ffconf.h</label>
        <link refid="ffconf_8h"/>
        <childnode refid="29036" relation="include">
        </childnode>
        <childnode refid="29037" relation="include">
        </childnode>
        <childnode refid="29050" relation="include">
        </childnode>
        <childnode refid="29052" relation="include">
        </childnode>
      </node>
      <node id="29042">
        <label>BCDS_Retcode.h</label>
        <link refid="_b_c_d_s___retcode_8h"/>
        <childnode refid="29043" relation="include">
        </childnode>
      </node>
      <node id="29039">
        <label>stdint.h</label>
      </node>
      <node id="29046">
        <label>stdlib.h</label>
      </node>
      <node id="29047">
        <label>BCDS_TaskConfig.h</label>
        <link refid="_b_c_d_s___task_config_8h"/>
      </node>
      <node id="29050">
        <label>semphr.h</label>
        <link refid="semphr_8h"/>
        <childnode refid="29051" relation="include">
        </childnode>
      </node>
      <node id="29034">
        <label>integer.h</label>
        <link refid="integer_8h"/>
      </node>
      <node id="29036">
        <label>diskio.h</label>
        <link refid="diskio_8h"/>
        <childnode refid="29034" relation="include">
        </childnode>
      </node>
      <node id="29038">
        <label>stddef.h</label>
      </node>
      <node id="29052">
        <label>BCDS_SDCard_Interface.h</label>
        <link refid="_b_c_d_s___s_d_card___interface_8h"/>
        <childnode refid="29039" relation="include">
        </childnode>
        <childnode refid="29053" relation="include">
        </childnode>
      </node>
      <node id="29049">
        <label>portable.h</label>
      </node>
      <node id="29045">
        <label>string.h</label>
      </node>
      <node id="29043">
        <label>BCDS_Basics.h</label>
        <link refid="_b_c_d_s___basics_8h"/>
        <childnode refid="29039" relation="include">
        </childnode>
        <childnode refid="29044" relation="include">
        </childnode>
        <childnode refid="29045" relation="include">
        </childnode>
        <childnode refid="29046" relation="include">
        </childnode>
      </node>
      <node id="29048">
        <label>projdefs.h</label>
      </node>
      <node id="29051">
        <label>queue.h</label>
        <link refid="queue_8h"/>
      </node>
      <node id="29032">
        <label>SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c</label>
        <link refid="ff.c"/>
        <childnode refid="29033" relation="include">
        </childnode>
        <childnode refid="29036" relation="include">
        </childnode>
        <childnode refid="29054" relation="include">
        </childnode>
      </node>
      <node id="29033">
        <label>ff.h</label>
        <link refid="ff_8h"/>
        <childnode refid="29034" relation="include">
        </childnode>
        <childnode refid="29035" relation="include">
        </childnode>
      </node>
      <node id="29040">
        <label>FreeRTOSConfig.h</label>
        <link refid="_free_r_t_o_s_config_8h"/>
        <childnode refid="29039" relation="include">
        </childnode>
        <childnode refid="29041" relation="include">
        </childnode>
        <childnode refid="29047" relation="include">
        </childnode>
      </node>
      <node id="29053">
        <label>BCDS_SDCard_Driver.h</label>
        <link refid="_b_c_d_s___s_d_card___driver_8h"/>
        <childnode refid="29042" relation="include">
        </childnode>
      </node>
      <node id="29037">
        <label>FreeRTOS.h</label>
        <link refid="_free_r_t_o_s_8h"/>
        <childnode refid="29038" relation="include">
        </childnode>
        <childnode refid="29039" relation="include">
        </childnode>
        <childnode refid="29040" relation="include">
        </childnode>
        <childnode refid="29048" relation="include">
        </childnode>
        <childnode refid="29049" relation="include">
        </childnode>
      </node>
    </incdepgraph>
    <innerclass refid="structputbuff" prot="public">putbuff</innerclass>
      <sectiondef kind="define">
      <memberdef kind="define" id="ff_8c_1ad6ce87cea84298e562cae4f6cde3c341" prot="public" static="no">
        <name>_DF1E</name>
        <initializer>0x9F	/* DBC 1st byte range 1 end */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="90" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="90" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a228bfd2cabe490c8567aaf08b8b2cc14" prot="public" static="no">
        <name>_DF1S</name>
        <initializer>0x81	/* DBC 1st byte range 1 start */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="89" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="89" bodyend="-1"/>
        <referencedby refid="ff_8c_1a2bc1b9d8567181c23b4720f4fb6076f5" compoundref="ff_8c" startline="1703" endline="1762">get_fileinfo</referencedby>
        <referencedby refid="ff_8c_1a1407adce52a966e786c7d37f9643a800" compoundref="ff_8c" startline="1843" endline="2042">create_name</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1ae92fde14909ccf6bec27f051a4b88a79" prot="public" static="no">
        <name>_DF2E</name>
        <initializer>0xFC	/* DBC 1st byte range 2 end */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="92" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="92" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a89ebd362b483a3a465fb485c9535a3c4" prot="public" static="no">
        <name>_DF2S</name>
        <initializer>0xE0	/* DBC 1st byte range 2 start */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="91" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="91" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a97cf766baca26c0ac1110df26e479c4c" prot="public" static="no">
        <name>_DS1E</name>
        <initializer>0x7E	/* DBC 2nd byte range 1 end */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="94" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="94" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a866564522f9fb431919f86ae507c42ef" prot="public" static="no">
        <name>_DS1S</name>
        <initializer>0x40	/* DBC 2nd byte range 1 start */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="93" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="93" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a0e747e5204b28f9c72c91cee52fde572" prot="public" static="no">
        <name>_DS2E</name>
        <initializer>0xFC	/* DBC 2nd byte range 2 end */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="96" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="96" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a6fd34725741cf6dc0524df2adbbb5a94" prot="public" static="no">
        <name>_DS2S</name>
        <initializer>0x80	/* DBC 2nd byte range 2 start */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="95" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="95" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a41e4c46636679236568cf50b5535847f" prot="public" static="no">
        <name>ABORT</name>
        <param><defname>fs</defname></param>
        <param><defname>res</defname></param>
        <initializer>{ fp-&gt;err = (<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)(res); <ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(fs, res); }</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="46" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="46" bodyend="-1"/>
        <referencedby refid="group__filesystem_1gac4c3dcb6869ca252888eebabe39727b3" compoundref="ff_8c" startline="2586" endline="2677">f_read</referencedby>
        <referencedby refid="group__filesystem_1gae6a4dfae8a9e308bdb2283a37ef680f2" compoundref="ff_8c" startline="2687" endline="2800">f_write</referencedby>
        <referencedby refid="group__filesystem_1ga5df0ac672ada972e89ef4b003e57f964" compoundref="ff_8c" startline="3029" endline="3178">f_lseek</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a383726fb93488d41866028b4f07c90e1" prot="public" static="no">
        <name>BPB_BkBootSec</name>
        <initializer>50		/* Offset of backup boot sector (2) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="394" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="394" bodyend="-1"/>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a8551844b4eb4e15aecd8cc9aa3585fa2" prot="public" static="no">
        <name>BPB_BytsPerSec</name>
        <initializer>11		/* Sector size [<ref refid="_fault_handler_8c_1a977b4c6fdb29af4d067f43aa302e99e9" kindref="member">byte</ref>] (2) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="371" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="371" bodyend="-1"/>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a6c832cd9e28f8e4fbbd45fdc86c7ebbb" prot="public" static="no">
        <name>BPB_ExtFlags</name>
        <initializer>40		/* Extended flags (2) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="390" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="390" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a60a2f6efeb6a4c7cb2da1e5def6ca43b" prot="public" static="no">
        <name>BPB_FATSz16</name>
        <initializer>22		/* FAT size [sector] (2) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="378" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="378" bodyend="-1"/>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a6e6340030dc29e7da2e9f92e472a763d" prot="public" static="no">
        <name>BPB_FATSz32</name>
        <initializer>36		/* FAT size [sector] (4) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="389" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="389" bodyend="-1"/>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a51c45669282b9ce9da5152231df9f3ac" prot="public" static="no">
        <name>BPB_FSInfo</name>
        <initializer>48		/* Offset of FSINFO sector (2) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="393" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="393" bodyend="-1"/>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a1f75a149df65028e24d43727b9ffcb9d" prot="public" static="no">
        <name>BPB_FSVer</name>
        <initializer>42		/* File system version (2) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="391" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="391" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a449d4ed5c4c8105daf29aad9488277f7" prot="public" static="no">
        <name>BPB_HiddSec</name>
        <initializer>28		/* Number of special hidden sectors (4) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="381" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="381" bodyend="-1"/>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a414e054c4b5ea3414ebefa3539e7e554" prot="public" static="no">
        <name>BPB_Media</name>
        <initializer>21		/* Media descriptor (1) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="377" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="377" bodyend="-1"/>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1af44a1e8c89ec5502595f23496d24cbf1" prot="public" static="no">
        <name>BPB_NumFATs</name>
        <initializer>16		/* Number of FAT copies (1) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="374" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="374" bodyend="-1"/>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a9c03603c3be34d4c5cc1b481b0bc6774" prot="public" static="no">
        <name>BPB_NumHeads</name>
        <initializer>26		/* Number of heads (2) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="380" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="380" bodyend="-1"/>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a7add0104bd20083d6940d616faecd45a" prot="public" static="no">
        <name>BPB_RootClus</name>
        <initializer>44		/* Root directory first cluster (4) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="392" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="392" bodyend="-1"/>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1aaa667f14c87c45dc128f2ab208e92f98" prot="public" static="no">
        <name>BPB_RootEntCnt</name>
        <initializer>17		/* Number of root directory entries for FAT12/16 (2) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="375" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="375" bodyend="-1"/>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1ab3ec444c8457c9bc98aa07e846f5c1b7" prot="public" static="no">
        <name>BPB_RsvdSecCnt</name>
        <initializer>14		/* Size of reserved area [sector] (2) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="373" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="373" bodyend="-1"/>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1aab78e41c617a14b9540c0563d6b957fa" prot="public" static="no">
        <name>BPB_SecPerClus</name>
        <initializer>13		/* Cluster size [sector] (1) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="372" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="372" bodyend="-1"/>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1ac71bb771432ea532bc47713a028ebd76" prot="public" static="no">
        <name>BPB_SecPerTrk</name>
        <initializer>24		/* Track size [sector] (2) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="379" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="379" bodyend="-1"/>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a4eb540eecde0f2df26fa8c7969341d68" prot="public" static="no">
        <name>BPB_TotSec16</name>
        <initializer>19		/* Volume size [sector] (2) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="376" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="376" bodyend="-1"/>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a7723a9f0da553e8879d60909d85ccb7b" prot="public" static="no">
        <name>BPB_TotSec32</name>
        <initializer>32		/* Volume size [sector] (4) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="382" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="382" bodyend="-1"/>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a74b810b3f3583c1eb54bd4305c0f261a" prot="public" static="no">
        <name>BS_55AA</name>
        <initializer>510		/* Signature word (2) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="407" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="407" bodyend="-1"/>
        <referencedby refid="ff_8c_1aec6b108298553219ebb2b960b528459d" compoundref="ff_8c" startline="760" endline="789">sync_fs</referencedby>
        <referencedby refid="ff_8c_1a55626c76a1556af5dc5345e2c0841a65" compoundref="ff_8c" startline="2175" endline="2193">check_fs</referencedby>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a85a92e790602efef4da3a2f141611ce8" prot="public" static="no">
        <name>BS_BootSig</name>
        <initializer>38		/* Extended boot signature (1) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="385" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="385" bodyend="-1"/>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a59c4b2f802ab4bc9319e5bd840e615b8" prot="public" static="no">
        <name>BS_BootSig32</name>
        <initializer>66		/* Extended boot signature (1) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="397" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="397" bodyend="-1"/>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a0c51f7393341b839dfb241c2951f3ef4" prot="public" static="no">
        <name>BS_DrvNum</name>
        <initializer>36		/* Physical drive number (1) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="383" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="383" bodyend="-1"/>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1aa670c7b495f5b347c442df67b188c58f" prot="public" static="no">
        <name>BS_DrvNum32</name>
        <initializer>64		/* Physical drive number (1) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="395" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="395" bodyend="-1"/>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a2264848692d36c1b2499c9b6a10acf75" prot="public" static="no">
        <name>BS_FilSysType</name>
        <initializer>54		/* File system type (1) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="388" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="388" bodyend="-1"/>
        <referencedby refid="ff_8c_1a55626c76a1556af5dc5345e2c0841a65" compoundref="ff_8c" startline="2175" endline="2193">check_fs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a8d8786452966cd0ce579f2575a54a348" prot="public" static="no">
        <name>BS_FilSysType32</name>
        <initializer>82		/* File system type (1) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="400" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="400" bodyend="-1"/>
        <referencedby refid="ff_8c_1a55626c76a1556af5dc5345e2c0841a65" compoundref="ff_8c" startline="2175" endline="2193">check_fs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a8f81669ee736efb2b2b49c7b0985472d" prot="public" static="no">
        <name>BS_jmpBoot</name>
        <initializer>0		/* x86 jump instruction (3) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="369" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="369" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a97d9de2942e551e182747f3ed01ab5b4" prot="public" static="no">
        <name>BS_NTres</name>
        <initializer>37		/* Error flag (1) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="384" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="384" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a0970c574d425c190a0d6fc6d40bcd9df" prot="public" static="no">
        <name>BS_NTres32</name>
        <initializer>65		/* Error flag (1) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="396" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="396" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a02a76ada191ec2dc5f8af60ff3576da7" prot="public" static="no">
        <name>BS_OEMName</name>
        <initializer>3		/* OEM name (8) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="370" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="370" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a383a71bda500a0fb5a37f4edd785acbf" prot="public" static="no">
        <name>BS_VolID</name>
        <initializer>39		/* Volume serial number (4) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="386" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="386" bodyend="-1"/>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1abaa3aafdcf5e83f8cb7e2bb373b13525" prot="public" static="no">
        <name>BS_VolID32</name>
        <initializer>67		/* Volume serial number (4) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="398" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="398" bodyend="-1"/>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a28498ba4b07ff90aaa9628e81fb89d32" prot="public" static="no">
        <name>BS_VolLab</name>
        <initializer>43		/* Volume label (8) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="387" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="387" bodyend="-1"/>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a8241a49bce313184a58617ba1ad9e84c" prot="public" static="no">
        <name>BS_VolLab32</name>
        <initializer>71		/* Volume label (8) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="399" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="399" bodyend="-1"/>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a0f2455f7318e6d56318c62f5e4048e1e" prot="public" static="no">
        <name>DDEM</name>
        <initializer>0xE5	/* Deleted directory entry mark at DIR_Name[0] */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="428" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="428" bodyend="-1"/>
        <referencedby refid="ff_8c_1a23ff0594686ccbd8f8d987547931ef04" compoundref="ff_8c" startline="1199" endline="1224">dir_alloc</referencedby>
        <referencedby refid="ff_8c_1abf87976453ebce0af60fa7bf4a6e21df" compoundref="ff_8c" startline="1458" endline="1509">dir_find</referencedby>
        <referencedby refid="ff_8c_1a3a47a08609e77266bc1928af812e06df" compoundref="ff_8c" startline="1519" endline="1567">dir_read</referencedby>
        <referencedby refid="ff_8c_1a724c260af4783a0ecf0db8d0687e7bd6" compoundref="ff_8c" startline="1656" endline="1692">dir_remove</referencedby>
        <referencedby refid="ff_8c_1a2bc1b9d8567181c23b4720f4fb6076f5" compoundref="ff_8c" startline="1703" endline="1762">get_fileinfo</referencedby>
        <referencedby refid="ff_8c_1a1407adce52a966e786c7d37f9643a800" compoundref="ff_8c" startline="1843" endline="2042">create_name</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a7cc27142421bd12be623072288599791" prot="public" static="no">
        <name>DEFINE_NAMEBUF</name>
        <initializer><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref> sfn[12]; <ref refid="integer_8h_1a570001c92f314285ad3e7139d8c58cf7" kindref="member">WCHAR</ref> lbuf[<ref refid="group___f_f_c_o_n_f_i_g_1ga14e73a5c703a586c614b3e40b849f82c" kindref="member">_MAX_LFN</ref> + 1]</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="473" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="473" bodyend="-1"/>
        <referencedby refid="group__filesystem_1gaefdef7126128d99d0b3bd82c28e54d80" compoundref="ff_8c" startline="2449" endline="2577">f_open</referencedby>
        <referencedby refid="group__filesystem_1gab63b213c75f7335fbb63a1f3f70e5fc7" compoundref="ff_8c" startline="3187" endline="3234">f_opendir</referencedby>
        <referencedby refid="group__filesystem_1gab39e82a110695de45f416f3149358012" compoundref="ff_8c" startline="3275" endline="3308">f_readdir</referencedby>
        <referencedby refid="group__filesystem_1gabe1f60daab5c7d11170c334fb832c798" compoundref="ff_8c" startline="3369" endline="3395">f_stat</referencedby>
        <referencedby refid="group__filesystem_1ga2858167fcd0bced48e9be434b3895efe" compoundref="ff_8c" startline="3526" endline="3586">f_unlink</referencedby>
        <referencedby refid="group__filesystem_1ga4b4d38db58e89c526cfcf53200d719d0" compoundref="ff_8c" startline="3595" endline="3660">f_mkdir</referencedby>
        <referencedby refid="group__filesystem_1ga9ee7e560eec8d82755c636ae41e702cd" compoundref="ff_8c" startline="3669" endline="3702">f_chmod</referencedby>
        <referencedby refid="group__filesystem_1ga2d0ceea336edd9b05754c8684ea8a72f" compoundref="ff_8c" startline="3711" endline="3780">f_rename</referencedby>
        <referencedby refid="group__filesystem_1gaafaa718d1a487e12a8f0087173dba0b9" compoundref="ff_8c" startline="3789" endline="3822">f_utime</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" prot="public" static="no">
        <name>DIR_Attr</name>
        <initializer>11		/* Attribute (1) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="410" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="410" bodyend="-1"/>
        <referencedby refid="ff_8c_1abf87976453ebce0af60fa7bf4a6e21df" compoundref="ff_8c" startline="1458" endline="1509">dir_find</referencedby>
        <referencedby refid="ff_8c_1a3a47a08609e77266bc1928af812e06df" compoundref="ff_8c" startline="1519" endline="1567">dir_read</referencedby>
        <referencedby refid="ff_8c_1a2bc1b9d8567181c23b4720f4fb6076f5" compoundref="ff_8c" startline="1703" endline="1762">get_fileinfo</referencedby>
        <referencedby refid="ff_8c_1af194524672491a522f041278b9b74e94" compoundref="ff_8c" startline="2052" endline="2104">follow_path</referencedby>
        <referencedby refid="group__filesystem_1gaefdef7126128d99d0b3bd82c28e54d80" compoundref="ff_8c" startline="2449" endline="2577">f_open</referencedby>
        <referencedby refid="group__filesystem_1gad69c7246b122ba56a134939ee0eaf847" compoundref="ff_8c" startline="2809" endline="2846">f_sync</referencedby>
        <referencedby refid="group__filesystem_1gab63b213c75f7335fbb63a1f3f70e5fc7" compoundref="ff_8c" startline="3187" endline="3234">f_opendir</referencedby>
        <referencedby refid="group__filesystem_1ga2858167fcd0bced48e9be434b3895efe" compoundref="ff_8c" startline="3526" endline="3586">f_unlink</referencedby>
        <referencedby refid="group__filesystem_1ga4b4d38db58e89c526cfcf53200d719d0" compoundref="ff_8c" startline="3595" endline="3660">f_mkdir</referencedby>
        <referencedby refid="group__filesystem_1ga9ee7e560eec8d82755c636ae41e702cd" compoundref="ff_8c" startline="3669" endline="3702">f_chmod</referencedby>
        <referencedby refid="group__filesystem_1ga2d0ceea336edd9b05754c8684ea8a72f" compoundref="ff_8c" startline="3711" endline="3780">f_rename</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1acf498617bb4c7750fd738864c3c0ab5a" prot="public" static="no">
        <name>DIR_CrtDate</name>
        <initializer>16		/* Created date (2) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="414" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="414" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a47fb1881ea71d860db9b8280564cb4d5" prot="public" static="no">
        <name>DIR_CrtTime</name>
        <initializer>14		/* Created <ref refid="_b_l_e_s_w___human_interface_device_01_release_notes_8txt_1a6f3a3fee0e1981cddf3c3bc3cde36aa5" kindref="member">time</ref> (2) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="413" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="413" bodyend="-1"/>
        <referencedby refid="group__filesystem_1gaefdef7126128d99d0b3bd82c28e54d80" compoundref="ff_8c" startline="2449" endline="2577">f_open</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a55fd459982581ae39fe3aeb242b2bc0f" prot="public" static="no">
        <name>DIR_CrtTimeTenth</name>
        <initializer>13		/* Created <ref refid="_b_l_e_s_w___human_interface_device_01_release_notes_8txt_1a6f3a3fee0e1981cddf3c3bc3cde36aa5" kindref="member">time</ref> sub-second (1) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="412" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="412" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1abfbfa613864a02a65f0bf70ead6672c7" prot="public" static="no">
        <name>DIR_FileSize</name>
        <initializer>28		/* File size (4) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="420" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="420" bodyend="-1"/>
        <referencedby refid="ff_8c_1a2bc1b9d8567181c23b4720f4fb6076f5" compoundref="ff_8c" startline="1703" endline="1762">get_fileinfo</referencedby>
        <referencedby refid="group__filesystem_1gaefdef7126128d99d0b3bd82c28e54d80" compoundref="ff_8c" startline="2449" endline="2577">f_open</referencedby>
        <referencedby refid="group__filesystem_1gad69c7246b122ba56a134939ee0eaf847" compoundref="ff_8c" startline="2809" endline="2846">f_sync</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a0bc29c3f09e1e9c40c414f7d50d7905c" prot="public" static="no">
        <name>DIR_FstClusHI</name>
        <initializer>20		/* Higher 16-bit of first cluster (2) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="416" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="416" bodyend="-1"/>
        <referencedby refid="ff_8c_1ad1b3343c92d0f0e58ba448c3c11b1f39" compoundref="ff_8c" startline="1235" endline="1247">ld_clust</referencedby>
        <referencedby refid="ff_8c_1a357e5a36452e057d68378c98cd61018c" compoundref="ff_8c" startline="1252" endline="1259">st_clust</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1aebe0e913bff75a89d38dbcb04baf5dff" prot="public" static="no">
        <name>DIR_FstClusLO</name>
        <initializer>26		/* Lower 16-bit of first cluster (2) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="419" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="419" bodyend="-1"/>
        <referencedby refid="ff_8c_1ad1b3343c92d0f0e58ba448c3c11b1f39" compoundref="ff_8c" startline="1235" endline="1247">ld_clust</referencedby>
        <referencedby refid="ff_8c_1a357e5a36452e057d68378c98cd61018c" compoundref="ff_8c" startline="1252" endline="1259">st_clust</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1afa0625d73f4683df24345f51e7a43da3" prot="public" static="no">
        <name>DIR_LstAccDate</name>
        <initializer>18		/* Last accessed date (2) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="415" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="415" bodyend="-1"/>
        <referencedby refid="group__filesystem_1gad69c7246b122ba56a134939ee0eaf847" compoundref="ff_8c" startline="2809" endline="2846">f_sync</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1afa89348e9fc2de82ae9e12c661366b0e" prot="public" static="no">
        <name>DIR_Name</name>
        <initializer>0		/* Short <ref refid="_b_l_e_s_w-_a_l_p_w_data_exchange_01_release_notes_8txt_1ac483df48653e4a0d787de0c45a6755b6" kindref="member">file</ref> name (11) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="409" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="409" bodyend="-1"/>
        <referencedby refid="ff_8c_1abf87976453ebce0af60fa7bf4a6e21df" compoundref="ff_8c" startline="1458" endline="1509">dir_find</referencedby>
        <referencedby refid="ff_8c_1a3a47a08609e77266bc1928af812e06df" compoundref="ff_8c" startline="1519" endline="1567">dir_read</referencedby>
        <referencedby refid="group__filesystem_1ga4b4d38db58e89c526cfcf53200d719d0" compoundref="ff_8c" startline="3595" endline="3660">f_mkdir</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a87ee1f701c2ab941862e3ce00c1c1e9d" prot="public" static="no">
        <name>DIR_NTres</name>
        <initializer>12		/* Lower case flag (1) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="411" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="411" bodyend="-1"/>
        <referencedby refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" compoundref="ff_8c" startline="1578" endline="1645">dir_register</referencedby>
        <referencedby refid="ff_8c_1a2bc1b9d8567181c23b4720f4fb6076f5" compoundref="ff_8c" startline="1703" endline="1762">get_fileinfo</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1abed17fa699511b09cbf64961373d63a4" prot="public" static="no">
        <name>DIR_WrtDate</name>
        <initializer>24		/* Modified date (2) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="418" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="418" bodyend="-1"/>
        <referencedby refid="ff_8c_1a2bc1b9d8567181c23b4720f4fb6076f5" compoundref="ff_8c" startline="1703" endline="1762">get_fileinfo</referencedby>
        <referencedby refid="group__filesystem_1gaafaa718d1a487e12a8f0087173dba0b9" compoundref="ff_8c" startline="3789" endline="3822">f_utime</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1ab9452d336adeece2a1b0b54ab35b8a59" prot="public" static="no">
        <name>DIR_WrtTime</name>
        <initializer>22		/* Modified <ref refid="_b_l_e_s_w___human_interface_device_01_release_notes_8txt_1a6f3a3fee0e1981cddf3c3bc3cde36aa5" kindref="member">time</ref> (2) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="417" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="417" bodyend="-1"/>
        <referencedby refid="ff_8c_1a2bc1b9d8567181c23b4720f4fb6076f5" compoundref="ff_8c" startline="1703" endline="1762">get_fileinfo</referencedby>
        <referencedby refid="group__filesystem_1gaefdef7126128d99d0b3bd82c28e54d80" compoundref="ff_8c" startline="2449" endline="2577">f_open</referencedby>
        <referencedby refid="group__filesystem_1gad69c7246b122ba56a134939ee0eaf847" compoundref="ff_8c" startline="2809" endline="2846">f_sync</referencedby>
        <referencedby refid="group__filesystem_1ga4b4d38db58e89c526cfcf53200d719d0" compoundref="ff_8c" startline="3595" endline="3660">f_mkdir</referencedby>
        <referencedby refid="group__filesystem_1gaafaa718d1a487e12a8f0087173dba0b9" compoundref="ff_8c" startline="3789" endline="3822">f_utime</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a458e336ac53f8249ed02d844469b7076" prot="public" static="no">
        <name>ENTER_FF</name>
        <param><defname>fs</defname></param>
        <initializer>{ if (!<ref refid="ff_8c_1af35d759ac2dbde3cef605901cab3a776" kindref="member">lock_fs</ref>(fs)) return <ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca3f8ca7e51af8b129d14328de7243c5d4" kindref="member">FR_TIMEOUT</ref>; }</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="39" column="10" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="39" bodyend="-1"/>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
        <referencedby refid="ff_8c_1aa7193f5b86c3996b5312043a0c26da5f" compoundref="ff_8c" startline="2372" endline="2385">validate</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1aba6d6942b59f11cf285bdbfb7e38f1fa" prot="public" static="no">
        <name>FREE_BUF</name>
        <param></param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="475" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="475" bodyend="-1"/>
        <referencedby refid="group__filesystem_1gaefdef7126128d99d0b3bd82c28e54d80" compoundref="ff_8c" startline="2449" endline="2577">f_open</referencedby>
        <referencedby refid="group__filesystem_1gab63b213c75f7335fbb63a1f3f70e5fc7" compoundref="ff_8c" startline="3187" endline="3234">f_opendir</referencedby>
        <referencedby refid="group__filesystem_1gab39e82a110695de45f416f3149358012" compoundref="ff_8c" startline="3275" endline="3308">f_readdir</referencedby>
        <referencedby refid="group__filesystem_1gabe1f60daab5c7d11170c334fb832c798" compoundref="ff_8c" startline="3369" endline="3395">f_stat</referencedby>
        <referencedby refid="group__filesystem_1ga2858167fcd0bced48e9be434b3895efe" compoundref="ff_8c" startline="3526" endline="3586">f_unlink</referencedby>
        <referencedby refid="group__filesystem_1ga4b4d38db58e89c526cfcf53200d719d0" compoundref="ff_8c" startline="3595" endline="3660">f_mkdir</referencedby>
        <referencedby refid="group__filesystem_1ga9ee7e560eec8d82755c636ae41e702cd" compoundref="ff_8c" startline="3669" endline="3702">f_chmod</referencedby>
        <referencedby refid="group__filesystem_1ga2d0ceea336edd9b05754c8684ea8a72f" compoundref="ff_8c" startline="3711" endline="3780">f_rename</referencedby>
        <referencedby refid="group__filesystem_1gaafaa718d1a487e12a8f0087173dba0b9" compoundref="ff_8c" startline="3789" endline="3822">f_utime</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1ab711e50459aba01b11c6b46a7cc1410b" prot="public" static="no">
        <name>FSI_Free_Count</name>
        <initializer>488		/* FSI: Number of free clusters (4) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="403" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="403" bodyend="-1"/>
        <referencedby refid="ff_8c_1aec6b108298553219ebb2b960b528459d" compoundref="ff_8c" startline="760" endline="789">sync_fs</referencedby>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a318e58c1966aba52b90ab98dcb649883" prot="public" static="no">
        <name>FSI_LeadSig</name>
        <initializer>0		/* FSI: Leading signature (4) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="401" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="401" bodyend="-1"/>
        <referencedby refid="ff_8c_1aec6b108298553219ebb2b960b528459d" compoundref="ff_8c" startline="760" endline="789">sync_fs</referencedby>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a320700cedf300c9b418edf56e5e6b086" prot="public" static="no">
        <name>FSI_Nxt_Free</name>
        <initializer>492		/* FSI: Last allocated cluster (4) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="404" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="404" bodyend="-1"/>
        <referencedby refid="ff_8c_1aec6b108298553219ebb2b960b528459d" compoundref="ff_8c" startline="760" endline="789">sync_fs</referencedby>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a3bac0e6ff5907873030db1d0a7c4ebef" prot="public" static="no">
        <name>FSI_StrucSig</name>
        <initializer>484		/* FSI: Structure signature (4) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="402" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="402" bodyend="-1"/>
        <referencedby refid="ff_8c_1aec6b108298553219ebb2b960b528459d" compoundref="ff_8c" startline="760" endline="789">sync_fs</referencedby>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a72589f5bbb514c0b222ab8b292764418" prot="public" static="no">
        <name>GET_FATTIME</name>
        <param></param>
        <initializer><ref refid="ff_8h_1af58b536abfd30f77213f4ecaf2ac52f5" kindref="member">get_fattime</ref>()</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="67" column="10" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="67" bodyend="-1"/>
        <referencedby refid="group__filesystem_1gaefdef7126128d99d0b3bd82c28e54d80" compoundref="ff_8c" startline="2449" endline="2577">f_open</referencedby>
        <referencedby refid="group__filesystem_1gad69c7246b122ba56a134939ee0eaf847" compoundref="ff_8c" startline="2809" endline="2846">f_sync</referencedby>
        <referencedby refid="group__filesystem_1ga4b4d38db58e89c526cfcf53200d719d0" compoundref="ff_8c" startline="3595" endline="3660">f_mkdir</referencedby>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a966fe5792671b39db1ccf655a8c1af8d" prot="public" static="no">
        <name>INIT_BUF</name>
        <param><defname>dobj</defname></param>
        <initializer>{ (dobj).fn = sfn; (dobj).lfn = lbuf; }</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="474" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="474" bodyend="-1"/>
        <referencedby refid="group__filesystem_1gaefdef7126128d99d0b3bd82c28e54d80" compoundref="ff_8c" startline="2449" endline="2577">f_open</referencedby>
        <referencedby refid="group__filesystem_1gab63b213c75f7335fbb63a1f3f70e5fc7" compoundref="ff_8c" startline="3187" endline="3234">f_opendir</referencedby>
        <referencedby refid="group__filesystem_1gab39e82a110695de45f416f3149358012" compoundref="ff_8c" startline="3275" endline="3308">f_readdir</referencedby>
        <referencedby refid="group__filesystem_1gabe1f60daab5c7d11170c334fb832c798" compoundref="ff_8c" startline="3369" endline="3395">f_stat</referencedby>
        <referencedby refid="group__filesystem_1ga2858167fcd0bced48e9be434b3895efe" compoundref="ff_8c" startline="3526" endline="3586">f_unlink</referencedby>
        <referencedby refid="group__filesystem_1ga4b4d38db58e89c526cfcf53200d719d0" compoundref="ff_8c" startline="3595" endline="3660">f_mkdir</referencedby>
        <referencedby refid="group__filesystem_1ga9ee7e560eec8d82755c636ae41e702cd" compoundref="ff_8c" startline="3669" endline="3702">f_chmod</referencedby>
        <referencedby refid="group__filesystem_1ga2d0ceea336edd9b05754c8684ea8a72f" compoundref="ff_8c" startline="3711" endline="3780">f_rename</referencedby>
        <referencedby refid="group__filesystem_1gaafaa718d1a487e12a8f0087173dba0b9" compoundref="ff_8c" startline="3789" endline="3822">f_utime</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a58d63a832a117f179e41c7373d013dd6" prot="public" static="no">
        <name>IsDBCS1</name>
        <param><defname>c</defname></param>
        <initializer>(((<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)(c) &gt;= <ref refid="ff_8c_1a228bfd2cabe490c8567aaf08b8b2cc14" kindref="member">_DF1S</ref> &amp;&amp; (<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)(c) &lt;= <ref refid="ff_8c_1ad6ce87cea84298e562cae4f6cde3c341" kindref="member">_DF1E</ref>) || ((<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)(c) &gt;= <ref refid="ff_8c_1a89ebd362b483a3a465fb485c9535a3c4" kindref="member">_DF2S</ref> &amp;&amp; (<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)(c) &lt;= <ref refid="ff_8c_1ae92fde14909ccf6bec27f051a4b88a79" kindref="member">_DF2E</ref>))</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="331" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="331" bodyend="-1"/>
        <referencedby refid="ff_8c_1a01f02bd7a6b0835c15c4978cad7977dd" compoundref="ff_8c" startline="1379" endline="1427">gen_numname</referencedby>
        <referencedby refid="ff_8c_1a2bc1b9d8567181c23b4720f4fb6076f5" compoundref="ff_8c" startline="1703" endline="1762">get_fileinfo</referencedby>
        <referencedby refid="ff_8c_1a1407adce52a966e786c7d37f9643a800" compoundref="ff_8c" startline="1843" endline="2042">create_name</referencedby>
        <referencedby refid="group__filesystem_1ga0fa54bd310785ecdaed19dda8f60dac5" compoundref="ff_8c" startline="4382" endline="4450">f_gets</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a66a3fa880af6078ef181656c1d7d8ef1" prot="public" static="no">
        <name>IsDBCS2</name>
        <param><defname>c</defname></param>
        <initializer>(((<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)(c) &gt;= <ref refid="ff_8c_1a866564522f9fb431919f86ae507c42ef" kindref="member">_DS1S</ref> &amp;&amp; (<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)(c) &lt;= <ref refid="ff_8c_1a97cf766baca26c0ac1110df26e479c4c" kindref="member">_DS1E</ref>) || ((<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)(c) &gt;= <ref refid="ff_8c_1a6fd34725741cf6dc0524df2adbbb5a94" kindref="member">_DS2S</ref> &amp;&amp; (<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)(c) &lt;= <ref refid="ff_8c_1a0e747e5204b28f9c72c91cee52fde572" kindref="member">_DS2E</ref>))</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="339" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="339" bodyend="-1"/>
        <referencedby refid="ff_8c_1a2bc1b9d8567181c23b4720f4fb6076f5" compoundref="ff_8c" startline="1703" endline="1762">get_fileinfo</referencedby>
        <referencedby refid="ff_8c_1a1407adce52a966e786c7d37f9643a800" compoundref="ff_8c" startline="1843" endline="2042">create_name</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a65dee564f69f2ec27f25b67a348018b9" prot="public" static="no">
        <name>IsDigit</name>
        <param><defname>c</defname></param>
        <initializer>(((c)&gt;=&apos;0&apos;)&amp;&amp;((c)&lt;=&apos;9&apos;))</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="326" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="326" bodyend="-1"/>
        <referencedby refid="group__filesystem_1ga49cccab38cd84e2d3357fef2d1df21f9" compoundref="ff_8c" startline="4579" endline="4674">f_printf</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a4a9d454724926bd51a3aed589a97f08b" prot="public" static="no">
        <name>IsLower</name>
        <param><defname>c</defname></param>
        <initializer>(((c)&gt;=&apos;a&apos;)&amp;&amp;((c)&lt;=&apos;z&apos;))</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="325" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="325" bodyend="-1"/>
        <referencedby refid="ff_8c_1a1407adce52a966e786c7d37f9643a800" compoundref="ff_8c" startline="1843" endline="2042">create_name</referencedby>
        <referencedby refid="ff_8c_1a88ad7e4b1bc98d1a2673a136283dc7ee" compoundref="ff_8c" startline="2114" endline="2165">get_ldnumber</referencedby>
        <referencedby refid="group__filesystem_1ga49cccab38cd84e2d3357fef2d1df21f9" compoundref="ff_8c" startline="4579" endline="4674">f_printf</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a89b2514198590e139dd064c5d534f302" prot="public" static="no">
        <name>IsUpper</name>
        <param><defname>c</defname></param>
        <initializer>(((c)&gt;=&apos;A&apos;)&amp;&amp;((c)&lt;=&apos;Z&apos;))</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="324" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="324" bodyend="-1"/>
        <referencedby refid="ff_8c_1a2bc1b9d8567181c23b4720f4fb6076f5" compoundref="ff_8c" startline="1703" endline="1762">get_fileinfo</referencedby>
        <referencedby refid="ff_8c_1a1407adce52a966e786c7d37f9643a800" compoundref="ff_8c" startline="1843" endline="2042">create_name</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a28dcd75633b49e40b42a31f0cf5f5929" prot="public" static="no">
        <name>LDIR_Attr</name>
        <initializer>11		/* LFN attribute (1) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="422" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="422" bodyend="-1"/>
        <referencedby refid="ff_8c_1a3fe23e7983a2974b8002a8e57c1c06e9" compoundref="ff_8c" startline="1341" endline="1366">fit_lfn</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1ade1d529763d2d097a6d1410956c8a84f" prot="public" static="no">
        <name>LDIR_Chksum</name>
        <initializer>13		/* Checksum of corresponding SFN entry */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="424" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="424" bodyend="-1"/>
        <referencedby refid="ff_8c_1a3fe23e7983a2974b8002a8e57c1c06e9" compoundref="ff_8c" startline="1341" endline="1366">fit_lfn</referencedby>
        <referencedby refid="ff_8c_1abf87976453ebce0af60fa7bf4a6e21df" compoundref="ff_8c" startline="1458" endline="1509">dir_find</referencedby>
        <referencedby refid="ff_8c_1a3a47a08609e77266bc1928af812e06df" compoundref="ff_8c" startline="1519" endline="1567">dir_read</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1ad73024151eff6baea94e680f7928969d" prot="public" static="no">
        <name>LDIR_FstClusLO</name>
        <initializer>26		/* Must be zero (0) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="425" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="425" bodyend="-1"/>
        <referencedby refid="ff_8c_1a7ce4d4f3aa55873dc160d76778536a5f" compoundref="ff_8c" startline="1274" endline="1302">cmp_lfn</referencedby>
        <referencedby refid="ff_8c_1a2a2c96233e92d8abe12c4496caec85cf" compoundref="ff_8c" startline="1307" endline="1336">pick_lfn</referencedby>
        <referencedby refid="ff_8c_1a3fe23e7983a2974b8002a8e57c1c06e9" compoundref="ff_8c" startline="1341" endline="1366">fit_lfn</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a6c97d545619e6586b02b5d4f39f7be25" prot="public" static="no">
        <name>LDIR_Ord</name>
        <initializer>0		/* LFN entry order and LLE flag (1) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="421" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="421" bodyend="-1"/>
        <referencedby refid="ff_8c_1a7ce4d4f3aa55873dc160d76778536a5f" compoundref="ff_8c" startline="1274" endline="1302">cmp_lfn</referencedby>
        <referencedby refid="ff_8c_1a2a2c96233e92d8abe12c4496caec85cf" compoundref="ff_8c" startline="1307" endline="1336">pick_lfn</referencedby>
        <referencedby refid="ff_8c_1a3fe23e7983a2974b8002a8e57c1c06e9" compoundref="ff_8c" startline="1341" endline="1366">fit_lfn</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1acb98a052a9be81564b56854df35480a0" prot="public" static="no">
        <name>LDIR_Type</name>
        <initializer>12		/* LFN type (1) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="423" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="423" bodyend="-1"/>
        <referencedby refid="ff_8c_1a3fe23e7983a2974b8002a8e57c1c06e9" compoundref="ff_8c" startline="1341" endline="1366">fit_lfn</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" prot="public" static="no">
        <name>LEAVE_FF</name>
        <param><defname>fs</defname></param>
        <param><defname>res</defname></param>
        <initializer>{ <ref refid="ff_8c_1a58c93c453ba943336cd24aa185cd72cf" kindref="member">unlock_fs</ref>(fs, res); return res; }</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="40" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="40" bodyend="-1"/>
        <referencedby refid="group__filesystem_1ga16a934c2bbfa2160295810adc49d5509" compoundref="ff_8c" startline="2402" endline="2440">f_mount</referencedby>
        <referencedby refid="group__filesystem_1gaefdef7126128d99d0b3bd82c28e54d80" compoundref="ff_8c" startline="2449" endline="2577">f_open</referencedby>
        <referencedby refid="group__filesystem_1gac4c3dcb6869ca252888eebabe39727b3" compoundref="ff_8c" startline="2586" endline="2677">f_read</referencedby>
        <referencedby refid="group__filesystem_1gae6a4dfae8a9e308bdb2283a37ef680f2" compoundref="ff_8c" startline="2687" endline="2800">f_write</referencedby>
        <referencedby refid="group__filesystem_1gad69c7246b122ba56a134939ee0eaf847" compoundref="ff_8c" startline="2809" endline="2846">f_sync</referencedby>
        <referencedby refid="group__filesystem_1ga5df0ac672ada972e89ef4b003e57f964" compoundref="ff_8c" startline="3029" endline="3178">f_lseek</referencedby>
        <referencedby refid="group__filesystem_1gab63b213c75f7335fbb63a1f3f70e5fc7" compoundref="ff_8c" startline="3187" endline="3234">f_opendir</referencedby>
        <referencedby refid="group__filesystem_1gab39e82a110695de45f416f3149358012" compoundref="ff_8c" startline="3275" endline="3308">f_readdir</referencedby>
        <referencedby refid="group__filesystem_1gabe1f60daab5c7d11170c334fb832c798" compoundref="ff_8c" startline="3369" endline="3395">f_stat</referencedby>
        <referencedby refid="group__filesystem_1ga0ff39f75a87cbda9cd6ea65d83f16cec" compoundref="ff_8c" startline="3404" endline="3461">f_getfree</referencedby>
        <referencedby refid="group__filesystem_1ga691a27b40c348f7c84b42e911636f38a" compoundref="ff_8c" startline="3470" endline="3517">f_truncate</referencedby>
        <referencedby refid="group__filesystem_1ga2858167fcd0bced48e9be434b3895efe" compoundref="ff_8c" startline="3526" endline="3586">f_unlink</referencedby>
        <referencedby refid="group__filesystem_1ga4b4d38db58e89c526cfcf53200d719d0" compoundref="ff_8c" startline="3595" endline="3660">f_mkdir</referencedby>
        <referencedby refid="group__filesystem_1ga9ee7e560eec8d82755c636ae41e702cd" compoundref="ff_8c" startline="3669" endline="3702">f_chmod</referencedby>
        <referencedby refid="group__filesystem_1ga2d0ceea336edd9b05754c8684ea8a72f" compoundref="ff_8c" startline="3711" endline="3780">f_rename</referencedby>
        <referencedby refid="group__filesystem_1gaafaa718d1a487e12a8f0087173dba0b9" compoundref="ff_8c" startline="3789" endline="3822">f_utime</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a31ec96cd263bb14418cb8b7b2b54b3ca" prot="public" static="no">
        <name>LLEF</name>
        <initializer>0x40	/* Last long entry flag in LDIR_Ord */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="427" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="427" bodyend="-1"/>
        <referencedby refid="ff_8c_1a7ce4d4f3aa55873dc160d76778536a5f" compoundref="ff_8c" startline="1274" endline="1302">cmp_lfn</referencedby>
        <referencedby refid="ff_8c_1a2a2c96233e92d8abe12c4496caec85cf" compoundref="ff_8c" startline="1307" endline="1336">pick_lfn</referencedby>
        <referencedby refid="ff_8c_1a3fe23e7983a2974b8002a8e57c1c06e9" compoundref="ff_8c" startline="1341" endline="1366">fit_lfn</referencedby>
        <referencedby refid="ff_8c_1abf87976453ebce0af60fa7bf4a6e21df" compoundref="ff_8c" startline="1458" endline="1509">dir_find</referencedby>
        <referencedby refid="ff_8c_1a3a47a08609e77266bc1928af812e06df" compoundref="ff_8c" startline="1519" endline="1567">dir_read</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1ac3f187bf0ba891551f594af6b61f3188" prot="public" static="no">
        <name>MBR_Table</name>
        <initializer>446		/* MBR: Partition table offset (2) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="405" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="405" bodyend="-1"/>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1aeec02d5ae07ede32b7d74155bf0fda15" prot="public" static="no">
        <name>MIN_FAT16</name>
        <initializer>4086U	/* Minimum number of clusters of FAT16 */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="361" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="361" bodyend="-1"/>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a483625319f3e3bd5ac6502b46c375aed" prot="public" static="no">
        <name>MIN_FAT32</name>
        <initializer>65526U	/* Minimum number of clusters of FAT32 */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="362" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="362" bodyend="-1"/>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a3f9495abc6071dcfdbd242cc1f9ad9f8" prot="public" static="no">
        <name>N_FATS</name>
        <initializer>1		/* Number of FATs (1 or 2) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="4060" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="4060" bodyend="-1"/>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a412083bc7d166082045a0111e890b22a" prot="public" static="no">
        <name>N_ROOTDIR</name>
        <initializer>512		/* Number of root directory entries for FAT12/16 */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="4059" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="4059" bodyend="-1"/>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a4a0e89b504dece19e2e4b02c83782ca2" prot="public" static="no">
        <name>NS_BODY</name>
        <initializer>0x08	/* Lower case flag (body) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="355" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="355" bodyend="-1"/>
        <referencedby refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" compoundref="ff_8c" startline="1578" endline="1645">dir_register</referencedby>
        <referencedby refid="ff_8c_1a2bc1b9d8567181c23b4720f4fb6076f5" compoundref="ff_8c" startline="1703" endline="1762">get_fileinfo</referencedby>
        <referencedby refid="ff_8c_1a1407adce52a966e786c7d37f9643a800" compoundref="ff_8c" startline="1843" endline="2042">create_name</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a2db528782a021797b34bdc6e9e9de1c3" prot="public" static="no">
        <name>NS_DOT</name>
        <initializer>0x20	/* Dot entry */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="357" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="357" bodyend="-1"/>
        <referencedby refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" compoundref="ff_8c" startline="1578" endline="1645">dir_register</referencedby>
        <referencedby refid="ff_8c_1a1407adce52a966e786c7d37f9643a800" compoundref="ff_8c" startline="1843" endline="2042">create_name</referencedby>
        <referencedby refid="ff_8c_1af194524672491a522f041278b9b74e94" compoundref="ff_8c" startline="2052" endline="2104">follow_path</referencedby>
        <referencedby refid="group__filesystem_1ga2858167fcd0bced48e9be434b3895efe" compoundref="ff_8c" startline="3526" endline="3586">f_unlink</referencedby>
        <referencedby refid="group__filesystem_1ga4b4d38db58e89c526cfcf53200d719d0" compoundref="ff_8c" startline="3595" endline="3660">f_mkdir</referencedby>
        <referencedby refid="group__filesystem_1ga9ee7e560eec8d82755c636ae41e702cd" compoundref="ff_8c" startline="3669" endline="3702">f_chmod</referencedby>
        <referencedby refid="group__filesystem_1ga2d0ceea336edd9b05754c8684ea8a72f" compoundref="ff_8c" startline="3711" endline="3780">f_rename</referencedby>
        <referencedby refid="group__filesystem_1gaafaa718d1a487e12a8f0087173dba0b9" compoundref="ff_8c" startline="3789" endline="3822">f_utime</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a3b7fad0942e816fdb84d869c1f7a613e" prot="public" static="no">
        <name>NS_EXT</name>
        <initializer>0x10	/* Lower case flag (ext) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="356" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="356" bodyend="-1"/>
        <referencedby refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" compoundref="ff_8c" startline="1578" endline="1645">dir_register</referencedby>
        <referencedby refid="ff_8c_1a2bc1b9d8567181c23b4720f4fb6076f5" compoundref="ff_8c" startline="1703" endline="1762">get_fileinfo</referencedby>
        <referencedby refid="ff_8c_1a1407adce52a966e786c7d37f9643a800" compoundref="ff_8c" startline="1843" endline="2042">create_name</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a5a0742bfc1d94f0c3baa5ede485048c4" prot="public" static="no">
        <name>NS_LAST</name>
        <initializer>0x04	/* Last segment */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="354" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="354" bodyend="-1"/>
        <referencedby refid="ff_8c_1a1407adce52a966e786c7d37f9643a800" compoundref="ff_8c" startline="1843" endline="2042">create_name</referencedby>
        <referencedby refid="ff_8c_1af194524672491a522f041278b9b74e94" compoundref="ff_8c" startline="2052" endline="2104">follow_path</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1ae957b8d4065ea0b3eed822aec5368d29" prot="public" static="no">
        <name>NS_LFN</name>
        <initializer>0x02	/* Force to create LFN entry */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="353" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="353" bodyend="-1"/>
        <referencedby refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" compoundref="ff_8c" startline="1578" endline="1645">dir_register</referencedby>
        <referencedby refid="ff_8c_1a1407adce52a966e786c7d37f9643a800" compoundref="ff_8c" startline="1843" endline="2042">create_name</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1ac92c92c3a3d6b9235ac98feeb00e565a" prot="public" static="no">
        <name>NS_LOSS</name>
        <initializer>0x01	/* Out of 8.3 format */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="352" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="352" bodyend="-1"/>
        <referencedby refid="ff_8c_1abf87976453ebce0af60fa7bf4a6e21df" compoundref="ff_8c" startline="1458" endline="1509">dir_find</referencedby>
        <referencedby refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" compoundref="ff_8c" startline="1578" endline="1645">dir_register</referencedby>
        <referencedby refid="ff_8c_1a1407adce52a966e786c7d37f9643a800" compoundref="ff_8c" startline="1843" endline="2042">create_name</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1ad2306816015e67e72cfd0a20a880b227" prot="public" static="no">
        <name>NSFLAG</name>
        <initializer>11		/* Index of name status <ref refid="_fault_handler_8c_1a977b4c6fdb29af4d067f43aa302e99e9" kindref="member">byte</ref> in fn[] */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="351" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="351" bodyend="-1"/>
        <referencedby refid="ff_8c_1abf87976453ebce0af60fa7bf4a6e21df" compoundref="ff_8c" startline="1458" endline="1509">dir_find</referencedby>
        <referencedby refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" compoundref="ff_8c" startline="1578" endline="1645">dir_register</referencedby>
        <referencedby refid="ff_8c_1a1407adce52a966e786c7d37f9643a800" compoundref="ff_8c" startline="1843" endline="2042">create_name</referencedby>
        <referencedby refid="ff_8c_1af194524672491a522f041278b9b74e94" compoundref="ff_8c" startline="2052" endline="2104">follow_path</referencedby>
        <referencedby refid="group__filesystem_1ga2858167fcd0bced48e9be434b3895efe" compoundref="ff_8c" startline="3526" endline="3586">f_unlink</referencedby>
        <referencedby refid="group__filesystem_1ga4b4d38db58e89c526cfcf53200d719d0" compoundref="ff_8c" startline="3595" endline="3660">f_mkdir</referencedby>
        <referencedby refid="group__filesystem_1ga9ee7e560eec8d82755c636ae41e702cd" compoundref="ff_8c" startline="3669" endline="3702">f_chmod</referencedby>
        <referencedby refid="group__filesystem_1ga2d0ceea336edd9b05754c8684ea8a72f" compoundref="ff_8c" startline="3711" endline="3780">f_rename</referencedby>
        <referencedby refid="group__filesystem_1gaafaa718d1a487e12a8f0087173dba0b9" compoundref="ff_8c" startline="3789" endline="3822">f_utime</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a24b6bc427cbd37fbe76e087f7f188abb" prot="public" static="no">
        <name>RDDEM</name>
        <initializer>0x05	/* Replacement of the character collides with DDEM */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="429" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="429" bodyend="-1"/>
        <referencedby refid="ff_8c_1a2bc1b9d8567181c23b4720f4fb6076f5" compoundref="ff_8c" startline="1703" endline="1762">get_fileinfo</referencedby>
        <referencedby refid="ff_8c_1a1407adce52a966e786c7d37f9643a800" compoundref="ff_8c" startline="1843" endline="2042">create_name</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" prot="public" static="no">
        <name>SS</name>
        <param><defname>fs</defname></param>
        <initializer>((<ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref>)<ref refid="group___f_f_c_o_n_f_i_g_1gac271b697378912f17132cb9c7d0de024" kindref="member">_MAX_SS</ref>)	/* Fixed sector size */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="54" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="54" bodyend="-1"/>
        <referencedby refid="ff_8c_1aec6b108298553219ebb2b960b528459d" compoundref="ff_8c" startline="760" endline="789">sync_fs</referencedby>
        <referencedby refid="ff_8c_1a65611adf1626e5e08da77cd33a98dd8b" compoundref="ff_8c" startline="818" endline="862">get_fat</referencedby>
        <referencedby refid="ff_8c_1abd4b6b071a8d728a88727051c12bc6d7" compoundref="ff_8c" startline="873" endline="926">put_fat</referencedby>
        <referencedby refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" compoundref="ff_8c" startline="1080" endline="1118">dir_sdi</referencedby>
        <referencedby refid="ff_8c_1a2edd26ac71869f25be5fce12eec58171" compoundref="ff_8c" startline="1128" endline="1188">dir_next</referencedby>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
        <referencedby refid="group__filesystem_1gac4c3dcb6869ca252888eebabe39727b3" compoundref="ff_8c" startline="2586" endline="2677">f_read</referencedby>
        <referencedby refid="group__filesystem_1gae6a4dfae8a9e308bdb2283a37ef680f2" compoundref="ff_8c" startline="2687" endline="2800">f_write</referencedby>
        <referencedby refid="group__filesystem_1ga5df0ac672ada972e89ef4b003e57f964" compoundref="ff_8c" startline="3029" endline="3178">f_lseek</referencedby>
        <referencedby refid="group__filesystem_1ga0ff39f75a87cbda9cd6ea65d83f16cec" compoundref="ff_8c" startline="3404" endline="3461">f_getfree</referencedby>
        <referencedby refid="group__filesystem_1ga4b4d38db58e89c526cfcf53200d719d0" compoundref="ff_8c" startline="3595" endline="3660">f_mkdir</referencedby>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" prot="public" static="no">
        <name>SZ_DIRE</name>
        <initializer>32		/* Size of a directory entry */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="426" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="426" bodyend="-1"/>
        <referencedby refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" compoundref="ff_8c" startline="1080" endline="1118">dir_sdi</referencedby>
        <referencedby refid="ff_8c_1a2edd26ac71869f25be5fce12eec58171" compoundref="ff_8c" startline="1128" endline="1188">dir_next</referencedby>
        <referencedby refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" compoundref="ff_8c" startline="1578" endline="1645">dir_register</referencedby>
        <referencedby refid="ff_8c_1a724c260af4783a0ecf0db8d0687e7bd6" compoundref="ff_8c" startline="1656" endline="1692">dir_remove</referencedby>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
        <referencedby refid="group__filesystem_1ga4b4d38db58e89c526cfcf53200d719d0" compoundref="ff_8c" startline="3595" endline="3660">f_mkdir</referencedby>
        <referencedby refid="group__filesystem_1ga2d0ceea336edd9b05754c8684ea8a72f" compoundref="ff_8c" startline="3711" endline="3780">f_rename</referencedby>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="define" id="ff_8c_1af133060c47366e7e557d4085d931183f" prot="public" static="no">
        <name>SZ_PTE</name>
        <initializer>16		/* MBR: Size of a partition table entry */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="406" column="9" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="406" bodyend="-1"/>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      </sectiondef>
      <sectiondef kind="var">
      <memberdef kind="variable" id="ff_8c_1a3d7aad0939745576943767bf6c410eaf" prot="public" static="yes" mutable="no">
        <type><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref> *</type>
        <definition>FATFS* FatFs[_VOLUMES]</definition>
        <argsstring>[_VOLUMES]</argsstring>
        <name>FatFs</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="448" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="448" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="ff_8c_1a0b3f41d8c416222e9b1c16e36d66e18b" prot="public" static="yes" mutable="no">
        <type><ref refid="integer_8h_1a197942eefa7db30960ae396d68339b97" kindref="member">WORD</ref></type>
        <definition>WORD Fsid</definition>
        <argsstring></argsstring>
        <name>Fsid</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="449" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="449" bodyend="-1"/>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
      </memberdef>
      <memberdef kind="variable" id="ff_8c_1a3b4d3baf920ca4a0ac8731e7b3e680c4" prot="public" static="yes" mutable="no">
        <type>const <ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref></type>
        <definition>const BYTE LfnOfs[]</definition>
        <argsstring>[]</argsstring>
        <name>LfnOfs</name>
        <initializer>= {1,3,5,7,9,14,16,18,20,22,24,28,30}</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="1270" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="1270" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="ff_8c_1a55626c76a1556af5dc5345e2c0841a65" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref></type>
        <definition>static BYTE check_fs</definition>
        <argsstring>(FATFS *fs, DWORD sect)</argsstring>
        <name>check_fs</name>
        <param>
          <type><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref> *</type>
          <declname>fs</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref></type>
          <declname>sect</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="2175" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="2175" bodyend="2193"/>
        <references refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" compoundref="ff_8h" startline="83">FATFS::wflag</references>
        <references refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" compoundref="ff_8h" startline="106">FATFS::winsect</references>
        <references refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" compoundref="ff_8c" startline="729" endline="750">move_window</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" compoundref="ff_8h" startline="335">LD_WORD</references>
        <references refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" compoundref="ff_8h" startline="107">FATFS::win</references>
        <references refid="ff_8c_1a74b810b3f3583c1eb54bd4305c0f261a" compoundref="ff_8c" startline="407">BS_55AA</references>
        <references refid="ff_8h_1a4690304ddc975516f7dc02575c96e34e" compoundref="ff_8h" startline="336">LD_DWORD</references>
        <references refid="ff_8c_1a2264848692d36c1b2499c9b6a10acf75" compoundref="ff_8c" startline="388">BS_FilSysType</references>
        <references refid="ff_8c_1a8d8786452966cd0ce579f2575a54a348" compoundref="ff_8c" startline="400">BS_FilSysType32</references>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1a1a60c4200d040e4f47e87dc927f23d14" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int chk_chr</definition>
        <argsstring>(const char *str, int chr)</argsstring>
        <name>chk_chr</name>
        <param>
          <type>const char *</type>
          <declname>str</declname>
        </param>
        <param>
          <type>int</type>
          <declname>chr</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="543" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="543" bodyend="546"/>
        <referencedby refid="ff_8c_1a1407adce52a966e786c7d37f9643a800" compoundref="ff_8c" startline="1843" endline="2042">create_name</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1a7519abb60fe91f6aa1d17f64fbae123a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref></type>
        <definition>DWORD clust2sect</definition>
        <argsstring>(FATFS *fs, DWORD clst)</argsstring>
        <name>clust2sect</name>
        <param>
          <type><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref> *</type>
          <declname>fs</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref></type>
          <declname>clst</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="800" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="800" bodyend="808"/>
        <references refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" compoundref="ff_8h" startline="100">FATFS::n_fatent</references>
        <references refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" compoundref="ff_8h" startline="81">FATFS::csize</references>
        <references refid="struct_f_a_t_f_s_1a112ba7d33529e5c9fda3b950fff01180" compoundref="ff_8h" startline="105">FATFS::database</references>
        <referencedby refid="ff_8c_1ab88651d19a5597dec220fe7538cccf23" compoundref="ff_8c" startline="937" endline="979">remove_chain</referencedby>
        <referencedby refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" compoundref="ff_8c" startline="1080" endline="1118">dir_sdi</referencedby>
        <referencedby refid="ff_8c_1a2edd26ac71869f25be5fce12eec58171" compoundref="ff_8c" startline="1128" endline="1188">dir_next</referencedby>
        <referencedby refid="group__filesystem_1gac4c3dcb6869ca252888eebabe39727b3" compoundref="ff_8c" startline="2586" endline="2677">f_read</referencedby>
        <referencedby refid="group__filesystem_1gae6a4dfae8a9e308bdb2283a37ef680f2" compoundref="ff_8c" startline="2687" endline="2800">f_write</referencedby>
        <referencedby refid="group__filesystem_1ga5df0ac672ada972e89ef4b003e57f964" compoundref="ff_8c" startline="3029" endline="3178">f_lseek</referencedby>
        <referencedby refid="group__filesystem_1ga4b4d38db58e89c526cfcf53200d719d0" compoundref="ff_8c" startline="3595" endline="3660">f_mkdir</referencedby>
        <referencedby refid="group__filesystem_1ga2d0ceea336edd9b05754c8684ea8a72f" compoundref="ff_8c" startline="3711" endline="3780">f_rename</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1a7ce4d4f3aa55873dc160d76778536a5f" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int cmp_lfn</definition>
        <argsstring>(WCHAR *lfnbuf, BYTE *dir)</argsstring>
        <name>cmp_lfn</name>
        <param>
          <type><ref refid="integer_8h_1a570001c92f314285ad3e7139d8c58cf7" kindref="member">WCHAR</ref> *</type>
          <declname>lfnbuf</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref> *</type>
          <declname>dir</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="1274" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="1274" bodyend="1302"/>
        <references refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" compoundref="ff_8h" startline="335">LD_WORD</references>
        <references refid="ff_8c_1ad73024151eff6baea94e680f7928969d" compoundref="ff_8c" startline="425">LDIR_FstClusLO</references>
        <references refid="ff_8c_1a6c97d545619e6586b02b5d4f39f7be25" compoundref="ff_8c" startline="421">LDIR_Ord</references>
        <references refid="group___f_f_c_o_n_f_i_g_1ga14e73a5c703a586c614b3e40b849f82c" compoundref="ffconf_8h" startline="113">_MAX_LFN</references>
        <references refid="ff_8h_1af3555c2976dfadc4f1e5cbacc275a012" compoundref="cc932_8c" startline="3785" endline="3828">ff_wtoupper</references>
        <references refid="ff_8c_1a31ec96cd263bb14418cb8b7b2b54b3ca" compoundref="ff_8c" startline="427">LLEF</references>
        <referencedby refid="ff_8c_1abf87976453ebce0af60fa7bf4a6e21df" compoundref="ff_8c" startline="1458" endline="1509">dir_find</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1acbd0a20a17c6f9b6d536490d1cc3c5ac" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref></type>
        <definition>static DWORD create_chain</definition>
        <argsstring>(FATFS *fs, DWORD clst)</argsstring>
        <name>create_chain</name>
        <param>
          <type><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref> *</type>
          <declname>fs</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref></type>
          <declname>clst</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="990" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="990" bodyend="1040"/>
        <references refid="struct_f_a_t_f_s_1a10cd8b80b3b6474bf0d6432c8fb9d2d2" compoundref="ff_8h" startline="94">FATFS::last_clust</references>
        <references refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" compoundref="ff_8h" startline="100">FATFS::n_fatent</references>
        <references refid="ff_8c_1a65611adf1626e5e08da77cd33a98dd8b" compoundref="ff_8c" startline="818" endline="862">get_fat</references>
        <references refid="ff_8c_1abd4b6b071a8d728a88727051c12bc6d7" compoundref="ff_8c" startline="873" endline="926">put_fat</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="struct_f_a_t_f_s_1a509defa217cfb2eb777ed3c74c4ef426" compoundref="ff_8h" startline="95">FATFS::free_clust</references>
        <references refid="struct_f_a_t_f_s_1a66c4d8e68262d5542852e2aed6ce69b4" compoundref="ff_8h" startline="84">FATFS::fsi_flag</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" compoundref="ff_8h" startline="186">FR_DISK_ERR</references>
        <referencedby refid="ff_8c_1a2edd26ac71869f25be5fce12eec58171" compoundref="ff_8c" startline="1128" endline="1188">dir_next</referencedby>
        <referencedby refid="group__filesystem_1gae6a4dfae8a9e308bdb2283a37ef680f2" compoundref="ff_8c" startline="2687" endline="2800">f_write</referencedby>
        <referencedby refid="group__filesystem_1ga5df0ac672ada972e89ef4b003e57f964" compoundref="ff_8c" startline="3029" endline="3178">f_lseek</referencedby>
        <referencedby refid="group__filesystem_1ga4b4d38db58e89c526cfcf53200d719d0" compoundref="ff_8c" startline="3595" endline="3660">f_mkdir</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1a1407adce52a966e786c7d37f9643a800" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>static FRESULT create_name</definition>
        <argsstring>(DIR *dp, const TCHAR **path)</argsstring>
        <name>create_name</name>
        <param>
          <type><ref refid="struct_d_i_r" kindref="compound">DIR</ref> *</type>
          <declname>dp</declname>
        </param>
        <param>
          <type>const <ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref> **</type>
          <declname>path</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="1843" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="1843" bodyend="2042"/>
        <references refid="struct_d_i_r_1a95ac58da8ca4254c6923552f1a9ca92d" compoundref="ff_8h" startline="156">DIR::lfn</references>
        <references refid="group___f_f_c_o_n_f_i_g_1ga14e73a5c703a586c614b3e40b849f82c" compoundref="ffconf_8h" startline="113">_MAX_LFN</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" compoundref="ff_8h" startline="191">FR_INVALID_NAME</references>
        <references refid="ff_8c_1a58d63a832a117f179e41c7373d013dd6" compoundref="ff_8c" startline="331">IsDBCS1</references>
        <references refid="ff_8c_1a66a3fa880af6078ef181656c1d7d8ef1" compoundref="ff_8c" startline="339">IsDBCS2</references>
        <references refid="ff_8h_1ae5146230b88ddb4a6a69340e0fd1eabd" compoundref="cc932_8c" startline="3725" endline="3781">ff_convert</references>
        <references refid="ff_8c_1a1a60c4200d040e4f47e87dc927f23d14" compoundref="ff_8c" startline="543" endline="546">chk_chr</references>
        <references refid="ff_8c_1a5a0742bfc1d94f0c3baa5ede485048c4" compoundref="ff_8c" startline="354">NS_LAST</references>
        <references refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" compoundref="ff_8h" startline="151">DIR::fn</references>
        <references refid="ff_8c_1a2db528782a021797b34bdc6e9e9de1c3" compoundref="ff_8c" startline="357">NS_DOT</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="ff_8c_1a02eb5189e43056a9ddc8a59cbe89be93" compoundref="ff_8c" startline="524" endline="529">mem_set</references>
        <references refid="ff_8c_1ac92c92c3a3d6b9235ac98feeb00e565a" compoundref="ff_8c" startline="352">NS_LOSS</references>
        <references refid="ff_8c_1ae957b8d4065ea0b3eed822aec5368d29" compoundref="ff_8c" startline="353">NS_LFN</references>
        <references refid="ff_8h_1af3555c2976dfadc4f1e5cbacc275a012" compoundref="cc932_8c" startline="3785" endline="3828">ff_wtoupper</references>
        <references refid="ff_8c_1a228bfd2cabe490c8567aaf08b8b2cc14" compoundref="ff_8c" startline="89">_DF1S</references>
        <references refid="ff_8c_1a89b2514198590e139dd064c5d534f302" compoundref="ff_8c" startline="324">IsUpper</references>
        <references refid="ff_8c_1a4a9d454724926bd51a3aed589a97f08b" compoundref="ff_8c" startline="325">IsLower</references>
        <references refid="ff_8c_1a0f2455f7318e6d56318c62f5e4048e1e" compoundref="ff_8c" startline="428">DDEM</references>
        <references refid="ff_8c_1a24b6bc427cbd37fbe76e087f7f188abb" compoundref="ff_8c" startline="429">RDDEM</references>
        <references refid="ff_8c_1a3b7fad0942e816fdb84d869c1f7a613e" compoundref="ff_8c" startline="356">NS_EXT</references>
        <references refid="ff_8c_1a4a0e89b504dece19e2e4b02c83782ca2" compoundref="ff_8c" startline="355">NS_BODY</references>
        <references refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" compoundref="ff_8c" startline="351">NSFLAG</references>
        <referencedby refid="ff_8c_1af194524672491a522f041278b9b74e94" compoundref="ff_8c" startline="2052" endline="2104">follow_path</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1a23ff0594686ccbd8f8d987547931ef04" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>static FRESULT dir_alloc</definition>
        <argsstring>(DIR *dp, UINT nent)</argsstring>
        <name>dir_alloc</name>
        <param>
          <type><ref refid="struct_d_i_r" kindref="compound">DIR</ref> *</type>
          <declname>dp</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref></type>
          <declname>nent</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="1199" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="1199" bodyend="1224"/>
        <references refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" compoundref="ff_8c" startline="1080" endline="1118">dir_sdi</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" compoundref="ff_8c" startline="729" endline="750">move_window</references>
        <references refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" compoundref="ff_8h" startline="144">DIR::fs</references>
        <references refid="struct_d_i_r_1a3e49e0860170e0fd9fc3e891b0d59975" compoundref="ff_8h" startline="149">DIR::sect</references>
        <references refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" compoundref="ff_8h" startline="150">DIR::dir</references>
        <references refid="ff_8c_1a0f2455f7318e6d56318c62f5e4048e1e" compoundref="ff_8c" startline="428">DDEM</references>
        <references refid="ff_8c_1a2edd26ac71869f25be5fce12eec58171" compoundref="ff_8c" startline="1128" endline="1188">dir_next</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" compoundref="ff_8h" startline="189">FR_NO_FILE</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d" compoundref="ff_8h" startline="192">FR_DENIED</references>
        <referencedby refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" compoundref="ff_8c" startline="1578" endline="1645">dir_register</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1abf87976453ebce0af60fa7bf4a6e21df" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>static FRESULT dir_find</definition>
        <argsstring>(DIR *dp)</argsstring>
        <name>dir_find</name>
        <param>
          <type><ref refid="struct_d_i_r" kindref="compound">DIR</ref> *</type>
          <declname>dp</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="1458" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="1458" bodyend="1509"/>
        <references refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" compoundref="ff_8c" startline="1080" endline="1118">dir_sdi</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="struct_d_i_r_1a7f94c0148d9e604278c77e10ab0140cb" compoundref="ff_8h" startline="157">DIR::lfn_idx</references>
        <references refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" compoundref="ff_8c" startline="729" endline="750">move_window</references>
        <references refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" compoundref="ff_8h" startline="144">DIR::fs</references>
        <references refid="struct_d_i_r_1a3e49e0860170e0fd9fc3e891b0d59975" compoundref="ff_8h" startline="149">DIR::sect</references>
        <references refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" compoundref="ff_8h" startline="150">DIR::dir</references>
        <references refid="ff_8c_1afa89348e9fc2de82ae9e12c661366b0e" compoundref="ff_8c" startline="409">DIR_Name</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" compoundref="ff_8h" startline="189">FR_NO_FILE</references>
        <references refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" compoundref="ff_8c" startline="410">DIR_Attr</references>
        <references refid="ff_8h_1aefa78fd6b130faaca4e115602869b57c" compoundref="ff_8h" startline="323">AM_MASK</references>
        <references refid="ff_8c_1a0f2455f7318e6d56318c62f5e4048e1e" compoundref="ff_8c" startline="428">DDEM</references>
        <references refid="ff_8h_1a5cfae62dabae0a54809e43b36685ce7c" compoundref="ff_8h" startline="319">AM_VOL</references>
        <references refid="ff_8h_1a91161ef62e0e85ba3c2876d3d339473d" compoundref="ff_8h" startline="320">AM_LFN</references>
        <references refid="struct_d_i_r_1a95ac58da8ca4254c6923552f1a9ca92d" compoundref="ff_8h" startline="156">DIR::lfn</references>
        <references refid="ff_8c_1a31ec96cd263bb14418cb8b7b2b54b3ca" compoundref="ff_8c" startline="427">LLEF</references>
        <references refid="ff_8c_1ade1d529763d2d097a6d1410956c8a84f" compoundref="ff_8c" startline="424">LDIR_Chksum</references>
        <references refid="struct_d_i_r_1ab7c5089b70ce76bcd61abe615ed2a42b" compoundref="ff_8h" startline="146">DIR::index</references>
        <references refid="ff_8c_1a7ce4d4f3aa55873dc160d76778536a5f" compoundref="ff_8c" startline="1274" endline="1302">cmp_lfn</references>
        <references refid="ff_8c_1a6d9c1b908dec282bedd5d1ee4b1f434e" compoundref="ff_8c" startline="1438" endline="1447">sum_sfn</references>
        <references refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" compoundref="ff_8h" startline="151">DIR::fn</references>
        <references refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" compoundref="ff_8c" startline="351">NSFLAG</references>
        <references refid="ff_8c_1ac92c92c3a3d6b9235ac98feeb00e565a" compoundref="ff_8c" startline="352">NS_LOSS</references>
        <references refid="ff_8c_1a38b4f223d18bd4416d8bce0f07a63c01" compoundref="ff_8c" startline="533" endline="539">mem_cmp</references>
        <references refid="ff_8c_1a2edd26ac71869f25be5fce12eec58171" compoundref="ff_8c" startline="1128" endline="1188">dir_next</references>
        <referencedby refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" compoundref="ff_8c" startline="1578" endline="1645">dir_register</referencedby>
        <referencedby refid="ff_8c_1af194524672491a522f041278b9b74e94" compoundref="ff_8c" startline="2052" endline="2104">follow_path</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1a2edd26ac71869f25be5fce12eec58171" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>static FRESULT dir_next</definition>
        <argsstring>(DIR *dp, int stretch)</argsstring>
        <name>dir_next</name>
        <param>
          <type><ref refid="struct_d_i_r" kindref="compound">DIR</ref> *</type>
          <declname>dp</declname>
        </param>
        <param>
          <type>int</type>
          <declname>stretch</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="1128" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="1128" bodyend="1188"/>
        <references refid="struct_d_i_r_1ab7c5089b70ce76bcd61abe615ed2a42b" compoundref="ff_8h" startline="146">DIR::index</references>
        <references refid="struct_d_i_r_1a3e49e0860170e0fd9fc3e891b0d59975" compoundref="ff_8h" startline="149">DIR::sect</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" compoundref="ff_8h" startline="189">FR_NO_FILE</references>
        <references refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" compoundref="ff_8c" startline="54">SS</references>
        <references refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" compoundref="ff_8h" startline="144">DIR::fs</references>
        <references refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" compoundref="ff_8c" startline="426">SZ_DIRE</references>
        <references refid="struct_d_i_r_1ac134c1b4645be670eb5207032e714616" compoundref="ff_8h" startline="148">DIR::clust</references>
        <references refid="struct_f_a_t_f_s_1a22e74fc44cd5274ba7c3b18d5e357697" compoundref="ff_8h" startline="86">FATFS::n_rootdir</references>
        <references refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" compoundref="ff_8h" startline="81">FATFS::csize</references>
        <references refid="ff_8c_1a65611adf1626e5e08da77cd33a98dd8b" compoundref="ff_8c" startline="818" endline="862">get_fat</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" compoundref="ff_8h" startline="187">FR_INT_ERR</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" compoundref="ff_8h" startline="186">FR_DISK_ERR</references>
        <references refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" compoundref="ff_8h" startline="100">FATFS::n_fatent</references>
        <references refid="ff_8c_1acbd0a20a17c6f9b6d536490d1cc3c5ac" compoundref="ff_8c" startline="990" endline="1040">create_chain</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d" compoundref="ff_8h" startline="192">FR_DENIED</references>
        <references refid="ff_8c_1a5e18753404354b210096f9af99e31bc1" compoundref="ff_8c" startline="700" endline="724">sync_window</references>
        <references refid="ff_8c_1a02eb5189e43056a9ddc8a59cbe89be93" compoundref="ff_8c" startline="524" endline="529">mem_set</references>
        <references refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" compoundref="ff_8h" startline="107">FATFS::win</references>
        <references refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" compoundref="ff_8h" startline="106">FATFS::winsect</references>
        <references refid="ff_8c_1a7519abb60fe91f6aa1d17f64fbae123a" compoundref="ff_8c" startline="800" endline="808">clust2sect</references>
        <references refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" compoundref="ff_8h" startline="83">FATFS::wflag</references>
        <references refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" compoundref="ff_8h" startline="150">DIR::dir</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <referencedby refid="ff_8c_1a23ff0594686ccbd8f8d987547931ef04" compoundref="ff_8c" startline="1199" endline="1224">dir_alloc</referencedby>
        <referencedby refid="ff_8c_1abf87976453ebce0af60fa7bf4a6e21df" compoundref="ff_8c" startline="1458" endline="1509">dir_find</referencedby>
        <referencedby refid="ff_8c_1a3a47a08609e77266bc1928af812e06df" compoundref="ff_8c" startline="1519" endline="1567">dir_read</referencedby>
        <referencedby refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" compoundref="ff_8c" startline="1578" endline="1645">dir_register</referencedby>
        <referencedby refid="ff_8c_1a724c260af4783a0ecf0db8d0687e7bd6" compoundref="ff_8c" startline="1656" endline="1692">dir_remove</referencedby>
        <referencedby refid="group__filesystem_1gab39e82a110695de45f416f3149358012" compoundref="ff_8c" startline="3275" endline="3308">f_readdir</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1a3a47a08609e77266bc1928af812e06df" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>static FRESULT dir_read</definition>
        <argsstring>(DIR *dp, int vol)</argsstring>
        <name>dir_read</name>
        <param>
          <type><ref refid="struct_d_i_r" kindref="compound">DIR</ref> *</type>
          <declname>dp</declname>
        </param>
        <param>
          <type>int</type>
          <declname>vol</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="1519" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="1519" bodyend="1567"/>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" compoundref="ff_8h" startline="189">FR_NO_FILE</references>
        <references refid="struct_d_i_r_1a3e49e0860170e0fd9fc3e891b0d59975" compoundref="ff_8h" startline="149">DIR::sect</references>
        <references refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" compoundref="ff_8c" startline="729" endline="750">move_window</references>
        <references refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" compoundref="ff_8h" startline="144">DIR::fs</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" compoundref="ff_8h" startline="150">DIR::dir</references>
        <references refid="ff_8c_1afa89348e9fc2de82ae9e12c661366b0e" compoundref="ff_8c" startline="409">DIR_Name</references>
        <references refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" compoundref="ff_8c" startline="410">DIR_Attr</references>
        <references refid="ff_8h_1aefa78fd6b130faaca4e115602869b57c" compoundref="ff_8h" startline="323">AM_MASK</references>
        <references refid="ff_8c_1a0f2455f7318e6d56318c62f5e4048e1e" compoundref="ff_8c" startline="428">DDEM</references>
        <references refid="group___f_f_c_o_n_f_i_g_1ga52faf11025401372f71e9d81905b7af4" compoundref="ffconf_8h" startline="146">_FS_RPATH</references>
        <references refid="ff_8h_1ae8174d00798e34e7c9e95898cb9e1a09" compoundref="ff_8h" startline="322">AM_ARC</references>
        <references refid="ff_8h_1a5cfae62dabae0a54809e43b36685ce7c" compoundref="ff_8h" startline="319">AM_VOL</references>
        <references refid="ff_8h_1a91161ef62e0e85ba3c2876d3d339473d" compoundref="ff_8h" startline="320">AM_LFN</references>
        <references refid="ff_8c_1a31ec96cd263bb14418cb8b7b2b54b3ca" compoundref="ff_8c" startline="427">LLEF</references>
        <references refid="ff_8c_1ade1d529763d2d097a6d1410956c8a84f" compoundref="ff_8c" startline="424">LDIR_Chksum</references>
        <references refid="struct_d_i_r_1a7f94c0148d9e604278c77e10ab0140cb" compoundref="ff_8h" startline="157">DIR::lfn_idx</references>
        <references refid="struct_d_i_r_1ab7c5089b70ce76bcd61abe615ed2a42b" compoundref="ff_8h" startline="146">DIR::index</references>
        <references refid="ff_8c_1a2a2c96233e92d8abe12c4496caec85cf" compoundref="ff_8c" startline="1307" endline="1336">pick_lfn</references>
        <references refid="struct_d_i_r_1a95ac58da8ca4254c6923552f1a9ca92d" compoundref="ff_8h" startline="156">DIR::lfn</references>
        <references refid="ff_8c_1a6d9c1b908dec282bedd5d1ee4b1f434e" compoundref="ff_8c" startline="1438" endline="1447">sum_sfn</references>
        <references refid="ff_8c_1a2edd26ac71869f25be5fce12eec58171" compoundref="ff_8c" startline="1128" endline="1188">dir_next</references>
        <referencedby refid="group__filesystem_1gab39e82a110695de45f416f3149358012" compoundref="ff_8c" startline="3275" endline="3308">f_readdir</referencedby>
        <referencedby refid="group__filesystem_1ga2858167fcd0bced48e9be434b3895efe" compoundref="ff_8c" startline="3526" endline="3586">f_unlink</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>static FRESULT dir_register</definition>
        <argsstring>(DIR *dp)</argsstring>
        <name>dir_register</name>
        <param>
          <type><ref refid="struct_d_i_r" kindref="compound">DIR</ref> *</type>
          <declname>dp</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="1578" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="1578" bodyend="1645"/>
        <references refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" compoundref="ff_8h" startline="151">DIR::fn</references>
        <references refid="struct_d_i_r_1a95ac58da8ca4254c6923552f1a9ca92d" compoundref="ff_8h" startline="156">DIR::lfn</references>
        <references refid="ff_8c_1a8941d573d16af92c8570950d53164f30" compoundref="ff_8c" startline="507" endline="520">mem_cpy</references>
        <references refid="group___f_f_c_o_n_f_i_g_1ga52faf11025401372f71e9d81905b7af4" compoundref="ffconf_8h" startline="146">_FS_RPATH</references>
        <references refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" compoundref="ff_8c" startline="351">NSFLAG</references>
        <references refid="ff_8c_1a2db528782a021797b34bdc6e9e9de1c3" compoundref="ff_8c" startline="357">NS_DOT</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" compoundref="ff_8h" startline="191">FR_INVALID_NAME</references>
        <references refid="ff_8c_1ac92c92c3a3d6b9235ac98feeb00e565a" compoundref="ff_8c" startline="352">NS_LOSS</references>
        <references refid="ff_8c_1a01f02bd7a6b0835c15c4978cad7977dd" compoundref="ff_8c" startline="1379" endline="1427">gen_numname</references>
        <references refid="ff_8c_1abf87976453ebce0af60fa7bf4a6e21df" compoundref="ff_8c" startline="1458" endline="1509">dir_find</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d" compoundref="ff_8h" startline="192">FR_DENIED</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" compoundref="ff_8h" startline="189">FR_NO_FILE</references>
        <references refid="ff_8c_1ae957b8d4065ea0b3eed822aec5368d29" compoundref="ff_8c" startline="353">NS_LFN</references>
        <references refid="ff_8c_1a23ff0594686ccbd8f8d987547931ef04" compoundref="ff_8c" startline="1199" endline="1224">dir_alloc</references>
        <references refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" compoundref="ff_8c" startline="1080" endline="1118">dir_sdi</references>
        <references refid="struct_d_i_r_1ab7c5089b70ce76bcd61abe615ed2a42b" compoundref="ff_8h" startline="146">DIR::index</references>
        <references refid="ff_8c_1a6d9c1b908dec282bedd5d1ee4b1f434e" compoundref="ff_8c" startline="1438" endline="1447">sum_sfn</references>
        <references refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" compoundref="ff_8c" startline="729" endline="750">move_window</references>
        <references refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" compoundref="ff_8h" startline="144">DIR::fs</references>
        <references refid="struct_d_i_r_1a3e49e0860170e0fd9fc3e891b0d59975" compoundref="ff_8h" startline="149">DIR::sect</references>
        <references refid="ff_8c_1a3fe23e7983a2974b8002a8e57c1c06e9" compoundref="ff_8c" startline="1341" endline="1366">fit_lfn</references>
        <references refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" compoundref="ff_8h" startline="150">DIR::dir</references>
        <references refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" compoundref="ff_8h" startline="83">FATFS::wflag</references>
        <references refid="ff_8c_1a2edd26ac71869f25be5fce12eec58171" compoundref="ff_8c" startline="1128" endline="1188">dir_next</references>
        <references refid="ff_8c_1a02eb5189e43056a9ddc8a59cbe89be93" compoundref="ff_8c" startline="524" endline="529">mem_set</references>
        <references refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" compoundref="ff_8c" startline="426">SZ_DIRE</references>
        <references refid="ff_8c_1a87ee1f701c2ab941862e3ce00c1c1e9d" compoundref="ff_8c" startline="411">DIR_NTres</references>
        <references refid="ff_8c_1a4a0e89b504dece19e2e4b02c83782ca2" compoundref="ff_8c" startline="355">NS_BODY</references>
        <references refid="ff_8c_1a3b7fad0942e816fdb84d869c1f7a613e" compoundref="ff_8c" startline="356">NS_EXT</references>
        <referencedby refid="group__filesystem_1gaefdef7126128d99d0b3bd82c28e54d80" compoundref="ff_8c" startline="2449" endline="2577">f_open</referencedby>
        <referencedby refid="group__filesystem_1ga4b4d38db58e89c526cfcf53200d719d0" compoundref="ff_8c" startline="3595" endline="3660">f_mkdir</referencedby>
        <referencedby refid="group__filesystem_1ga2d0ceea336edd9b05754c8684ea8a72f" compoundref="ff_8c" startline="3711" endline="3780">f_rename</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1a724c260af4783a0ecf0db8d0687e7bd6" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>static FRESULT dir_remove</definition>
        <argsstring>(DIR *dp)</argsstring>
        <name>dir_remove</name>
        <param>
          <type><ref refid="struct_d_i_r" kindref="compound">DIR</ref> *</type>
          <declname>dp</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="1656" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="1656" bodyend="1692"/>
        <references refid="struct_d_i_r_1ab7c5089b70ce76bcd61abe615ed2a42b" compoundref="ff_8h" startline="146">DIR::index</references>
        <references refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" compoundref="ff_8c" startline="1080" endline="1118">dir_sdi</references>
        <references refid="struct_d_i_r_1a7f94c0148d9e604278c77e10ab0140cb" compoundref="ff_8h" startline="157">DIR::lfn_idx</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" compoundref="ff_8c" startline="729" endline="750">move_window</references>
        <references refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" compoundref="ff_8h" startline="144">DIR::fs</references>
        <references refid="struct_d_i_r_1a3e49e0860170e0fd9fc3e891b0d59975" compoundref="ff_8h" startline="149">DIR::sect</references>
        <references refid="ff_8c_1a02eb5189e43056a9ddc8a59cbe89be93" compoundref="ff_8c" startline="524" endline="529">mem_set</references>
        <references refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" compoundref="ff_8h" startline="150">DIR::dir</references>
        <references refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" compoundref="ff_8c" startline="426">SZ_DIRE</references>
        <references refid="ff_8c_1a0f2455f7318e6d56318c62f5e4048e1e" compoundref="ff_8c" startline="428">DDEM</references>
        <references refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" compoundref="ff_8h" startline="83">FATFS::wflag</references>
        <references refid="ff_8c_1a2edd26ac71869f25be5fce12eec58171" compoundref="ff_8c" startline="1128" endline="1188">dir_next</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" compoundref="ff_8h" startline="189">FR_NO_FILE</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" compoundref="ff_8h" startline="187">FR_INT_ERR</references>
        <referencedby refid="group__filesystem_1ga2858167fcd0bced48e9be434b3895efe" compoundref="ff_8c" startline="3526" endline="3586">f_unlink</referencedby>
        <referencedby refid="group__filesystem_1ga2d0ceea336edd9b05754c8684ea8a72f" compoundref="ff_8c" startline="3711" endline="3780">f_rename</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>static FRESULT dir_sdi</definition>
        <argsstring>(DIR *dp, UINT idx)</argsstring>
        <name>dir_sdi</name>
        <param>
          <type><ref refid="struct_d_i_r" kindref="compound">DIR</ref> *</type>
          <declname>dp</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref></type>
          <declname>idx</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="1080" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="1080" bodyend="1118"/>
        <references refid="struct_d_i_r_1ab7c5089b70ce76bcd61abe615ed2a42b" compoundref="ff_8h" startline="146">DIR::index</references>
        <references refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" compoundref="ff_8h" startline="147">DIR::sclust</references>
        <references refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" compoundref="ff_8h" startline="144">DIR::fs</references>
        <references refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" compoundref="ff_8h" startline="100">FATFS::n_fatent</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" compoundref="ff_8h" startline="187">FR_INT_ERR</references>
        <references refid="struct_f_a_t_f_s_1a3630ef0b29c45ef8e0c1de639efab754" compoundref="ff_8h" startline="79">FATFS::fs_type</references>
        <references refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" compoundref="ff_8h" startline="311">FS_FAT32</references>
        <references refid="struct_f_a_t_f_s_1aebfa6556d8f94e951a8b2c1eb740e9a1" compoundref="ff_8h" startline="104">FATFS::dirbase</references>
        <references refid="struct_f_a_t_f_s_1a22e74fc44cd5274ba7c3b18d5e357697" compoundref="ff_8h" startline="86">FATFS::n_rootdir</references>
        <references refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" compoundref="ff_8c" startline="54">SS</references>
        <references refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" compoundref="ff_8c" startline="426">SZ_DIRE</references>
        <references refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" compoundref="ff_8h" startline="81">FATFS::csize</references>
        <references refid="ff_8c_1a65611adf1626e5e08da77cd33a98dd8b" compoundref="ff_8c" startline="818" endline="862">get_fat</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" compoundref="ff_8h" startline="186">FR_DISK_ERR</references>
        <references refid="ff_8c_1a7519abb60fe91f6aa1d17f64fbae123a" compoundref="ff_8c" startline="800" endline="808">clust2sect</references>
        <references refid="struct_d_i_r_1ac134c1b4645be670eb5207032e714616" compoundref="ff_8h" startline="148">DIR::clust</references>
        <references refid="struct_d_i_r_1a3e49e0860170e0fd9fc3e891b0d59975" compoundref="ff_8h" startline="149">DIR::sect</references>
        <references refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" compoundref="ff_8h" startline="150">DIR::dir</references>
        <references refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" compoundref="ff_8h" startline="107">FATFS::win</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <referencedby refid="ff_8c_1a23ff0594686ccbd8f8d987547931ef04" compoundref="ff_8c" startline="1199" endline="1224">dir_alloc</referencedby>
        <referencedby refid="ff_8c_1abf87976453ebce0af60fa7bf4a6e21df" compoundref="ff_8c" startline="1458" endline="1509">dir_find</referencedby>
        <referencedby refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" compoundref="ff_8c" startline="1578" endline="1645">dir_register</referencedby>
        <referencedby refid="ff_8c_1a724c260af4783a0ecf0db8d0687e7bd6" compoundref="ff_8c" startline="1656" endline="1692">dir_remove</referencedby>
        <referencedby refid="ff_8c_1af194524672491a522f041278b9b74e94" compoundref="ff_8c" startline="2052" endline="2104">follow_path</referencedby>
        <referencedby refid="group__filesystem_1gab63b213c75f7335fbb63a1f3f70e5fc7" compoundref="ff_8c" startline="3187" endline="3234">f_opendir</referencedby>
        <referencedby refid="group__filesystem_1gab39e82a110695de45f416f3149358012" compoundref="ff_8c" startline="3275" endline="3308">f_readdir</referencedby>
        <referencedby refid="group__filesystem_1ga2858167fcd0bced48e9be434b3895efe" compoundref="ff_8c" startline="3526" endline="3586">f_unlink</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__filesystem_1ga9ee7e560eec8d82755c636ae41e702cd" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>FRESULT f_chmod</definition>
        <argsstring>(const TCHAR *path, BYTE attr, BYTE mask)</argsstring>
        <name>f_chmod</name>
        <param>
          <type>const <ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref> *</type>
          <declname>path</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref></type>
          <declname>attr</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref></type>
          <declname>mask</declname>
        </param>
        <briefdescription>
<para>The f_chmod function changes the attribute of a file or sub-directory. </para>        </briefdescription>
        <detaileddescription>
<para>The <ref refid="group__filesystem_1ga9ee7e560eec8d82755c636ae41e702cd" kindref="member">f_chmod()</ref> function changes the attribute of a file or sub-directory. <linebreak/>
 Example: <programlisting><codeline><highlight class="normal">/*<sp/>Set<sp/>read-only<sp/>flag,<sp/>clear<sp/>archive<sp/>flag<sp/>and<sp/>others<sp/>are<sp/>left<sp/>unchanged.<sp/>*/</highlight></codeline>
<codeline><highlight class="normal">f_chmod(&quot;file.txt&quot;,<sp/>AR_RDO,<sp/>AR_RDO<sp/>|<sp/>AR_ARC);</highlight></codeline>
</programlisting> <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">path</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the null-terminated string that specifies an object to be changed </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">attr</parametername>
</parameternamelist>
<parameterdescription>
<para>Attribute flags to be set in one or more combination of the following flags. The specified flags are set and others are cleard. <table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute </para></entry><entry thead="yes"><para>Description  </para></entry></row>
<row>
<entry thead="no"><para>AM_RDO </para></entry><entry thead="no"><para>Read only </para></entry></row>
<row>
<entry thead="no"><para>AM_ARC </para></entry><entry thead="no"><para>Archive </para></entry></row>
<row>
<entry thead="no"><para>AM_SYS </para></entry><entry thead="no"><para>System </para></entry></row>
<row>
<entry thead="no"><para>AM_HID </para></entry><entry thead="no"><para>Hidden </para></entry></row>
</table>
</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">mask</parametername>
</parameternamelist>
<parameterdescription>
<para>Attribute mask that specifies which attribute is changed. The specified attributes are set or cleard and others are left unchanged. </para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>FR_OK</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_DISK_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INT_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_READY</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NO_FILE</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NO_PATH</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_NAME</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_WRITE_PROTECTED</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_DRIVE</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_ENABLED</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NO_FILESYSTEM</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_TIMEOUT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_ENOUGH_CORE</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="note"><para>Available when _FS_READONLY == 0 and _FS_MINIMIZE == 0. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="3669" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="3669" bodyend="3702"/>
        <references refid="ff_8c_1a7cc27142421bd12be623072288599791" compoundref="ff_8c" startline="473">DEFINE_NAMEBUF</references>
        <references refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</references>
        <references refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" compoundref="ff_8h" startline="144">DIR::fs</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="ff_8c_1a966fe5792671b39db1ccf655a8c1af8d" compoundref="ff_8c" startline="474">INIT_BUF</references>
        <references refid="ff_8c_1af194524672491a522f041278b9b74e94" compoundref="ff_8c" startline="2052" endline="2104">follow_path</references>
        <references refid="ff_8c_1aba6d6942b59f11cf285bdbfb7e38f1fa" compoundref="ff_8c" startline="475">FREE_BUF</references>
        <references refid="group___f_f_c_o_n_f_i_g_1ga52faf11025401372f71e9d81905b7af4" compoundref="ffconf_8h" startline="146">_FS_RPATH</references>
        <references refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" compoundref="ff_8h" startline="151">DIR::fn</references>
        <references refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" compoundref="ff_8c" startline="351">NSFLAG</references>
        <references refid="ff_8c_1a2db528782a021797b34bdc6e9e9de1c3" compoundref="ff_8c" startline="357">NS_DOT</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" compoundref="ff_8h" startline="191">FR_INVALID_NAME</references>
        <references refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" compoundref="ff_8h" startline="150">DIR::dir</references>
        <references refid="ff_8h_1add6d85d1e7a02b4f6188783ef91a5f1e" compoundref="ff_8h" startline="316">AM_RDO</references>
        <references refid="ff_8h_1aa90c4c921c1955fd407d8bbf17f1674e" compoundref="ff_8h" startline="317">AM_HID</references>
        <references refid="ff_8h_1a1f25d5c17b5a3a6397b3398add8cdc15" compoundref="ff_8h" startline="318">AM_SYS</references>
        <references refid="ff_8h_1ae8174d00798e34e7c9e95898cb9e1a09" compoundref="ff_8h" startline="322">AM_ARC</references>
        <references refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" compoundref="ff_8c" startline="410">DIR_Attr</references>
        <references refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" compoundref="ff_8h" startline="83">FATFS::wflag</references>
        <references refid="ff_8c_1aec6b108298553219ebb2b960b528459d" compoundref="ff_8c" startline="760" endline="789">sync_fs</references>
        <references refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" compoundref="ff_8c" startline="40">LEAVE_FF</references>
      </memberdef>
      <memberdef kind="function" id="group__filesystem_1ga53882db20ef4323dcfd1874d7733ffc3" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>FRESULT f_close</definition>
        <argsstring>(FIL *fp)</argsstring>
        <name>f_close</name>
        <param>
          <type><ref refid="struct_f_i_l" kindref="compound">FIL</ref> *</type>
          <declname>fp</declname>
        </param>
        <briefdescription>
<para>The f_close function closes an open file. </para>        </briefdescription>
        <detaileddescription>
<para>The <ref refid="group__filesystem_1ga53882db20ef4323dcfd1874d7733ffc3" kindref="member">f_close()</ref> function closes an open file object. If any data has been written to the file, the cached information of the file is written back to the volume. After the function succeeded, the file object is no longer valid and it can be discarded. <linebreak/>
 Note that if the file object is in read-only mode and _FS_LOCK option is not enabled, the file object can also be discarded without this process. However this is not recommended for future compatibility.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">fp</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the open file object structure to be closed. </para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>FR_OK</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_DISK_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INT_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_READY</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_OBJECT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_TIMEOUT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="note"><para>Always available. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="2857" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="2857" bodyend="2885"/>
        <references refid="group__filesystem_1gad69c7246b122ba56a134939ee0eaf847" compoundref="ff_8c" startline="2809" endline="2846">f_sync</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="ff_8c_1aa7193f5b86c3996b5312043a0c26da5f" compoundref="ff_8c" startline="2372" endline="2385">validate</references>
        <references refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" compoundref="ff_8h" startline="115">FIL::fs</references>
        <references refid="ff_8c_1a58c93c453ba943336cd24aa185cd72cf" compoundref="ff_8c" startline="565" endline="577">unlock_fs</references>
      </memberdef>
      <memberdef kind="function" id="group__filesystem_1gab5f7376b6f3e3bcc7f5ff5497c8b7364" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>FRESULT f_closedir</definition>
        <argsstring>(DIR *dp)</argsstring>
        <name>f_closedir</name>
        <param>
          <type><ref refid="struct_d_i_r" kindref="compound">DIR</ref> *</type>
          <declname>dp</declname>
        </param>
        <briefdescription>
<para>The f_closedir function closes an open directory. </para>        </briefdescription>
        <detaileddescription>
<para>The <ref refid="group__filesystem_1gab5f7376b6f3e3bcc7f5ff5497c8b7364" kindref="member">f_closedir()</ref> function closes an open directory object. After the function succeeded, the directory object is no longer valid and it can be discarded. <linebreak/>
 Note that the directory object can also be discarded without this process if _FS_LOCK option is not enabled. However this is not recommended for future compatibility. <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">dp</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the open directory object structure to be closed. </para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>FR_OK</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INT_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_OBJECT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_TIMEOUT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="note"><para>Available when _FS_MINIMIZE &lt;= 1. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="3243" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="3243" bodyend="3266"/>
        <references refid="ff_8c_1aa7193f5b86c3996b5312043a0c26da5f" compoundref="ff_8c" startline="2372" endline="2385">validate</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" compoundref="ff_8h" startline="144">DIR::fs</references>
        <references refid="ff_8c_1a58c93c453ba943336cd24aa185cd72cf" compoundref="ff_8c" startline="565" endline="577">unlock_fs</references>
      </memberdef>
      <memberdef kind="function" id="group__filesystem_1ga0ff39f75a87cbda9cd6ea65d83f16cec" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>FRESULT f_getfree</definition>
        <argsstring>(const TCHAR *path, DWORD *nclst, FATFS **fatfs)</argsstring>
        <name>f_getfree</name>
        <param>
          <type>const <ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref> *</type>
          <declname>path</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref> *</type>
          <declname>nclst</declname>
        </param>
        <param>
          <type><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref> **</type>
          <declname>fatfs</declname>
        </param>
        <briefdescription>
<para>The f_getfree function gets number of the free clusters on the volume. </para>        </briefdescription>
        <detaileddescription>
<para>The <ref refid="group__filesystem_1ga0ff39f75a87cbda9cd6ea65d83f16cec" kindref="member">f_getfree()</ref> function gets number of free clusters on the volume. The member csize in the file system object indicates number of sectors per cluster, so that the free space in unit of sector can be calcurated with this information. When FSINFO structure on the FAT32 volume is not in sync, this function can return an incorrect free cluster count. To avoid this problem, FatFs can be forced full FAT scan by _FS_NOFSINFO option. <linebreak/>
 Example: <programlisting><codeline><highlight class="normal"><sp/><sp/><sp/>FATFS<sp/>*fs;</highlight></codeline>
<codeline><highlight class="normal">DWORD<sp/>fre_clust,<sp/>fre_sect,<sp/>tot_sect;</highlight></codeline>
<codeline><highlight class="normal"><sp/>/*<sp/>Get<sp/>volume<sp/>information<sp/>and<sp/>free<sp/>clusters<sp/>of<sp/>drive<sp/>1<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/>res<sp/>=<sp/>f_getfree(&quot;1:&quot;,<sp/>&amp;fre_clust,<sp/>&amp;fs);</highlight></codeline>
<codeline><highlight class="normal"><sp/>if<sp/>(res)<sp/>die(res);</highlight></codeline>
<codeline><highlight class="normal"><sp/>/*<sp/>Get<sp/>total<sp/>sectors<sp/>and<sp/>free<sp/>sectors<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/>tot_sect<sp/>=<sp/>(fs-&gt;n_fatent<sp/>-<sp/>2)<sp/>*<sp/>fs-&gt;csize;</highlight></codeline>
<codeline><highlight class="normal"><sp/>fre_sect<sp/>=<sp/>fre_clust<sp/>*<sp/>fs-&gt;csize;</highlight></codeline>
<codeline><highlight class="normal"><sp/>/*<sp/>Print<sp/>the<sp/>free<sp/>space<sp/>(assuming<sp/>512<sp/>bytes/sector)<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/>printf(&quot;%10lu<sp/>KiB<sp/>total<sp/>drive<sp/>space.\n%10lu<sp/>KiB<sp/>available.\n&quot;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tot_sect<sp/>/<sp/>2,<sp/>fre_sect<sp/>/<sp/>2);</highlight></codeline>
</programlisting> <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">path</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the null-terminated string that specifies the logical drive. A null-string means the default drive. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="out">nclst</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the DWORD variable to store number of free clusters. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="out">fatfs</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to pointer that to store a pointer to the corresponding file system object. </para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>FR_OK</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_DISK_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INT_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_READY</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_DRIVE</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_ENABLED</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NO_FILESYSTEM</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_TIMEOUT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="note"><para>Available when _FS_READONLY == 0 and _FS_MINIMIZE == 0. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="3404" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="3404" bodyend="3461"/>
        <references refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="struct_f_a_t_f_s_1a509defa217cfb2eb777ed3c74c4ef426" compoundref="ff_8h" startline="95">FATFS::free_clust</references>
        <references refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" compoundref="ff_8h" startline="100">FATFS::n_fatent</references>
        <references refid="struct_f_a_t_f_s_1a3630ef0b29c45ef8e0c1de639efab754" compoundref="ff_8h" startline="79">FATFS::fs_type</references>
        <references refid="ff_8h_1aab755aa1b4f81f4aabee4a5d4738cfb0" compoundref="ff_8h" startline="309">FS_FAT12</references>
        <references refid="ff_8c_1a65611adf1626e5e08da77cd33a98dd8b" compoundref="ff_8c" startline="818" endline="862">get_fat</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" compoundref="ff_8h" startline="186">FR_DISK_ERR</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" compoundref="ff_8h" startline="187">FR_INT_ERR</references>
        <references refid="struct_f_a_t_f_s_1a74e60540a346de6eb9f0c13d6203efa1" compoundref="ff_8h" startline="103">FATFS::fatbase</references>
        <references refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" compoundref="ff_8c" startline="729" endline="750">move_window</references>
        <references refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" compoundref="ff_8h" startline="107">FATFS::win</references>
        <references refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" compoundref="ff_8c" startline="54">SS</references>
        <references refid="ff_8h_1a7ef90a36d99edfc0138a2155a17a79b9" compoundref="ff_8h" startline="310">FS_FAT16</references>
        <references refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" compoundref="ff_8h" startline="335">LD_WORD</references>
        <references refid="ff_8h_1a4690304ddc975516f7dc02575c96e34e" compoundref="ff_8h" startline="336">LD_DWORD</references>
        <references refid="struct_f_a_t_f_s_1a66c4d8e68262d5542852e2aed6ce69b4" compoundref="ff_8h" startline="84">FATFS::fsi_flag</references>
        <references refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" compoundref="ff_8c" startline="40">LEAVE_FF</references>
      </memberdef>
      <memberdef kind="function" id="group__filesystem_1ga0fa54bd310785ecdaed19dda8f60dac5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref> *</type>
        <definition>TCHAR* f_gets</definition>
        <argsstring>(TCHAR *buff, int len, FIL *fp)</argsstring>
        <name>f_gets</name>
        <param>
          <type><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref> *</type>
          <declname>buff</declname>
        </param>
        <param>
          <type>int</type>
          <declname>len</declname>
        </param>
        <param>
          <type><ref refid="struct_f_i_l" kindref="compound">FIL</ref> *</type>
          <declname>fp</declname>
        </param>
        <briefdescription>
<para>The f_gets reads a string from the file. </para>        </briefdescription>
        <detaileddescription>
<para>The <ref refid="group__filesystem_1ga0fa54bd310785ecdaed19dda8f60dac5" kindref="member">f_gets()</ref> function is a wrapper function of <ref refid="group__filesystem_1gac4c3dcb6869ca252888eebabe39727b3" kindref="member">f_read()</ref> function. The read operation continues until a &apos;<linebreak/>
&apos; is stored, reached end of the file or the buffer is filled with len - 1 characters. The read string is terminated with a &apos;\0&apos;. When no character to read or any error occured during read operation, it returns a null pointer. The status of EOF and error can be examined with <ref refid="group__filesystem_1gaf0878582b1255b693b29dca3c6ecccf1" kindref="member">f_eof()</ref> and <ref refid="group__filesystem_1gad3c6dd79ef26a59629a6c8f6afe71fbf" kindref="member">f_error()</ref> macros. <linebreak/>
 When FatFs is configured to Unicode API (_LFN_UNICODE == 1), data types on the srting fuctions, <ref refid="group__filesystem_1ga62a35ee79e4913c1e31ac706241be7da" kindref="member">f_putc()</ref>, <ref refid="group__filesystem_1ga9443c00129414fbfc16a5a13ad876ced" kindref="member">f_puts()</ref>, <ref refid="group__filesystem_1ga49cccab38cd84e2d3357fef2d1df21f9" kindref="member">f_printf()</ref> and <ref refid="group__filesystem_1ga0fa54bd310785ecdaed19dda8f60dac5" kindref="member">f_gets()</ref>, is also switched to Unicode. The character encoding on the file to be read/written via those functions is selected by _STRF_ENCODE option. <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="out">buff</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to read buffer to store the read string. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">len</parametername>
</parameternamelist>
<parameterdescription>
<para>Size of the read buffer in unit of character. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">fp</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the open file object structure. </para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>When</parametername>
</parameternamelist>
<parameterdescription>
<para>the function succeeded, buff will be returuned. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="note"><para>Available when _USE_STRFUNC is 1 or 2. When it is set to 2, &apos;&apos;s contained in the file are stripped out. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="4382" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="4382" bodyend="4450"/>
        <references refid="group__filesystem_1gac4c3dcb6869ca252888eebabe39727b3" compoundref="ff_8c" startline="2586" endline="2677">f_read</references>
        <references refid="ff_8c_1a58d63a832a117f179e41c7373d013dd6" compoundref="ff_8c" startline="331">IsDBCS1</references>
        <references refid="ff_8h_1ae5146230b88ddb4a6a69340e0fd1eabd" compoundref="cc932_8c" startline="3725" endline="3781">ff_convert</references>
        <references refid="group___f_f_c_o_n_f_i_g_1gaaab0313f867bb008b64236239f5c2660" compoundref="ffconf_8h" startline="47">_USE_STRFUNC</references>
      </memberdef>
      <memberdef kind="function" id="group__filesystem_1ga5df0ac672ada972e89ef4b003e57f964" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>FRESULT f_lseek</definition>
        <argsstring>(FIL *fp, DWORD ofs)</argsstring>
        <name>f_lseek</name>
        <param>
          <type><ref refid="struct_f_i_l" kindref="compound">FIL</ref> *</type>
          <declname>fp</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref></type>
          <declname>ofs</declname>
        </param>
        <briefdescription>
<para>The f_lseek function moves the file read/write pointer of an open file object. It can also be used to expand the file size (cluster pre-allocation). </para>        </briefdescription>
        <detaileddescription>
<para>The <ref refid="group__filesystem_1ga5df0ac672ada972e89ef4b003e57f964" kindref="member">f_lseek()</ref> function moves the file read/write pointer of an open file. The offset can be specified in only origin from top of the file. When an offset beyond the file size is specified at write mode, the file size is expanded to the specified offset. The file data in the expanded area is undefined because no data is written to the file. This is suitable to pre-allocate a cluster chain quickly, for fast write operation. After the <ref refid="group__filesystem_1ga5df0ac672ada972e89ef4b003e57f964" kindref="member">f_lseek()</ref> function succeeded, the current read/write pointer should be checked in order to make sure the read/write pointer has been moved correctry. In case of the current read/write pointer is not the expected value, either of followings has been occured. <linebreak/>
 <itemizedlist>
<listitem><para><computeroutput>End</computeroutput> of file. The specified ofs was clipped at end of the file because the file has been opened in read-only mode. </para></listitem>
<listitem><para><computeroutput>Disk</computeroutput> full. There is insufficient free space on the volume to expand the file. <linebreak/>
 Fast seek feature is enabled when _USE_FASTSEEK is set to 1 and the member cltbl in the file object is not NULL. This feature enables fast backward/long seek operations without FAT access by using CLMT (cluster link map table). The fast seek feature is also applied to <ref refid="group__filesystem_1gac4c3dcb6869ca252888eebabe39727b3" kindref="member">f_read()</ref>/f_write() function, however, the file size cannot be expanded by <ref refid="group__filesystem_1gae6a4dfae8a9e308bdb2283a37ef680f2" kindref="member">f_write()</ref>/f_lseek() function. <linebreak/>
 The CLMT must be created in the user defined DWORD array prior to use the fast seek feature. To create the CLMT, set address of the DWORD array to the member cltbl in the file object, set the array size in unit of items into the first item and call the <ref refid="group__filesystem_1ga5df0ac672ada972e89ef4b003e57f964" kindref="member">f_lseek()</ref> function with ofs = CREATE_LINKMAP. After the function succeeded and CLMT is created, no FAT access is occured at subsequent <ref refid="group__filesystem_1gac4c3dcb6869ca252888eebabe39727b3" kindref="member">f_read()</ref>/f_write()/f_lseek() function to the file. If the function failed with FR_NOT_ENOUGH_CORE, the given array size is insufficient for the file and number of items required is returned into the first item of the array. The required array size is (number of fragments + 1) * 2 items. For example, when the file is fragmented in 5, 12 items will be required for the CLMT. <linebreak/>
 Examples: <programlisting><codeline><highlight class="normal"><sp/><sp/><sp/>/*<sp/>Open<sp/>file<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>fp<sp/>=<sp/>malloc(sizeof<sp/>(FIL));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>res<sp/>=<sp/>f_open(fp,<sp/>&quot;file.dat&quot;,<sp/>FA_READ|FA_WRITE);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>if<sp/>(res)<sp/>...</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>Move<sp/>to<sp/>offset<sp/>of<sp/>5000<sp/>from<sp/>top<sp/>of<sp/>the<sp/>file<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>res<sp/>=<sp/>f_lseek(fp,<sp/>5000);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>/*<sp/>Move<sp/>to<sp/>end<sp/>of<sp/>the<sp/>file<sp/>to<sp/>append<sp/>data<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>res<sp/>=<sp/>f_lseek(fp,<sp/>f_size(fp));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>/*<sp/>Forward<sp/>3000<sp/>bytes<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>res<sp/>=<sp/>f_lseek(fp,<sp/>f_tell(fp)<sp/>+<sp/>3000);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>/*<sp/>Rewind<sp/>2000<sp/>bytes<sp/>(take<sp/>care<sp/>on<sp/>wraparound)<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>res<sp/>=<sp/>f_lseek(fp,<sp/>f_tell(fp)<sp/>-<sp/>2000);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>/*<sp/>Cluster<sp/>pre-allocation<sp/>(to<sp/>prevent<sp/>buffer<sp/>overrun<sp/>on<sp/>streaming<sp/>write)<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>res<sp/>=<sp/>f_open(fp,<sp/>recfile,<sp/>FA_CREATE_NEW<sp/>|<sp/>FA_WRITE);<sp/><sp/><sp/>/*<sp/>Create<sp/>a<sp/>file<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>res<sp/>=<sp/>f_lseek(fp,<sp/>PRE_SIZE);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>Expand<sp/>file<sp/>size<sp/>(cluster<sp/>pre-allocation)<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>if<sp/>(res<sp/>||<sp/>f_tell(fp)<sp/>!=<sp/>PRE_SIZE)<sp/>...<sp/><sp/><sp/>/*<sp/>Check<sp/>if<sp/>the<sp/>file<sp/>has<sp/>been<sp/>expanded<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>res<sp/>=<sp/>f_lseek(fp,<sp/>DATA_START);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>Record<sp/>data<sp/>stream<sp/>WITHOUT<sp/>cluster<sp/>allocation<sp/>delay<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>...<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>DATA_START<sp/>and<sp/>write<sp/>block<sp/>size<sp/>should<sp/>be<sp/>aligned<sp/>to<sp/>sector<sp/>boundary<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>res<sp/>=<sp/>f_truncate(fp);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>Truncate<sp/>unused<sp/>area<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>res<sp/>=<sp/>f_lseek(fp,<sp/>0);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>Put<sp/>file<sp/>header<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>...</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>res<sp/>=<sp/>f_close(fp);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">/*<sp/>Using<sp/>fast<sp/>seek<sp/>feature<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>DWORD<sp/>clmt[SZ_TBL];<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>Cluster<sp/>link<sp/>map<sp/>table<sp/>buffer<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>res<sp/>=<sp/>f_lseek(fp,<sp/>ofs1);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>This<sp/>is<sp/>normal<sp/>seek<sp/>(cltbl<sp/>is<sp/>nulled<sp/>on<sp/>file<sp/>open)<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>fp-&gt;cltbl<sp/>=<sp/>clmt;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>Enable<sp/>fast<sp/>seek<sp/>feature<sp/>(cltbl<sp/>!=<sp/>NULL)<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>clmt[0]<sp/>=<sp/>SZ_TBL;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>Set<sp/>table<sp/>size<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>res<sp/>=<sp/>f_lseek(fp,<sp/>CREATE_LINKMAP);<sp/><sp/><sp/><sp/><sp/>/*<sp/>Create<sp/>CLMT<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>...</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>res<sp/>=<sp/>f_lseek(fp,<sp/>ofs2);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>This<sp/>is<sp/>fast<sp/>seek<sp/>*/</highlight></codeline>
</programlisting> <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">fp</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the open file object. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">ofs</parametername>
</parameternamelist>
<parameterdescription>
<para>Byte offset from top of the file. </para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>FR_OK</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_DISK_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INT_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_READY</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_OBJECT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_TIMEOUT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="note"><para>Available when _FS_MINIMIZE &lt;= 2. </para></simplesect>
</para></listitem>
</itemizedlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="3029" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="3029" bodyend="3178"/>
        <references refid="ff_8c_1aa7193f5b86c3996b5312043a0c26da5f" compoundref="ff_8c" startline="2372" endline="2385">validate</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" compoundref="ff_8c" startline="40">LEAVE_FF</references>
        <references refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" compoundref="ff_8h" startline="115">FIL::fs</references>
        <references refid="struct_f_i_l_1a32b2a186af2cab58af8114c05386b9f6" compoundref="ff_8h" startline="118">FIL::err</references>
        <references refid="ff_8h_1aee297a9011164cf485a4df2a72758b08" compoundref="ff_8h" startline="327">CREATE_LINKMAP</references>
        <references refid="struct_f_i_l_1ad5d52f3fde971d2a05ff777a6243c252" compoundref="ff_8h" startline="121">FIL::sclust</references>
        <references refid="ff_8c_1a65611adf1626e5e08da77cd33a98dd8b" compoundref="ff_8c" startline="818" endline="862">get_fat</references>
        <references refid="ff_8c_1a41e4c46636679236568cf50b5535847f" compoundref="ff_8c" startline="46">ABORT</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" compoundref="ff_8h" startline="187">FR_INT_ERR</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" compoundref="ff_8h" startline="186">FR_DISK_ERR</references>
        <references refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" compoundref="ff_8h" startline="100">FATFS::n_fatent</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44caf56a76a86602cbdeb2c4f3d00cfad21c" compoundref="ff_8h" startline="202">FR_NOT_ENOUGH_CORE</references>
        <references refid="struct_f_i_l_1af70a0afd16367837984d6205cbfca308" compoundref="ff_8h" startline="120">FIL::fsize</references>
        <references refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" compoundref="ff_8h" startline="119">FIL::fptr</references>
        <references refid="struct_f_i_l_1ac134c1b4645be670eb5207032e714616" compoundref="ff_8h" startline="122">FIL::clust</references>
        <references refid="ff_8c_1a7519abb60fe91f6aa1d17f64fbae123a" compoundref="ff_8c" startline="800" endline="808">clust2sect</references>
        <references refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" compoundref="ff_8c" startline="54">SS</references>
        <references refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" compoundref="ff_8h" startline="81">FATFS::csize</references>
        <references refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" compoundref="ff_8h" startline="123">FIL::dsect</references>
        <references refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" compoundref="ff_8h" startline="117">FIL::flag</references>
        <references refid="ff_8h_1a5b2962e3616a1e9eb709d95f4c75c67c" compoundref="ff_8h" startline="303">FA__DIRTY</references>
        <references refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" compoundref="_b_c_d_s___s_d_card___interface_8h" startline="63">disk_write</references>
        <references refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" compoundref="ff_8h" startline="80">FATFS::drv</references>
        <references refid="struct_f_i_l_1a1602edc1ba9d9ae2b583cf55f3492325" compoundref="ff_8h" startline="135">FIL::buf</references>
        <references refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" compoundref="diskio_8h" startline="23">RES_OK</references>
        <references refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1gae55155170bc9b99f73b440b93cc1c9e2" compoundref="_b_c_d_s___s_d_card___interface_8h" startline="62">disk_read</references>
        <references refid="group___f_f_c_o_n_f_i_g_1gafb8d35370cfe0c23832ac2d82e854ec6" compoundref="ffconf_8h" startline="30">_FS_READONLY</references>
        <references refid="ff_8h_1afa366963220c89b882c0361794020c14" compoundref="ff_8h" startline="298">FA_WRITE</references>
        <references refid="ff_8c_1acbd0a20a17c6f9b6d536490d1cc3c5ac" compoundref="ff_8c" startline="990" endline="1040">create_chain</references>
        <references refid="ff_8h_1ac4b7d5223f84df91c306ffbff536fae4" compoundref="ff_8h" startline="302">FA__WRITTEN</references>
      </memberdef>
      <memberdef kind="function" id="group__filesystem_1ga4b4d38db58e89c526cfcf53200d719d0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>FRESULT f_mkdir</definition>
        <argsstring>(const TCHAR *path)</argsstring>
        <name>f_mkdir</name>
        <param>
          <type>const <ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref> *</type>
          <declname>path</declname>
        </param>
        <briefdescription>
<para>The f_mkdir function creates a new directory. </para>        </briefdescription>
        <detaileddescription>
<para>This function creates a new directory. <linebreak/>
 Example: <programlisting><codeline><highlight class="normal">res<sp/>=<sp/>f_mkdir(&quot;sub1&quot;);</highlight></codeline>
<codeline><highlight class="normal">if<sp/>(res)<sp/>die(res);</highlight></codeline>
<codeline><highlight class="normal">res<sp/>=<sp/>f_mkdir(&quot;sub1/sub2&quot;);</highlight></codeline>
<codeline><highlight class="normal">if<sp/>(res)<sp/>die(res);</highlight></codeline>
<codeline><highlight class="normal">res<sp/>=<sp/>f_mkdir(&quot;sub1/sub2/sub3&quot;);</highlight></codeline>
<codeline><highlight class="normal">if<sp/>(res)<sp/>die(res);</highlight></codeline>
</programlisting> <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">path</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the null-terminated string that specifies the directory name to create. </para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>FR_OK</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_DISK_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INT_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_READY</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NO_PATH</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_NAME</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_DENIED</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_EXIST</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_WRITE_PROTECTED</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_DRIVE</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_ENABLED</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NO_FILESYSTEM</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_TIMEOUT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_ENOUGH_CORE</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="note"><para>Available when _FS_READONLY == 0 and _FS_MINIMIZE == 0. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="3595" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="3595" bodyend="3660"/>
        <references refid="ff_8c_1a72589f5bbb514c0b222ab8b292764418" compoundref="ff_8c" startline="67">GET_FATTIME</references>
        <references refid="ff_8c_1a7cc27142421bd12be623072288599791" compoundref="ff_8c" startline="473">DEFINE_NAMEBUF</references>
        <references refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</references>
        <references refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" compoundref="ff_8h" startline="144">DIR::fs</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="ff_8c_1a966fe5792671b39db1ccf655a8c1af8d" compoundref="ff_8c" startline="474">INIT_BUF</references>
        <references refid="ff_8c_1af194524672491a522f041278b9b74e94" compoundref="ff_8c" startline="2052" endline="2104">follow_path</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca0d8f024d256df76e84782b95018a2450" compoundref="ff_8h" startline="193">FR_EXIST</references>
        <references refid="group___f_f_c_o_n_f_i_g_1ga52faf11025401372f71e9d81905b7af4" compoundref="ffconf_8h" startline="146">_FS_RPATH</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" compoundref="ff_8h" startline="189">FR_NO_FILE</references>
        <references refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" compoundref="ff_8h" startline="151">DIR::fn</references>
        <references refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" compoundref="ff_8c" startline="351">NSFLAG</references>
        <references refid="ff_8c_1a2db528782a021797b34bdc6e9e9de1c3" compoundref="ff_8c" startline="357">NS_DOT</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" compoundref="ff_8h" startline="191">FR_INVALID_NAME</references>
        <references refid="ff_8c_1acbd0a20a17c6f9b6d536490d1cc3c5ac" compoundref="ff_8c" startline="990" endline="1040">create_chain</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d" compoundref="ff_8h" startline="192">FR_DENIED</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" compoundref="ff_8h" startline="187">FR_INT_ERR</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" compoundref="ff_8h" startline="186">FR_DISK_ERR</references>
        <references refid="ff_8c_1a5e18753404354b210096f9af99e31bc1" compoundref="ff_8c" startline="700" endline="724">sync_window</references>
        <references refid="ff_8c_1a7519abb60fe91f6aa1d17f64fbae123a" compoundref="ff_8c" startline="800" endline="808">clust2sect</references>
        <references refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" compoundref="ff_8h" startline="107">FATFS::win</references>
        <references refid="ff_8c_1a02eb5189e43056a9ddc8a59cbe89be93" compoundref="ff_8c" startline="524" endline="529">mem_set</references>
        <references refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" compoundref="ff_8c" startline="54">SS</references>
        <references refid="ff_8c_1afa89348e9fc2de82ae9e12c661366b0e" compoundref="ff_8c" startline="409">DIR_Name</references>
        <references refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" compoundref="ff_8c" startline="410">DIR_Attr</references>
        <references refid="ff_8h_1a3a9db44e978ed6c13b641e092d4cd7d3" compoundref="ff_8h" startline="321">AM_DIR</references>
        <references refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" compoundref="ff_8h" startline="338">ST_DWORD</references>
        <references refid="ff_8c_1ab9452d336adeece2a1b0b54ab35b8a59" compoundref="ff_8c" startline="417">DIR_WrtTime</references>
        <references refid="ff_8c_1a357e5a36452e057d68378c98cd61018c" compoundref="ff_8c" startline="1252" endline="1259">st_clust</references>
        <references refid="ff_8c_1a8941d573d16af92c8570950d53164f30" compoundref="ff_8c" startline="507" endline="520">mem_cpy</references>
        <references refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" compoundref="ff_8c" startline="426">SZ_DIRE</references>
        <references refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" compoundref="ff_8h" startline="147">DIR::sclust</references>
        <references refid="struct_f_a_t_f_s_1a3630ef0b29c45ef8e0c1de639efab754" compoundref="ff_8h" startline="79">FATFS::fs_type</references>
        <references refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" compoundref="ff_8h" startline="311">FS_FAT32</references>
        <references refid="struct_f_a_t_f_s_1aebfa6556d8f94e951a8b2c1eb740e9a1" compoundref="ff_8h" startline="104">FATFS::dirbase</references>
        <references refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" compoundref="ff_8h" startline="81">FATFS::csize</references>
        <references refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" compoundref="ff_8h" startline="106">FATFS::winsect</references>
        <references refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" compoundref="ff_8h" startline="83">FATFS::wflag</references>
        <references refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" compoundref="ff_8c" startline="1578" endline="1645">dir_register</references>
        <references refid="ff_8c_1ab88651d19a5597dec220fe7538cccf23" compoundref="ff_8c" startline="937" endline="979">remove_chain</references>
        <references refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" compoundref="ff_8h" startline="150">DIR::dir</references>
        <references refid="ff_8c_1aec6b108298553219ebb2b960b528459d" compoundref="ff_8c" startline="760" endline="789">sync_fs</references>
        <references refid="ff_8c_1aba6d6942b59f11cf285bdbfb7e38f1fa" compoundref="ff_8c" startline="475">FREE_BUF</references>
        <references refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" compoundref="ff_8c" startline="40">LEAVE_FF</references>
      </memberdef>
      <memberdef kind="function" id="group__filesystem_1ga799aff9594e708c8be357281cf85428b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>FRESULT f_mkfs</definition>
        <argsstring>(const TCHAR *path, BYTE sfd, UINT au)</argsstring>
        <name>f_mkfs</name>
        <param>
          <type>const <ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref> *</type>
          <declname>path</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref></type>
          <declname>sfd</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref></type>
          <declname>au</declname>
        </param>
        <briefdescription>
<para>The f_mkfs fucntion creates an FAT file system on the logical drive. </para>        </briefdescription>
        <detaileddescription>
<para>The <ref refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" kindref="member">f_mkfs()</ref> function creates an FAT volume on the specified logical drive. When FDISK format is specified, a primary partition occupies entire space of the physical drive is created and then an FAT volume is created on the partition. When SFD format is specified, the FAT volume starts from the first sector of the physical drive. <linebreak/>
 If the logical drive is bound to the specific partition (1-4) by multiple partition feature (_MULTI_PARTITION), the FAT volume is created into the partition. In this case, the second argument sfd is ignored. The physical drive must have been partitioned with <ref refid="group__filesystem_1ga0c1bd3e3872abbda0e256e7c73da9f3b" kindref="member">f_fdisk()</ref> function or any other partitioning tools prior to create the FAT volume with this function. <linebreak/>
 Note that there are two partitioning rules, FDISK and SFD. The FDISK partitioning is usually used for harddisk, MMC, SDC, CFC and U Disk. It can divide a physical drive into one or more partitions with a partition table on the MBR. However Windows does not support multiple partition on the removable disk. The SFD is non-partitioned method. The FAT volume starts from the first sector on the physical drive without partition table. It is usually used for floppy disk, Microdrive, optical disk and any type of super-floppy media. <linebreak/>
 The FAT sub-type, FAT12/FAT16/FAT32, is determined by number of clusters on the volume and nothing else, according to the FAT specification issued by Microsoft. Thus which FAT sub-type is selected, is depends on the volume size and the specified cluster size. The cluster size affects read/write throughput and space usage efficiency. Larger cluster size increases the read/write throughput and decreases the space usage efficiency of the volume. <linebreak/>
 In case of the number of clusters gets near the FAT sub-type boundaries, the function can fail with FR_MKFS_ABORTED. <linebreak/>
 Example: <programlisting><codeline><highlight class="normal">/*<sp/>Format<sp/>the<sp/>default<sp/>drive<sp/>*/</highlight></codeline>
<codeline><highlight class="normal">int<sp/>main<sp/>(void)</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/>FATFS<sp/>fs;<sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>File<sp/>system<sp/>object<sp/>(volume<sp/>work<sp/>area)<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/>FIL<sp/>fil;<sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>File<sp/>object<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/>FRESULT<sp/>res;<sp/><sp/><sp/>/*<sp/>API<sp/>result<sp/>code<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/>UINT<sp/>bw;<sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>Bytes<sp/>written<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/>/*<sp/>Register<sp/>work<sp/>area<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/>f_mount(&amp;fs,<sp/>&quot;&quot;,<sp/>0);</highlight></codeline>
<codeline><highlight class="normal"><sp/>/*<sp/>Create<sp/>FAT<sp/>volume<sp/>with<sp/>default<sp/>cluster<sp/>size<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/>res<sp/>=<sp/>f_mkfs(&quot;&quot;,<sp/>0,<sp/>0);</highlight></codeline>
<codeline><highlight class="normal"><sp/>if<sp/>(res)<sp/>...</highlight></codeline>
<codeline><highlight class="normal"><sp/>/*<sp/>Create<sp/>a<sp/>file<sp/>as<sp/>new<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/>res<sp/>=<sp/>f_open(&amp;fil,<sp/>&quot;hello.txt&quot;,<sp/>FA_CREATE_NEW<sp/>|<sp/>FA_WRITE);</highlight></codeline>
<codeline><highlight class="normal"><sp/>if<sp/>(res)<sp/>...</highlight></codeline>
<codeline><highlight class="normal"><sp/>/*<sp/>Write<sp/>a<sp/>message<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/>f_write(&amp;fil,<sp/>&quot;Hello,<sp/>World!\r\n&quot;,<sp/>15,<sp/>&amp;bw);</highlight></codeline>
<codeline><highlight class="normal"><sp/>if<sp/>(bw<sp/>!=<sp/>15)<sp/>...</highlight></codeline>
<codeline><highlight class="normal"><sp/>/*<sp/>Close<sp/>the<sp/>file<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/>f_close(&amp;fil);</highlight></codeline>
<codeline><highlight class="normal"><sp/>/*<sp/>Unregister<sp/>work<sp/>area<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/>f_mount(0,<sp/>&quot;&quot;,<sp/>0);</highlight></codeline>
</programlisting> <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">path</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the null-terminated string that specifies the logical drive to be formatted. If there is no drive number, it means the default drive. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">sfd</parametername>
</parameternamelist>
<parameterdescription>
<para>Specifies partitioning rule (FDISK(0) or SFD(1)). This argument will be ignored on some case. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">au</parametername>
</parameternamelist>
<parameterdescription>
<para>Specifies size of the allocation unit (cluter) in number of bytes or sectors. When the value is from 1 to 128, it specifies number of sectors. When the value is &gt;= _MIN_SS, it specifies number of bytes. If any invalid value, zero or not power of 2, is given, the cluster size is automatically determined depends on the volume size. </para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>FR_OK</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_DISK_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_READY</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_WRITE_PROTECTED</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_DRIVE</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_ENABLED</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_MKFS_ABORTED</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_PARAMETER</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="note"><para>Available when _FS_READOLNY == 0 and _USE_MKFS == 1. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="4063" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="4063" bodyend="4300"/>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca3b89faeceab64db277d0fcdeaaa315d6" compoundref="ff_8h" startline="204">FR_INVALID_PARAMETER</references>
        <references refid="ff_8c_1a88ad7e4b1bc98d1a2673a136283dc7ee" compoundref="ff_8c" startline="2114" endline="2165">get_ldnumber</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca487844af77de15f6932a3b41ef3a2d65" compoundref="ff_8h" startline="196">FR_INVALID_DRIVE</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cafc56605c68aaffab4a428339a8bd600d" compoundref="ff_8h" startline="197">FR_NOT_ENABLED</references>
        <references refid="struct_f_a_t_f_s_1a3630ef0b29c45ef8e0c1de639efab754" compoundref="ff_8h" startline="79">FATFS::fs_type</references>
        <references refid="ff_8h_1a6577ed2f95527745bf4d27c53488b9a7" compoundref="ff_8h" startline="46">LD2PD</references>
        <references refid="ff_8h_1aadc4a9aefaf2588bdd7565549f5d91e7" compoundref="ff_8h" startline="47">LD2PT</references>
        <references refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga45e4ba27a706ed2421edd501406a6496" compoundref="_b_c_d_s___s_d_card___interface_8h" startline="61">disk_initialize</references>
        <references refid="diskio_8h_1abd6503c70d862b979a3f7080a59e9acd" compoundref="diskio_8h" startline="44">STA_NOINIT</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cac9894bed3e8632ede8d2712235fa8e45" compoundref="ff_8h" startline="188">FR_NOT_READY</references>
        <references refid="diskio_8h_1a9ec6dc5f6620a33fabe388d3a111ca8c" compoundref="diskio_8h" startline="46">STA_PROTECT</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cac3afbb423b1d4497229416812aff383b" compoundref="ff_8h" startline="195">FR_WRITE_PROTECTED</references>
        <references refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga3051f51f1cccb103d145804d5d91b04d" compoundref="_b_c_d_s___s_d_card___interface_8h" startline="64">disk_ioctl</references>
        <references refid="diskio_8h_1ac73b5cf2135cbd459d109b96c9aa346a" compoundref="diskio_8h" startline="54">GET_SECTOR_SIZE</references>
        <references refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" compoundref="ff_8c" startline="54">SS</references>
        <references refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" compoundref="diskio_8h" startline="23">RES_OK</references>
        <references refid="group___f_f_c_o_n_f_i_g_1gac271b697378912f17132cb9c7d0de024" compoundref="ffconf_8h" startline="182">_MAX_SS</references>
        <references refid="group___f_f_c_o_n_f_i_g_1gad03aa6d0e294709ae15898ee2c14dc3a" compoundref="ffconf_8h" startline="181">_MIN_SS</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" compoundref="ff_8h" startline="186">FR_DISK_ERR</references>
        <references refid="group___f_f_c_o_n_f_i_g_1gadc02609ba893fe8706a2f8af0e3a3bb5" compoundref="ffconf_8h" startline="173">_MULTI_PARTITION</references>
        <references refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1gae55155170bc9b99f73b440b93cc1c9e2" compoundref="_b_c_d_s___s_d_card___interface_8h" startline="62">disk_read</references>
        <references refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" compoundref="ff_8h" startline="107">FATFS::win</references>
        <references refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" compoundref="ff_8h" startline="335">LD_WORD</references>
        <references refid="ff_8c_1a74b810b3f3583c1eb54bd4305c0f261a" compoundref="ff_8c" startline="407">BS_55AA</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca4b02760f758f5b1a89f445244fe9fbca" compoundref="ff_8h" startline="199">FR_MKFS_ABORTED</references>
        <references refid="ff_8c_1ac3f187bf0ba891551f594af6b61f3188" compoundref="ff_8c" startline="405">MBR_Table</references>
        <references refid="ff_8c_1af133060c47366e7e557d4085d931183f" compoundref="ff_8c" startline="406">SZ_PTE</references>
        <references refid="ff_8h_1a4690304ddc975516f7dc02575c96e34e" compoundref="ff_8h" startline="336">LD_DWORD</references>
        <references refid="diskio_8h_1a570216006f6a8fc4e1698b1bbb2d1dde" compoundref="diskio_8h" startline="53">GET_SECTOR_COUNT</references>
        <references refid="ff_8h_1aab755aa1b4f81f4aabee4a5d4738cfb0" compoundref="ff_8h" startline="309">FS_FAT12</references>
        <references refid="ff_8c_1aeec02d5ae07ede32b7d74155bf0fda15" compoundref="ff_8c" startline="361">MIN_FAT16</references>
        <references refid="ff_8h_1a7ef90a36d99edfc0138a2155a17a79b9" compoundref="ff_8h" startline="310">FS_FAT16</references>
        <references refid="ff_8c_1a483625319f3e3bd5ac6502b46c375aed" compoundref="ff_8c" startline="362">MIN_FAT32</references>
        <references refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" compoundref="ff_8h" startline="311">FS_FAT32</references>
        <references refid="ff_8c_1a412083bc7d166082045a0111e890b22a" compoundref="ff_8c" startline="4059">N_ROOTDIR</references>
        <references refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" compoundref="ff_8c" startline="426">SZ_DIRE</references>
        <references refid="ff_8c_1a3f9495abc6071dcfdbd242cc1f9ad9f8" compoundref="ff_8c" startline="4060">N_FATS</references>
        <references refid="diskio_8h_1aec3bb4dfe075d0ba2f3b07b300a95500" compoundref="diskio_8h" startline="55">GET_BLOCK_SIZE</references>
        <references refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" compoundref="_b_c_d_s___s_d_card___interface_8h" startline="63">disk_write</references>
        <references refid="ff_8c_1a02eb5189e43056a9ddc8a59cbe89be93" compoundref="ff_8c" startline="524" endline="529">mem_set</references>
        <references refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" compoundref="ff_8h" startline="338">ST_DWORD</references>
        <references refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" compoundref="ff_8h" startline="337">ST_WORD</references>
        <references refid="ff_8c_1a8941d573d16af92c8570950d53164f30" compoundref="ff_8c" startline="507" endline="520">mem_cpy</references>
        <references refid="ff_8c_1a8551844b4eb4e15aecd8cc9aa3585fa2" compoundref="ff_8c" startline="371">BPB_BytsPerSec</references>
        <references refid="ff_8c_1aab78e41c617a14b9540c0563d6b957fa" compoundref="ff_8c" startline="372">BPB_SecPerClus</references>
        <references refid="ff_8c_1ab3ec444c8457c9bc98aa07e846f5c1b7" compoundref="ff_8c" startline="373">BPB_RsvdSecCnt</references>
        <references refid="ff_8c_1af44a1e8c89ec5502595f23496d24cbf1" compoundref="ff_8c" startline="374">BPB_NumFATs</references>
        <references refid="ff_8c_1aaa667f14c87c45dc128f2ab208e92f98" compoundref="ff_8c" startline="375">BPB_RootEntCnt</references>
        <references refid="ff_8c_1a4eb540eecde0f2df26fa8c7969341d68" compoundref="ff_8c" startline="376">BPB_TotSec16</references>
        <references refid="ff_8c_1a7723a9f0da553e8879d60909d85ccb7b" compoundref="ff_8c" startline="382">BPB_TotSec32</references>
        <references refid="ff_8c_1a414e054c4b5ea3414ebefa3539e7e554" compoundref="ff_8c" startline="377">BPB_Media</references>
        <references refid="ff_8c_1ac71bb771432ea532bc47713a028ebd76" compoundref="ff_8c" startline="379">BPB_SecPerTrk</references>
        <references refid="ff_8c_1a9c03603c3be34d4c5cc1b481b0bc6774" compoundref="ff_8c" startline="380">BPB_NumHeads</references>
        <references refid="ff_8c_1a449d4ed5c4c8105daf29aad9488277f7" compoundref="ff_8c" startline="381">BPB_HiddSec</references>
        <references refid="ff_8c_1a72589f5bbb514c0b222ab8b292764418" compoundref="ff_8c" startline="67">GET_FATTIME</references>
        <references refid="ff_8c_1abaa3aafdcf5e83f8cb7e2bb373b13525" compoundref="ff_8c" startline="398">BS_VolID32</references>
        <references refid="ff_8c_1a6e6340030dc29e7da2e9f92e472a763d" compoundref="ff_8c" startline="389">BPB_FATSz32</references>
        <references refid="ff_8c_1a7add0104bd20083d6940d616faecd45a" compoundref="ff_8c" startline="392">BPB_RootClus</references>
        <references refid="ff_8c_1a51c45669282b9ce9da5152231df9f3ac" compoundref="ff_8c" startline="393">BPB_FSInfo</references>
        <references refid="ff_8c_1a383726fb93488d41866028b4f07c90e1" compoundref="ff_8c" startline="394">BPB_BkBootSec</references>
        <references refid="ff_8c_1aa670c7b495f5b347c442df67b188c58f" compoundref="ff_8c" startline="395">BS_DrvNum32</references>
        <references refid="ff_8c_1a59c4b2f802ab4bc9319e5bd840e615b8" compoundref="ff_8c" startline="397">BS_BootSig32</references>
        <references refid="ff_8c_1a8241a49bce313184a58617ba1ad9e84c" compoundref="ff_8c" startline="399">BS_VolLab32</references>
        <references refid="ff_8c_1a383a71bda500a0fb5a37f4edd785acbf" compoundref="ff_8c" startline="386">BS_VolID</references>
        <references refid="ff_8c_1a60a2f6efeb6a4c7cb2da1e5def6ca43b" compoundref="ff_8c" startline="378">BPB_FATSz16</references>
        <references refid="ff_8c_1a0c51f7393341b839dfb241c2951f3ef4" compoundref="ff_8c" startline="383">BS_DrvNum</references>
        <references refid="ff_8c_1a85a92e790602efef4da3a2f141611ce8" compoundref="ff_8c" startline="385">BS_BootSig</references>
        <references refid="ff_8c_1a28498ba4b07ff90aaa9628e81fb89d32" compoundref="ff_8c" startline="387">BS_VolLab</references>
        <references refid="diskio_8h_1af09fd84bea8d4e889e272471f44d60d6" compoundref="diskio_8h" startline="56">CTRL_TRIM</references>
        <references refid="ff_8c_1a318e58c1966aba52b90ab98dcb649883" compoundref="ff_8c" startline="401">FSI_LeadSig</references>
        <references refid="ff_8c_1a3bac0e6ff5907873030db1d0a7c4ebef" compoundref="ff_8c" startline="402">FSI_StrucSig</references>
        <references refid="ff_8c_1ab711e50459aba01b11c6b46a7cc1410b" compoundref="ff_8c" startline="403">FSI_Free_Count</references>
        <references refid="ff_8c_1a320700cedf300c9b418edf56e5e6b086" compoundref="ff_8c" startline="404">FSI_Nxt_Free</references>
        <references refid="diskio_8h_1a1b3c492f9aec325f0655941b75256f3c" compoundref="diskio_8h" startline="52">CTRL_SYNC</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
      </memberdef>
      <memberdef kind="function" id="group__filesystem_1ga16a934c2bbfa2160295810adc49d5509" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>FRESULT f_mount</definition>
        <argsstring>(FATFS *fs, const TCHAR *path, BYTE opt)</argsstring>
        <name>f_mount</name>
        <param>
          <type><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref> *</type>
          <declname>fs</declname>
        </param>
        <param>
          <type>const <ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref> *</type>
          <declname>path</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref></type>
          <declname>opt</declname>
        </param>
        <briefdescription>
<para>The f_mount fucntion registers/unregisters file system object to the FatFs module. </para>        </briefdescription>
        <detaileddescription>
<para>The <ref refid="group__filesystem_1ga16a934c2bbfa2160295810adc49d5509" kindref="member">f_mount()</ref> function registers/unregisters a file system object used for the logical drive to the FatFs module as follows: <linebreak/>
 1.Determines the logical drive which specified by path. <linebreak/>
 2.Clears and unregisters the regsitered work area of the drive. <linebreak/>
 3.Clears and registers the new work area to the drive if fs is not NULL. <linebreak/>
 4.Performs volume mount process to the drive if forced mount is specified. <linebreak/>
 The file system object is the work area needed for each logical drive. It must be given to the logical drive with this function prior to use any other file functions except for <ref refid="group__filesystem_1ga0c1bd3e3872abbda0e256e7c73da9f3b" kindref="member">f_fdisk()</ref> function. To unregister a work area, specify a NULL to the fs, and then the work area can be discarded. <linebreak/>
 If forced mount is not specified, this function always succeeds regardless of the physical drive status due to delayed mount feature. It only clears (de-initializes) the given work area and registers its address to the internal table. No activity of the physical drive in this function. It can also be used to force de-initialized the registered work area of a logical drive. The volume mount processes, initialize the corresponding physical drive, find the FAT volume in it and initialize the work area, is performed in the subsequent file access functions when either or both of following condition is true. <linebreak/>
<itemizedlist>
<listitem><para>File system object is not initialized. It is cleared by <ref refid="group__filesystem_1ga16a934c2bbfa2160295810adc49d5509" kindref="member">f_mount()</ref>.</para></listitem><listitem><para>Physical drive is not initialized. It is de-initialized by system reset or media removal. <linebreak/>
 If the function with forced mount failed, it means that the file system object has been registered successfully but the volume is currently not ready to use. Mount process will also be attempted in subsequent file access functions. <linebreak/>
 If implementation of the disk I/O layer lacks media change detection, application program needs to perform a <ref refid="group__filesystem_1ga16a934c2bbfa2160295810adc49d5509" kindref="member">f_mount()</ref> after each media change to force cleared the file system object.</para></listitem></itemizedlist>
</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">fs</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the new file system object to be registered. Null pointer unregisters the registered file system object. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">path</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the null-terminated string that specifies the logical drive. The string with no drive number means the default drive. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">opt</parametername>
</parameternamelist>
<parameterdescription>
<para>Initialization option.<itemizedlist>
<listitem><para>0: Do not mount now (to be mounted later),</para></listitem><listitem><para>1: Force mounted the volume to check if the FAT volume is available. </para></listitem></itemizedlist>
</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>FR_OK</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_DRIVE</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_DISK_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_READY</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NO_FILESYSTEM</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="note"><para>Always available. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="2402" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="2402" bodyend="2440"/>
        <references refid="ff_8c_1a88ad7e4b1bc98d1a2673a136283dc7ee" compoundref="ff_8c" startline="2114" endline="2165">get_ldnumber</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca487844af77de15f6932a3b41ef3a2d65" compoundref="ff_8h" startline="196">FR_INVALID_DRIVE</references>
        <references refid="ff_8h_1a9184443f4d0a50b0f9a7fdb241613119" compoundref="syscall_8c" startline="52" endline="70">ff_del_syncobj</references>
        <references refid="struct_f_a_t_f_s_1a1c2c369d5858a2d8b60e65431b0b1a85" compoundref="ff_8h" startline="91">FATFS::sobj</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" compoundref="ff_8h" startline="187">FR_INT_ERR</references>
        <references refid="struct_f_a_t_f_s_1a3630ef0b29c45ef8e0c1de639efab754" compoundref="ff_8h" startline="79">FATFS::fs_type</references>
        <references refid="ff_8h_1a2593b7acfe680686184f9ecb1be50323" compoundref="syscall_8c" startline="19" endline="40">ff_cre_syncobj</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</references>
        <references refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" compoundref="ff_8c" startline="40">LEAVE_FF</references>
      </memberdef>
      <memberdef kind="function" id="group__filesystem_1gaefdef7126128d99d0b3bd82c28e54d80" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>FRESULT f_open</definition>
        <argsstring>(FIL *fp, const TCHAR *path, BYTE mode)</argsstring>
        <name>f_open</name>
        <param>
          <type><ref refid="struct_f_i_l" kindref="compound">FIL</ref> *</type>
          <declname>fp</declname>
        </param>
        <param>
          <type>const <ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref> *</type>
          <declname>path</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref></type>
          <declname>mode</declname>
        </param>
        <briefdescription>
<para>The f_open function creates a file object to be used to access the file. </para>        </briefdescription>
        <detaileddescription>
<para>After <ref refid="group__filesystem_1gaefdef7126128d99d0b3bd82c28e54d80" kindref="member">f_open()</ref> function succeeded, the file object is valid. The file object is used for subsequent read/write functions to identify the file. To close an open file, use <ref refid="group__filesystem_1ga53882db20ef4323dcfd1874d7733ffc3" kindref="member">f_close()</ref> function. If the file is modified and not closed properly, the file data will be collapsed. <linebreak/>
 If duplicated file open is needed, read here carefully. However duplicated open of a file with write mode flag is always prohibited. <linebreak/>
 Before using any file function, a work area (file system object) must be registered to the logical drive with <ref refid="group__filesystem_1ga16a934c2bbfa2160295810adc49d5509" kindref="member">f_mount()</ref> function. All API functions except for <ref refid="group__filesystem_1ga0c1bd3e3872abbda0e256e7c73da9f3b" kindref="member">f_fdisk()</ref> function can work after this procedure. <linebreak/>
 Examples: <programlisting><codeline><highlight class="normal"><sp/>/*<sp/>Read<sp/>a<sp/>text<sp/>file<sp/>and<sp/>display<sp/>it<sp/>*/</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/>FATFS<sp/>FatFs;<sp/><sp/><sp/>/*<sp/>Work<sp/>area<sp/>(file<sp/>system<sp/>object)<sp/>for<sp/>logical<sp/>drive<sp/>*/</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/>int<sp/>main<sp/>(void)</highlight></codeline>
<codeline><highlight class="normal"><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>FIL<sp/>fil;<sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>File<sp/>object<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>char<sp/>line[82];<sp/>/*<sp/>Line<sp/>buffer<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>FRESULT<sp/>fr;<sp/><sp/><sp/><sp/>/*<sp/>FatFs<sp/>return<sp/>code<sp/>*/</highlight></codeline>
<codeline></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>/*<sp/>Register<sp/>work<sp/>area<sp/>to<sp/>the<sp/>default<sp/>drive<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>f_mount(&amp;FatFs,<sp/>&quot;&quot;,<sp/>0);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>/*<sp/>Open<sp/>a<sp/>text<sp/>file<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>fr<sp/>=<sp/>f_open(&amp;fil,<sp/>&quot;message.txt&quot;,<sp/>FA_READ);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>if<sp/>(fr)<sp/>return<sp/>(int)fr;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>/*<sp/>Read<sp/>all<sp/>lines<sp/>and<sp/>display<sp/>it<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>while<sp/>(f_gets(line,<sp/>sizeof<sp/>line,<sp/>&amp;fil))</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(line);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>/*<sp/>Close<sp/>the<sp/>file<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>f_close(&amp;fil);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>return<sp/>0;</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting> <programlisting><codeline><highlight class="normal">/*<sp/>Copy<sp/>a<sp/>file<sp/>&quot;file.bin&quot;<sp/>on<sp/>the<sp/>drive<sp/>1<sp/>to<sp/>drive<sp/>0<sp/>*/</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">int<sp/>main<sp/>(void)</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>FATFS<sp/>fs[2];<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>Work<sp/>area<sp/>(file<sp/>system<sp/>object)<sp/>for<sp/>logical<sp/>drives<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>FIL<sp/>fsrc,<sp/>fdst;<sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>File<sp/>objects<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>BYTE<sp/>buffer[4096];<sp/><sp/><sp/>/*<sp/>File<sp/>copy<sp/>buffer<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>FRESULT<sp/>fr;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>FatFs<sp/>function<sp/>common<sp/>result<sp/>code<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>UINT<sp/>br,<sp/>bw;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>File<sp/>read/write<sp/>count<sp/>*/</highlight></codeline>
<codeline></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/>/*<sp/>Register<sp/>work<sp/>area<sp/>for<sp/>each<sp/>logical<sp/>drive<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>f_mount(&amp;fs[0],<sp/>&quot;0:&quot;,<sp/>0);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>f_mount(&amp;fs[1],<sp/>&quot;1:&quot;,<sp/>0);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>/*<sp/>Open<sp/>source<sp/>file<sp/>on<sp/>the<sp/>drive<sp/>1<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>fr<sp/>=<sp/>f_open(&amp;fsrc,<sp/>&quot;1:file.bin&quot;,<sp/>FA_OPEN_EXISTING<sp/>|<sp/>FA_READ);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>if<sp/>(fr)<sp/>return<sp/>(int)fr;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>/*<sp/>Create<sp/>destination<sp/>file<sp/>on<sp/>the<sp/>drive<sp/>0<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>fr<sp/>=<sp/>f_open(&amp;fdst,<sp/>&quot;0:file.bin&quot;,<sp/>FA_CREATE_ALWAYS<sp/>|<sp/>FA_WRITE);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>if<sp/>(fr)<sp/>return<sp/>(int)fr;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>/*<sp/>Copy<sp/>source<sp/>to<sp/>destination<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>for<sp/>(;;)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fr<sp/>=<sp/>f_read(&amp;fsrc,<sp/>buffer,<sp/>sizeof<sp/>buffer,<sp/>&amp;br);<sp/><sp/>/*<sp/>Read<sp/>a<sp/>chunk<sp/>of<sp/>source<sp/>file<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(fr<sp/>||<sp/>br<sp/>==<sp/>0)<sp/>break;<sp/>/*<sp/>error<sp/>or<sp/>eof<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fr<sp/>=<sp/>f_write(&amp;fdst,<sp/>buffer,<sp/>br,<sp/>&amp;bw);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>Write<sp/>it<sp/>to<sp/>the<sp/>destination<sp/>file<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(fr<sp/>||<sp/>bw<sp/>&lt;<sp/>br)<sp/>break;<sp/>/*<sp/>error<sp/>or<sp/>disk<sp/>full<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>/*<sp/>Close<sp/>open<sp/>files<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>f_close(&amp;fsrc);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>f_close(&amp;fdst);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>/*<sp/>Unregister<sp/>work<sp/>area<sp/>prior<sp/>to<sp/>discard<sp/>it<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>f_mount(NULL,<sp/>&quot;0:&quot;,<sp/>0);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>f_mount(NULL,<sp/>&quot;1:&quot;,<sp/>0);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>return<sp/>(int)fr;</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting> <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="out">fp</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the blank file object structure to be created. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">path</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to a null-terminated string that specifies the file name to open or create. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">mode</parametername>
</parameternamelist>
<parameterdescription>
<para>Mode flags that specifies the type of access and open method for the file. It is specified by a combination of following flags.<linebreak/>
<table rows="7" cols="2"><row>
<entry thead="yes"><para>Value </para></entry><entry thead="yes"><para>Description  </para></entry></row>
<row>
<entry thead="no"><para>FA_READ </para></entry><entry thead="no"><para>Specifies read access to the object. Data can be read from the file. Combine with FA_WRITE for read-write access. </para></entry></row>
<row>
<entry thead="no"><para>FA_WRITE </para></entry><entry thead="no"><para>Specifies write access to the object. Data can be written to the file. Combine with FA_READ for read-write access. </para></entry></row>
<row>
<entry thead="no"><para>FA_OPEN_EXISTING </para></entry><entry thead="no"><para>Opens the file. The function fails if the file is not existing. (Default) . </para></entry></row>
<row>
<entry thead="no"><para>FA_OPEN_ALWAYS </para></entry><entry thead="no"><para>Opens the file if it is existing. If not, a new file is created. To append data to the file, use <ref refid="group__filesystem_1ga5df0ac672ada972e89ef4b003e57f964" kindref="member">f_lseek()</ref> function after file open in this method. </para></entry></row>
<row>
<entry thead="no"><para>FA_CREATE_NEW </para></entry><entry thead="no"><para>Creates a new file. The function fails with FR_EXIST if the file is existing. </para></entry></row>
<row>
<entry thead="no"><para>FA_CREATE_NEW </para></entry><entry thead="no"><para>Creates a new file. If the file is existing, it will be truncated and overwritten. <linebreak/>
 </para></entry></row>
</table>
</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>FR_OK</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_DISK_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INT_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_READY</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NO_FILE</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NO_PATH</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_NAME</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_DENIED</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_EXIST</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_OBJECT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_WRITE_PROTECTED</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_DRIVE</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_ENABLED</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NO_FILESYSTEM</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_TIMEOUT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_LOCKED</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_ENOUGH_CORE</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_TOO_MANY_OPEN_FILES</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="note"><para>Always available. The mode flags, FA_WRITE, FA_CREATE_ALWAYS, FA_CREATE_NEW and FA_OPEN_ALWAYS, are not available when _FS_READONLY == 1. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="2449" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="2449" bodyend="2577"/>
        <references refid="ff_8c_1a7cc27142421bd12be623072288599791" compoundref="ff_8c" startline="473">DEFINE_NAMEBUF</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca3dec4eba481cdf5e99d7cd6009e6dcf8" compoundref="ff_8h" startline="194">FR_INVALID_OBJECT</references>
        <references refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" compoundref="ff_8h" startline="115">FIL::fs</references>
        <references refid="ff_8h_1a1f4f3530ff03abbd979b072536e72290" compoundref="ff_8h" startline="294">FA_READ</references>
        <references refid="ff_8h_1afa366963220c89b882c0361794020c14" compoundref="ff_8h" startline="298">FA_WRITE</references>
        <references refid="ff_8h_1afba4546b131dea4b24727fa20a80e29f" compoundref="ff_8h" startline="300">FA_CREATE_ALWAYS</references>
        <references refid="ff_8h_1a17b01553029920ac0468912b4bcb16c7" compoundref="ff_8h" startline="301">FA_OPEN_ALWAYS</references>
        <references refid="ff_8h_1a417bb1babd1785fd181a806b5613eba3" compoundref="ff_8h" startline="299">FA_CREATE_NEW</references>
        <references refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</references>
        <references refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" compoundref="ff_8h" startline="144">DIR::fs</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="ff_8c_1a966fe5792671b39db1ccf655a8c1af8d" compoundref="ff_8c" startline="474">INIT_BUF</references>
        <references refid="ff_8c_1af194524672491a522f041278b9b74e94" compoundref="ff_8c" startline="2052" endline="2104">follow_path</references>
        <references refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" compoundref="ff_8h" startline="150">DIR::dir</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" compoundref="ff_8h" startline="191">FR_INVALID_NAME</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" compoundref="ff_8h" startline="189">FR_NO_FILE</references>
        <references refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" compoundref="ff_8c" startline="1578" endline="1645">dir_register</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca50dd3c3c274ccebb2cfbddde9d065bb9" compoundref="ff_8h" startline="203">FR_TOO_MANY_OPEN_FILES</references>
        <references refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" compoundref="ff_8c" startline="410">DIR_Attr</references>
        <references refid="ff_8h_1add6d85d1e7a02b4f6188783ef91a5f1e" compoundref="ff_8h" startline="316">AM_RDO</references>
        <references refid="ff_8h_1a3a9db44e978ed6c13b641e092d4cd7d3" compoundref="ff_8h" startline="321">AM_DIR</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d" compoundref="ff_8h" startline="192">FR_DENIED</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca0d8f024d256df76e84782b95018a2450" compoundref="ff_8h" startline="193">FR_EXIST</references>
        <references refid="ff_8c_1a72589f5bbb514c0b222ab8b292764418" compoundref="ff_8c" startline="67">GET_FATTIME</references>
        <references refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" compoundref="ff_8h" startline="338">ST_DWORD</references>
        <references refid="ff_8c_1a47fb1881ea71d860db9b8280564cb4d5" compoundref="ff_8c" startline="413">DIR_CrtTime</references>
        <references refid="ff_8c_1ab9452d336adeece2a1b0b54ab35b8a59" compoundref="ff_8c" startline="417">DIR_WrtTime</references>
        <references refid="ff_8c_1abfbfa613864a02a65f0bf70ead6672c7" compoundref="ff_8c" startline="420">DIR_FileSize</references>
        <references refid="ff_8c_1ad1b3343c92d0f0e58ba448c3c11b1f39" compoundref="ff_8c" startline="1235" endline="1247">ld_clust</references>
        <references refid="ff_8c_1a357e5a36452e057d68378c98cd61018c" compoundref="ff_8c" startline="1252" endline="1259">st_clust</references>
        <references refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" compoundref="ff_8h" startline="83">FATFS::wflag</references>
        <references refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" compoundref="ff_8h" startline="106">FATFS::winsect</references>
        <references refid="ff_8c_1ab88651d19a5597dec220fe7538cccf23" compoundref="ff_8c" startline="937" endline="979">remove_chain</references>
        <references refid="struct_f_a_t_f_s_1a10cd8b80b3b6474bf0d6432c8fb9d2d2" compoundref="ff_8h" startline="94">FATFS::last_clust</references>
        <references refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" compoundref="ff_8c" startline="729" endline="750">move_window</references>
        <references refid="ff_8h_1ac4b7d5223f84df91c306ffbff536fae4" compoundref="ff_8h" startline="302">FA__WRITTEN</references>
        <references refid="struct_f_i_l_1a5e11faf537370889c867127205f26ad1" compoundref="ff_8h" startline="125">FIL::dir_sect</references>
        <references refid="struct_f_i_l_1a0071755a7d2cacd3bafbb1bf2dab98a0" compoundref="ff_8h" startline="126">FIL::dir_ptr</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" compoundref="ff_8h" startline="187">FR_INT_ERR</references>
        <references refid="ff_8c_1aba6d6942b59f11cf285bdbfb7e38f1fa" compoundref="ff_8c" startline="475">FREE_BUF</references>
        <references refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" compoundref="ff_8h" startline="117">FIL::flag</references>
        <references refid="struct_f_i_l_1a32b2a186af2cab58af8114c05386b9f6" compoundref="ff_8h" startline="118">FIL::err</references>
        <references refid="struct_f_i_l_1ad5d52f3fde971d2a05ff777a6243c252" compoundref="ff_8h" startline="121">FIL::sclust</references>
        <references refid="struct_f_i_l_1af70a0afd16367837984d6205cbfca308" compoundref="ff_8h" startline="120">FIL::fsize</references>
        <references refid="ff_8h_1a4690304ddc975516f7dc02575c96e34e" compoundref="ff_8h" startline="336">LD_DWORD</references>
        <references refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" compoundref="ff_8h" startline="119">FIL::fptr</references>
        <references refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" compoundref="ff_8h" startline="123">FIL::dsect</references>
        <references refid="struct_f_i_l_1a7b7a6396b2c82ad46c6d8b2bf141a8dd" compoundref="ff_8h" startline="116">FIL::id</references>
        <references refid="struct_f_a_t_f_s_1a7b7a6396b2c82ad46c6d8b2bf141a8dd" compoundref="ff_8h" startline="85">FATFS::id</references>
        <references refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" compoundref="ff_8c" startline="40">LEAVE_FF</references>
      </memberdef>
      <memberdef kind="function" id="group__filesystem_1gab63b213c75f7335fbb63a1f3f70e5fc7" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>FRESULT f_opendir</definition>
        <argsstring>(DIR *dp, const TCHAR *path)</argsstring>
        <name>f_opendir</name>
        <param>
          <type><ref refid="struct_d_i_r" kindref="compound">DIR</ref> *</type>
          <declname>dp</declname>
        </param>
        <param>
          <type>const <ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref> *</type>
          <declname>path</declname>
        </param>
        <briefdescription>
<para>The f_opendir function opens a directory. </para>        </briefdescription>
        <detaileddescription>
<para>The <ref refid="group__filesystem_1gab63b213c75f7335fbb63a1f3f70e5fc7" kindref="member">f_opendir()</ref> function opens an exsisting directory and creates a directory object for subsequent <ref refid="group__filesystem_1gab39e82a110695de45f416f3149358012" kindref="member">f_readdir()</ref> function. <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="out">dp</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the blank directory object to create a new one. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">path</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the null-terminated string that specifies the directory name to be opened. </para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>FR_OK</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_DISK_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INT_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_READY</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NO_PATH</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_NAME</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_OBJECT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_DRIVE</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_ENABLED</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NO_FILESYSTEM</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_TIMEOUT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_ENOUGH_CORE</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_TOO_MANY_OPEN_FILES</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="note"><para>Available when _FS_MINIMIZE &lt;= 1. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="3187" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="3187" bodyend="3234"/>
        <references refid="ff_8c_1a7cc27142421bd12be623072288599791" compoundref="ff_8c" startline="473">DEFINE_NAMEBUF</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca3dec4eba481cdf5e99d7cd6009e6dcf8" compoundref="ff_8h" startline="194">FR_INVALID_OBJECT</references>
        <references refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" compoundref="ff_8h" startline="144">DIR::fs</references>
        <references refid="ff_8c_1a966fe5792671b39db1ccf655a8c1af8d" compoundref="ff_8c" startline="474">INIT_BUF</references>
        <references refid="ff_8c_1af194524672491a522f041278b9b74e94" compoundref="ff_8c" startline="2052" endline="2104">follow_path</references>
        <references refid="ff_8c_1aba6d6942b59f11cf285bdbfb7e38f1fa" compoundref="ff_8c" startline="475">FREE_BUF</references>
        <references refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" compoundref="ff_8h" startline="150">DIR::dir</references>
        <references refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" compoundref="ff_8c" startline="410">DIR_Attr</references>
        <references refid="ff_8h_1a3a9db44e978ed6c13b641e092d4cd7d3" compoundref="ff_8h" startline="321">AM_DIR</references>
        <references refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" compoundref="ff_8h" startline="147">DIR::sclust</references>
        <references refid="ff_8c_1ad1b3343c92d0f0e58ba448c3c11b1f39" compoundref="ff_8c" startline="1235" endline="1247">ld_clust</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cae4529c8cc8b59783d6efc9ba4f574532" compoundref="ff_8h" startline="190">FR_NO_PATH</references>
        <references refid="struct_d_i_r_1a7b7a6396b2c82ad46c6d8b2bf141a8dd" compoundref="ff_8h" startline="145">DIR::id</references>
        <references refid="struct_f_a_t_f_s_1a7b7a6396b2c82ad46c6d8b2bf141a8dd" compoundref="ff_8h" startline="85">FATFS::id</references>
        <references refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" compoundref="ff_8c" startline="1080" endline="1118">dir_sdi</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca50dd3c3c274ccebb2cfbddde9d065bb9" compoundref="ff_8h" startline="203">FR_TOO_MANY_OPEN_FILES</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" compoundref="ff_8h" startline="189">FR_NO_FILE</references>
        <references refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" compoundref="ff_8c" startline="40">LEAVE_FF</references>
      </memberdef>
      <memberdef kind="function" id="group__filesystem_1ga49cccab38cd84e2d3357fef2d1df21f9" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int f_printf</definition>
        <argsstring>(FIL *fp, const TCHAR *fmt,...)</argsstring>
        <name>f_printf</name>
        <param>
          <type><ref refid="struct_f_i_l" kindref="compound">FIL</ref> *</type>
          <declname>fp</declname>
        </param>
        <param>
          <type>const <ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref> *</type>
          <declname>fmt</declname>
        </param>
        <param>
          <type>...</type>
        </param>
        <briefdescription>
<para>The f_printf function writes formatted string to the file. </para>        </briefdescription>
        <detaileddescription>
<para>The <ref refid="group__filesystem_1ga49cccab38cd84e2d3357fef2d1df21f9" kindref="member">f_printf()</ref> is a wrapper function of <ref refid="group__filesystem_1gae6a4dfae8a9e308bdb2283a37ef680f2" kindref="member">f_write()</ref>. The format control directive is a sub-set of standard library shown as follows:<itemizedlist>
<listitem><para>Type: c C s S d D u U x X b B</para></listitem><listitem><para>Size: l L</para></listitem><listitem><para>Flag: 0 - <linebreak/>
 Example: <programlisting><codeline><highlight class="normal">f_printf(&amp;fil,<sp/>&quot;%d&quot;,<sp/>1234);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>&quot;1234&quot;<sp/>*/</highlight></codeline>
<codeline><highlight class="normal">f_printf(&amp;fil,<sp/>&quot;%6d,%3d%%&quot;,<sp/>-200,<sp/>5);<sp/><sp/>/*<sp/>&quot;<sp/><sp/>-200,<sp/><sp/>5%&quot;<sp/>*/</highlight></codeline>
<codeline><highlight class="normal">f_printf(&amp;fil,<sp/>&quot;%ld&quot;,<sp/>12345L);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>&quot;12345&quot;<sp/>*/</highlight></codeline>
<codeline><highlight class="normal">f_printf(&amp;fil,<sp/>&quot;%06d&quot;,<sp/>25);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>&quot;000025&quot;<sp/>*/</highlight></codeline>
<codeline><highlight class="normal">f_printf(&amp;fil,<sp/>&quot;%06d&quot;,<sp/>-25);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>&quot;000-25&quot;<sp/>*/</highlight></codeline>
<codeline><highlight class="normal">f_printf(&amp;fil,<sp/>&quot;%-6d&quot;,<sp/>25);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>&quot;25<sp/><sp/><sp/><sp/>&quot;<sp/>*/</highlight></codeline>
<codeline><highlight class="normal">f_printf(&amp;fil,<sp/>&quot;%u&quot;,<sp/>-1);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>&quot;65535&quot;<sp/>or<sp/>&quot;4294967295&quot;<sp/>*/</highlight></codeline>
<codeline><highlight class="normal">f_printf(&amp;fil,<sp/>&quot;%04x&quot;,<sp/>0xAB3);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>&quot;0ab3&quot;<sp/>*/</highlight></codeline>
<codeline><highlight class="normal">f_printf(&amp;fil,<sp/>&quot;%08LX&quot;,<sp/>0x123ABCL);<sp/><sp/><sp/><sp/>/*<sp/>&quot;00123ABC&quot;<sp/>*/</highlight></codeline>
<codeline><highlight class="normal">f_printf(&amp;fil,<sp/>&quot;%016b&quot;,<sp/>0x550F);<sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>&quot;0101010100001111&quot;<sp/>*/</highlight></codeline>
<codeline><highlight class="normal">f_printf(&amp;fil,<sp/>&quot;%s&quot;,<sp/>&quot;String&quot;);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>&quot;String&quot;<sp/>*/</highlight></codeline>
<codeline><highlight class="normal">f_printf(&amp;fil,<sp/>&quot;%8s&quot;,<sp/>&quot;abc&quot;);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>&quot;<sp/><sp/><sp/><sp/><sp/>abc&quot;<sp/>*/</highlight></codeline>
<codeline><highlight class="normal">f_printf(&amp;fil,<sp/>&quot;%-8s&quot;,<sp/>&quot;abc&quot;);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>&quot;abc<sp/><sp/><sp/><sp/><sp/>&quot;<sp/>*/</highlight></codeline>
<codeline><highlight class="normal">f_printf(&amp;fil,<sp/>&quot;%c&quot;,<sp/>&apos;a&apos;);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>&quot;a&quot;<sp/>*/</highlight></codeline>
<codeline><highlight class="normal">f_printf(&amp;fil,<sp/>&quot;%f&quot;,<sp/>10.0);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>f_printf<sp/>lacks<sp/>floating<sp/>point<sp/>support<sp/>*/</highlight></codeline>
</programlisting> <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">fp</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the open file object structure. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">fmt</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the null terminated format string. The terminator charactor will not be written. ... Optional arguments... </para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>When</parametername>
</parameternamelist>
<parameterdescription>
<para>the function succeeded, it returns number of characters written. When the function failed due to disk full or any error, an EOF (-1) will be returned. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="note"><para>Available when _FS_READONLY == 0 and _USE_STRFUNC is 1 or 2. When it is set to 2, &apos;<linebreak/>
&apos;s contained in the output are converted to &apos;&apos;+&apos;<linebreak/>
&apos;. <linebreak/>
 When FatFs is configured to Unicode API (_LFN_UNICODE == 1), data types on the srting fuctions, <ref refid="group__filesystem_1ga62a35ee79e4913c1e31ac706241be7da" kindref="member">f_putc()</ref>, <ref refid="group__filesystem_1ga9443c00129414fbfc16a5a13ad876ced" kindref="member">f_puts()</ref>, <ref refid="group__filesystem_1ga49cccab38cd84e2d3357fef2d1df21f9" kindref="member">f_printf()</ref> and <ref refid="group__filesystem_1ga0fa54bd310785ecdaed19dda8f60dac5" kindref="member">f_gets()</ref>, is also switched to Unicode. The character encoding on the file to be read/written via those functions is selected by _STRF_ENCODE option. </para></simplesect>
</para></listitem></itemizedlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="4579" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="4579" bodyend="4674"/>
        <references refid="structputbuff_1a8d839bbcaa5e21902d2481c87c4f359f" compoundref="ff_8c" startline="4462">putbuff::fp</references>
        <references refid="structputbuff_1a1560bca810e056ea71cbf8c667d59580" compoundref="ff_8c" startline="4463">putbuff::nchr</references>
        <references refid="structputbuff_1ae40354a1051342eb5a9db005715dcfa9" compoundref="ff_8c" startline="4463">putbuff::idx</references>
        <references refid="ff_8c_1a19f72a515ee94dd8a9660d513172ce9b" compoundref="ff_8c" startline="4469" endline="4520">putc_bfd</references>
        <references refid="ff_8c_1a65dee564f69f2ec27f25b67a348018b9" compoundref="ff_8c" startline="326">IsDigit</references>
        <references refid="ff_8c_1a4a9d454724926bd51a3aed589a97f08b" compoundref="ff_8c" startline="325">IsLower</references>
        <references refid="group__filesystem_1gae6a4dfae8a9e308bdb2283a37ef680f2" compoundref="ff_8c" startline="2687" endline="2800">f_write</references>
        <references refid="structputbuff_1a6966cd5c37fc8748361cad1ff6f7f640" compoundref="ff_8c" startline="4464">putbuff::buf</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="ff_8h_1a59adc4c82490d23754cd39c2fb99b0da" compoundref="ff_8h" startline="253">EOF</references>
      </memberdef>
      <memberdef kind="function" id="group__filesystem_1ga62a35ee79e4913c1e31ac706241be7da" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int f_putc</definition>
        <argsstring>(TCHAR c, FIL *fp)</argsstring>
        <name>f_putc</name>
        <param>
          <type><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref></type>
          <declname>chr</declname>
          <defname>c</defname>
        </param>
        <param>
          <type><ref refid="struct_f_i_l" kindref="compound">FIL</ref> *</type>
          <declname>fp</declname>
        </param>
        <briefdescription>
<para>The f_putc funciton puts a character to the file. </para>        </briefdescription>
        <detaileddescription>
<para>The <ref refid="group__filesystem_1ga62a35ee79e4913c1e31ac706241be7da" kindref="member">f_putc()</ref> function is a wrapper function of <ref refid="group__filesystem_1gae6a4dfae8a9e308bdb2283a37ef680f2" kindref="member">f_write()</ref> function. <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">chr</parametername>
</parameternamelist>
<parameterdescription>
<para>A character to be put. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">fp</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the open file object structuer. </para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>When</parametername>
</parameternamelist>
<parameterdescription>
<para>the character was written successfuly, it returns number of characters written. When the function failed due to disk full or any error, an EOF (-1) will be returned. <linebreak/>
 When FatFs is configured to Unicode API (_LFN_UNICODE == 1), character encoding on the string fuctions, <ref refid="group__filesystem_1ga62a35ee79e4913c1e31ac706241be7da" kindref="member">f_putc()</ref>, <ref refid="group__filesystem_1ga9443c00129414fbfc16a5a13ad876ced" kindref="member">f_puts()</ref>, <ref refid="group__filesystem_1ga49cccab38cd84e2d3357fef2d1df21f9" kindref="member">f_printf()</ref> and <ref refid="group__filesystem_1ga0fa54bd310785ecdaed19dda8f60dac5" kindref="member">f_gets()</ref>, is also switched to Unicode. The character encoding on the file to be read/written via those functions is selected by _STRF_ENCODE option. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="note"><para>Available when _FS_READONLY == 0 and _USE_STRFUNC is 1 or 2. When it is set to 2, a &apos;<linebreak/>
&apos; is converted to &apos;&apos;+&apos;<linebreak/>
&apos;. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="4524" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="4524" bodyend="4542"/>
        <references refid="structputbuff_1a8d839bbcaa5e21902d2481c87c4f359f" compoundref="ff_8c" startline="4462">putbuff::fp</references>
        <references refid="structputbuff_1a1560bca810e056ea71cbf8c667d59580" compoundref="ff_8c" startline="4463">putbuff::nchr</references>
        <references refid="structputbuff_1ae40354a1051342eb5a9db005715dcfa9" compoundref="ff_8c" startline="4463">putbuff::idx</references>
        <references refid="ff_8c_1a19f72a515ee94dd8a9660d513172ce9b" compoundref="ff_8c" startline="4469" endline="4520">putc_bfd</references>
        <references refid="group__filesystem_1gae6a4dfae8a9e308bdb2283a37ef680f2" compoundref="ff_8c" startline="2687" endline="2800">f_write</references>
        <references refid="structputbuff_1a6966cd5c37fc8748361cad1ff6f7f640" compoundref="ff_8c" startline="4464">putbuff::buf</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="ff_8h_1a59adc4c82490d23754cd39c2fb99b0da" compoundref="ff_8h" startline="253">EOF</references>
      </memberdef>
      <memberdef kind="function" id="group__filesystem_1ga9443c00129414fbfc16a5a13ad876ced" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int f_puts</definition>
        <argsstring>(const TCHAR *str, FIL *fp)</argsstring>
        <name>f_puts</name>
        <param>
          <type>const <ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref> *</type>
          <declname>str</declname>
        </param>
        <param>
          <type><ref refid="struct_f_i_l" kindref="compound">FIL</ref> *</type>
          <declname>fp</declname>
        </param>
        <briefdescription>
<para>The f_puts function writes a string to the file. </para>        </briefdescription>
        <detaileddescription>
<para>The <ref refid="group__filesystem_1ga9443c00129414fbfc16a5a13ad876ced" kindref="member">f_puts()</ref> function is a wrapper function of <ref refid="group__filesystem_1gae6a4dfae8a9e308bdb2283a37ef680f2" kindref="member">f_write()</ref> function. <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">str</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the null terminated string to be written. The terminator character will not be written. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">fp</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the open file object structure. </para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>When</parametername>
</parameternamelist>
<parameterdescription>
<para>the function succeeded, it returns number of characters written. When the write operation is aborted due to disk full or any error, an EOF (-1) will be returned. <linebreak/>
 When FatFs is configured to Unicode API (_LFN_UNICODE == 1), character encoding on the srting fuctions, <ref refid="group__filesystem_1ga62a35ee79e4913c1e31ac706241be7da" kindref="member">f_putc()</ref>, <ref refid="group__filesystem_1ga9443c00129414fbfc16a5a13ad876ced" kindref="member">f_puts()</ref>, <ref refid="group__filesystem_1ga49cccab38cd84e2d3357fef2d1df21f9" kindref="member">f_printf()</ref> and <ref refid="group__filesystem_1ga0fa54bd310785ecdaed19dda8f60dac5" kindref="member">f_gets()</ref>, is also switched to Unicode. The character encoding on the file to be read/written via those functions is selected by _STRF_ENCODE option. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="note"><para>Available when _FS_READONLY == 0 and _USE_STRFUNC is 1 or 2. When it is set to 2, &apos;<linebreak/>
&apos;s contained in the string are converted to &apos;&apos;+&apos;<linebreak/>
&apos;. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="4551" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="4551" bodyend="4570"/>
        <references refid="structputbuff_1a8d839bbcaa5e21902d2481c87c4f359f" compoundref="ff_8c" startline="4462">putbuff::fp</references>
        <references refid="structputbuff_1a1560bca810e056ea71cbf8c667d59580" compoundref="ff_8c" startline="4463">putbuff::nchr</references>
        <references refid="structputbuff_1ae40354a1051342eb5a9db005715dcfa9" compoundref="ff_8c" startline="4463">putbuff::idx</references>
        <references refid="ff_8c_1a19f72a515ee94dd8a9660d513172ce9b" compoundref="ff_8c" startline="4469" endline="4520">putc_bfd</references>
        <references refid="group__filesystem_1gae6a4dfae8a9e308bdb2283a37ef680f2" compoundref="ff_8c" startline="2687" endline="2800">f_write</references>
        <references refid="structputbuff_1a6966cd5c37fc8748361cad1ff6f7f640" compoundref="ff_8c" startline="4464">putbuff::buf</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="ff_8h_1a59adc4c82490d23754cd39c2fb99b0da" compoundref="ff_8h" startline="253">EOF</references>
      </memberdef>
      <memberdef kind="function" id="group__filesystem_1gac4c3dcb6869ca252888eebabe39727b3" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>FRESULT f_read</definition>
        <argsstring>(FIL *fp, void *buff, UINT btr, UINT *br)</argsstring>
        <name>f_read</name>
        <param>
          <type><ref refid="struct_f_i_l" kindref="compound">FIL</ref> *</type>
          <declname>fp</declname>
        </param>
        <param>
          <type>void *</type>
          <declname>buff</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref></type>
          <declname>btr</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref> *</type>
          <declname>br</declname>
        </param>
        <briefdescription>
<para>The f_read function reads data from a file. </para>        </briefdescription>
        <detaileddescription>
<para>The file read/write pointer of the file object advances number of bytes read. After the function succeeded, *br should be checked to detect end of the file. In case of *br is less than btr, it means the read/write pointer reached end of the file during read operation.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">fp</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the open file object. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="out">buff</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the buffer to store read data. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">btr</parametername>
</parameternamelist>
<parameterdescription>
<para>Number of bytes to read in range of UINT type. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="out">br</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the UINT variable to return number of bytes read. The value is always valid after the function call regardless of the result. </para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>FR_OK</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_DISK_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INT_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_READY</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_OBJECT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_TIMEOUT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="note"><para>Always available. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="2586" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="2586" bodyend="2677"/>
        <references refid="ff_8c_1aa7193f5b86c3996b5312043a0c26da5f" compoundref="ff_8c" startline="2372" endline="2385">validate</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" compoundref="ff_8c" startline="40">LEAVE_FF</references>
        <references refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" compoundref="ff_8h" startline="115">FIL::fs</references>
        <references refid="struct_f_i_l_1a32b2a186af2cab58af8114c05386b9f6" compoundref="ff_8h" startline="118">FIL::err</references>
        <references refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" compoundref="ff_8h" startline="117">FIL::flag</references>
        <references refid="ff_8h_1a1f4f3530ff03abbd979b072536e72290" compoundref="ff_8h" startline="294">FA_READ</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d" compoundref="ff_8h" startline="192">FR_DENIED</references>
        <references refid="struct_f_i_l_1af70a0afd16367837984d6205cbfca308" compoundref="ff_8h" startline="120">FIL::fsize</references>
        <references refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" compoundref="ff_8h" startline="119">FIL::fptr</references>
        <references refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" compoundref="ff_8c" startline="54">SS</references>
        <references refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" compoundref="ff_8h" startline="81">FATFS::csize</references>
        <references refid="struct_f_i_l_1ad5d52f3fde971d2a05ff777a6243c252" compoundref="ff_8h" startline="121">FIL::sclust</references>
        <references refid="ff_8c_1a65611adf1626e5e08da77cd33a98dd8b" compoundref="ff_8c" startline="818" endline="862">get_fat</references>
        <references refid="struct_f_i_l_1ac134c1b4645be670eb5207032e714616" compoundref="ff_8h" startline="122">FIL::clust</references>
        <references refid="ff_8c_1a41e4c46636679236568cf50b5535847f" compoundref="ff_8c" startline="46">ABORT</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" compoundref="ff_8h" startline="187">FR_INT_ERR</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" compoundref="ff_8h" startline="186">FR_DISK_ERR</references>
        <references refid="ff_8c_1a7519abb60fe91f6aa1d17f64fbae123a" compoundref="ff_8c" startline="800" endline="808">clust2sect</references>
        <references refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1gae55155170bc9b99f73b440b93cc1c9e2" compoundref="_b_c_d_s___s_d_card___interface_8h" startline="62">disk_read</references>
        <references refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" compoundref="ff_8h" startline="80">FATFS::drv</references>
        <references refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" compoundref="diskio_8h" startline="23">RES_OK</references>
        <references refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" compoundref="ff_8h" startline="83">FATFS::wflag</references>
        <references refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" compoundref="ff_8h" startline="106">FATFS::winsect</references>
        <references refid="ff_8c_1a8941d573d16af92c8570950d53164f30" compoundref="ff_8c" startline="507" endline="520">mem_cpy</references>
        <references refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" compoundref="ff_8h" startline="107">FATFS::win</references>
        <references refid="ff_8h_1a5b2962e3616a1e9eb709d95f4c75c67c" compoundref="ff_8h" startline="303">FA__DIRTY</references>
        <references refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" compoundref="ff_8h" startline="123">FIL::dsect</references>
        <references refid="struct_f_i_l_1a1602edc1ba9d9ae2b583cf55f3492325" compoundref="ff_8h" startline="135">FIL::buf</references>
        <references refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" compoundref="_b_c_d_s___s_d_card___interface_8h" startline="63">disk_write</references>
        <references refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" compoundref="ff_8c" startline="729" endline="750">move_window</references>
        <referencedby refid="group__filesystem_1ga0fa54bd310785ecdaed19dda8f60dac5" compoundref="ff_8c" startline="4382" endline="4450">f_gets</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__filesystem_1gab39e82a110695de45f416f3149358012" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>FRESULT f_readdir</definition>
        <argsstring>(DIR *dp, FILINFO *fno)</argsstring>
        <name>f_readdir</name>
        <param>
          <type><ref refid="struct_d_i_r" kindref="compound">DIR</ref> *</type>
          <declname>dp</declname>
        </param>
        <param>
          <type><ref refid="struct_f_i_l_i_n_f_o" kindref="compound">FILINFO</ref> *</type>
          <declname>fno</declname>
        </param>
        <briefdescription>
<para>The f_readdir function reads directory entries. </para>        </briefdescription>
        <detaileddescription>
<para>The <ref refid="group__filesystem_1gab39e82a110695de45f416f3149358012" kindref="member">f_readdir()</ref> function reads directory items, file and directory, in sequence. All items in the directory can be read by calling <ref refid="group__filesystem_1gab39e82a110695de45f416f3149358012" kindref="member">f_readdir()</ref> function repeatedly. When relative path feature is enabled (_FS_RPATH &gt;= 1), dot entries (&quot;.&quot; and &quot;..&quot;) are not filtered out and they will appear in the read items. When all directory items have been read and no item to read, a null string is returned into the fname[] without any error. When a null pointer is given to the fno, the read index of the directory object is rewinded. <linebreak/>
 When LFN feature is enabled, lfname and lfsize in the file information structure must be initialized with valid value prior to use it. The lfname is a pointer to the LFN read buffer. The lfsize is size of the LFN read buffer in unit of TCHAR. If the LFN is not needed, set a null pointer to the lfname and the LFN is not returned. A null string will be returned into the LFN read buffer in case of following conditions. <linebreak/>
<itemizedlist>
<listitem><para>The directory item has no LFN information.</para></listitem><listitem><para>Either the size of read buffer or LFN working buffer is insufficient for the LFN.</para></listitem><listitem><para>The LFN contains any Unicode character that cannot be converted to OEM code. (not the case at Unicode API cfg.) <linebreak/>
 When the directory item has no LFN information, lower case characters can be contained in the fname[]. <linebreak/>
 Sample Code: <programlisting><codeline><highlight class="normal"><sp/>FRESULT<sp/>scan_files<sp/>(</highlight></codeline>
<codeline><highlight class="normal"><sp/>char*<sp/>path<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>Start<sp/>node<sp/>to<sp/>be<sp/>scanned<sp/>(also<sp/>used<sp/>as<sp/>work<sp/>area)<sp/>*/</highlight></codeline>
<codeline><highlight class="normal">)</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>FRESULT<sp/>res;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>FILINFO<sp/>fno;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>DIR<sp/>dir;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>int<sp/>i;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>char<sp/>*fn;<sp/><sp/><sp/>/*<sp/>This<sp/>function<sp/>assumes<sp/>non-Unicode<sp/>configuration<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>#if<sp/>_USE_LFN</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>static<sp/>char<sp/>lfn[_MAX_LFN<sp/>+<sp/>1];<sp/><sp/><sp/>/*<sp/>Buffer<sp/>to<sp/>store<sp/>the<sp/>LFN<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>fno.lfname<sp/>=<sp/>lfn;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>fno.lfsize<sp/>=<sp/>sizeof<sp/>lfn;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>#endif</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>res<sp/>=<sp/>f_opendir(&amp;dir,<sp/>path);<sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>Open<sp/>the<sp/>directory<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>if<sp/>(res<sp/>==<sp/>FR_OK)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/>strlen(path);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>for<sp/>(;;)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>f_readdir(&amp;dir,<sp/>&amp;fno);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>Read<sp/>a<sp/>directory<sp/>item<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(res<sp/>!=<sp/>FR_OK<sp/>||<sp/>fno.fname[0]<sp/>==<sp/>0)<sp/>break;<sp/><sp/>/*<sp/>Break<sp/>on<sp/>error<sp/>or<sp/>end<sp/>of<sp/>dir<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(fno.fname[0]<sp/>==<sp/>&apos;.&apos;)<sp/>continue;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>Ignore<sp/>dot<sp/>entry<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>#if<sp/>_USE_LFN</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fn<sp/>=<sp/>*fno.lfname<sp/>?<sp/>fno.lfname<sp/>:<sp/>fno.fname;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>#else</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fn<sp/>=<sp/>fno.fname;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>#endif</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(fno.fattrib<sp/>&amp;<sp/>AM_DIR)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>It<sp/>is<sp/>a<sp/>directory<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(&amp;path[i],<sp/>&quot;/%s&quot;,<sp/>fn);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>scan_files(path);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path[i]<sp/>=<sp/>0;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(res<sp/>!=<sp/>FR_OK)<sp/>break;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>else<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/*<sp/>It<sp/>is<sp/>a<sp/>file.<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(&quot;%s/%s\n&quot;,<sp/>path,<sp/>fn);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>f_closedir(&amp;dir)</highlight></codeline>
<codeline><highlight class="normal"><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>return<sp/>res;</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting> <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">dp</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the open directory object. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="out">fno</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the file information structure to store the read item. </para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>FR_OK</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_DISK_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INT_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_READY</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_OBJECT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_TIMEOUT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_ENOUGH_CORE</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="note"><para>Available when _FS_MINIMIZE &lt;= 1. </para></simplesect>
</para></listitem></itemizedlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="3275" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="3275" bodyend="3308"/>
        <references refid="ff_8c_1a7cc27142421bd12be623072288599791" compoundref="ff_8c" startline="473">DEFINE_NAMEBUF</references>
        <references refid="ff_8c_1aa7193f5b86c3996b5312043a0c26da5f" compoundref="ff_8c" startline="2372" endline="2385">validate</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" compoundref="ff_8c" startline="1080" endline="1118">dir_sdi</references>
        <references refid="ff_8c_1a966fe5792671b39db1ccf655a8c1af8d" compoundref="ff_8c" startline="474">INIT_BUF</references>
        <references refid="ff_8c_1a3a47a08609e77266bc1928af812e06df" compoundref="ff_8c" startline="1519" endline="1567">dir_read</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" compoundref="ff_8h" startline="189">FR_NO_FILE</references>
        <references refid="struct_d_i_r_1a3e49e0860170e0fd9fc3e891b0d59975" compoundref="ff_8h" startline="149">DIR::sect</references>
        <references refid="ff_8c_1a2bc1b9d8567181c23b4720f4fb6076f5" compoundref="ff_8c" startline="1703" endline="1762">get_fileinfo</references>
        <references refid="ff_8c_1a2edd26ac71869f25be5fce12eec58171" compoundref="ff_8c" startline="1128" endline="1188">dir_next</references>
        <references refid="ff_8c_1aba6d6942b59f11cf285bdbfb7e38f1fa" compoundref="ff_8c" startline="475">FREE_BUF</references>
        <references refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" compoundref="ff_8c" startline="40">LEAVE_FF</references>
        <references refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" compoundref="ff_8h" startline="144">DIR::fs</references>
      </memberdef>
      <memberdef kind="function" id="group__filesystem_1ga2d0ceea336edd9b05754c8684ea8a72f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>FRESULT f_rename</definition>
        <argsstring>(const TCHAR *path_old, const TCHAR *path_new)</argsstring>
        <name>f_rename</name>
        <param>
          <type>const <ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref> *</type>
          <declname>old_name</declname>
          <defname>path_old</defname>
        </param>
        <param>
          <type>const <ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref> *</type>
          <declname>new_name</declname>
          <defname>path_new</defname>
        </param>
        <briefdescription>
<para>Renames a file or sub-directory. </para>        </briefdescription>
        <detaileddescription>
<para>Renames a file or sub-directory and can also move it to other directory within the same logical drive. Do not rename open objects or directry table can be broken. <linebreak/>
 Example: <programlisting><codeline><highlight class="normal">/*<sp/>Rename<sp/>an<sp/>object<sp/>*/</highlight></codeline>
<codeline><highlight class="normal">f_rename(&quot;oldname.txt&quot;,<sp/>&quot;newname.txt&quot;);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">/*<sp/>Rename<sp/>and<sp/>move<sp/>an<sp/>object<sp/>to<sp/>other<sp/>directory<sp/>*/</highlight></codeline>
<codeline><highlight class="normal">f_rename(&quot;oldname.txt&quot;,<sp/>&quot;dir1/newname.txt&quot;);</highlight></codeline>
</programlisting> <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">old_name</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to a null-terminated string that specifies an existing file or sub-directory to be renamed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">new_name</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to a null-terminated string that specifies the new object name. The drive number specified in this string is ignored and one determined by old_name is used instead. </para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>FR_OK</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_DISK_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INT_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_READY</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NO_FILE</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NO_PATH</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_NAME</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_DENIED</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_EXIST</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_EXIST</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_WRITE_PROTECTED</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_DRIVE</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_ENABLED</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NO_FILESYSTEM</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_TIMEOUT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_LOCKED</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_ENOUGH_CORE</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="note"><para>Available when _FS_READONLY == 0 and _FS_MINIMIZE == 0. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="3711" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="3711" bodyend="3780"/>
        <references refid="ff_8c_1a7cc27142421bd12be623072288599791" compoundref="ff_8c" startline="473">DEFINE_NAMEBUF</references>
        <references refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</references>
        <references refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" compoundref="ff_8h" startline="144">DIR::fs</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="ff_8c_1a966fe5792671b39db1ccf655a8c1af8d" compoundref="ff_8c" startline="474">INIT_BUF</references>
        <references refid="ff_8c_1af194524672491a522f041278b9b74e94" compoundref="ff_8c" startline="2052" endline="2104">follow_path</references>
        <references refid="group___f_f_c_o_n_f_i_g_1ga52faf11025401372f71e9d81905b7af4" compoundref="ffconf_8h" startline="146">_FS_RPATH</references>
        <references refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" compoundref="ff_8h" startline="151">DIR::fn</references>
        <references refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" compoundref="ff_8c" startline="351">NSFLAG</references>
        <references refid="ff_8c_1a2db528782a021797b34bdc6e9e9de1c3" compoundref="ff_8c" startline="357">NS_DOT</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" compoundref="ff_8h" startline="191">FR_INVALID_NAME</references>
        <references refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" compoundref="ff_8h" startline="150">DIR::dir</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" compoundref="ff_8h" startline="189">FR_NO_FILE</references>
        <references refid="ff_8c_1a8941d573d16af92c8570950d53164f30" compoundref="ff_8c" startline="507" endline="520">mem_cpy</references>
        <references refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" compoundref="ff_8c" startline="410">DIR_Attr</references>
        <references refid="ff_8c_1a88ad7e4b1bc98d1a2673a136283dc7ee" compoundref="ff_8c" startline="2114" endline="2165">get_ldnumber</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca487844af77de15f6932a3b41ef3a2d65" compoundref="ff_8h" startline="196">FR_INVALID_DRIVE</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca0d8f024d256df76e84782b95018a2450" compoundref="ff_8h" startline="193">FR_EXIST</references>
        <references refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" compoundref="ff_8c" startline="1578" endline="1645">dir_register</references>
        <references refid="ff_8h_1ae8174d00798e34e7c9e95898cb9e1a09" compoundref="ff_8h" startline="322">AM_ARC</references>
        <references refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" compoundref="ff_8h" startline="83">FATFS::wflag</references>
        <references refid="ff_8h_1a3a9db44e978ed6c13b641e092d4cd7d3" compoundref="ff_8h" startline="321">AM_DIR</references>
        <references refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" compoundref="ff_8h" startline="147">DIR::sclust</references>
        <references refid="ff_8c_1a7519abb60fe91f6aa1d17f64fbae123a" compoundref="ff_8c" startline="800" endline="808">clust2sect</references>
        <references refid="ff_8c_1ad1b3343c92d0f0e58ba448c3c11b1f39" compoundref="ff_8c" startline="1235" endline="1247">ld_clust</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" compoundref="ff_8h" startline="187">FR_INT_ERR</references>
        <references refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" compoundref="ff_8c" startline="729" endline="750">move_window</references>
        <references refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" compoundref="ff_8h" startline="107">FATFS::win</references>
        <references refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" compoundref="ff_8c" startline="426">SZ_DIRE</references>
        <references refid="ff_8c_1a357e5a36452e057d68378c98cd61018c" compoundref="ff_8c" startline="1252" endline="1259">st_clust</references>
        <references refid="ff_8c_1a724c260af4783a0ecf0db8d0687e7bd6" compoundref="ff_8c" startline="1656" endline="1692">dir_remove</references>
        <references refid="ff_8c_1aec6b108298553219ebb2b960b528459d" compoundref="ff_8c" startline="760" endline="789">sync_fs</references>
        <references refid="ff_8c_1aba6d6942b59f11cf285bdbfb7e38f1fa" compoundref="ff_8c" startline="475">FREE_BUF</references>
        <references refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" compoundref="ff_8c" startline="40">LEAVE_FF</references>
        <referencedby refid="group___f_o_t_a_1ga02aaeb14e249d60489d2f887a46f26bc" compoundref="_f_o_t_a_8c" startline="322" endline="368">FOTA_ValidateSdcardFw</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__filesystem_1gabe1f60daab5c7d11170c334fb832c798" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>FRESULT f_stat</definition>
        <argsstring>(const TCHAR *path, FILINFO *fno)</argsstring>
        <name>f_stat</name>
        <param>
          <type>const <ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref> *</type>
          <declname>path</declname>
        </param>
        <param>
          <type><ref refid="struct_f_i_l_i_n_f_o" kindref="compound">FILINFO</ref> *</type>
          <declname>fno</declname>
        </param>
        <briefdescription>
<para>The f_stat function checks the existence of a file or sub-directory. </para>        </briefdescription>
        <detaileddescription>
<para>The <ref refid="group__filesystem_1gabe1f60daab5c7d11170c334fb832c798" kindref="member">f_stat()</ref> function checks the existence of a file or sub-directory. If not exist, the function returns with FR_NO_FILE. If exist, the function returns with FR_OK and the informations of the object, file size, timestamp, attribute and SFN, are stored to the file information structure. For details of the file information, refer to the <ref refid="struct_f_i_l_i_n_f_o" kindref="compound">FILINFO</ref> structure and <ref refid="group__filesystem_1gab39e82a110695de45f416f3149358012" kindref="member">f_readdir()</ref> function. <linebreak/>
 When LFN feature is enabled, lfname in the file information structure must be NULLed prior to use it. <linebreak/>
 Examples: <programlisting><codeline><highlight class="normal">FRESULT<sp/>fr;</highlight></codeline>
<codeline><highlight class="normal">FILINFO<sp/>fno;</highlight></codeline>
<codeline><highlight class="normal">printf(&quot;Test<sp/>for<sp/>&apos;file.txt&apos;...\n&quot;);</highlight></codeline>
<codeline><highlight class="normal">#if<sp/>_USE_LFN</highlight></codeline>
<codeline><highlight class="normal">fno.lfname<sp/>=<sp/>0;</highlight></codeline>
<codeline><highlight class="normal">#endif</highlight></codeline>
<codeline><highlight class="normal">fr<sp/>=<sp/>f_stat(&quot;file.txt&quot;,<sp/>&amp;fno);</highlight></codeline>
<codeline><highlight class="normal">switch<sp/>(fr)<sp/>{</highlight></codeline>
<codeline><highlight class="normal">case<sp/>FR_OK:</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>printf(&quot;Size:<sp/>%u\n&quot;,<sp/>fno.fsize);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>printf(&quot;Timestamp:<sp/>%u/%02u/%02u,<sp/>%02u:%02u\n&quot;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(fno.fdate<sp/>&gt;&gt;<sp/>9)<sp/>+<sp/>1980,<sp/>fno.fdate<sp/>&gt;&gt;<sp/>5<sp/>&amp;<sp/>15,<sp/>fno.fdate<sp/>&amp;<sp/>31,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fno.ftime<sp/>&gt;&gt;<sp/>11,<sp/>fno.ftime<sp/>&gt;&gt;<sp/>5<sp/>&amp;<sp/>63);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>printf(&quot;Attributes:<sp/>%c%c%c%c%c\n&quot;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(fno.fattrib<sp/>&amp;<sp/>AM_DIR)<sp/>?<sp/>&apos;D&apos;<sp/>:<sp/>&apos;-&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(fno.fattrib<sp/>&amp;<sp/>AM_RDO)<sp/>?<sp/>&apos;R&apos;<sp/>:<sp/>&apos;-&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(fno.fattrib<sp/>&amp;<sp/>AM_HID)<sp/>?<sp/>&apos;H&apos;<sp/>:<sp/>&apos;-&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(fno.fattrib<sp/>&amp;<sp/>AM_SYS)<sp/>?<sp/>&apos;S&apos;<sp/>:<sp/>&apos;-&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(fno.fattrib<sp/>&amp;<sp/>AM_ARC)<sp/>?<sp/>&apos;A&apos;<sp/>:<sp/>&apos;-&apos;);</highlight></codeline>
<codeline><highlight class="normal"><sp/>break;</highlight></codeline>
<codeline><highlight class="normal"><sp/>case<sp/>FR_NO_FILE:</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>printf(&quot;It<sp/>is<sp/>not<sp/>exist.\n&quot;);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>break;</highlight></codeline>
<codeline><highlight class="normal"><sp/>default:</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>printf(&quot;An<sp/>error<sp/>occured.<sp/>(%d)\n&quot;,<sp/>fr);</highlight></codeline>
<codeline><highlight class="normal"><sp/>}</highlight></codeline>
</programlisting> <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">path</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the null-terminated string that specifies the object to get its information. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="out">fno</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the blank <ref refid="struct_f_i_l_i_n_f_o" kindref="compound">FILINFO</ref> structure to store the information of the object. Set null pointer if it is not needed. </para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>FR_OK</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_DISK_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INT_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_READY</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NO_FILE</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NO_PATH</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_NAME</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_DRIVE</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_ENABLED</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NO_FILESYSTEM</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_TIMEOUT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_ENOUGH_CORE</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="note"><para>Available when _FS_MINIMIZE == 0. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="3369" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="3369" bodyend="3395"/>
        <references refid="ff_8c_1a7cc27142421bd12be623072288599791" compoundref="ff_8c" startline="473">DEFINE_NAMEBUF</references>
        <references refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</references>
        <references refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" compoundref="ff_8h" startline="144">DIR::fs</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="ff_8c_1a966fe5792671b39db1ccf655a8c1af8d" compoundref="ff_8c" startline="474">INIT_BUF</references>
        <references refid="ff_8c_1af194524672491a522f041278b9b74e94" compoundref="ff_8c" startline="2052" endline="2104">follow_path</references>
        <references refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" compoundref="ff_8h" startline="150">DIR::dir</references>
        <references refid="ff_8c_1a2bc1b9d8567181c23b4720f4fb6076f5" compoundref="ff_8c" startline="1703" endline="1762">get_fileinfo</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" compoundref="ff_8h" startline="191">FR_INVALID_NAME</references>
        <references refid="ff_8c_1aba6d6942b59f11cf285bdbfb7e38f1fa" compoundref="ff_8c" startline="475">FREE_BUF</references>
        <references refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" compoundref="ff_8c" startline="40">LEAVE_FF</references>
        <referencedby refid="group___f_o_t_a_1gaa17c22be08c000fec0331fab53040c26" compoundref="_f_o_t_a_8c" startline="371" endline="413">FOTA_UpdateSdcardFw</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__filesystem_1gad69c7246b122ba56a134939ee0eaf847" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>FRESULT f_sync</definition>
        <argsstring>(FIL *fp)</argsstring>
        <name>f_sync</name>
        <param>
          <type><ref refid="struct_f_i_l" kindref="compound">FIL</ref> *</type>
          <declname>fp</declname>
        </param>
        <briefdescription>
<para>The f_sync function flushes the cached information of a writing file. </para>        </briefdescription>
        <detaileddescription>
<para>The <ref refid="group__filesystem_1gad69c7246b122ba56a134939ee0eaf847" kindref="member">f_sync()</ref> function performs the same process as <ref refid="group__filesystem_1ga53882db20ef4323dcfd1874d7733ffc3" kindref="member">f_close()</ref> function but the file is left opened and can continue read/write/seek operations to the file. This is suitable for the applications that open files for a long time in write mode, such as data logger. Performing <ref refid="group__filesystem_1gad69c7246b122ba56a134939ee0eaf847" kindref="member">f_sync()</ref> function of periodic or immediataly after <ref refid="group__filesystem_1gae6a4dfae8a9e308bdb2283a37ef680f2" kindref="member">f_write()</ref> function can minimize the risk of data loss due to a sudden blackout or an unintentional media removal. <linebreak/>
 However there is no sense in <ref refid="group__filesystem_1gad69c7246b122ba56a134939ee0eaf847" kindref="member">f_sync()</ref> function immediataly before <ref refid="group__filesystem_1ga53882db20ef4323dcfd1874d7733ffc3" kindref="member">f_close()</ref> function because it performs <ref refid="group__filesystem_1gad69c7246b122ba56a134939ee0eaf847" kindref="member">f_sync()</ref> function in it. In other words, the differnce between those functions is that the file object is invalidated or not. <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">fp</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the open file object to be flushed. </para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>FR_OK</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_DISK_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INT_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_READY</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_OBJECT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_TIMEOUT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="note"><para>Available when _FS_READONLY == 0. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="2809" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="2809" bodyend="2846"/>
        <references refid="ff_8c_1aa7193f5b86c3996b5312043a0c26da5f" compoundref="ff_8c" startline="2372" endline="2385">validate</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" compoundref="ff_8h" startline="117">FIL::flag</references>
        <references refid="ff_8h_1ac4b7d5223f84df91c306ffbff536fae4" compoundref="ff_8h" startline="302">FA__WRITTEN</references>
        <references refid="ff_8h_1a5b2962e3616a1e9eb709d95f4c75c67c" compoundref="ff_8h" startline="303">FA__DIRTY</references>
        <references refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" compoundref="_b_c_d_s___s_d_card___interface_8h" startline="63">disk_write</references>
        <references refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" compoundref="ff_8h" startline="115">FIL::fs</references>
        <references refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" compoundref="ff_8h" startline="80">FATFS::drv</references>
        <references refid="struct_f_i_l_1a1602edc1ba9d9ae2b583cf55f3492325" compoundref="ff_8h" startline="135">FIL::buf</references>
        <references refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" compoundref="ff_8h" startline="123">FIL::dsect</references>
        <references refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" compoundref="diskio_8h" startline="23">RES_OK</references>
        <references refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" compoundref="ff_8c" startline="40">LEAVE_FF</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" compoundref="ff_8h" startline="186">FR_DISK_ERR</references>
        <references refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" compoundref="ff_8c" startline="729" endline="750">move_window</references>
        <references refid="struct_f_i_l_1a5e11faf537370889c867127205f26ad1" compoundref="ff_8h" startline="125">FIL::dir_sect</references>
        <references refid="struct_f_i_l_1a0071755a7d2cacd3bafbb1bf2dab98a0" compoundref="ff_8h" startline="126">FIL::dir_ptr</references>
        <references refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" compoundref="ff_8c" startline="410">DIR_Attr</references>
        <references refid="ff_8h_1ae8174d00798e34e7c9e95898cb9e1a09" compoundref="ff_8h" startline="322">AM_ARC</references>
        <references refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" compoundref="ff_8h" startline="338">ST_DWORD</references>
        <references refid="ff_8c_1abfbfa613864a02a65f0bf70ead6672c7" compoundref="ff_8c" startline="420">DIR_FileSize</references>
        <references refid="struct_f_i_l_1af70a0afd16367837984d6205cbfca308" compoundref="ff_8h" startline="120">FIL::fsize</references>
        <references refid="ff_8c_1a357e5a36452e057d68378c98cd61018c" compoundref="ff_8c" startline="1252" endline="1259">st_clust</references>
        <references refid="struct_f_i_l_1ad5d52f3fde971d2a05ff777a6243c252" compoundref="ff_8h" startline="121">FIL::sclust</references>
        <references refid="ff_8c_1a72589f5bbb514c0b222ab8b292764418" compoundref="ff_8c" startline="67">GET_FATTIME</references>
        <references refid="ff_8c_1ab9452d336adeece2a1b0b54ab35b8a59" compoundref="ff_8c" startline="417">DIR_WrtTime</references>
        <references refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" compoundref="ff_8h" startline="337">ST_WORD</references>
        <references refid="ff_8c_1afa0625d73f4683df24345f51e7a43da3" compoundref="ff_8c" startline="415">DIR_LstAccDate</references>
        <references refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" compoundref="ff_8h" startline="83">FATFS::wflag</references>
        <references refid="ff_8c_1aec6b108298553219ebb2b960b528459d" compoundref="ff_8c" startline="760" endline="789">sync_fs</references>
        <referencedby refid="group__filesystem_1ga53882db20ef4323dcfd1874d7733ffc3" compoundref="ff_8c" startline="2857" endline="2885">f_close</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__filesystem_1ga691a27b40c348f7c84b42e911636f38a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>FRESULT f_truncate</definition>
        <argsstring>(FIL *fp)</argsstring>
        <name>f_truncate</name>
        <param>
          <type><ref refid="struct_f_i_l" kindref="compound">FIL</ref> *</type>
          <declname>fp</declname>
        </param>
        <briefdescription>
<para>The f_truncate function truncates the file size. </para>        </briefdescription>
        <detaileddescription>
<para>The <ref refid="group__filesystem_1ga691a27b40c348f7c84b42e911636f38a" kindref="member">f_truncate()</ref> function truncates the file size to the current file read/write pointer. This function has no effect if the file read/write pointer is already pointing end of the file. <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">fp</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the open file object to be truncated. </para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>FR_OK</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_DISK_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INT_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_READY</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_OBJECT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_TIMEOUT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="note"><para>Available when _FS_READONLY == 0 and _FS_MINIMIZE == 0. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="3470" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="3470" bodyend="3517"/>
        <references refid="ff_8c_1aa7193f5b86c3996b5312043a0c26da5f" compoundref="ff_8c" startline="2372" endline="2385">validate</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="struct_f_i_l_1a32b2a186af2cab58af8114c05386b9f6" compoundref="ff_8h" startline="118">FIL::err</references>
        <references refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" compoundref="ff_8h" startline="117">FIL::flag</references>
        <references refid="ff_8h_1afa366963220c89b882c0361794020c14" compoundref="ff_8h" startline="298">FA_WRITE</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d" compoundref="ff_8h" startline="192">FR_DENIED</references>
        <references refid="struct_f_i_l_1af70a0afd16367837984d6205cbfca308" compoundref="ff_8h" startline="120">FIL::fsize</references>
        <references refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" compoundref="ff_8h" startline="119">FIL::fptr</references>
        <references refid="ff_8h_1ac4b7d5223f84df91c306ffbff536fae4" compoundref="ff_8h" startline="302">FA__WRITTEN</references>
        <references refid="ff_8c_1ab88651d19a5597dec220fe7538cccf23" compoundref="ff_8c" startline="937" endline="979">remove_chain</references>
        <references refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" compoundref="ff_8h" startline="115">FIL::fs</references>
        <references refid="struct_f_i_l_1ad5d52f3fde971d2a05ff777a6243c252" compoundref="ff_8h" startline="121">FIL::sclust</references>
        <references refid="ff_8c_1a65611adf1626e5e08da77cd33a98dd8b" compoundref="ff_8c" startline="818" endline="862">get_fat</references>
        <references refid="struct_f_i_l_1ac134c1b4645be670eb5207032e714616" compoundref="ff_8h" startline="122">FIL::clust</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" compoundref="ff_8h" startline="186">FR_DISK_ERR</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" compoundref="ff_8h" startline="187">FR_INT_ERR</references>
        <references refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" compoundref="ff_8h" startline="100">FATFS::n_fatent</references>
        <references refid="ff_8c_1abd4b6b071a8d728a88727051c12bc6d7" compoundref="ff_8c" startline="873" endline="926">put_fat</references>
        <references refid="ff_8h_1a5b2962e3616a1e9eb709d95f4c75c67c" compoundref="ff_8h" startline="303">FA__DIRTY</references>
        <references refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" compoundref="_b_c_d_s___s_d_card___interface_8h" startline="63">disk_write</references>
        <references refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" compoundref="ff_8h" startline="80">FATFS::drv</references>
        <references refid="struct_f_i_l_1a1602edc1ba9d9ae2b583cf55f3492325" compoundref="ff_8h" startline="135">FIL::buf</references>
        <references refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" compoundref="ff_8h" startline="123">FIL::dsect</references>
        <references refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" compoundref="diskio_8h" startline="23">RES_OK</references>
        <references refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" compoundref="ff_8c" startline="40">LEAVE_FF</references>
      </memberdef>
      <memberdef kind="function" id="group__filesystem_1ga2858167fcd0bced48e9be434b3895efe" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>FRESULT f_unlink</definition>
        <argsstring>(const TCHAR *path)</argsstring>
        <name>f_unlink</name>
        <param>
          <type>const <ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref> *</type>
          <declname>path</declname>
        </param>
        <briefdescription>
<para>The f_unlink function removes a file or sub-directory. </para>        </briefdescription>
        <detaileddescription>
<para>If condition of the object to be removed is applicable to the following terms, the function will be rejected. <linebreak/>
<itemizedlist>
<listitem><para>The file/sub-directory must not have read-only attribute (AM_RDO), or the function will be rejected with FR_DENIED.</para></listitem><listitem><para>The sub-directory must be empty and must not be current directory, or the function will be rejected with FR_DENIED.</para></listitem><listitem><para>The file/sub-directory must not be opened, or the FAT volume can be collapsed. It can be rejected with FR_LOCKED when file lock feature is enabled. <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">path</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the null-terminated string that specifies an object to be removed. </para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>FR_OK</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_DISK_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INT_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_READY</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NO_FILE</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NO_PATH</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_NAME</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_DENIED</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_EXIST</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_WRITE_PROTECTED</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_DRIVE</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_ENABLED</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NO_FILESYSTEM</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_TIMEOUT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_LOCKED</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_ENOUGH_CORE</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="note"><para>Available when _FS_READONLY == 0 and _FS_MINIMIZE == 0. </para></simplesect>
</para></listitem></itemizedlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="3526" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="3526" bodyend="3586"/>
        <references refid="ff_8c_1a7cc27142421bd12be623072288599791" compoundref="ff_8c" startline="473">DEFINE_NAMEBUF</references>
        <references refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</references>
        <references refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" compoundref="ff_8h" startline="144">DIR::fs</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="ff_8c_1a966fe5792671b39db1ccf655a8c1af8d" compoundref="ff_8c" startline="474">INIT_BUF</references>
        <references refid="ff_8c_1af194524672491a522f041278b9b74e94" compoundref="ff_8c" startline="2052" endline="2104">follow_path</references>
        <references refid="group___f_f_c_o_n_f_i_g_1ga52faf11025401372f71e9d81905b7af4" compoundref="ffconf_8h" startline="146">_FS_RPATH</references>
        <references refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" compoundref="ff_8h" startline="151">DIR::fn</references>
        <references refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" compoundref="ff_8c" startline="351">NSFLAG</references>
        <references refid="ff_8c_1a2db528782a021797b34bdc6e9e9de1c3" compoundref="ff_8c" startline="357">NS_DOT</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" compoundref="ff_8h" startline="191">FR_INVALID_NAME</references>
        <references refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" compoundref="ff_8h" startline="150">DIR::dir</references>
        <references refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" compoundref="ff_8c" startline="410">DIR_Attr</references>
        <references refid="ff_8h_1add6d85d1e7a02b4f6188783ef91a5f1e" compoundref="ff_8h" startline="316">AM_RDO</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d" compoundref="ff_8h" startline="192">FR_DENIED</references>
        <references refid="ff_8c_1ad1b3343c92d0f0e58ba448c3c11b1f39" compoundref="ff_8c" startline="1235" endline="1247">ld_clust</references>
        <references refid="ff_8h_1a3a9db44e978ed6c13b641e092d4cd7d3" compoundref="ff_8h" startline="321">AM_DIR</references>
        <references refid="ff_8c_1a8941d573d16af92c8570950d53164f30" compoundref="ff_8c" startline="507" endline="520">mem_cpy</references>
        <references refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" compoundref="ff_8h" startline="147">DIR::sclust</references>
        <references refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" compoundref="ff_8c" startline="1080" endline="1118">dir_sdi</references>
        <references refid="ff_8c_1a3a47a08609e77266bc1928af812e06df" compoundref="ff_8c" startline="1519" endline="1567">dir_read</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" compoundref="ff_8h" startline="189">FR_NO_FILE</references>
        <references refid="ff_8c_1a724c260af4783a0ecf0db8d0687e7bd6" compoundref="ff_8c" startline="1656" endline="1692">dir_remove</references>
        <references refid="ff_8c_1ab88651d19a5597dec220fe7538cccf23" compoundref="ff_8c" startline="937" endline="979">remove_chain</references>
        <references refid="ff_8c_1aec6b108298553219ebb2b960b528459d" compoundref="ff_8c" startline="760" endline="789">sync_fs</references>
        <references refid="ff_8c_1aba6d6942b59f11cf285bdbfb7e38f1fa" compoundref="ff_8c" startline="475">FREE_BUF</references>
        <references refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" compoundref="ff_8c" startline="40">LEAVE_FF</references>
        <referencedby refid="group___f_o_t_a_1ga02aaeb14e249d60489d2f887a46f26bc" compoundref="_f_o_t_a_8c" startline="322" endline="368">FOTA_ValidateSdcardFw</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__filesystem_1gaafaa718d1a487e12a8f0087173dba0b9" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>FRESULT f_utime</definition>
        <argsstring>(const TCHAR *path, const FILINFO *fno)</argsstring>
        <name>f_utime</name>
        <param>
          <type>const <ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref> *</type>
          <declname>path</declname>
        </param>
        <param>
          <type>const <ref refid="struct_f_i_l_i_n_f_o" kindref="compound">FILINFO</ref> *</type>
          <declname>fno</declname>
        </param>
        <briefdescription>
<para>The f_utime function changes the timestamp of a file or sub-directory. </para>        </briefdescription>
        <detaileddescription>
<para>The <ref refid="group__filesystem_1gaafaa718d1a487e12a8f0087173dba0b9" kindref="member">f_utime()</ref> function changes the timestamp of a file or sub-directory <linebreak/>
 Example: <programlisting><codeline><highlight class="normal">FRESULT<sp/>set_timestamp<sp/>(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>char<sp/>*obj,<sp/><sp/><sp/><sp/><sp/>/*<sp/>Pointer<sp/>to<sp/>the<sp/>file<sp/>name<sp/>*/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>int<sp/>year,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>int<sp/>month,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>int<sp/>mday,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>int<sp/>hour,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>int<sp/>min,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>int<sp/>sec</highlight></codeline>
<codeline><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>FILINFO<sp/>fno;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>fno.fdate<sp/>=<sp/>(WORD)(((year<sp/>-<sp/>1980)<sp/>*<sp/>512U)<sp/>|<sp/>month<sp/>*<sp/>32U<sp/>|<sp/>mday);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>fno.ftime<sp/>=<sp/>(WORD)(hour<sp/>*<sp/>2048U<sp/>|<sp/>min<sp/>*<sp/>32U<sp/>|<sp/>sec<sp/>/<sp/>2U);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/>return<sp/>f_utime(obj,<sp/>&amp;fno);</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting> <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">path</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the null-terminated string that specifies an object to be changed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">fno</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the file information structure that has a timestamp to be set in member fdate and ftime. Do not care any other members. </para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>FR_OK</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_DISK_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INT_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_READY</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NO_FILE</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NO_PATH</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_NAME</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_WRITE_PROTECTED</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_DRIVE</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_ENABLED</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NO_FILESYSTEM</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_TIMEOUT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_ENOUGH_CORE</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="note"><para>Available when _FS_READONLY == 0 and _FS_MINIMIZE == 0. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="3789" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="3789" bodyend="3822"/>
        <references refid="ff_8c_1a7cc27142421bd12be623072288599791" compoundref="ff_8c" startline="473">DEFINE_NAMEBUF</references>
        <references refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</references>
        <references refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" compoundref="ff_8h" startline="144">DIR::fs</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="ff_8c_1a966fe5792671b39db1ccf655a8c1af8d" compoundref="ff_8c" startline="474">INIT_BUF</references>
        <references refid="ff_8c_1af194524672491a522f041278b9b74e94" compoundref="ff_8c" startline="2052" endline="2104">follow_path</references>
        <references refid="ff_8c_1aba6d6942b59f11cf285bdbfb7e38f1fa" compoundref="ff_8c" startline="475">FREE_BUF</references>
        <references refid="group___f_f_c_o_n_f_i_g_1ga52faf11025401372f71e9d81905b7af4" compoundref="ffconf_8h" startline="146">_FS_RPATH</references>
        <references refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" compoundref="ff_8h" startline="151">DIR::fn</references>
        <references refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" compoundref="ff_8c" startline="351">NSFLAG</references>
        <references refid="ff_8c_1a2db528782a021797b34bdc6e9e9de1c3" compoundref="ff_8c" startline="357">NS_DOT</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" compoundref="ff_8h" startline="191">FR_INVALID_NAME</references>
        <references refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" compoundref="ff_8h" startline="150">DIR::dir</references>
        <references refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" compoundref="ff_8h" startline="337">ST_WORD</references>
        <references refid="ff_8c_1ab9452d336adeece2a1b0b54ab35b8a59" compoundref="ff_8c" startline="417">DIR_WrtTime</references>
        <references refid="struct_f_i_l_i_n_f_o_1adb685b4c58c087d1cd790afb710001cb" compoundref="ff_8h" startline="171">FILINFO::ftime</references>
        <references refid="ff_8c_1abed17fa699511b09cbf64961373d63a4" compoundref="ff_8c" startline="418">DIR_WrtDate</references>
        <references refid="struct_f_i_l_i_n_f_o_1af49edeb97b10af8854cc15a05947a7d4" compoundref="ff_8h" startline="170">FILINFO::fdate</references>
        <references refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" compoundref="ff_8h" startline="83">FATFS::wflag</references>
        <references refid="ff_8c_1aec6b108298553219ebb2b960b528459d" compoundref="ff_8c" startline="760" endline="789">sync_fs</references>
        <references refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" compoundref="ff_8c" startline="40">LEAVE_FF</references>
      </memberdef>
      <memberdef kind="function" id="group__filesystem_1gae6a4dfae8a9e308bdb2283a37ef680f2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>FRESULT f_write</definition>
        <argsstring>(FIL *fp, const void *buff, UINT btw, UINT *bw)</argsstring>
        <name>f_write</name>
        <param>
          <type><ref refid="struct_f_i_l" kindref="compound">FIL</ref> *</type>
          <declname>fp</declname>
        </param>
        <param>
          <type>const void *</type>
          <declname>buff</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref></type>
          <declname>btw</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref> *</type>
          <declname>bw</declname>
        </param>
        <briefdescription>
<para>The f_write writes data to a file. </para>        </briefdescription>
        <detaileddescription>
<para>The read/write pointer of the file object advances number of bytes written. After the function succeeded, *bw should be checked to detect the disk full. In case of *bw is less than btw, it means the volume got full during the write operation. The function can take a time when the volume is full or close to full. <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">fp</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the open file object. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">buff</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the data to be written. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">btw</parametername>
</parameternamelist>
<parameterdescription>
<para>Specifies number of bytes to write in range of UINT type. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="out">bw</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the UINT variable to return the number of bytes written. The value is always valid after the function call regardless of the result. </para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>FR_OK</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_DISK_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INT_ERR</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_NOT_READY</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_INVALID_OBJECT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>FR_TIMEOUT</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="note"><para>Available when _FS_READONLY == 0. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="2687" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="2687" bodyend="2800"/>
        <references refid="ff_8c_1aa7193f5b86c3996b5312043a0c26da5f" compoundref="ff_8c" startline="2372" endline="2385">validate</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" compoundref="ff_8c" startline="40">LEAVE_FF</references>
        <references refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" compoundref="ff_8h" startline="115">FIL::fs</references>
        <references refid="struct_f_i_l_1a32b2a186af2cab58af8114c05386b9f6" compoundref="ff_8h" startline="118">FIL::err</references>
        <references refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" compoundref="ff_8h" startline="117">FIL::flag</references>
        <references refid="ff_8h_1afa366963220c89b882c0361794020c14" compoundref="ff_8h" startline="298">FA_WRITE</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d" compoundref="ff_8h" startline="192">FR_DENIED</references>
        <references refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" compoundref="ff_8h" startline="119">FIL::fptr</references>
        <references refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" compoundref="ff_8c" startline="54">SS</references>
        <references refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" compoundref="ff_8h" startline="81">FATFS::csize</references>
        <references refid="struct_f_i_l_1ad5d52f3fde971d2a05ff777a6243c252" compoundref="ff_8h" startline="121">FIL::sclust</references>
        <references refid="ff_8c_1acbd0a20a17c6f9b6d536490d1cc3c5ac" compoundref="ff_8c" startline="990" endline="1040">create_chain</references>
        <references refid="struct_f_i_l_1ac134c1b4645be670eb5207032e714616" compoundref="ff_8h" startline="122">FIL::clust</references>
        <references refid="ff_8c_1a41e4c46636679236568cf50b5535847f" compoundref="ff_8c" startline="46">ABORT</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" compoundref="ff_8h" startline="187">FR_INT_ERR</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" compoundref="ff_8h" startline="186">FR_DISK_ERR</references>
        <references refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" compoundref="ff_8h" startline="106">FATFS::winsect</references>
        <references refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" compoundref="ff_8h" startline="123">FIL::dsect</references>
        <references refid="ff_8c_1a5e18753404354b210096f9af99e31bc1" compoundref="ff_8c" startline="700" endline="724">sync_window</references>
        <references refid="ff_8h_1a5b2962e3616a1e9eb709d95f4c75c67c" compoundref="ff_8h" startline="303">FA__DIRTY</references>
        <references refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" compoundref="_b_c_d_s___s_d_card___interface_8h" startline="63">disk_write</references>
        <references refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" compoundref="ff_8h" startline="80">FATFS::drv</references>
        <references refid="struct_f_i_l_1a1602edc1ba9d9ae2b583cf55f3492325" compoundref="ff_8h" startline="135">FIL::buf</references>
        <references refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" compoundref="diskio_8h" startline="23">RES_OK</references>
        <references refid="ff_8c_1a7519abb60fe91f6aa1d17f64fbae123a" compoundref="ff_8c" startline="800" endline="808">clust2sect</references>
        <references refid="ff_8c_1a8941d573d16af92c8570950d53164f30" compoundref="ff_8c" startline="507" endline="520">mem_cpy</references>
        <references refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" compoundref="ff_8h" startline="107">FATFS::win</references>
        <references refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" compoundref="ff_8h" startline="83">FATFS::wflag</references>
        <references refid="struct_f_i_l_1af70a0afd16367837984d6205cbfca308" compoundref="ff_8h" startline="120">FIL::fsize</references>
        <references refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1gae55155170bc9b99f73b440b93cc1c9e2" compoundref="_b_c_d_s___s_d_card___interface_8h" startline="62">disk_read</references>
        <references refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" compoundref="ff_8c" startline="729" endline="750">move_window</references>
        <references refid="ff_8h_1ac4b7d5223f84df91c306ffbff536fae4" compoundref="ff_8h" startline="302">FA__WRITTEN</references>
        <referencedby refid="ff_8c_1a19f72a515ee94dd8a9660d513172ce9b" compoundref="ff_8c" startline="4469" endline="4520">putc_bfd</referencedby>
        <referencedby refid="group__filesystem_1ga62a35ee79e4913c1e31ac706241be7da" compoundref="ff_8c" startline="4524" endline="4542">f_putc</referencedby>
        <referencedby refid="group__filesystem_1ga9443c00129414fbfc16a5a13ad876ced" compoundref="ff_8c" startline="4551" endline="4570">f_puts</referencedby>
        <referencedby refid="group__filesystem_1ga49cccab38cd84e2d3357fef2d1df21f9" compoundref="ff_8c" startline="4579" endline="4674">f_printf</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>static FRESULT find_volume</definition>
        <argsstring>(FATFS **rfs, const TCHAR **path, BYTE wmode)</argsstring>
        <name>find_volume</name>
        <param>
          <type><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref> **</type>
          <declname>rfs</declname>
        </param>
        <param>
          <type>const <ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref> **</type>
          <declname>path</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref></type>
          <declname>wmode</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="2203" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="2203" bodyend="2362"/>
        <references refid="ff_8c_1a88ad7e4b1bc98d1a2673a136283dc7ee" compoundref="ff_8c" startline="2114" endline="2165">get_ldnumber</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca487844af77de15f6932a3b41ef3a2d65" compoundref="ff_8h" startline="196">FR_INVALID_DRIVE</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cafc56605c68aaffab4a428339a8bd600d" compoundref="ff_8h" startline="197">FR_NOT_ENABLED</references>
        <references refid="ff_8c_1a458e336ac53f8249ed02d844469b7076" compoundref="ff_8c" startline="39">ENTER_FF</references>
        <references refid="struct_f_a_t_f_s_1a3630ef0b29c45ef8e0c1de639efab754" compoundref="ff_8h" startline="79">FATFS::fs_type</references>
        <references refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga0b8d23a060415e85133803b8fcc6f42a" compoundref="_b_c_d_s___s_d_card___interface_8h" startline="60">disk_status</references>
        <references refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" compoundref="ff_8h" startline="80">FATFS::drv</references>
        <references refid="diskio_8h_1abd6503c70d862b979a3f7080a59e9acd" compoundref="diskio_8h" startline="44">STA_NOINIT</references>
        <references refid="group___f_f_c_o_n_f_i_g_1gafb8d35370cfe0c23832ac2d82e854ec6" compoundref="ffconf_8h" startline="30">_FS_READONLY</references>
        <references refid="diskio_8h_1a9ec6dc5f6620a33fabe388d3a111ca8c" compoundref="diskio_8h" startline="46">STA_PROTECT</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cac3afbb423b1d4497229416812aff383b" compoundref="ff_8h" startline="195">FR_WRITE_PROTECTED</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="ff_8h_1a6577ed2f95527745bf4d27c53488b9a7" compoundref="ff_8h" startline="46">LD2PD</references>
        <references refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga45e4ba27a706ed2421edd501406a6496" compoundref="_b_c_d_s___s_d_card___interface_8h" startline="61">disk_initialize</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cac9894bed3e8632ede8d2712235fa8e45" compoundref="ff_8h" startline="188">FR_NOT_READY</references>
        <references refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga3051f51f1cccb103d145804d5d91b04d" compoundref="_b_c_d_s___s_d_card___interface_8h" startline="64">disk_ioctl</references>
        <references refid="diskio_8h_1ac73b5cf2135cbd459d109b96c9aa346a" compoundref="diskio_8h" startline="54">GET_SECTOR_SIZE</references>
        <references refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" compoundref="ff_8c" startline="54">SS</references>
        <references refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" compoundref="diskio_8h" startline="23">RES_OK</references>
        <references refid="group___f_f_c_o_n_f_i_g_1gad03aa6d0e294709ae15898ee2c14dc3a" compoundref="ffconf_8h" startline="181">_MIN_SS</references>
        <references refid="group___f_f_c_o_n_f_i_g_1gac271b697378912f17132cb9c7d0de024" compoundref="ffconf_8h" startline="182">_MAX_SS</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" compoundref="ff_8h" startline="186">FR_DISK_ERR</references>
        <references refid="ff_8c_1a55626c76a1556af5dc5345e2c0841a65" compoundref="ff_8c" startline="2175" endline="2193">check_fs</references>
        <references refid="ff_8h_1aadc4a9aefaf2588bdd7565549f5d91e7" compoundref="ff_8h" startline="47">LD2PT</references>
        <references refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" compoundref="ff_8h" startline="107">FATFS::win</references>
        <references refid="ff_8c_1ac3f187bf0ba891551f594af6b61f3188" compoundref="ff_8c" startline="405">MBR_Table</references>
        <references refid="ff_8c_1af133060c47366e7e557d4085d931183f" compoundref="ff_8c" startline="406">SZ_PTE</references>
        <references refid="ff_8h_1a4690304ddc975516f7dc02575c96e34e" compoundref="ff_8h" startline="336">LD_DWORD</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca086154b5fee763f28c49fd0e2c1cb463" compoundref="ff_8h" startline="198">FR_NO_FILESYSTEM</references>
        <references refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" compoundref="ff_8h" startline="335">LD_WORD</references>
        <references refid="ff_8c_1a8551844b4eb4e15aecd8cc9aa3585fa2" compoundref="ff_8c" startline="371">BPB_BytsPerSec</references>
        <references refid="ff_8c_1a60a2f6efeb6a4c7cb2da1e5def6ca43b" compoundref="ff_8c" startline="378">BPB_FATSz16</references>
        <references refid="ff_8c_1a6e6340030dc29e7da2e9f92e472a763d" compoundref="ff_8c" startline="389">BPB_FATSz32</references>
        <references refid="struct_f_a_t_f_s_1af70a0afd16367837984d6205cbfca308" compoundref="ff_8h" startline="101">FATFS::fsize</references>
        <references refid="struct_f_a_t_f_s_1af18fdbb9dec86b70abc6ee2a1217ac47" compoundref="ff_8h" startline="82">FATFS::n_fats</references>
        <references refid="ff_8c_1af44a1e8c89ec5502595f23496d24cbf1" compoundref="ff_8c" startline="374">BPB_NumFATs</references>
        <references refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" compoundref="ff_8h" startline="81">FATFS::csize</references>
        <references refid="ff_8c_1aab78e41c617a14b9540c0563d6b957fa" compoundref="ff_8c" startline="372">BPB_SecPerClus</references>
        <references refid="struct_f_a_t_f_s_1a22e74fc44cd5274ba7c3b18d5e357697" compoundref="ff_8h" startline="86">FATFS::n_rootdir</references>
        <references refid="ff_8c_1aaa667f14c87c45dc128f2ab208e92f98" compoundref="ff_8c" startline="375">BPB_RootEntCnt</references>
        <references refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" compoundref="ff_8c" startline="426">SZ_DIRE</references>
        <references refid="ff_8c_1a4eb540eecde0f2df26fa8c7969341d68" compoundref="ff_8c" startline="376">BPB_TotSec16</references>
        <references refid="ff_8c_1a7723a9f0da553e8879d60909d85ccb7b" compoundref="ff_8c" startline="382">BPB_TotSec32</references>
        <references refid="ff_8c_1ab3ec444c8457c9bc98aa07e846f5c1b7" compoundref="ff_8c" startline="373">BPB_RsvdSecCnt</references>
        <references refid="ff_8h_1aab755aa1b4f81f4aabee4a5d4738cfb0" compoundref="ff_8h" startline="309">FS_FAT12</references>
        <references refid="ff_8c_1aeec02d5ae07ede32b7d74155bf0fda15" compoundref="ff_8c" startline="361">MIN_FAT16</references>
        <references refid="ff_8h_1a7ef90a36d99edfc0138a2155a17a79b9" compoundref="ff_8h" startline="310">FS_FAT16</references>
        <references refid="ff_8c_1a483625319f3e3bd5ac6502b46c375aed" compoundref="ff_8c" startline="362">MIN_FAT32</references>
        <references refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" compoundref="ff_8h" startline="311">FS_FAT32</references>
        <references refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" compoundref="ff_8h" startline="100">FATFS::n_fatent</references>
        <references refid="struct_f_a_t_f_s_1a3e3472628262823af495681702709e8e" compoundref="ff_8h" startline="102">FATFS::volbase</references>
        <references refid="struct_f_a_t_f_s_1a74e60540a346de6eb9f0c13d6203efa1" compoundref="ff_8h" startline="103">FATFS::fatbase</references>
        <references refid="struct_f_a_t_f_s_1a112ba7d33529e5c9fda3b950fff01180" compoundref="ff_8h" startline="105">FATFS::database</references>
        <references refid="struct_f_a_t_f_s_1aebfa6556d8f94e951a8b2c1eb740e9a1" compoundref="ff_8h" startline="104">FATFS::dirbase</references>
        <references refid="ff_8c_1a7add0104bd20083d6940d616faecd45a" compoundref="ff_8c" startline="392">BPB_RootClus</references>
        <references refid="struct_f_a_t_f_s_1a10cd8b80b3b6474bf0d6432c8fb9d2d2" compoundref="ff_8h" startline="94">FATFS::last_clust</references>
        <references refid="struct_f_a_t_f_s_1a509defa217cfb2eb777ed3c74c4ef426" compoundref="ff_8h" startline="95">FATFS::free_clust</references>
        <references refid="struct_f_a_t_f_s_1a66c4d8e68262d5542852e2aed6ce69b4" compoundref="ff_8h" startline="84">FATFS::fsi_flag</references>
        <references refid="ff_8c_1a51c45669282b9ce9da5152231df9f3ac" compoundref="ff_8c" startline="393">BPB_FSInfo</references>
        <references refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" compoundref="ff_8c" startline="729" endline="750">move_window</references>
        <references refid="ff_8c_1a74b810b3f3583c1eb54bd4305c0f261a" compoundref="ff_8c" startline="407">BS_55AA</references>
        <references refid="ff_8c_1a318e58c1966aba52b90ab98dcb649883" compoundref="ff_8c" startline="401">FSI_LeadSig</references>
        <references refid="ff_8c_1a3bac0e6ff5907873030db1d0a7c4ebef" compoundref="ff_8c" startline="402">FSI_StrucSig</references>
        <references refid="ff_8c_1ab711e50459aba01b11c6b46a7cc1410b" compoundref="ff_8c" startline="403">FSI_Free_Count</references>
        <references refid="ff_8c_1a320700cedf300c9b418edf56e5e6b086" compoundref="ff_8c" startline="404">FSI_Nxt_Free</references>
        <references refid="struct_f_a_t_f_s_1a7b7a6396b2c82ad46c6d8b2bf141a8dd" compoundref="ff_8h" startline="85">FATFS::id</references>
        <references refid="ff_8c_1a0b3f41d8c416222e9b1c16e36d66e18b" compoundref="ff_8c" startline="449">Fsid</references>
        <referencedby refid="group__filesystem_1ga16a934c2bbfa2160295810adc49d5509" compoundref="ff_8c" startline="2402" endline="2440">f_mount</referencedby>
        <referencedby refid="group__filesystem_1gaefdef7126128d99d0b3bd82c28e54d80" compoundref="ff_8c" startline="2449" endline="2577">f_open</referencedby>
        <referencedby refid="group__filesystem_1gab63b213c75f7335fbb63a1f3f70e5fc7" compoundref="ff_8c" startline="3187" endline="3234">f_opendir</referencedby>
        <referencedby refid="group__filesystem_1gabe1f60daab5c7d11170c334fb832c798" compoundref="ff_8c" startline="3369" endline="3395">f_stat</referencedby>
        <referencedby refid="group__filesystem_1ga0ff39f75a87cbda9cd6ea65d83f16cec" compoundref="ff_8c" startline="3404" endline="3461">f_getfree</referencedby>
        <referencedby refid="group__filesystem_1ga2858167fcd0bced48e9be434b3895efe" compoundref="ff_8c" startline="3526" endline="3586">f_unlink</referencedby>
        <referencedby refid="group__filesystem_1ga4b4d38db58e89c526cfcf53200d719d0" compoundref="ff_8c" startline="3595" endline="3660">f_mkdir</referencedby>
        <referencedby refid="group__filesystem_1ga9ee7e560eec8d82755c636ae41e702cd" compoundref="ff_8c" startline="3669" endline="3702">f_chmod</referencedby>
        <referencedby refid="group__filesystem_1ga2d0ceea336edd9b05754c8684ea8a72f" compoundref="ff_8c" startline="3711" endline="3780">f_rename</referencedby>
        <referencedby refid="group__filesystem_1gaafaa718d1a487e12a8f0087173dba0b9" compoundref="ff_8c" startline="3789" endline="3822">f_utime</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1a3fe23e7983a2974b8002a8e57c1c06e9" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void fit_lfn</definition>
        <argsstring>(const WCHAR *lfnbuf, BYTE *dir, BYTE ord, BYTE sum)</argsstring>
        <name>fit_lfn</name>
        <param>
          <type>const <ref refid="integer_8h_1a570001c92f314285ad3e7139d8c58cf7" kindref="member">WCHAR</ref> *</type>
          <declname>lfnbuf</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref> *</type>
          <declname>dir</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref></type>
          <declname>ord</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref></type>
          <declname>sum</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="1341" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="1341" bodyend="1366"/>
        <references refid="ff_8c_1ade1d529763d2d097a6d1410956c8a84f" compoundref="ff_8c" startline="424">LDIR_Chksum</references>
        <references refid="ff_8c_1a28dcd75633b49e40b42a31f0cf5f5929" compoundref="ff_8c" startline="422">LDIR_Attr</references>
        <references refid="ff_8h_1a91161ef62e0e85ba3c2876d3d339473d" compoundref="ff_8h" startline="320">AM_LFN</references>
        <references refid="ff_8c_1acb98a052a9be81564b56854df35480a0" compoundref="ff_8c" startline="423">LDIR_Type</references>
        <references refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" compoundref="ff_8h" startline="337">ST_WORD</references>
        <references refid="ff_8c_1ad73024151eff6baea94e680f7928969d" compoundref="ff_8c" startline="425">LDIR_FstClusLO</references>
        <references refid="ff_8c_1a31ec96cd263bb14418cb8b7b2b54b3ca" compoundref="ff_8c" startline="427">LLEF</references>
        <references refid="ff_8c_1a6c97d545619e6586b02b5d4f39f7be25" compoundref="ff_8c" startline="421">LDIR_Ord</references>
        <referencedby refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" compoundref="ff_8c" startline="1578" endline="1645">dir_register</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1af194524672491a522f041278b9b74e94" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>static FRESULT follow_path</definition>
        <argsstring>(DIR *dp, const TCHAR *path)</argsstring>
        <name>follow_path</name>
        <param>
          <type><ref refid="struct_d_i_r" kindref="compound">DIR</ref> *</type>
          <declname>dp</declname>
        </param>
        <param>
          <type>const <ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref> *</type>
          <declname>path</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="2052" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="2052" bodyend="2104"/>
        <references refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" compoundref="ff_8h" startline="147">DIR::sclust</references>
        <references refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" compoundref="ff_8h" startline="144">DIR::fs</references>
        <references refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" compoundref="ff_8c" startline="1080" endline="1118">dir_sdi</references>
        <references refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" compoundref="ff_8h" startline="150">DIR::dir</references>
        <references refid="ff_8c_1a1407adce52a966e786c7d37f9643a800" compoundref="ff_8c" startline="1843" endline="2042">create_name</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="ff_8c_1abf87976453ebce0af60fa7bf4a6e21df" compoundref="ff_8c" startline="1458" endline="1509">dir_find</references>
        <references refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" compoundref="ff_8h" startline="151">DIR::fn</references>
        <references refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" compoundref="ff_8c" startline="351">NSFLAG</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" compoundref="ff_8h" startline="189">FR_NO_FILE</references>
        <references refid="group___f_f_c_o_n_f_i_g_1ga52faf11025401372f71e9d81905b7af4" compoundref="ffconf_8h" startline="146">_FS_RPATH</references>
        <references refid="ff_8c_1a2db528782a021797b34bdc6e9e9de1c3" compoundref="ff_8c" startline="357">NS_DOT</references>
        <references refid="ff_8c_1a5a0742bfc1d94f0c3baa5ede485048c4" compoundref="ff_8c" startline="354">NS_LAST</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cae4529c8cc8b59783d6efc9ba4f574532" compoundref="ff_8h" startline="190">FR_NO_PATH</references>
        <references refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" compoundref="ff_8c" startline="410">DIR_Attr</references>
        <references refid="ff_8h_1a3a9db44e978ed6c13b641e092d4cd7d3" compoundref="ff_8h" startline="321">AM_DIR</references>
        <references refid="ff_8c_1ad1b3343c92d0f0e58ba448c3c11b1f39" compoundref="ff_8c" startline="1235" endline="1247">ld_clust</references>
        <referencedby refid="group__filesystem_1gaefdef7126128d99d0b3bd82c28e54d80" compoundref="ff_8c" startline="2449" endline="2577">f_open</referencedby>
        <referencedby refid="group__filesystem_1gab63b213c75f7335fbb63a1f3f70e5fc7" compoundref="ff_8c" startline="3187" endline="3234">f_opendir</referencedby>
        <referencedby refid="group__filesystem_1gabe1f60daab5c7d11170c334fb832c798" compoundref="ff_8c" startline="3369" endline="3395">f_stat</referencedby>
        <referencedby refid="group__filesystem_1ga2858167fcd0bced48e9be434b3895efe" compoundref="ff_8c" startline="3526" endline="3586">f_unlink</referencedby>
        <referencedby refid="group__filesystem_1ga4b4d38db58e89c526cfcf53200d719d0" compoundref="ff_8c" startline="3595" endline="3660">f_mkdir</referencedby>
        <referencedby refid="group__filesystem_1ga9ee7e560eec8d82755c636ae41e702cd" compoundref="ff_8c" startline="3669" endline="3702">f_chmod</referencedby>
        <referencedby refid="group__filesystem_1ga2d0ceea336edd9b05754c8684ea8a72f" compoundref="ff_8c" startline="3711" endline="3780">f_rename</referencedby>
        <referencedby refid="group__filesystem_1gaafaa718d1a487e12a8f0087173dba0b9" compoundref="ff_8c" startline="3789" endline="3822">f_utime</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1a01f02bd7a6b0835c15c4978cad7977dd" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void gen_numname</definition>
        <argsstring>(BYTE *dst, const BYTE *src, const WCHAR *lfn, UINT seq)</argsstring>
        <name>gen_numname</name>
        <param>
          <type><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref> *</type>
          <declname>dst</declname>
        </param>
        <param>
          <type>const <ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref> *</type>
          <declname>src</declname>
        </param>
        <param>
          <type>const <ref refid="integer_8h_1a570001c92f314285ad3e7139d8c58cf7" kindref="member">WCHAR</ref> *</type>
          <declname>lfn</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref></type>
          <declname>seq</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="1379" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="1379" bodyend="1427"/>
        <references refid="ff_8c_1a8941d573d16af92c8570950d53164f30" compoundref="ff_8c" startline="507" endline="520">mem_cpy</references>
        <references refid="ff_8c_1a58d63a832a117f179e41c7373d013dd6" compoundref="ff_8c" startline="331">IsDBCS1</references>
        <referencedby refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" compoundref="ff_8c" startline="1578" endline="1645">dir_register</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1a65611adf1626e5e08da77cd33a98dd8b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref></type>
        <definition>DWORD get_fat</definition>
        <argsstring>(FATFS *fs, DWORD clst)</argsstring>
        <name>get_fat</name>
        <param>
          <type><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref> *</type>
          <declname>fs</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref></type>
          <declname>clst</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="818" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="818" bodyend="862"/>
        <references refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" compoundref="ff_8h" startline="100">FATFS::n_fatent</references>
        <references refid="struct_f_a_t_f_s_1a3630ef0b29c45ef8e0c1de639efab754" compoundref="ff_8h" startline="79">FATFS::fs_type</references>
        <references refid="ff_8h_1aab755aa1b4f81f4aabee4a5d4738cfb0" compoundref="ff_8h" startline="309">FS_FAT12</references>
        <references refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" compoundref="ff_8c" startline="729" endline="750">move_window</references>
        <references refid="struct_f_a_t_f_s_1a74e60540a346de6eb9f0c13d6203efa1" compoundref="ff_8h" startline="103">FATFS::fatbase</references>
        <references refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" compoundref="ff_8c" startline="54">SS</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" compoundref="ff_8h" startline="107">FATFS::win</references>
        <references refid="ff_8h_1a7ef90a36d99edfc0138a2155a17a79b9" compoundref="ff_8h" startline="310">FS_FAT16</references>
        <references refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" compoundref="ff_8h" startline="335">LD_WORD</references>
        <references refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" compoundref="ff_8h" startline="311">FS_FAT32</references>
        <references refid="ff_8h_1a4690304ddc975516f7dc02575c96e34e" compoundref="ff_8h" startline="336">LD_DWORD</references>
        <referencedby refid="ff_8c_1ab88651d19a5597dec220fe7538cccf23" compoundref="ff_8c" startline="937" endline="979">remove_chain</referencedby>
        <referencedby refid="ff_8c_1acbd0a20a17c6f9b6d536490d1cc3c5ac" compoundref="ff_8c" startline="990" endline="1040">create_chain</referencedby>
        <referencedby refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" compoundref="ff_8c" startline="1080" endline="1118">dir_sdi</referencedby>
        <referencedby refid="ff_8c_1a2edd26ac71869f25be5fce12eec58171" compoundref="ff_8c" startline="1128" endline="1188">dir_next</referencedby>
        <referencedby refid="group__filesystem_1gac4c3dcb6869ca252888eebabe39727b3" compoundref="ff_8c" startline="2586" endline="2677">f_read</referencedby>
        <referencedby refid="group__filesystem_1ga5df0ac672ada972e89ef4b003e57f964" compoundref="ff_8c" startline="3029" endline="3178">f_lseek</referencedby>
        <referencedby refid="group__filesystem_1ga0ff39f75a87cbda9cd6ea65d83f16cec" compoundref="ff_8c" startline="3404" endline="3461">f_getfree</referencedby>
        <referencedby refid="group__filesystem_1ga691a27b40c348f7c84b42e911636f38a" compoundref="ff_8c" startline="3470" endline="3517">f_truncate</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1a2bc1b9d8567181c23b4720f4fb6076f5" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void get_fileinfo</definition>
        <argsstring>(DIR *dp, FILINFO *fno)</argsstring>
        <name>get_fileinfo</name>
        <param>
          <type><ref refid="struct_d_i_r" kindref="compound">DIR</ref> *</type>
          <declname>dp</declname>
        </param>
        <param>
          <type><ref refid="struct_f_i_l_i_n_f_o" kindref="compound">FILINFO</ref> *</type>
          <declname>fno</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="1703" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="1703" bodyend="1762"/>
        <references refid="struct_f_i_l_i_n_f_o_1a7c33845207b44ca3b394052ad6724e72" compoundref="ff_8h" startline="173">FILINFO::fname</references>
        <references refid="struct_d_i_r_1a3e49e0860170e0fd9fc3e891b0d59975" compoundref="ff_8h" startline="149">DIR::sect</references>
        <references refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" compoundref="ff_8h" startline="150">DIR::dir</references>
        <references refid="ff_8c_1a24b6bc427cbd37fbe76e087f7f188abb" compoundref="ff_8c" startline="429">RDDEM</references>
        <references refid="ff_8c_1a0f2455f7318e6d56318c62f5e4048e1e" compoundref="ff_8c" startline="428">DDEM</references>
        <references refid="ff_8c_1a89b2514198590e139dd064c5d534f302" compoundref="ff_8c" startline="324">IsUpper</references>
        <references refid="ff_8c_1a87ee1f701c2ab941862e3ce00c1c1e9d" compoundref="ff_8c" startline="411">DIR_NTres</references>
        <references refid="ff_8c_1a3b7fad0942e816fdb84d869c1f7a613e" compoundref="ff_8c" startline="356">NS_EXT</references>
        <references refid="ff_8c_1a4a0e89b504dece19e2e4b02c83782ca2" compoundref="ff_8c" startline="355">NS_BODY</references>
        <references refid="ff_8c_1a58d63a832a117f179e41c7373d013dd6" compoundref="ff_8c" startline="331">IsDBCS1</references>
        <references refid="ff_8c_1a66a3fa880af6078ef181656c1d7d8ef1" compoundref="ff_8c" startline="339">IsDBCS2</references>
        <references refid="ff_8h_1ae5146230b88ddb4a6a69340e0fd1eabd" compoundref="cc932_8c" startline="3725" endline="3781">ff_convert</references>
        <references refid="struct_f_i_l_i_n_f_o_1a8d28e8b20d001f36bf6099d312384fbd" compoundref="ff_8h" startline="172">FILINFO::fattrib</references>
        <references refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" compoundref="ff_8c" startline="410">DIR_Attr</references>
        <references refid="struct_f_i_l_i_n_f_o_1af70a0afd16367837984d6205cbfca308" compoundref="ff_8h" startline="169">FILINFO::fsize</references>
        <references refid="ff_8h_1a4690304ddc975516f7dc02575c96e34e" compoundref="ff_8h" startline="336">LD_DWORD</references>
        <references refid="ff_8c_1abfbfa613864a02a65f0bf70ead6672c7" compoundref="ff_8c" startline="420">DIR_FileSize</references>
        <references refid="struct_f_i_l_i_n_f_o_1af49edeb97b10af8854cc15a05947a7d4" compoundref="ff_8h" startline="170">FILINFO::fdate</references>
        <references refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" compoundref="ff_8h" startline="335">LD_WORD</references>
        <references refid="ff_8c_1abed17fa699511b09cbf64961373d63a4" compoundref="ff_8c" startline="418">DIR_WrtDate</references>
        <references refid="struct_f_i_l_i_n_f_o_1adb685b4c58c087d1cd790afb710001cb" compoundref="ff_8h" startline="171">FILINFO::ftime</references>
        <references refid="ff_8c_1ab9452d336adeece2a1b0b54ab35b8a59" compoundref="ff_8c" startline="417">DIR_WrtTime</references>
        <references refid="struct_f_i_l_i_n_f_o_1ac40e23991a0616f2573d7856cdbba9ea" compoundref="ff_8h" startline="175">FILINFO::lfname</references>
        <references refid="struct_f_i_l_i_n_f_o_1a28ec94b667e705d5eb0ec0bc7b5e32ec" compoundref="ff_8h" startline="176">FILINFO::lfsize</references>
        <references refid="struct_d_i_r_1a7f94c0148d9e604278c77e10ab0140cb" compoundref="ff_8h" startline="157">DIR::lfn_idx</references>
        <references refid="struct_d_i_r_1a95ac58da8ca4254c6923552f1a9ca92d" compoundref="ff_8h" startline="156">DIR::lfn</references>
        <references refid="ff_8c_1a228bfd2cabe490c8567aaf08b8b2cc14" compoundref="ff_8c" startline="89">_DF1S</references>
        <referencedby refid="group__filesystem_1gab39e82a110695de45f416f3149358012" compoundref="ff_8c" startline="3275" endline="3308">f_readdir</referencedby>
        <referencedby refid="group__filesystem_1gabe1f60daab5c7d11170c334fb832c798" compoundref="ff_8c" startline="3369" endline="3395">f_stat</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1a88ad7e4b1bc98d1a2673a136283dc7ee" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int get_ldnumber</definition>
        <argsstring>(const TCHAR **path)</argsstring>
        <name>get_ldnumber</name>
        <param>
          <type>const <ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref> **</type>
          <declname>path</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="2114" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="2114" bodyend="2165"/>
        <references refid="group___f_f_c_o_n_f_i_g_1ga75c97afb8b06935364e42e3ec3fdc6c4" compoundref="ffconf_8h" startline="165">_VOLUME_STRS</references>
        <references refid="group___f_f_c_o_n_f_i_g_1gae471cce284bf1888f9e991f5a811fc11" compoundref="ffconf_8h" startline="112">_USE_LFN</references>
        <references refid="group___f_f_c_o_n_f_i_g_1ga366da9a40c8ceb3103a6b72ca02b9969" compoundref="ffconf_8h" startline="160">_VOLUMES</references>
        <references refid="ff_8c_1a4a9d454724926bd51a3aed589a97f08b" compoundref="ff_8c" startline="325">IsLower</references>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
        <referencedby refid="group__filesystem_1ga16a934c2bbfa2160295810adc49d5509" compoundref="ff_8c" startline="2402" endline="2440">f_mount</referencedby>
        <referencedby refid="group__filesystem_1ga2d0ceea336edd9b05754c8684ea8a72f" compoundref="ff_8c" startline="3711" endline="3780">f_rename</referencedby>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1ad1b3343c92d0f0e58ba448c3c11b1f39" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref></type>
        <definition>static DWORD ld_clust</definition>
        <argsstring>(FATFS *fs, const BYTE *dir)</argsstring>
        <name>ld_clust</name>
        <param>
          <type><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref> *</type>
          <declname>fs</declname>
        </param>
        <param>
          <type>const <ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref> *</type>
          <declname>dir</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="1235" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="1235" bodyend="1247"/>
        <references refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" compoundref="ff_8h" startline="335">LD_WORD</references>
        <references refid="ff_8c_1aebe0e913bff75a89d38dbcb04baf5dff" compoundref="ff_8c" startline="419">DIR_FstClusLO</references>
        <references refid="struct_f_a_t_f_s_1a3630ef0b29c45ef8e0c1de639efab754" compoundref="ff_8h" startline="79">FATFS::fs_type</references>
        <references refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" compoundref="ff_8h" startline="311">FS_FAT32</references>
        <references refid="ff_8c_1a0bc29c3f09e1e9c40c414f7d50d7905c" compoundref="ff_8c" startline="416">DIR_FstClusHI</references>
        <referencedby refid="ff_8c_1af194524672491a522f041278b9b74e94" compoundref="ff_8c" startline="2052" endline="2104">follow_path</referencedby>
        <referencedby refid="group__filesystem_1gaefdef7126128d99d0b3bd82c28e54d80" compoundref="ff_8c" startline="2449" endline="2577">f_open</referencedby>
        <referencedby refid="group__filesystem_1gab63b213c75f7335fbb63a1f3f70e5fc7" compoundref="ff_8c" startline="3187" endline="3234">f_opendir</referencedby>
        <referencedby refid="group__filesystem_1ga2858167fcd0bced48e9be434b3895efe" compoundref="ff_8c" startline="3526" endline="3586">f_unlink</referencedby>
        <referencedby refid="group__filesystem_1ga2d0ceea336edd9b05754c8684ea8a72f" compoundref="ff_8c" startline="3711" endline="3780">f_rename</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1af35d759ac2dbde3cef605901cab3a776" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int lock_fs</definition>
        <argsstring>(FATFS *fs)</argsstring>
        <name>lock_fs</name>
        <param>
          <type><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref> *</type>
          <declname>fs</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="556" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="556" bodyend="561"/>
        <references refid="ff_8h_1aa0dd2bf38b270e6b39ff395f2d25a0ed" compoundref="syscall_8c" startline="81" endline="97">ff_req_grant</references>
        <references refid="struct_f_a_t_f_s_1a1c2c369d5858a2d8b60e65431b0b1a85" compoundref="ff_8h" startline="91">FATFS::sobj</references>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1a38b4f223d18bd4416d8bce0f07a63c01" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int mem_cmp</definition>
        <argsstring>(const void *dst, const void *src, UINT cnt)</argsstring>
        <name>mem_cmp</name>
        <param>
          <type>const void *</type>
          <declname>dst</declname>
        </param>
        <param>
          <type>const void *</type>
          <declname>src</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref></type>
          <declname>cnt</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="533" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="533" bodyend="539"/>
        <referencedby refid="ff_8c_1abf87976453ebce0af60fa7bf4a6e21df" compoundref="ff_8c" startline="1458" endline="1509">dir_find</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1a8941d573d16af92c8570950d53164f30" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void mem_cpy</definition>
        <argsstring>(void *dst, const void *src, UINT cnt)</argsstring>
        <name>mem_cpy</name>
        <param>
          <type>void *</type>
          <declname>dst</declname>
        </param>
        <param>
          <type>const void *</type>
          <declname>src</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref></type>
          <declname>cnt</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="507" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="507" bodyend="520"/>
        <referencedby refid="ff_8c_1a01f02bd7a6b0835c15c4978cad7977dd" compoundref="ff_8c" startline="1379" endline="1427">gen_numname</referencedby>
        <referencedby refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" compoundref="ff_8c" startline="1578" endline="1645">dir_register</referencedby>
        <referencedby refid="group__filesystem_1gac4c3dcb6869ca252888eebabe39727b3" compoundref="ff_8c" startline="2586" endline="2677">f_read</referencedby>
        <referencedby refid="group__filesystem_1gae6a4dfae8a9e308bdb2283a37ef680f2" compoundref="ff_8c" startline="2687" endline="2800">f_write</referencedby>
        <referencedby refid="group__filesystem_1ga2858167fcd0bced48e9be434b3895efe" compoundref="ff_8c" startline="3526" endline="3586">f_unlink</referencedby>
        <referencedby refid="group__filesystem_1ga4b4d38db58e89c526cfcf53200d719d0" compoundref="ff_8c" startline="3595" endline="3660">f_mkdir</referencedby>
        <referencedby refid="group__filesystem_1ga2d0ceea336edd9b05754c8684ea8a72f" compoundref="ff_8c" startline="3711" endline="3780">f_rename</referencedby>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1a02eb5189e43056a9ddc8a59cbe89be93" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void mem_set</definition>
        <argsstring>(void *dst, int val, UINT cnt)</argsstring>
        <name>mem_set</name>
        <param>
          <type>void *</type>
          <declname>dst</declname>
        </param>
        <param>
          <type>int</type>
          <declname>val</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref></type>
          <declname>cnt</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="524" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="524" bodyend="529"/>
        <referencedby refid="ff_8c_1aec6b108298553219ebb2b960b528459d" compoundref="ff_8c" startline="760" endline="789">sync_fs</referencedby>
        <referencedby refid="ff_8c_1a2edd26ac71869f25be5fce12eec58171" compoundref="ff_8c" startline="1128" endline="1188">dir_next</referencedby>
        <referencedby refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" compoundref="ff_8c" startline="1578" endline="1645">dir_register</referencedby>
        <referencedby refid="ff_8c_1a724c260af4783a0ecf0db8d0687e7bd6" compoundref="ff_8c" startline="1656" endline="1692">dir_remove</referencedby>
        <referencedby refid="ff_8c_1a1407adce52a966e786c7d37f9643a800" compoundref="ff_8c" startline="1843" endline="2042">create_name</referencedby>
        <referencedby refid="group__filesystem_1ga4b4d38db58e89c526cfcf53200d719d0" compoundref="ff_8c" startline="3595" endline="3660">f_mkdir</referencedby>
        <referencedby refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" compoundref="ff_8c" startline="4063" endline="4300">f_mkfs</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>static FRESULT move_window</definition>
        <argsstring>(FATFS *fs, DWORD sector)</argsstring>
        <name>move_window</name>
        <param>
          <type><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref> *</type>
          <declname>fs</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref></type>
          <declname>sector</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="729" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="729" bodyend="750"/>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" compoundref="ff_8h" startline="106">FATFS::winsect</references>
        <references refid="ff_8c_1a5e18753404354b210096f9af99e31bc1" compoundref="ff_8c" startline="700" endline="724">sync_window</references>
        <references refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1gae55155170bc9b99f73b440b93cc1c9e2" compoundref="_b_c_d_s___s_d_card___interface_8h" startline="62">disk_read</references>
        <references refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" compoundref="ff_8h" startline="80">FATFS::drv</references>
        <references refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" compoundref="ff_8h" startline="107">FATFS::win</references>
        <references refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" compoundref="diskio_8h" startline="23">RES_OK</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" compoundref="ff_8h" startline="186">FR_DISK_ERR</references>
        <referencedby refid="ff_8c_1a65611adf1626e5e08da77cd33a98dd8b" compoundref="ff_8c" startline="818" endline="862">get_fat</referencedby>
        <referencedby refid="ff_8c_1abd4b6b071a8d728a88727051c12bc6d7" compoundref="ff_8c" startline="873" endline="926">put_fat</referencedby>
        <referencedby refid="ff_8c_1a23ff0594686ccbd8f8d987547931ef04" compoundref="ff_8c" startline="1199" endline="1224">dir_alloc</referencedby>
        <referencedby refid="ff_8c_1abf87976453ebce0af60fa7bf4a6e21df" compoundref="ff_8c" startline="1458" endline="1509">dir_find</referencedby>
        <referencedby refid="ff_8c_1a3a47a08609e77266bc1928af812e06df" compoundref="ff_8c" startline="1519" endline="1567">dir_read</referencedby>
        <referencedby refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" compoundref="ff_8c" startline="1578" endline="1645">dir_register</referencedby>
        <referencedby refid="ff_8c_1a724c260af4783a0ecf0db8d0687e7bd6" compoundref="ff_8c" startline="1656" endline="1692">dir_remove</referencedby>
        <referencedby refid="ff_8c_1a55626c76a1556af5dc5345e2c0841a65" compoundref="ff_8c" startline="2175" endline="2193">check_fs</referencedby>
        <referencedby refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" compoundref="ff_8c" startline="2203" endline="2362">find_volume</referencedby>
        <referencedby refid="group__filesystem_1gaefdef7126128d99d0b3bd82c28e54d80" compoundref="ff_8c" startline="2449" endline="2577">f_open</referencedby>
        <referencedby refid="group__filesystem_1gac4c3dcb6869ca252888eebabe39727b3" compoundref="ff_8c" startline="2586" endline="2677">f_read</referencedby>
        <referencedby refid="group__filesystem_1gae6a4dfae8a9e308bdb2283a37ef680f2" compoundref="ff_8c" startline="2687" endline="2800">f_write</referencedby>
        <referencedby refid="group__filesystem_1gad69c7246b122ba56a134939ee0eaf847" compoundref="ff_8c" startline="2809" endline="2846">f_sync</referencedby>
        <referencedby refid="group__filesystem_1ga0ff39f75a87cbda9cd6ea65d83f16cec" compoundref="ff_8c" startline="3404" endline="3461">f_getfree</referencedby>
        <referencedby refid="group__filesystem_1ga2d0ceea336edd9b05754c8684ea8a72f" compoundref="ff_8c" startline="3711" endline="3780">f_rename</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1a2a2c96233e92d8abe12c4496caec85cf" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int pick_lfn</definition>
        <argsstring>(WCHAR *lfnbuf, BYTE *dir)</argsstring>
        <name>pick_lfn</name>
        <param>
          <type><ref refid="integer_8h_1a570001c92f314285ad3e7139d8c58cf7" kindref="member">WCHAR</ref> *</type>
          <declname>lfnbuf</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref> *</type>
          <declname>dir</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="1307" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="1307" bodyend="1336"/>
        <references refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" compoundref="ff_8h" startline="335">LD_WORD</references>
        <references refid="ff_8c_1ad73024151eff6baea94e680f7928969d" compoundref="ff_8c" startline="425">LDIR_FstClusLO</references>
        <references refid="ff_8c_1a6c97d545619e6586b02b5d4f39f7be25" compoundref="ff_8c" startline="421">LDIR_Ord</references>
        <references refid="group___f_f_c_o_n_f_i_g_1ga14e73a5c703a586c614b3e40b849f82c" compoundref="ffconf_8h" startline="113">_MAX_LFN</references>
        <references refid="ff_8c_1a31ec96cd263bb14418cb8b7b2b54b3ca" compoundref="ff_8c" startline="427">LLEF</references>
        <referencedby refid="ff_8c_1a3a47a08609e77266bc1928af812e06df" compoundref="ff_8c" startline="1519" endline="1567">dir_read</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1abd4b6b071a8d728a88727051c12bc6d7" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>FRESULT put_fat</definition>
        <argsstring>(FATFS *fs, DWORD clst, DWORD val)</argsstring>
        <name>put_fat</name>
        <param>
          <type><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref> *</type>
          <declname>fs</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref></type>
          <declname>clst</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref></type>
          <declname>val</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="873" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="873" bodyend="926"/>
        <references refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" compoundref="ff_8h" startline="100">FATFS::n_fatent</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" compoundref="ff_8h" startline="187">FR_INT_ERR</references>
        <references refid="struct_f_a_t_f_s_1a3630ef0b29c45ef8e0c1de639efab754" compoundref="ff_8h" startline="79">FATFS::fs_type</references>
        <references refid="ff_8h_1aab755aa1b4f81f4aabee4a5d4738cfb0" compoundref="ff_8h" startline="309">FS_FAT12</references>
        <references refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" compoundref="ff_8c" startline="729" endline="750">move_window</references>
        <references refid="struct_f_a_t_f_s_1a74e60540a346de6eb9f0c13d6203efa1" compoundref="ff_8h" startline="103">FATFS::fatbase</references>
        <references refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" compoundref="ff_8c" startline="54">SS</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" compoundref="ff_8h" startline="107">FATFS::win</references>
        <references refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" compoundref="ff_8h" startline="83">FATFS::wflag</references>
        <references refid="ff_8h_1a7ef90a36d99edfc0138a2155a17a79b9" compoundref="ff_8h" startline="310">FS_FAT16</references>
        <references refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" compoundref="ff_8h" startline="337">ST_WORD</references>
        <references refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" compoundref="ff_8h" startline="311">FS_FAT32</references>
        <references refid="ff_8h_1a4690304ddc975516f7dc02575c96e34e" compoundref="ff_8h" startline="336">LD_DWORD</references>
        <references refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" compoundref="ff_8h" startline="338">ST_DWORD</references>
        <referencedby refid="ff_8c_1ab88651d19a5597dec220fe7538cccf23" compoundref="ff_8c" startline="937" endline="979">remove_chain</referencedby>
        <referencedby refid="ff_8c_1acbd0a20a17c6f9b6d536490d1cc3c5ac" compoundref="ff_8c" startline="990" endline="1040">create_chain</referencedby>
        <referencedby refid="group__filesystem_1ga691a27b40c348f7c84b42e911636f38a" compoundref="ff_8c" startline="3470" endline="3517">f_truncate</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1a19f72a515ee94dd8a9660d513172ce9b" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void putc_bfd</definition>
        <argsstring>(putbuff *pb, TCHAR c)</argsstring>
        <name>putc_bfd</name>
        <param>
          <type><ref refid="structputbuff" kindref="compound">putbuff</ref> *</type>
          <declname>pb</declname>
        </param>
        <param>
          <type><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref></type>
          <declname>c</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="4469" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="4469" bodyend="4520"/>
        <references refid="group___f_f_c_o_n_f_i_g_1gaaab0313f867bb008b64236239f5c2660" compoundref="ffconf_8h" startline="47">_USE_STRFUNC</references>
        <references refid="structputbuff_1ae40354a1051342eb5a9db005715dcfa9" compoundref="ff_8c" startline="4463">putbuff::idx</references>
        <references refid="structputbuff_1a6966cd5c37fc8748361cad1ff6f7f640" compoundref="ff_8c" startline="4464">putbuff::buf</references>
        <references refid="ff_8h_1ae5146230b88ddb4a6a69340e0fd1eabd" compoundref="cc932_8c" startline="3725" endline="3781">ff_convert</references>
        <references refid="group__filesystem_1gae6a4dfae8a9e308bdb2283a37ef680f2" compoundref="ff_8c" startline="2687" endline="2800">f_write</references>
        <references refid="structputbuff_1a8d839bbcaa5e21902d2481c87c4f359f" compoundref="ff_8c" startline="4462">putbuff::fp</references>
        <references refid="structputbuff_1a1560bca810e056ea71cbf8c667d59580" compoundref="ff_8c" startline="4463">putbuff::nchr</references>
        <referencedby refid="group__filesystem_1ga62a35ee79e4913c1e31ac706241be7da" compoundref="ff_8c" startline="4524" endline="4542">f_putc</referencedby>
        <referencedby refid="group__filesystem_1ga9443c00129414fbfc16a5a13ad876ced" compoundref="ff_8c" startline="4551" endline="4570">f_puts</referencedby>
        <referencedby refid="group__filesystem_1ga49cccab38cd84e2d3357fef2d1df21f9" compoundref="ff_8c" startline="4579" endline="4674">f_printf</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1ab88651d19a5597dec220fe7538cccf23" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>static FRESULT remove_chain</definition>
        <argsstring>(FATFS *fs, DWORD clst)</argsstring>
        <name>remove_chain</name>
        <param>
          <type><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref> *</type>
          <declname>fs</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref></type>
          <declname>clst</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="937" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="937" bodyend="979"/>
        <references refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" compoundref="ff_8h" startline="100">FATFS::n_fatent</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" compoundref="ff_8h" startline="187">FR_INT_ERR</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="ff_8c_1a65611adf1626e5e08da77cd33a98dd8b" compoundref="ff_8c" startline="818" endline="862">get_fat</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" compoundref="ff_8h" startline="186">FR_DISK_ERR</references>
        <references refid="ff_8c_1abd4b6b071a8d728a88727051c12bc6d7" compoundref="ff_8c" startline="873" endline="926">put_fat</references>
        <references refid="struct_f_a_t_f_s_1a509defa217cfb2eb777ed3c74c4ef426" compoundref="ff_8h" startline="95">FATFS::free_clust</references>
        <references refid="struct_f_a_t_f_s_1a66c4d8e68262d5542852e2aed6ce69b4" compoundref="ff_8h" startline="84">FATFS::fsi_flag</references>
        <references refid="ff_8c_1a7519abb60fe91f6aa1d17f64fbae123a" compoundref="ff_8c" startline="800" endline="808">clust2sect</references>
        <references refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" compoundref="ff_8h" startline="81">FATFS::csize</references>
        <references refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga3051f51f1cccb103d145804d5d91b04d" compoundref="_b_c_d_s___s_d_card___interface_8h" startline="64">disk_ioctl</references>
        <references refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" compoundref="ff_8h" startline="80">FATFS::drv</references>
        <references refid="diskio_8h_1af09fd84bea8d4e889e272471f44d60d6" compoundref="diskio_8h" startline="56">CTRL_TRIM</references>
        <referencedby refid="group__filesystem_1gaefdef7126128d99d0b3bd82c28e54d80" compoundref="ff_8c" startline="2449" endline="2577">f_open</referencedby>
        <referencedby refid="group__filesystem_1ga691a27b40c348f7c84b42e911636f38a" compoundref="ff_8c" startline="3470" endline="3517">f_truncate</referencedby>
        <referencedby refid="group__filesystem_1ga2858167fcd0bced48e9be434b3895efe" compoundref="ff_8c" startline="3526" endline="3586">f_unlink</referencedby>
        <referencedby refid="group__filesystem_1ga4b4d38db58e89c526cfcf53200d719d0" compoundref="ff_8c" startline="3595" endline="3660">f_mkdir</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1a357e5a36452e057d68378c98cd61018c" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void st_clust</definition>
        <argsstring>(BYTE *dir, DWORD cl)</argsstring>
        <name>st_clust</name>
        <param>
          <type><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref> *</type>
          <declname>dir</declname>
        </param>
        <param>
          <type><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref></type>
          <declname>cl</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="1252" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="1252" bodyend="1259"/>
        <references refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" compoundref="ff_8h" startline="337">ST_WORD</references>
        <references refid="ff_8c_1aebe0e913bff75a89d38dbcb04baf5dff" compoundref="ff_8c" startline="419">DIR_FstClusLO</references>
        <references refid="ff_8c_1a0bc29c3f09e1e9c40c414f7d50d7905c" compoundref="ff_8c" startline="416">DIR_FstClusHI</references>
        <referencedby refid="group__filesystem_1gaefdef7126128d99d0b3bd82c28e54d80" compoundref="ff_8c" startline="2449" endline="2577">f_open</referencedby>
        <referencedby refid="group__filesystem_1gad69c7246b122ba56a134939ee0eaf847" compoundref="ff_8c" startline="2809" endline="2846">f_sync</referencedby>
        <referencedby refid="group__filesystem_1ga4b4d38db58e89c526cfcf53200d719d0" compoundref="ff_8c" startline="3595" endline="3660">f_mkdir</referencedby>
        <referencedby refid="group__filesystem_1ga2d0ceea336edd9b05754c8684ea8a72f" compoundref="ff_8c" startline="3711" endline="3780">f_rename</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1a6d9c1b908dec282bedd5d1ee4b1f434e" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref></type>
        <definition>static BYTE sum_sfn</definition>
        <argsstring>(const BYTE *dir)</argsstring>
        <name>sum_sfn</name>
        <param>
          <type>const <ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref> *</type>
          <declname>dir</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="1438" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="1438" bodyend="1447"/>
        <referencedby refid="ff_8c_1abf87976453ebce0af60fa7bf4a6e21df" compoundref="ff_8c" startline="1458" endline="1509">dir_find</referencedby>
        <referencedby refid="ff_8c_1a3a47a08609e77266bc1928af812e06df" compoundref="ff_8c" startline="1519" endline="1567">dir_read</referencedby>
        <referencedby refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" compoundref="ff_8c" startline="1578" endline="1645">dir_register</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1aec6b108298553219ebb2b960b528459d" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>static FRESULT sync_fs</definition>
        <argsstring>(FATFS *fs)</argsstring>
        <name>sync_fs</name>
        <param>
          <type><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref> *</type>
          <declname>fs</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="760" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="760" bodyend="789"/>
        <references refid="ff_8c_1a5e18753404354b210096f9af99e31bc1" compoundref="ff_8c" startline="700" endline="724">sync_window</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="struct_f_a_t_f_s_1a3630ef0b29c45ef8e0c1de639efab754" compoundref="ff_8h" startline="79">FATFS::fs_type</references>
        <references refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" compoundref="ff_8h" startline="311">FS_FAT32</references>
        <references refid="struct_f_a_t_f_s_1a66c4d8e68262d5542852e2aed6ce69b4" compoundref="ff_8h" startline="84">FATFS::fsi_flag</references>
        <references refid="ff_8c_1a02eb5189e43056a9ddc8a59cbe89be93" compoundref="ff_8c" startline="524" endline="529">mem_set</references>
        <references refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" compoundref="ff_8h" startline="107">FATFS::win</references>
        <references refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" compoundref="ff_8c" startline="54">SS</references>
        <references refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" compoundref="ff_8h" startline="337">ST_WORD</references>
        <references refid="ff_8c_1a74b810b3f3583c1eb54bd4305c0f261a" compoundref="ff_8c" startline="407">BS_55AA</references>
        <references refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" compoundref="ff_8h" startline="338">ST_DWORD</references>
        <references refid="ff_8c_1a318e58c1966aba52b90ab98dcb649883" compoundref="ff_8c" startline="401">FSI_LeadSig</references>
        <references refid="ff_8c_1a3bac0e6ff5907873030db1d0a7c4ebef" compoundref="ff_8c" startline="402">FSI_StrucSig</references>
        <references refid="ff_8c_1ab711e50459aba01b11c6b46a7cc1410b" compoundref="ff_8c" startline="403">FSI_Free_Count</references>
        <references refid="struct_f_a_t_f_s_1a509defa217cfb2eb777ed3c74c4ef426" compoundref="ff_8h" startline="95">FATFS::free_clust</references>
        <references refid="ff_8c_1a320700cedf300c9b418edf56e5e6b086" compoundref="ff_8c" startline="404">FSI_Nxt_Free</references>
        <references refid="struct_f_a_t_f_s_1a10cd8b80b3b6474bf0d6432c8fb9d2d2" compoundref="ff_8h" startline="94">FATFS::last_clust</references>
        <references refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" compoundref="ff_8h" startline="106">FATFS::winsect</references>
        <references refid="struct_f_a_t_f_s_1a3e3472628262823af495681702709e8e" compoundref="ff_8h" startline="102">FATFS::volbase</references>
        <references refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" compoundref="_b_c_d_s___s_d_card___interface_8h" startline="63">disk_write</references>
        <references refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" compoundref="ff_8h" startline="80">FATFS::drv</references>
        <references refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga3051f51f1cccb103d145804d5d91b04d" compoundref="_b_c_d_s___s_d_card___interface_8h" startline="64">disk_ioctl</references>
        <references refid="diskio_8h_1a1b3c492f9aec325f0655941b75256f3c" compoundref="diskio_8h" startline="52">CTRL_SYNC</references>
        <references refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" compoundref="diskio_8h" startline="23">RES_OK</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" compoundref="ff_8h" startline="186">FR_DISK_ERR</references>
        <referencedby refid="group__filesystem_1gad69c7246b122ba56a134939ee0eaf847" compoundref="ff_8c" startline="2809" endline="2846">f_sync</referencedby>
        <referencedby refid="group__filesystem_1ga2858167fcd0bced48e9be434b3895efe" compoundref="ff_8c" startline="3526" endline="3586">f_unlink</referencedby>
        <referencedby refid="group__filesystem_1ga4b4d38db58e89c526cfcf53200d719d0" compoundref="ff_8c" startline="3595" endline="3660">f_mkdir</referencedby>
        <referencedby refid="group__filesystem_1ga9ee7e560eec8d82755c636ae41e702cd" compoundref="ff_8c" startline="3669" endline="3702">f_chmod</referencedby>
        <referencedby refid="group__filesystem_1ga2d0ceea336edd9b05754c8684ea8a72f" compoundref="ff_8c" startline="3711" endline="3780">f_rename</referencedby>
        <referencedby refid="group__filesystem_1gaafaa718d1a487e12a8f0087173dba0b9" compoundref="ff_8c" startline="3789" endline="3822">f_utime</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1a5e18753404354b210096f9af99e31bc1" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>static FRESULT sync_window</definition>
        <argsstring>(FATFS *fs)</argsstring>
        <name>sync_window</name>
        <param>
          <type><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref> *</type>
          <declname>fs</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="700" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="700" bodyend="724"/>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <references refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" compoundref="ff_8h" startline="83">FATFS::wflag</references>
        <references refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" compoundref="ff_8h" startline="106">FATFS::winsect</references>
        <references refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" compoundref="_b_c_d_s___s_d_card___interface_8h" startline="63">disk_write</references>
        <references refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" compoundref="ff_8h" startline="80">FATFS::drv</references>
        <references refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" compoundref="ff_8h" startline="107">FATFS::win</references>
        <references refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" compoundref="diskio_8h" startline="23">RES_OK</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" compoundref="ff_8h" startline="186">FR_DISK_ERR</references>
        <references refid="struct_f_a_t_f_s_1a74e60540a346de6eb9f0c13d6203efa1" compoundref="ff_8h" startline="103">FATFS::fatbase</references>
        <references refid="struct_f_a_t_f_s_1af70a0afd16367837984d6205cbfca308" compoundref="ff_8h" startline="101">FATFS::fsize</references>
        <references refid="struct_f_a_t_f_s_1af18fdbb9dec86b70abc6ee2a1217ac47" compoundref="ff_8h" startline="82">FATFS::n_fats</references>
        <referencedby refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" compoundref="ff_8c" startline="729" endline="750">move_window</referencedby>
        <referencedby refid="ff_8c_1aec6b108298553219ebb2b960b528459d" compoundref="ff_8c" startline="760" endline="789">sync_fs</referencedby>
        <referencedby refid="ff_8c_1a2edd26ac71869f25be5fce12eec58171" compoundref="ff_8c" startline="1128" endline="1188">dir_next</referencedby>
        <referencedby refid="group__filesystem_1gae6a4dfae8a9e308bdb2283a37ef680f2" compoundref="ff_8c" startline="2687" endline="2800">f_write</referencedby>
        <referencedby refid="group__filesystem_1ga4b4d38db58e89c526cfcf53200d719d0" compoundref="ff_8c" startline="3595" endline="3660">f_mkdir</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1a58c93c453ba943336cd24aa185cd72cf" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void unlock_fs</definition>
        <argsstring>(FATFS *fs, FRESULT res)</argsstring>
        <name>unlock_fs</name>
        <param>
          <type><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref> *</type>
          <declname>fs</declname>
        </param>
        <param>
          <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
          <declname>res</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="565" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="565" bodyend="577"/>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cafc56605c68aaffab4a428339a8bd600d" compoundref="ff_8h" startline="197">FR_NOT_ENABLED</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca487844af77de15f6932a3b41ef3a2d65" compoundref="ff_8h" startline="196">FR_INVALID_DRIVE</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca3dec4eba481cdf5e99d7cd6009e6dcf8" compoundref="ff_8h" startline="194">FR_INVALID_OBJECT</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca3f8ca7e51af8b129d14328de7243c5d4" compoundref="ff_8h" startline="200">FR_TIMEOUT</references>
        <references refid="ff_8h_1a5bb37b1d2ec72388812e11003f2b508a" compoundref="syscall_8c" startline="107" endline="118">ff_rel_grant</references>
        <references refid="struct_f_a_t_f_s_1a1c2c369d5858a2d8b60e65431b0b1a85" compoundref="ff_8h" startline="91">FATFS::sobj</references>
        <referencedby refid="group__filesystem_1ga53882db20ef4323dcfd1874d7733ffc3" compoundref="ff_8c" startline="2857" endline="2885">f_close</referencedby>
        <referencedby refid="group__filesystem_1gab5f7376b6f3e3bcc7f5ff5497c8b7364" compoundref="ff_8c" startline="3243" endline="3266">f_closedir</referencedby>
      </memberdef>
      <memberdef kind="function" id="ff_8c_1aa7193f5b86c3996b5312043a0c26da5f" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref></type>
        <definition>static FRESULT validate</definition>
        <argsstring>(void *obj)</argsstring>
        <name>validate</name>
        <param>
          <type>void *</type>
          <declname>obj</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" line="2372" column="1" bodyfile="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c" bodystart="2372" bodyend="2385"/>
        <references refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" compoundref="ff_8h" startline="115">FIL::fs</references>
        <references refid="struct_f_a_t_f_s_1a3630ef0b29c45ef8e0c1de639efab754" compoundref="ff_8h" startline="79">FATFS::fs_type</references>
        <references refid="struct_f_a_t_f_s_1a7b7a6396b2c82ad46c6d8b2bf141a8dd" compoundref="ff_8h" startline="85">FATFS::id</references>
        <references refid="struct_f_i_l_1a7b7a6396b2c82ad46c6d8b2bf141a8dd" compoundref="ff_8h" startline="116">FIL::id</references>
        <references refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga0b8d23a060415e85133803b8fcc6f42a" compoundref="_b_c_d_s___s_d_card___interface_8h" startline="60">disk_status</references>
        <references refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" compoundref="ff_8h" startline="80">FATFS::drv</references>
        <references refid="diskio_8h_1abd6503c70d862b979a3f7080a59e9acd" compoundref="diskio_8h" startline="44">STA_NOINIT</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca3dec4eba481cdf5e99d7cd6009e6dcf8" compoundref="ff_8h" startline="194">FR_INVALID_OBJECT</references>
        <references refid="ff_8c_1a458e336ac53f8249ed02d844469b7076" compoundref="ff_8c" startline="39">ENTER_FF</references>
        <references refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" compoundref="ff_8h" startline="185">FR_OK</references>
        <referencedby refid="group__filesystem_1gac4c3dcb6869ca252888eebabe39727b3" compoundref="ff_8c" startline="2586" endline="2677">f_read</referencedby>
        <referencedby refid="group__filesystem_1gae6a4dfae8a9e308bdb2283a37ef680f2" compoundref="ff_8c" startline="2687" endline="2800">f_write</referencedby>
        <referencedby refid="group__filesystem_1gad69c7246b122ba56a134939ee0eaf847" compoundref="ff_8c" startline="2809" endline="2846">f_sync</referencedby>
        <referencedby refid="group__filesystem_1ga53882db20ef4323dcfd1874d7733ffc3" compoundref="ff_8c" startline="2857" endline="2885">f_close</referencedby>
        <referencedby refid="group__filesystem_1ga5df0ac672ada972e89ef4b003e57f964" compoundref="ff_8c" startline="3029" endline="3178">f_lseek</referencedby>
        <referencedby refid="group__filesystem_1gab5f7376b6f3e3bcc7f5ff5497c8b7364" compoundref="ff_8c" startline="3243" endline="3266">f_closedir</referencedby>
        <referencedby refid="group__filesystem_1gab39e82a110695de45f416f3149358012" compoundref="ff_8c" startline="3275" endline="3308">f_readdir</referencedby>
        <referencedby refid="group__filesystem_1ga691a27b40c348f7c84b42e911636f38a" compoundref="ff_8c" startline="3470" endline="3517">f_truncate</referencedby>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*----------------------------------------------------------------------------/</highlight></codeline>
<codeline lineno="2"><highlight class="comment">/<sp/><sp/>FatFs<sp/>-<sp/>FAT<sp/>file<sp/>system<sp/>module<sp/><sp/>R0.11a<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(C)ChaN,<sp/>2015<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/</highlight></codeline>
<codeline lineno="3"><highlight class="comment">/-----------------------------------------------------------------------------/</highlight></codeline>
<codeline lineno="4"><highlight class="comment">/<sp/>FatFs<sp/>module<sp/>is<sp/>a<sp/>free<sp/>software<sp/>that<sp/>opened<sp/>under<sp/>license<sp/>policy<sp/>of</highlight></codeline>
<codeline lineno="5"><highlight class="comment">/<sp/>following<sp/>conditions.</highlight></codeline>
<codeline lineno="6"><highlight class="comment">/</highlight></codeline>
<codeline lineno="7"><highlight class="comment">/<sp/>Copyright<sp/>(C)<sp/>2015,<sp/>ChaN,<sp/>all<sp/>right<sp/>reserved.</highlight></codeline>
<codeline lineno="8"><highlight class="comment">/</highlight></codeline>
<codeline lineno="9"><highlight class="comment">/<sp/>1.<sp/>Redistributions<sp/>of<sp/>source<sp/>code<sp/>must<sp/>retain<sp/>the<sp/>above<sp/>copyright<sp/>notice,</highlight></codeline>
<codeline lineno="10"><highlight class="comment">/<sp/><sp/><sp/><sp/>this<sp/>condition<sp/>and<sp/>the<sp/>following<sp/>disclaimer.</highlight></codeline>
<codeline lineno="11"><highlight class="comment">/</highlight></codeline>
<codeline lineno="12"><highlight class="comment">/<sp/>This<sp/>software<sp/>is<sp/>provided<sp/>by<sp/>the<sp/>copyright<sp/>holder<sp/>and<sp/>contributors<sp/>&quot;AS<sp/>IS&quot;</highlight></codeline>
<codeline lineno="13"><highlight class="comment">/<sp/>and<sp/>any<sp/>warranties<sp/>related<sp/>to<sp/>this<sp/>software<sp/>are<sp/>DISCLAIMED.</highlight></codeline>
<codeline lineno="14"><highlight class="comment">/<sp/>The<sp/>copyright<sp/>owner<sp/>or<sp/>contributors<sp/>be<sp/>NOT<sp/>LIABLE<sp/>for<sp/>any<sp/>damages<sp/>caused</highlight></codeline>
<codeline lineno="15"><highlight class="comment">/<sp/>by<sp/>use<sp/>of<sp/>this<sp/>software.</highlight></codeline>
<codeline lineno="16"><highlight class="comment">/----------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="ff_8h" kindref="compound">ff.h</ref>&quot;</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Declarations<sp/>of<sp/>FatFs<sp/>API<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="diskio_8h" kindref="compound">diskio.h</ref>&quot;</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Declarations<sp/>of<sp/>disk<sp/>I/O<sp/>functions<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="comment">/*--------------------------------------------------------------------------</highlight></codeline>
<codeline lineno="24"><highlight class="comment"></highlight></codeline>
<codeline lineno="25"><highlight class="comment"><sp/><sp/><sp/>Module<sp/>Private<sp/>Definitions</highlight></codeline>
<codeline lineno="26"><highlight class="comment"></highlight></codeline>
<codeline lineno="27"><highlight class="comment">---------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FATFS<sp/>!=<sp/>64180<sp/></highlight><highlight class="comment">/*<sp/>Revision<sp/>ID<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="preprocessor">#error<sp/>Wrong<sp/>include<sp/>file<sp/>(ff.h).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Reentrancy<sp/>related<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_REENTRANT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN<sp/>==<sp/>1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="preprocessor">#error<sp/>Static<sp/>LFN<sp/>work<sp/>area<sp/>cannot<sp/>be<sp/>used<sp/>at<sp/>thread-safe<sp/>configuration</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39" refid="ff_8c_1a458e336ac53f8249ed02d844469b7076" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ENTER_FF(fs)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/>if<sp/>(!lock_fs(fs))<sp/>return<sp/>FR_TIMEOUT;<sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40" refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>LEAVE_FF(fs,<sp/>res)<sp/><sp/><sp/>{<sp/>unlock_fs(fs,<sp/>res);<sp/>return<sp/>res;<sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ENTER_FF(fs)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>LEAVE_FF(fs,<sp/>res)<sp/><sp/><sp/>return<sp/>res</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight></codeline>
<codeline lineno="46" refid="ff_8c_1a41e4c46636679236568cf50b5535847f" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ABORT(fs,<sp/>res)<sp/><sp/><sp/><sp/><sp/><sp/>{<sp/>fp-&gt;err<sp/>=<sp/>(BYTE)(res);<sp/>LEAVE_FF(fs,<sp/>res);<sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Definitions<sp/>of<sp/>sector<sp/>size<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>(_MAX_SS<sp/>&lt;<sp/>_MIN_SS)<sp/>||<sp/>(_MAX_SS<sp/>!=<sp/>512<sp/>&amp;&amp;<sp/>_MAX_SS<sp/>!=<sp/>1024<sp/>&amp;&amp;<sp/>_MAX_SS<sp/>!=<sp/>2048<sp/>&amp;&amp;<sp/>_MAX_SS<sp/>!=<sp/>4096)<sp/>||<sp/>(_MIN_SS<sp/>!=<sp/>512<sp/>&amp;&amp;<sp/>_MIN_SS<sp/>!=<sp/>1024<sp/>&amp;&amp;<sp/>_MIN_SS<sp/>!=<sp/>2048<sp/>&amp;&amp;<sp/>_MIN_SS<sp/>!=<sp/>4096)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight><highlight class="preprocessor">#error<sp/>Wrong<sp/>sector<sp/>size<sp/>configuration</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_MAX_SS<sp/>==<sp/>_MIN_SS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="54" refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>SS(fs)<sp/><sp/>((UINT)_MAX_SS)<sp/></highlight><highlight class="comment">/*<sp/>Fixed<sp/>sector<sp/>size<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>SS(fs)<sp/><sp/>((fs)-&gt;ssize)<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Variable<sp/>sector<sp/>size<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Timestamp<sp/>feature<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_NORTC<sp/>==<sp/>1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_NORTC_YEAR<sp/>&lt;<sp/>1980<sp/>||<sp/>_NORTC_YEAR<sp/>&gt;<sp/>2107<sp/>||<sp/>_NORTC_MON<sp/>&lt;<sp/>1<sp/>||<sp/>_NORTC_MON<sp/>&gt;<sp/>12<sp/>||<sp/>_NORTC_MDAY<sp/>&lt;<sp/>1<sp/>||<sp/>_NORTC_MDAY<sp/>&gt;<sp/>31</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight><highlight class="preprocessor">#error<sp/>Invalid<sp/>_FS_NORTC<sp/>settings</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>GET_FATTIME()<sp/><sp/><sp/>((DWORD)(_NORTC_YEAR<sp/>-<sp/>1980)<sp/>&lt;&lt;<sp/>25<sp/>|<sp/>(DWORD)_NORTC_MON<sp/>&lt;&lt;<sp/>21<sp/>|<sp/>(DWORD)_NORTC_MDAY<sp/>&lt;&lt;<sp/>16)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="67" refid="ff_8c_1a72589f5bbb514c0b222ab8b292764418" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>GET_FATTIME()<sp/><sp/><sp/>get_fattime()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"></highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>File<sp/>access<sp/>control<sp/>feature<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_LOCK</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight><highlight class="preprocessor">#error<sp/>_FS_LOCK<sp/>must<sp/>be<sp/>0<sp/>at<sp/>read-only<sp/>configuration</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref><sp/>*fs;<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Object<sp/>ID<sp/>1,<sp/>volume<sp/>(NULL:blank<sp/>entry)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>clu;<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Object<sp/>ID<sp/>2,<sp/>directory<sp/>(0:root)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a197942eefa7db30960ae396d68339b97" kindref="member">WORD</ref><sp/>idx;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Object<sp/>ID<sp/>3,<sp/>directory<sp/>index<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a197942eefa7db30960ae396d68339b97" kindref="member">WORD</ref><sp/>ctr;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Object<sp/>open<sp/>counter,<sp/>0:none,<sp/>0x01..0xFF:read<sp/>mode<sp/>open<sp/>count,<sp/>0x100:write<sp/>mode<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="81"><highlight class="normal">}<sp/>FILESEM;</highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal"></highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>DBCS<sp/>code<sp/>ranges<sp/>and<sp/>SBCS<sp/>upper<sp/>conversion<sp/>tables<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_CODE_PAGE<sp/>==<sp/>932<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Japanese<sp/>Shift-JIS<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="89" refid="ff_8c_1a228bfd2cabe490c8567aaf08b8b2cc14" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF1S<sp/><sp/><sp/>0x81<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>DBC<sp/>1st<sp/>byte<sp/>range<sp/>1<sp/>start<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="90" refid="ff_8c_1ad6ce87cea84298e562cae4f6cde3c341" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF1E<sp/><sp/><sp/>0x9F<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>DBC<sp/>1st<sp/>byte<sp/>range<sp/>1<sp/>end<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="91" refid="ff_8c_1a89ebd362b483a3a465fb485c9535a3c4" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF2S<sp/><sp/><sp/>0xE0<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>DBC<sp/>1st<sp/>byte<sp/>range<sp/>2<sp/>start<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="92" refid="ff_8c_1ae92fde14909ccf6bec27f051a4b88a79" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF2E<sp/><sp/><sp/>0xFC<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>DBC<sp/>1st<sp/>byte<sp/>range<sp/>2<sp/>end<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="93" refid="ff_8c_1a866564522f9fb431919f86ae507c42ef" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DS1S<sp/><sp/><sp/>0x40<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>DBC<sp/>2nd<sp/>byte<sp/>range<sp/>1<sp/>start<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="94" refid="ff_8c_1a97cf766baca26c0ac1110df26e479c4c" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DS1E<sp/><sp/><sp/>0x7E<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>DBC<sp/>2nd<sp/>byte<sp/>range<sp/>1<sp/>end<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="95" refid="ff_8c_1a6fd34725741cf6dc0524df2adbbb5a94" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DS2S<sp/><sp/><sp/>0x80<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>DBC<sp/>2nd<sp/>byte<sp/>range<sp/>2<sp/>start<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="96" refid="ff_8c_1a0e747e5204b28f9c72c91cee52fde572" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DS2E<sp/><sp/><sp/>0xFC<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>DBC<sp/>2nd<sp/>byte<sp/>range<sp/>2<sp/>end<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="97"><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_CODE_PAGE<sp/>==<sp/>936<sp/></highlight><highlight class="comment">/*<sp/>Simplified<sp/>Chinese<sp/>GBK<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="99"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF1S<sp/><sp/><sp/>0x81</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="100"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF1E<sp/><sp/><sp/>0xFE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DS1S<sp/><sp/><sp/>0x40</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DS1E<sp/><sp/><sp/>0x7E</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="103"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DS2S<sp/><sp/><sp/>0x80</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="104"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DS2E<sp/><sp/><sp/>0xFE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_CODE_PAGE<sp/>==<sp/>949<sp/></highlight><highlight class="comment">/*<sp/>Korean<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF1S<sp/><sp/><sp/>0x81</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF1E<sp/><sp/><sp/>0xFE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DS1S<sp/><sp/><sp/>0x41</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="110"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DS1E<sp/><sp/><sp/>0x5A</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="111"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DS2S<sp/><sp/><sp/>0x61</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DS2E<sp/><sp/><sp/>0x7A</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DS3S<sp/><sp/><sp/>0x81</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DS3E<sp/><sp/><sp/>0xFE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="115"><highlight class="normal"></highlight></codeline>
<codeline lineno="116"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_CODE_PAGE<sp/>==<sp/>950<sp/></highlight><highlight class="comment">/*<sp/>Traditional<sp/>Chinese<sp/>Big5<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF1S<sp/><sp/><sp/>0x81</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="118"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF1E<sp/><sp/><sp/>0xFE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="119"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DS1S<sp/><sp/><sp/>0x40</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="120"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DS1E<sp/><sp/><sp/>0x7E</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="121"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DS2S<sp/><sp/><sp/>0xA1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DS2E<sp/><sp/><sp/>0xFE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="123"><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_CODE_PAGE<sp/>==<sp/>437<sp/></highlight><highlight class="comment">/*<sp/>U.S.<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF1S<sp/><sp/><sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="126"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_EXCVT<sp/>{0x80,0x9A,0x45,0x41,0x8E,0x41,0x8F,0x80,0x45,0x45,0x45,0x49,0x49,0x49,0x8E,0x8F,<sp/>\</highlight></codeline>
<codeline lineno="127"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x90,0x92,0x92,0x4F,0x99,0x4F,0x55,0x55,0x59,0x99,0x9A,0x9B,0x9C,0x9D,0x9E,0x9F,<sp/>\</highlight></codeline>
<codeline lineno="128"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x41,0x49,0x4F,0x55,0xA5,0xA5,0xA6,0xA7,0xA8,0xA9,0xAA,0xAB,0xAC,0xAD,0xAE,0xAF,<sp/>\</highlight></codeline>
<codeline lineno="129"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF,<sp/>\</highlight></codeline>
<codeline lineno="130"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF,<sp/>\</highlight></codeline>
<codeline lineno="131"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xD0,0xD1,0xD2,0xD3,0xD4,0xD5,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF,<sp/>\</highlight></codeline>
<codeline lineno="132"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xE0,0xE1,0xE2,0xE3,0xE4,0xE5,0xE6,0xE7,0xE8,0xE9,0xEA,0xEB,0xEC,0xED,0xEE,0xEF,<sp/>\</highlight></codeline>
<codeline lineno="133"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="134"><highlight class="normal"></highlight></codeline>
<codeline lineno="135"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_CODE_PAGE<sp/>==<sp/>720<sp/></highlight><highlight class="comment">/*<sp/>Arabic<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="136"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF1S<sp/><sp/><sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="137"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_EXCVT<sp/>{0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F,<sp/>\</highlight></codeline>
<codeline lineno="138"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x90,0x91,0x92,0x93,0x94,0x95,0x96,0x97,0x98,0x99,0x9A,0x9B,0x9C,0x9D,0x9E,0x9F,<sp/>\</highlight></codeline>
<codeline lineno="139"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xA0,0xA1,0xA2,0xA3,0xA4,0xA5,0xA6,0xA7,0xA8,0xA9,0xAA,0xAB,0xAC,0xAD,0xAE,0xAF,<sp/>\</highlight></codeline>
<codeline lineno="140"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF,<sp/>\</highlight></codeline>
<codeline lineno="141"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF,<sp/>\</highlight></codeline>
<codeline lineno="142"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xD0,0xD1,0xD2,0xD3,0xD4,0xD5,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF,<sp/>\</highlight></codeline>
<codeline lineno="143"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xE0,0xE1,0xE2,0xE3,0xE4,0xE5,0xE6,0xE7,0xE8,0xE9,0xEA,0xEB,0xEC,0xED,0xEE,0xEF,<sp/>\</highlight></codeline>
<codeline lineno="144"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"></highlight></codeline>
<codeline lineno="146"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_CODE_PAGE<sp/>==<sp/>737<sp/></highlight><highlight class="comment">/*<sp/>Greek<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="147"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF1S<sp/><sp/><sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="148"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_EXCVT<sp/>{0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F,<sp/>\</highlight></codeline>
<codeline lineno="149"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x90,0x92,0x92,0x93,0x94,0x95,0x96,0x97,0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,<sp/>\</highlight></codeline>
<codeline lineno="150"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F,0x90,0x91,0xAA,0x92,0x93,0x94,0x95,0x96,<sp/>\</highlight></codeline>
<codeline lineno="151"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF,<sp/>\</highlight></codeline>
<codeline lineno="152"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF,<sp/>\</highlight></codeline>
<codeline lineno="153"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xD0,0xD1,0xD2,0xD3,0xD4,0xD5,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF,<sp/>\</highlight></codeline>
<codeline lineno="154"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x97,0xEA,0xEB,0xEC,0xE4,0xED,0xEE,0xEF,0xF5,0xF0,0xEA,0xEB,0xEC,0xED,0xEE,0xEF,<sp/>\</highlight></codeline>
<codeline lineno="155"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="156"><highlight class="normal"></highlight></codeline>
<codeline lineno="157"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_CODE_PAGE<sp/>==<sp/>771<sp/></highlight><highlight class="comment">/*<sp/>KBL<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF1S<sp/><sp/><sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="159"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_EXCVT<sp/>{0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F,<sp/>\</highlight></codeline>
<codeline lineno="160"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x90,0x91,0x92,0x93,0x94,0x95,0x96,0x97,0x98,0x99,0x9A,0x9B,0x9C,0x9D,0x9E,0x9F,<sp/>\</highlight></codeline>
<codeline lineno="161"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F,<sp/>\</highlight></codeline>
<codeline lineno="162"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF,<sp/>\</highlight></codeline>
<codeline lineno="163"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF,<sp/>\</highlight></codeline>
<codeline lineno="164"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xD0,0xD1,0xD2,0xD3,0xD4,0xD5,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDC,0xDC,0xDE,0xDE,<sp/>\</highlight></codeline>
<codeline lineno="165"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x90,0x91,0x92,0x93,0x94,0x95,0x96,0x97,0x98,0x99,0x9A,0x9B,0x9C,0x9D,0x9E,0x9F,<sp/>\</highlight></codeline>
<codeline lineno="166"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xF0,0xF0,0xF2,0xF2,0xF4,0xF4,0xF6,0xF6,0xF8,0xF8,0xFA,0xFA,0xFC,0xFC,0xFE,0xFF}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_CODE_PAGE<sp/>==<sp/>775<sp/></highlight><highlight class="comment">/*<sp/>Baltic<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="169"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF1S<sp/><sp/><sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="170"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_EXCVT<sp/>{0x80,0x9A,0x91,0xA0,0x8E,0x95,0x8F,0x80,0xAD,0xED,0x8A,0x8A,0xA1,0x8D,0x8E,0x8F,<sp/>\</highlight></codeline>
<codeline lineno="171"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x90,0x92,0x92,0xE2,0x99,0x95,0x96,0x97,0x97,0x99,0x9A,0x9D,0x9C,0x9D,0x9E,0x9F,<sp/>\</highlight></codeline>
<codeline lineno="172"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xA0,0xA1,0xE0,0xA3,0xA3,0xA5,0xA6,0xA7,0xA8,0xA9,0xAA,0xAB,0xAC,0xAD,0xAE,0xAF,<sp/>\</highlight></codeline>
<codeline lineno="173"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF,<sp/>\</highlight></codeline>
<codeline lineno="174"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF,<sp/>\</highlight></codeline>
<codeline lineno="175"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xB5,0xB6,0xB7,0xB8,0xBD,0xBE,0xC6,0xC7,0xA5,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF,<sp/>\</highlight></codeline>
<codeline lineno="176"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xE0,0xE1,0xE2,0xE3,0xE5,0xE5,0xE6,0xE3,0xE8,0xE8,0xEA,0xEA,0xEE,0xED,0xEE,0xEF,<sp/>\</highlight></codeline>
<codeline lineno="177"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"></highlight></codeline>
<codeline lineno="179"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_CODE_PAGE<sp/>==<sp/>850<sp/></highlight><highlight class="comment">/*<sp/>Latin<sp/>1<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF1S<sp/><sp/><sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="181"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_EXCVT<sp/>{0x43,0x55,0x45,0x41,0x41,0x41,0x41,0x43,0x45,0x45,0x45,0x49,0x49,0x49,0x41,0x41,<sp/>\</highlight></codeline>
<codeline lineno="182"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x45,0x92,0x92,0x4F,0x4F,0x4F,0x55,0x55,0x59,0x4F,0x55,0x4F,0x9C,0x4F,0x9E,0x9F,<sp/>\</highlight></codeline>
<codeline lineno="183"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x41,0x49,0x4F,0x55,0xA5,0xA5,0xA6,0xA7,0xA8,0xA9,0xAA,0xAB,0xAC,0xAD,0xAE,0xAF,<sp/>\</highlight></codeline>
<codeline lineno="184"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xB0,0xB1,0xB2,0xB3,0xB4,0x41,0x41,0x41,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF,<sp/>\</highlight></codeline>
<codeline lineno="185"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0x41,0x41,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF,<sp/>\</highlight></codeline>
<codeline lineno="186"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xD1,0xD1,0x45,0x45,0x45,0x49,0x49,0x49,0x49,0xD9,0xDA,0xDB,0xDC,0xDD,0x49,0xDF,<sp/>\</highlight></codeline>
<codeline lineno="187"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x4F,0xE1,0x4F,0x4F,0x4F,0x4F,0xE6,0xE8,0xE8,0x55,0x55,0x55,0x59,0x59,0xEE,0xEF,<sp/>\</highlight></codeline>
<codeline lineno="188"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="189"><highlight class="normal"></highlight></codeline>
<codeline lineno="190"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_CODE_PAGE<sp/>==<sp/>852<sp/></highlight><highlight class="comment">/*<sp/>Latin<sp/>2<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF1S<sp/><sp/><sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_EXCVT<sp/>{0x80,0x9A,0x90,0xB6,0x8E,0xDE,0x8F,0x80,0x9D,0xD3,0x8A,0x8A,0xD7,0x8D,0x8E,0x8F,<sp/>\</highlight></codeline>
<codeline lineno="193"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x90,0x91,0x91,0xE2,0x99,0x95,0x95,0x97,0x97,0x99,0x9A,0x9B,0x9B,0x9D,0x9E,0xAC,<sp/>\</highlight></codeline>
<codeline lineno="194"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xB5,0xD6,0xE0,0xE9,0xA4,0xA4,0xA6,0xA6,0xA8,0xA8,0xAA,0x8D,0xAC,0xB8,0xAE,0xAF,<sp/>\</highlight></codeline>
<codeline lineno="195"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBD,0xBF,<sp/>\</highlight></codeline>
<codeline lineno="196"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC6,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF,<sp/>\</highlight></codeline>
<codeline lineno="197"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xD1,0xD1,0xD2,0xD3,0xD2,0xD5,0xD6,0xD7,0xB7,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF,<sp/>\</highlight></codeline>
<codeline lineno="198"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xE0,0xE1,0xE2,0xE3,0xE3,0xD5,0xE6,0xE6,0xE8,0xE9,0xE8,0xEB,0xED,0xED,0xDD,0xEF,<sp/>\</highlight></codeline>
<codeline lineno="199"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xEB,0xFC,0xFC,0xFE,0xFF}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_CODE_PAGE<sp/>==<sp/>855<sp/></highlight><highlight class="comment">/*<sp/>Cyrillic<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF1S<sp/><sp/><sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_EXCVT<sp/>{0x81,0x81,0x83,0x83,0x85,0x85,0x87,0x87,0x89,0x89,0x8B,0x8B,0x8D,0x8D,0x8F,0x8F,<sp/>\</highlight></codeline>
<codeline lineno="204"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x91,0x91,0x93,0x93,0x95,0x95,0x97,0x97,0x99,0x99,0x9B,0x9B,0x9D,0x9D,0x9F,0x9F,<sp/>\</highlight></codeline>
<codeline lineno="205"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xA1,0xA1,0xA3,0xA3,0xA5,0xA5,0xA7,0xA7,0xA9,0xA9,0xAB,0xAB,0xAD,0xAD,0xAE,0xAF,<sp/>\</highlight></codeline>
<codeline lineno="206"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xB0,0xB1,0xB2,0xB3,0xB4,0xB6,0xB6,0xB8,0xB8,0xB9,0xBA,0xBB,0xBC,0xBE,0xBE,0xBF,<sp/>\</highlight></codeline>
<codeline lineno="207"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC7,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF,<sp/>\</highlight></codeline>
<codeline lineno="208"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xD1,0xD1,0xD3,0xD3,0xD5,0xD5,0xD7,0xD7,0xDD,0xD9,0xDA,0xDB,0xDC,0xDD,0xE0,0xDF,<sp/>\</highlight></codeline>
<codeline lineno="209"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xE0,0xE2,0xE2,0xE4,0xE4,0xE6,0xE6,0xE8,0xE8,0xEA,0xEA,0xEC,0xEC,0xEE,0xEE,0xEF,<sp/>\</highlight></codeline>
<codeline lineno="210"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xF0,0xF2,0xF2,0xF4,0xF4,0xF6,0xF6,0xF8,0xF8,0xFA,0xFA,0xFC,0xFC,0xFD,0xFE,0xFF}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="211"><highlight class="normal"></highlight></codeline>
<codeline lineno="212"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_CODE_PAGE<sp/>==<sp/>857<sp/></highlight><highlight class="comment">/*<sp/>Turkish<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="213"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF1S<sp/><sp/><sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="214"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_EXCVT<sp/>{0x80,0x9A,0x90,0xB6,0x8E,0xB7,0x8F,0x80,0xD2,0xD3,0xD4,0xD8,0xD7,0x49,0x8E,0x8F,<sp/>\</highlight></codeline>
<codeline lineno="215"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x90,0x92,0x92,0xE2,0x99,0xE3,0xEA,0xEB,0x98,0x99,0x9A,0x9D,0x9C,0x9D,0x9E,0x9E,<sp/>\</highlight></codeline>
<codeline lineno="216"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xB5,0xD6,0xE0,0xE9,0xA5,0xA5,0xA6,0xA6,0xA8,0xA9,0xAA,0xAB,0xAC,0xAD,0xAE,0xAF,<sp/>\</highlight></codeline>
<codeline lineno="217"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF,<sp/>\</highlight></codeline>
<codeline lineno="218"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC7,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF,<sp/>\</highlight></codeline>
<codeline lineno="219"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xD0,0xD1,0xD2,0xD3,0xD4,0x49,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF,<sp/>\</highlight></codeline>
<codeline lineno="220"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xE0,0xE1,0xE2,0xE3,0xE5,0xE5,0xE6,0xE7,0xE8,0xE9,0xEA,0xEB,0xDE,0xED,0xEE,0xEF,<sp/>\</highlight></codeline>
<codeline lineno="221"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="222"><highlight class="normal"></highlight></codeline>
<codeline lineno="223"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_CODE_PAGE<sp/>==<sp/>860<sp/></highlight><highlight class="comment">/*<sp/>Portuguese<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="224"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF1S<sp/><sp/><sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="225"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_EXCVT<sp/>{0x80,0x9A,0x90,0x8F,0x8E,0x91,0x86,0x80,0x89,0x89,0x92,0x8B,0x8C,0x98,0x8E,0x8F,<sp/>\</highlight></codeline>
<codeline lineno="226"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x90,0x91,0x92,0x8C,0x99,0xA9,0x96,0x9D,0x98,0x99,0x9A,0x9B,0x9C,0x9D,0x9E,0x9F,<sp/>\</highlight></codeline>
<codeline lineno="227"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x86,0x8B,0x9F,0x96,0xA5,0xA5,0xA6,0xA7,0xA8,0xA9,0xAA,0xAB,0xAC,0xAD,0xAE,0xAF,<sp/>\</highlight></codeline>
<codeline lineno="228"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF,<sp/>\</highlight></codeline>
<codeline lineno="229"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF,<sp/>\</highlight></codeline>
<codeline lineno="230"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xD0,0xD1,0xD2,0xD3,0xD4,0xD5,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF,<sp/>\</highlight></codeline>
<codeline lineno="231"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xE0,0xE1,0xE2,0xE3,0xE4,0xE5,0xE6,0xE7,0xE8,0xE9,0xEA,0xEB,0xEC,0xED,0xEE,0xEF,<sp/>\</highlight></codeline>
<codeline lineno="232"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="233"><highlight class="normal"></highlight></codeline>
<codeline lineno="234"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_CODE_PAGE<sp/>==<sp/>861<sp/></highlight><highlight class="comment">/*<sp/>Icelandic<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="235"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF1S<sp/><sp/><sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="236"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_EXCVT<sp/>{0x80,0x9A,0x90,0x41,0x8E,0x41,0x8F,0x80,0x45,0x45,0x45,0x8B,0x8B,0x8D,0x8E,0x8F,<sp/>\</highlight></codeline>
<codeline lineno="237"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x90,0x92,0x92,0x4F,0x99,0x8D,0x55,0x97,0x97,0x99,0x9A,0x9D,0x9C,0x9D,0x9E,0x9F,<sp/>\</highlight></codeline>
<codeline lineno="238"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xA4,0xA5,0xA6,0xA7,0xA4,0xA5,0xA6,0xA7,0xA8,0xA9,0xAA,0xAB,0xAC,0xAD,0xAE,0xAF,<sp/>\</highlight></codeline>
<codeline lineno="239"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF,<sp/>\</highlight></codeline>
<codeline lineno="240"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF,<sp/>\</highlight></codeline>
<codeline lineno="241"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xD0,0xD1,0xD2,0xD3,0xD4,0xD5,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF,<sp/>\</highlight></codeline>
<codeline lineno="242"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xE0,0xE1,0xE2,0xE3,0xE4,0xE5,0xE6,0xE7,0xE8,0xE9,0xEA,0xEB,0xEC,0xED,0xEE,0xEF,<sp/>\</highlight></codeline>
<codeline lineno="243"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_CODE_PAGE<sp/>==<sp/>862<sp/></highlight><highlight class="comment">/*<sp/>Hebrew<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="246"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF1S<sp/><sp/><sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="247"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_EXCVT<sp/>{0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F,<sp/>\</highlight></codeline>
<codeline lineno="248"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x90,0x91,0x92,0x93,0x94,0x95,0x96,0x97,0x98,0x99,0x9A,0x9B,0x9C,0x9D,0x9E,0x9F,<sp/>\</highlight></codeline>
<codeline lineno="249"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x41,0x49,0x4F,0x55,0xA5,0xA5,0xA6,0xA7,0xA8,0xA9,0xAA,0xAB,0xAC,0xAD,0xAE,0xAF,<sp/>\</highlight></codeline>
<codeline lineno="250"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF,<sp/>\</highlight></codeline>
<codeline lineno="251"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF,<sp/>\</highlight></codeline>
<codeline lineno="252"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xD0,0xD1,0xD2,0xD3,0xD4,0xD5,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF,<sp/>\</highlight></codeline>
<codeline lineno="253"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xE0,0xE1,0xE2,0xE3,0xE4,0xE5,0xE6,0xE7,0xE8,0xE9,0xEA,0xEB,0xEC,0xED,0xEE,0xEF,<sp/>\</highlight></codeline>
<codeline lineno="254"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="255"><highlight class="normal"></highlight></codeline>
<codeline lineno="256"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_CODE_PAGE<sp/>==<sp/>863<sp/></highlight><highlight class="comment">/*<sp/>Canadian-French<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="257"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF1S<sp/><sp/><sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="258"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_EXCVT<sp/>{0x43,0x55,0x45,0x41,0x41,0x41,0x86,0x43,0x45,0x45,0x45,0x49,0x49,0x8D,0x41,0x8F,<sp/>\</highlight></codeline>
<codeline lineno="259"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x45,0x45,0x45,0x4F,0x45,0x49,0x55,0x55,0x98,0x4F,0x55,0x9B,0x9C,0x55,0x55,0x9F,<sp/>\</highlight></codeline>
<codeline lineno="260"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xA0,0xA1,0x4F,0x55,0xA4,0xA5,0xA6,0xA7,0x49,0xA9,0xAA,0xAB,0xAC,0xAD,0xAE,0xAF,<sp/>\</highlight></codeline>
<codeline lineno="261"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF,<sp/>\</highlight></codeline>
<codeline lineno="262"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF,<sp/>\</highlight></codeline>
<codeline lineno="263"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xD0,0xD1,0xD2,0xD3,0xD4,0xD5,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF,<sp/>\</highlight></codeline>
<codeline lineno="264"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xE0,0xE1,0xE2,0xE3,0xE4,0xE5,0xE6,0xE7,0xE8,0xE9,0xEA,0xEB,0xEC,0xED,0xEE,0xEF,<sp/>\</highlight></codeline>
<codeline lineno="265"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="266"><highlight class="normal"></highlight></codeline>
<codeline lineno="267"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_CODE_PAGE<sp/>==<sp/>864<sp/></highlight><highlight class="comment">/*<sp/>Arabic<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="268"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF1S<sp/><sp/><sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="269"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_EXCVT<sp/>{0x80,0x9A,0x45,0x41,0x8E,0x41,0x8F,0x80,0x45,0x45,0x45,0x49,0x49,0x49,0x8E,0x8F,<sp/>\</highlight></codeline>
<codeline lineno="270"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x90,0x92,0x92,0x4F,0x99,0x4F,0x55,0x55,0x59,0x99,0x9A,0x9B,0x9C,0x9D,0x9E,0x9F,<sp/>\</highlight></codeline>
<codeline lineno="271"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x41,0x49,0x4F,0x55,0xA5,0xA5,0xA6,0xA7,0xA8,0xA9,0xAA,0xAB,0xAC,0xAD,0xAE,0xAF,<sp/>\</highlight></codeline>
<codeline lineno="272"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF,<sp/>\</highlight></codeline>
<codeline lineno="273"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF,<sp/>\</highlight></codeline>
<codeline lineno="274"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xD0,0xD1,0xD2,0xD3,0xD4,0xD5,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF,<sp/>\</highlight></codeline>
<codeline lineno="275"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xE0,0xE1,0xE2,0xE3,0xE4,0xE5,0xE6,0xE7,0xE8,0xE9,0xEA,0xEB,0xEC,0xED,0xEE,0xEF,<sp/>\</highlight></codeline>
<codeline lineno="276"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="277"><highlight class="normal"></highlight></codeline>
<codeline lineno="278"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_CODE_PAGE<sp/>==<sp/>865<sp/></highlight><highlight class="comment">/*<sp/>Nordic<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="279"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF1S<sp/><sp/><sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="280"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_EXCVT<sp/>{0x80,0x9A,0x90,0x41,0x8E,0x41,0x8F,0x80,0x45,0x45,0x45,0x49,0x49,0x49,0x8E,0x8F,<sp/>\</highlight></codeline>
<codeline lineno="281"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x90,0x92,0x92,0x4F,0x99,0x4F,0x55,0x55,0x59,0x99,0x9A,0x9B,0x9C,0x9D,0x9E,0x9F,<sp/>\</highlight></codeline>
<codeline lineno="282"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x41,0x49,0x4F,0x55,0xA5,0xA5,0xA6,0xA7,0xA8,0xA9,0xAA,0xAB,0xAC,0xAD,0xAE,0xAF,<sp/>\</highlight></codeline>
<codeline lineno="283"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF,<sp/>\</highlight></codeline>
<codeline lineno="284"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF,<sp/>\</highlight></codeline>
<codeline lineno="285"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xD0,0xD1,0xD2,0xD3,0xD4,0xD5,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF,<sp/>\</highlight></codeline>
<codeline lineno="286"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xE0,0xE1,0xE2,0xE3,0xE4,0xE5,0xE6,0xE7,0xE8,0xE9,0xEA,0xEB,0xEC,0xED,0xEE,0xEF,<sp/>\</highlight></codeline>
<codeline lineno="287"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="288"><highlight class="normal"></highlight></codeline>
<codeline lineno="289"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_CODE_PAGE<sp/>==<sp/>866<sp/></highlight><highlight class="comment">/*<sp/>Russian<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="290"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF1S<sp/><sp/><sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="291"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_EXCVT<sp/>{0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F,<sp/>\</highlight></codeline>
<codeline lineno="292"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x90,0x91,0x92,0x93,0x94,0x95,0x96,0x97,0x98,0x99,0x9A,0x9B,0x9C,0x9D,0x9E,0x9F,<sp/>\</highlight></codeline>
<codeline lineno="293"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F,<sp/>\</highlight></codeline>
<codeline lineno="294"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF,<sp/>\</highlight></codeline>
<codeline lineno="295"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF,<sp/>\</highlight></codeline>
<codeline lineno="296"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xD0,0xD1,0xD2,0xD3,0xD4,0xD5,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF,<sp/>\</highlight></codeline>
<codeline lineno="297"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x90,0x91,0x92,0x93,0x9d,0x95,0x96,0x97,0x98,0x99,0x9A,0x9B,0x9C,0x9D,0x9E,0x9F,<sp/>\</highlight></codeline>
<codeline lineno="298"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xF0,0xF0,0xF2,0xF2,0xF4,0xF4,0xF6,0xF6,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="299"><highlight class="normal"></highlight></codeline>
<codeline lineno="300"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_CODE_PAGE<sp/>==<sp/>869<sp/></highlight><highlight class="comment">/*<sp/>Greek<sp/>2<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="301"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF1S<sp/><sp/><sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="302"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_EXCVT<sp/>{0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F,<sp/>\</highlight></codeline>
<codeline lineno="303"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x90,0x91,0x92,0x93,0x94,0x95,0x96,0x97,0x98,0x99,0x9A,0x86,0x9C,0x8D,0x8F,0x90,<sp/>\</highlight></codeline>
<codeline lineno="304"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x91,0x90,0x92,0x95,0xA4,0xA5,0xA6,0xA7,0xA8,0xA9,0xAA,0xAB,0xAC,0xAD,0xAE,0xAF,<sp/>\</highlight></codeline>
<codeline lineno="305"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF,<sp/>\</highlight></codeline>
<codeline lineno="306"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF,<sp/>\</highlight></codeline>
<codeline lineno="307"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xD0,0xD1,0xD2,0xD3,0xD4,0xD5,0xA4,0xA5,0xA6,0xD9,0xDA,0xDB,0xDC,0xA7,0xA8,0xDF,<sp/>\</highlight></codeline>
<codeline lineno="308"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xA9,0xAA,0xAC,0xAD,0xB5,0xB6,0xB7,0xB8,0xBD,0xBE,0xC6,0xC7,0xCF,0xCF,0xD0,0xEF,<sp/>\</highlight></codeline>
<codeline lineno="309"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xF0,0xF1,0xD1,0xD2,0xD3,0xF5,0xD4,0xF7,0xF8,0xF9,0xD5,0x96,0x95,0x98,0xFE,0xFF}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="310"><highlight class="normal"></highlight></codeline>
<codeline lineno="311"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_CODE_PAGE<sp/>==<sp/>1<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>ASCII<sp/>(for<sp/>only<sp/>non-LFN<sp/>cfg)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="312"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"></highlight><highlight class="preprocessor">#error<sp/>Cannot<sp/>use<sp/>LFN<sp/>feature<sp/>without<sp/>valid<sp/>code<sp/>page.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="314"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="315"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_DF1S<sp/><sp/><sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="316"><highlight class="normal"></highlight></codeline>
<codeline lineno="317"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="318"><highlight class="normal"></highlight><highlight class="preprocessor">#error<sp/>Unknown<sp/>code<sp/>page</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="319"><highlight class="normal"></highlight></codeline>
<codeline lineno="320"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="321"><highlight class="normal"></highlight></codeline>
<codeline lineno="322"><highlight class="normal"></highlight></codeline>
<codeline lineno="323"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Character<sp/>code<sp/>support<sp/>macros<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="324" refid="ff_8c_1a89b2514198590e139dd064c5d534f302" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>IsUpper(c)<sp/><sp/>(((c)&gt;=&apos;A&apos;)&amp;&amp;((c)&lt;=&apos;Z&apos;))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="325" refid="ff_8c_1a4a9d454724926bd51a3aed589a97f08b" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>IsLower(c)<sp/><sp/>(((c)&gt;=&apos;a&apos;)&amp;&amp;((c)&lt;=&apos;z&apos;))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="326" refid="ff_8c_1a65dee564f69f2ec27f25b67a348018b9" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>IsDigit(c)<sp/><sp/>(((c)&gt;=&apos;0&apos;)&amp;&amp;((c)&lt;=&apos;9&apos;))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="327"><highlight class="normal"></highlight></codeline>
<codeline lineno="328"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_DF1S<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Code<sp/>page<sp/>is<sp/>DBCS<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="329"><highlight class="normal"></highlight></codeline>
<codeline lineno="330"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>_DF2S<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Two<sp/>1st<sp/>byte<sp/>areas<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="331" refid="ff_8c_1a58d63a832a117f179e41c7373d013dd6" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>IsDBCS1(c)<sp/><sp/>(((BYTE)(c)<sp/>&gt;=<sp/>_DF1S<sp/>&amp;&amp;<sp/>(BYTE)(c)<sp/>&lt;=<sp/>_DF1E)<sp/>||<sp/>((BYTE)(c)<sp/>&gt;=<sp/>_DF2S<sp/>&amp;&amp;<sp/>(BYTE)(c)<sp/>&lt;=<sp/>_DF2E))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="332"><highlight class="normal"></highlight><highlight class="preprocessor">#else<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>One<sp/>1st<sp/>byte<sp/>area<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="333"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>IsDBCS1(c)<sp/><sp/>((BYTE)(c)<sp/>&gt;=<sp/>_DF1S<sp/>&amp;&amp;<sp/>(BYTE)(c)<sp/>&lt;=<sp/>_DF1E)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="334"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="335"><highlight class="normal"></highlight></codeline>
<codeline lineno="336"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>_DS3S<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Three<sp/>2nd<sp/>byte<sp/>areas<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="337"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>IsDBCS2(c)<sp/><sp/>(((BYTE)(c)<sp/>&gt;=<sp/>_DS1S<sp/>&amp;&amp;<sp/>(BYTE)(c)<sp/>&lt;=<sp/>_DS1E)<sp/>||<sp/>((BYTE)(c)<sp/>&gt;=<sp/>_DS2S<sp/>&amp;&amp;<sp/>(BYTE)(c)<sp/>&lt;=<sp/>_DS2E)<sp/>||<sp/>((BYTE)(c)<sp/>&gt;=<sp/>_DS3S<sp/>&amp;&amp;<sp/>(BYTE)(c)<sp/>&lt;=<sp/>_DS3E))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="338"><highlight class="normal"></highlight><highlight class="preprocessor">#else<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Two<sp/>2nd<sp/>byte<sp/>areas<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="339" refid="ff_8c_1a66a3fa880af6078ef181656c1d7d8ef1" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>IsDBCS2(c)<sp/><sp/>(((BYTE)(c)<sp/>&gt;=<sp/>_DS1S<sp/>&amp;&amp;<sp/>(BYTE)(c)<sp/>&lt;=<sp/>_DS1E)<sp/>||<sp/>((BYTE)(c)<sp/>&gt;=<sp/>_DS2S<sp/>&amp;&amp;<sp/>(BYTE)(c)<sp/>&lt;=<sp/>_DS2E))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="340"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="341"><highlight class="normal"></highlight></codeline>
<codeline lineno="342"><highlight class="normal"></highlight><highlight class="preprocessor">#else<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Code<sp/>page<sp/>is<sp/>SBCS<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="343"><highlight class="normal"></highlight></codeline>
<codeline lineno="344"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>IsDBCS1(c)<sp/><sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="345"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>IsDBCS2(c)<sp/><sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="346"><highlight class="normal"></highlight></codeline>
<codeline lineno="347"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>_DF1S<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="348"><highlight class="normal"></highlight></codeline>
<codeline lineno="349"><highlight class="normal"></highlight></codeline>
<codeline lineno="350"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Name<sp/>status<sp/>flags<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="351" refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>NSFLAG<sp/><sp/><sp/><sp/><sp/><sp/>11<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Index<sp/>of<sp/>name<sp/>status<sp/>byte<sp/>in<sp/>fn[]<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="352" refid="ff_8c_1ac92c92c3a3d6b9235ac98feeb00e565a" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>NS_LOSS<sp/><sp/><sp/><sp/><sp/>0x01<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Out<sp/>of<sp/>8.3<sp/>format<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="353" refid="ff_8c_1ae957b8d4065ea0b3eed822aec5368d29" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>NS_LFN<sp/><sp/><sp/><sp/><sp/><sp/>0x02<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Force<sp/>to<sp/>create<sp/>LFN<sp/>entry<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="354" refid="ff_8c_1a5a0742bfc1d94f0c3baa5ede485048c4" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>NS_LAST<sp/><sp/><sp/><sp/><sp/>0x04<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Last<sp/>segment<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="355" refid="ff_8c_1a4a0e89b504dece19e2e4b02c83782ca2" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>NS_BODY<sp/><sp/><sp/><sp/><sp/>0x08<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Lower<sp/>case<sp/>flag<sp/>(body)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="356" refid="ff_8c_1a3b7fad0942e816fdb84d869c1f7a613e" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>NS_EXT<sp/><sp/><sp/><sp/><sp/><sp/>0x10<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Lower<sp/>case<sp/>flag<sp/>(ext)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="357" refid="ff_8c_1a2db528782a021797b34bdc6e9e9de1c3" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>NS_DOT<sp/><sp/><sp/><sp/><sp/><sp/>0x20<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Dot<sp/>entry<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="358"><highlight class="normal"></highlight></codeline>
<codeline lineno="359"><highlight class="normal"></highlight></codeline>
<codeline lineno="360"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>FAT<sp/>sub-type<sp/>boundaries<sp/>(Differ<sp/>from<sp/>specs<sp/>but<sp/>correct<sp/>for<sp/>real<sp/>DOS/Windows)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="361" refid="ff_8c_1aeec02d5ae07ede32b7d74155bf0fda15" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>MIN_FAT16<sp/><sp/><sp/>4086U<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Minimum<sp/>number<sp/>of<sp/>clusters<sp/>of<sp/>FAT16<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="362" refid="ff_8c_1a483625319f3e3bd5ac6502b46c375aed" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>MIN_FAT32<sp/><sp/><sp/>65526U<sp/><sp/></highlight><highlight class="comment">/*<sp/>Minimum<sp/>number<sp/>of<sp/>clusters<sp/>of<sp/>FAT32<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="363"><highlight class="normal"></highlight></codeline>
<codeline lineno="364"><highlight class="normal"></highlight></codeline>
<codeline lineno="365"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>FatFs<sp/>refers<sp/>the<sp/>members<sp/>in<sp/>the<sp/>FAT<sp/>structures<sp/>as<sp/>byte<sp/>array<sp/>instead<sp/>of</highlight></codeline>
<codeline lineno="366"><highlight class="comment">/<sp/>structure<sp/>members<sp/>because<sp/>the<sp/>structure<sp/>is<sp/>not<sp/>binary<sp/>compatible<sp/>between</highlight></codeline>
<codeline lineno="367"><highlight class="comment">/<sp/>different<sp/>platforms<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="368"><highlight class="normal"></highlight></codeline>
<codeline lineno="369" refid="ff_8c_1a8f81669ee736efb2b2b49c7b0985472d" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BS_jmpBoot<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>x86<sp/>jump<sp/>instruction<sp/>(3)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="370" refid="ff_8c_1a02a76ada191ec2dc5f8af60ff3576da7" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BS_OEMName<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>3<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>OEM<sp/>name<sp/>(8)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="371" refid="ff_8c_1a8551844b4eb4e15aecd8cc9aa3585fa2" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BPB_BytsPerSec<sp/><sp/><sp/><sp/><sp/><sp/>11<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Sector<sp/>size<sp/>[byte]<sp/>(2)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="372" refid="ff_8c_1aab78e41c617a14b9540c0563d6b957fa" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BPB_SecPerClus<sp/><sp/><sp/><sp/><sp/><sp/>13<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Cluster<sp/>size<sp/>[sector]<sp/>(1)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="373" refid="ff_8c_1ab3ec444c8457c9bc98aa07e846f5c1b7" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BPB_RsvdSecCnt<sp/><sp/><sp/><sp/><sp/><sp/>14<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Size<sp/>of<sp/>reserved<sp/>area<sp/>[sector]<sp/>(2)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="374" refid="ff_8c_1af44a1e8c89ec5502595f23496d24cbf1" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BPB_NumFATs<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>16<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>FAT<sp/>copies<sp/>(1)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="375" refid="ff_8c_1aaa667f14c87c45dc128f2ab208e92f98" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BPB_RootEntCnt<sp/><sp/><sp/><sp/><sp/><sp/>17<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>root<sp/>directory<sp/>entries<sp/>for<sp/>FAT12/16<sp/>(2)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="376" refid="ff_8c_1a4eb540eecde0f2df26fa8c7969341d68" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BPB_TotSec16<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>19<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Volume<sp/>size<sp/>[sector]<sp/>(2)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="377" refid="ff_8c_1a414e054c4b5ea3414ebefa3539e7e554" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BPB_Media<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>21<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Media<sp/>descriptor<sp/>(1)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="378" refid="ff_8c_1a60a2f6efeb6a4c7cb2da1e5def6ca43b" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BPB_FATSz16<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>22<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FAT<sp/>size<sp/>[sector]<sp/>(2)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="379" refid="ff_8c_1ac71bb771432ea532bc47713a028ebd76" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BPB_SecPerTrk<sp/><sp/><sp/><sp/><sp/><sp/><sp/>24<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Track<sp/>size<sp/>[sector]<sp/>(2)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="380" refid="ff_8c_1a9c03603c3be34d4c5cc1b481b0bc6774" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BPB_NumHeads<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>26<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>heads<sp/>(2)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="381" refid="ff_8c_1a449d4ed5c4c8105daf29aad9488277f7" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BPB_HiddSec<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>28<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>special<sp/>hidden<sp/>sectors<sp/>(4)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="382" refid="ff_8c_1a7723a9f0da553e8879d60909d85ccb7b" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BPB_TotSec32<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>32<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Volume<sp/>size<sp/>[sector]<sp/>(4)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="383" refid="ff_8c_1a0c51f7393341b839dfb241c2951f3ef4" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BS_DrvNum<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>36<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Physical<sp/>drive<sp/>number<sp/>(1)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="384" refid="ff_8c_1a97d9de2942e551e182747f3ed01ab5b4" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BS_NTres<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>37<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Error<sp/>flag<sp/>(1)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="385" refid="ff_8c_1a85a92e790602efef4da3a2f141611ce8" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BS_BootSig<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>38<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Extended<sp/>boot<sp/>signature<sp/>(1)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="386" refid="ff_8c_1a383a71bda500a0fb5a37f4edd785acbf" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BS_VolID<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>39<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Volume<sp/>serial<sp/>number<sp/>(4)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="387" refid="ff_8c_1a28498ba4b07ff90aaa9628e81fb89d32" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BS_VolLab<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>43<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Volume<sp/>label<sp/>(8)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="388" refid="ff_8c_1a2264848692d36c1b2499c9b6a10acf75" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BS_FilSysType<sp/><sp/><sp/><sp/><sp/><sp/><sp/>54<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>File<sp/>system<sp/>type<sp/>(1)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="389" refid="ff_8c_1a6e6340030dc29e7da2e9f92e472a763d" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BPB_FATSz32<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>36<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FAT<sp/>size<sp/>[sector]<sp/>(4)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="390" refid="ff_8c_1a6c832cd9e28f8e4fbbd45fdc86c7ebbb" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BPB_ExtFlags<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>40<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Extended<sp/>flags<sp/>(2)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="391" refid="ff_8c_1a1f75a149df65028e24d43727b9ffcb9d" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BPB_FSVer<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>42<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>File<sp/>system<sp/>version<sp/>(2)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="392" refid="ff_8c_1a7add0104bd20083d6940d616faecd45a" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BPB_RootClus<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>44<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Root<sp/>directory<sp/>first<sp/>cluster<sp/>(4)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="393" refid="ff_8c_1a51c45669282b9ce9da5152231df9f3ac" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BPB_FSInfo<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>48<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Offset<sp/>of<sp/>FSINFO<sp/>sector<sp/>(2)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="394" refid="ff_8c_1a383726fb93488d41866028b4f07c90e1" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BPB_BkBootSec<sp/><sp/><sp/><sp/><sp/><sp/><sp/>50<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Offset<sp/>of<sp/>backup<sp/>boot<sp/>sector<sp/>(2)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="395" refid="ff_8c_1aa670c7b495f5b347c442df67b188c58f" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BS_DrvNum32<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>64<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Physical<sp/>drive<sp/>number<sp/>(1)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="396" refid="ff_8c_1a0970c574d425c190a0d6fc6d40bcd9df" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BS_NTres32<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>65<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Error<sp/>flag<sp/>(1)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="397" refid="ff_8c_1a59c4b2f802ab4bc9319e5bd840e615b8" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BS_BootSig32<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>66<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Extended<sp/>boot<sp/>signature<sp/>(1)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="398" refid="ff_8c_1abaa3aafdcf5e83f8cb7e2bb373b13525" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BS_VolID32<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>67<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Volume<sp/>serial<sp/>number<sp/>(4)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="399" refid="ff_8c_1a8241a49bce313184a58617ba1ad9e84c" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BS_VolLab32<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>71<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Volume<sp/>label<sp/>(8)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="400" refid="ff_8c_1a8d8786452966cd0ce579f2575a54a348" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BS_FilSysType32<sp/><sp/><sp/><sp/><sp/>82<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>File<sp/>system<sp/>type<sp/>(1)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="401" refid="ff_8c_1a318e58c1966aba52b90ab98dcb649883" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>FSI_LeadSig<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FSI:<sp/>Leading<sp/>signature<sp/>(4)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="402" refid="ff_8c_1a3bac0e6ff5907873030db1d0a7c4ebef" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>FSI_StrucSig<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>484<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FSI:<sp/>Structure<sp/>signature<sp/>(4)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="403" refid="ff_8c_1ab711e50459aba01b11c6b46a7cc1410b" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>FSI_Free_Count<sp/><sp/><sp/><sp/><sp/><sp/>488<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FSI:<sp/>Number<sp/>of<sp/>free<sp/>clusters<sp/>(4)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="404" refid="ff_8c_1a320700cedf300c9b418edf56e5e6b086" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>FSI_Nxt_Free<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>492<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FSI:<sp/>Last<sp/>allocated<sp/>cluster<sp/>(4)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="405" refid="ff_8c_1ac3f187bf0ba891551f594af6b61f3188" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>MBR_Table<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>446<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>MBR:<sp/>Partition<sp/>table<sp/>offset<sp/>(2)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="406" refid="ff_8c_1af133060c47366e7e557d4085d931183f" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>SZ_PTE<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>16<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>MBR:<sp/>Size<sp/>of<sp/>a<sp/>partition<sp/>table<sp/>entry<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="407" refid="ff_8c_1a74b810b3f3583c1eb54bd4305c0f261a" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BS_55AA<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>510<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Signature<sp/>word<sp/>(2)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="408"><highlight class="normal"></highlight></codeline>
<codeline lineno="409" refid="ff_8c_1afa89348e9fc2de82ae9e12c661366b0e" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>DIR_Name<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Short<sp/>file<sp/>name<sp/>(11)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="410" refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>DIR_Attr<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>11<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Attribute<sp/>(1)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="411" refid="ff_8c_1a87ee1f701c2ab941862e3ce00c1c1e9d" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>DIR_NTres<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>12<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Lower<sp/>case<sp/>flag<sp/>(1)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="412" refid="ff_8c_1a55fd459982581ae39fe3aeb242b2bc0f" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>DIR_CrtTimeTenth<sp/><sp/><sp/><sp/>13<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Created<sp/>time<sp/>sub-second<sp/>(1)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="413" refid="ff_8c_1a47fb1881ea71d860db9b8280564cb4d5" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>DIR_CrtTime<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>14<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Created<sp/>time<sp/>(2)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="414" refid="ff_8c_1acf498617bb4c7750fd738864c3c0ab5a" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>DIR_CrtDate<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>16<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Created<sp/>date<sp/>(2)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="415" refid="ff_8c_1afa0625d73f4683df24345f51e7a43da3" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>DIR_LstAccDate<sp/><sp/><sp/><sp/><sp/><sp/>18<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Last<sp/>accessed<sp/>date<sp/>(2)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="416" refid="ff_8c_1a0bc29c3f09e1e9c40c414f7d50d7905c" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>DIR_FstClusHI<sp/><sp/><sp/><sp/><sp/><sp/><sp/>20<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Higher<sp/>16-bit<sp/>of<sp/>first<sp/>cluster<sp/>(2)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="417" refid="ff_8c_1ab9452d336adeece2a1b0b54ab35b8a59" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>DIR_WrtTime<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>22<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Modified<sp/>time<sp/>(2)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="418" refid="ff_8c_1abed17fa699511b09cbf64961373d63a4" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>DIR_WrtDate<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>24<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Modified<sp/>date<sp/>(2)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="419" refid="ff_8c_1aebe0e913bff75a89d38dbcb04baf5dff" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>DIR_FstClusLO<sp/><sp/><sp/><sp/><sp/><sp/><sp/>26<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Lower<sp/>16-bit<sp/>of<sp/>first<sp/>cluster<sp/>(2)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="420" refid="ff_8c_1abfbfa613864a02a65f0bf70ead6672c7" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>DIR_FileSize<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>28<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>File<sp/>size<sp/>(4)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="421" refid="ff_8c_1a6c97d545619e6586b02b5d4f39f7be25" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>LDIR_Ord<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>LFN<sp/>entry<sp/>order<sp/>and<sp/>LLE<sp/>flag<sp/>(1)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="422" refid="ff_8c_1a28dcd75633b49e40b42a31f0cf5f5929" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>LDIR_Attr<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>11<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>LFN<sp/>attribute<sp/>(1)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="423" refid="ff_8c_1acb98a052a9be81564b56854df35480a0" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>LDIR_Type<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>12<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>LFN<sp/>type<sp/>(1)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="424" refid="ff_8c_1ade1d529763d2d097a6d1410956c8a84f" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>LDIR_Chksum<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>13<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Checksum<sp/>of<sp/>corresponding<sp/>SFN<sp/>entry<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="425" refid="ff_8c_1ad73024151eff6baea94e680f7928969d" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>LDIR_FstClusLO<sp/><sp/><sp/><sp/><sp/><sp/>26<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Must<sp/>be<sp/>zero<sp/>(0)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="426" refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>SZ_DIRE<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>32<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Size<sp/>of<sp/>a<sp/>directory<sp/>entry<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="427" refid="ff_8c_1a31ec96cd263bb14418cb8b7b2b54b3ca" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>LLEF<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x40<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Last<sp/>long<sp/>entry<sp/>flag<sp/>in<sp/>LDIR_Ord<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="428" refid="ff_8c_1a0f2455f7318e6d56318c62f5e4048e1e" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>DDEM<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xE5<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Deleted<sp/>directory<sp/>entry<sp/>mark<sp/>at<sp/>DIR_Name[0]<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="429" refid="ff_8c_1a24b6bc427cbd37fbe76e087f7f188abb" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>RDDEM<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x05<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Replacement<sp/>of<sp/>the<sp/>character<sp/>collides<sp/>with<sp/>DDEM<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="430"><highlight class="normal"></highlight></codeline>
<codeline lineno="431"><highlight class="normal"></highlight></codeline>
<codeline lineno="432"><highlight class="normal"></highlight></codeline>
<codeline lineno="433"><highlight class="normal"></highlight></codeline>
<codeline lineno="434"><highlight class="normal"></highlight><highlight class="comment">/*--------------------------------------------------------------------------</highlight></codeline>
<codeline lineno="435"><highlight class="comment"></highlight></codeline>
<codeline lineno="436"><highlight class="comment"><sp/><sp/><sp/>Module<sp/>Private<sp/>Work<sp/>Area</highlight></codeline>
<codeline lineno="437"><highlight class="comment"></highlight></codeline>
<codeline lineno="438"><highlight class="comment">---------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="439"><highlight class="normal"></highlight></codeline>
<codeline lineno="440"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Remark:<sp/>Uninitialized<sp/>variables<sp/>with<sp/>static<sp/>duration<sp/>are<sp/>guaranteed</highlight></codeline>
<codeline lineno="441"><highlight class="comment">/<sp/><sp/>zero/null<sp/>at<sp/>start-up.<sp/>If<sp/>not,<sp/>either<sp/>the<sp/>linker<sp/>or<sp/>start-up<sp/>routine</highlight></codeline>
<codeline lineno="442"><highlight class="comment">/<sp/><sp/>being<sp/>used<sp/>is<sp/>not<sp/>compliance<sp/>with<sp/>ANSI-C<sp/>standard.</highlight></codeline>
<codeline lineno="443"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="444"><highlight class="normal"></highlight></codeline>
<codeline lineno="445"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_VOLUMES<sp/>&lt;<sp/>1<sp/>||<sp/>_VOLUMES<sp/>&gt;<sp/>9</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="446"><highlight class="normal"></highlight><highlight class="preprocessor">#error<sp/>Wrong<sp/>_VOLUMES<sp/>setting</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="447"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="448" refid="ff_8c_1a3d7aad0939745576943767bf6c410eaf" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref><sp/>*<ref refid="ff_8c_1a3d7aad0939745576943767bf6c410eaf" kindref="member">FatFs</ref>[<ref refid="group___f_f_c_o_n_f_i_g_1ga366da9a40c8ceb3103a6b72ca02b9969" kindref="member">_VOLUMES</ref>];<sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>file<sp/>system<sp/>objects<sp/>(logical<sp/>drives)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="449" refid="ff_8c_1a0b3f41d8c416222e9b1c16e36d66e18b" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="integer_8h_1a197942eefa7db30960ae396d68339b97" kindref="member">WORD</ref><sp/><ref refid="ff_8c_1a0b3f41d8c416222e9b1c16e36d66e18b" kindref="member">Fsid</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>File<sp/>system<sp/>mount<sp/>ID<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="450"><highlight class="normal"></highlight></codeline>
<codeline lineno="451"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_RPATH<sp/>&amp;&amp;<sp/>_VOLUMES<sp/>&gt;=<sp/>2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="452"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>CurrVol;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Current<sp/>drive<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="453"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="454"><highlight class="normal"></highlight></codeline>
<codeline lineno="455"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_LOCK</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="456"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>FILESEM<sp/>Files[<ref refid="group___f_f_c_o_n_f_i_g_1ga01410fcb45c2d2d2c5692c56d4f0a481" kindref="member">_FS_LOCK</ref>];<sp/></highlight><highlight class="comment">/*<sp/>Open<sp/>object<sp/>lock<sp/>semaphores<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="457"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="458"><highlight class="normal"></highlight></codeline>
<codeline lineno="459"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN<sp/>==<sp/>0<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Non<sp/>LFN<sp/>feature<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="460"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>DEFINE_NAMEBUF<sp/><sp/><sp/><sp/><sp/><sp/>BYTE<sp/>sfn[12]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="461"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>INIT_BUF(dobj)<sp/><sp/><sp/><sp/><sp/><sp/>(dobj).fn<sp/>=<sp/>sfn</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="462"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>FREE_BUF()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="463"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="464"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_MAX_LFN<sp/>&lt;<sp/>12<sp/>||<sp/>_MAX_LFN<sp/>&gt;<sp/>255</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="465"><highlight class="normal"></highlight><highlight class="preprocessor">#error<sp/>Wrong<sp/>_MAX_LFN<sp/>setting</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="466"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="467"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN<sp/>==<sp/>1<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>LFN<sp/>feature<sp/>with<sp/>static<sp/>working<sp/>buffer<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="468"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="integer_8h_1a570001c92f314285ad3e7139d8c58cf7" kindref="member">WCHAR</ref><sp/>LfnBuf[<ref refid="group___f_f_c_o_n_f_i_g_1ga14e73a5c703a586c614b3e40b849f82c" kindref="member">_MAX_LFN</ref><sp/>+<sp/>1];</highlight></codeline>
<codeline lineno="469"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>DEFINE_NAMEBUF<sp/><sp/><sp/><sp/><sp/><sp/>BYTE<sp/>sfn[12]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="470"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>INIT_BUF(dobj)<sp/><sp/><sp/><sp/><sp/><sp/>{<sp/>(dobj).fn<sp/>=<sp/>sfn;<sp/>(dobj).lfn<sp/>=<sp/>LfnBuf;<sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="471"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>FREE_BUF()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="472"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_USE_LFN<sp/>==<sp/>2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>LFN<sp/>feature<sp/>with<sp/>dynamic<sp/>working<sp/>buffer<sp/>on<sp/>the<sp/>stack<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="473" refid="ff_8c_1a7cc27142421bd12be623072288599791" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>DEFINE_NAMEBUF<sp/><sp/><sp/><sp/><sp/><sp/>BYTE<sp/>sfn[12];<sp/>WCHAR<sp/>lbuf[_MAX_LFN<sp/>+<sp/>1]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="474" refid="ff_8c_1a966fe5792671b39db1ccf655a8c1af8d" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>INIT_BUF(dobj)<sp/><sp/><sp/><sp/><sp/><sp/>{<sp/>(dobj).fn<sp/>=<sp/>sfn;<sp/>(dobj).lfn<sp/>=<sp/>lbuf;<sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="475" refid="ff_8c_1aba6d6942b59f11cf285bdbfb7e38f1fa" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>FREE_BUF()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="476"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_USE_LFN<sp/>==<sp/>3<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>LFN<sp/>feature<sp/>with<sp/>dynamic<sp/>working<sp/>buffer<sp/>on<sp/>the<sp/>heap<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="477"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>DEFINE_NAMEBUF<sp/><sp/><sp/><sp/><sp/><sp/>BYTE<sp/>sfn[12];<sp/>WCHAR<sp/>*lfn</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="478"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>INIT_BUF(dobj)<sp/><sp/><sp/><sp/><sp/><sp/>{<sp/>lfn<sp/>=<sp/>ff_memalloc((_MAX_LFN<sp/>+<sp/>1)<sp/>*<sp/>2);<sp/>if<sp/>(!lfn)<sp/>LEAVE_FF((dobj).fs,<sp/>FR_NOT_ENOUGH_CORE);<sp/>(dobj).lfn<sp/>=<sp/>lfn;<sp/>(dobj).fn<sp/>=<sp/>sfn;<sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="479"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>FREE_BUF()<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ff_memfree(lfn)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="480"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="481"><highlight class="normal"></highlight><highlight class="preprocessor">#error<sp/>Wrong<sp/>_USE_LFN<sp/>setting</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="482"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="483"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="484"><highlight class="normal"></highlight></codeline>
<codeline lineno="485"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>_EXCVT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="486"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>ExCvt[]<sp/>=<sp/>_EXCVT;<sp/></highlight><highlight class="comment">/*<sp/>Upper<sp/>conversion<sp/>table<sp/>for<sp/>SBCS<sp/>extended<sp/>characters<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="487"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="488"><highlight class="normal"></highlight></codeline>
<codeline lineno="489"><highlight class="normal"></highlight></codeline>
<codeline lineno="490"><highlight class="normal"></highlight></codeline>
<codeline lineno="491"><highlight class="normal"></highlight></codeline>
<codeline lineno="492"><highlight class="normal"></highlight></codeline>
<codeline lineno="493"><highlight class="normal"></highlight></codeline>
<codeline lineno="494"><highlight class="normal"></highlight><highlight class="comment">/*--------------------------------------------------------------------------</highlight></codeline>
<codeline lineno="495"><highlight class="comment"></highlight></codeline>
<codeline lineno="496"><highlight class="comment"><sp/><sp/><sp/>Module<sp/>Private<sp/>Functions</highlight></codeline>
<codeline lineno="497"><highlight class="comment"></highlight></codeline>
<codeline lineno="498"><highlight class="comment">---------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="499"><highlight class="normal"></highlight></codeline>
<codeline lineno="500"><highlight class="normal"></highlight></codeline>
<codeline lineno="501"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="502"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>String<sp/>functions<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="503"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="504"><highlight class="normal"></highlight></codeline>
<codeline lineno="505"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Copy<sp/>memory<sp/>to<sp/>memory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="506"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="507" refid="ff_8c_1a8941d573d16af92c8570950d53164f30" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ff_8c_1a8941d573d16af92c8570950d53164f30" kindref="member">mem_cpy</ref><sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>dst,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>src,<sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>cnt)<sp/>{</highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>*d<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>*)dst;</highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>*s<sp/>=<sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>*)src;</highlight></codeline>
<codeline lineno="510"><highlight class="normal"></highlight></codeline>
<codeline lineno="511"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_WORD_ACCESS<sp/>==<sp/>1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(cnt<sp/>&gt;=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">))<sp/>{</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">*)d<sp/>=<sp/>*(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">*)s;</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d<sp/>+=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(int);<sp/>s<sp/>+=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(int);</highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cnt<sp/>-=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(int);</highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="517"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(cnt--)</highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*d++<sp/>=<sp/>*s++;</highlight></codeline>
<codeline lineno="520"><highlight class="normal">}</highlight></codeline>
<codeline lineno="521"><highlight class="normal"></highlight></codeline>
<codeline lineno="522"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Fill<sp/>memory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="523"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="524" refid="ff_8c_1a02eb5189e43056a9ddc8a59cbe89be93" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ff_8c_1a02eb5189e43056a9ddc8a59cbe89be93" kindref="member">mem_set</ref><sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>dst,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>val,<sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>cnt)<sp/>{</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>*d<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>*)dst;</highlight></codeline>
<codeline lineno="526"><highlight class="normal"></highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(cnt--)</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*d++<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)val;</highlight></codeline>
<codeline lineno="529"><highlight class="normal">}</highlight></codeline>
<codeline lineno="530"><highlight class="normal"></highlight></codeline>
<codeline lineno="531"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Compare<sp/>memory<sp/>to<sp/>memory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="532"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="533" refid="ff_8c_1a38b4f223d18bd4416d8bce0f07a63c01" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="ff_8c_1a38b4f223d18bd4416d8bce0f07a63c01" kindref="member">mem_cmp</ref><sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>dst,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>src,<sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>cnt)<sp/>{</highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>*d<sp/>=<sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>*)dst,<sp/>*s<sp/>=<sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>*)src;</highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>r<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="536"><highlight class="normal"></highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(cnt--<sp/>&amp;&amp;<sp/>(r<sp/>=<sp/>*d++<sp/>-<sp/>*s++)<sp/>==<sp/>0)<sp/>;</highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>r;</highlight></codeline>
<codeline lineno="539"><highlight class="normal">}</highlight></codeline>
<codeline lineno="540"><highlight class="normal"></highlight></codeline>
<codeline lineno="541"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Check<sp/>if<sp/>chr<sp/>is<sp/>contained<sp/>in<sp/>the<sp/>string<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="542"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="543" refid="ff_8c_1a1a60c4200d040e4f47e87dc927f23d14" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="ff_8c_1a1a60c4200d040e4f47e87dc927f23d14" kindref="member">chk_chr</ref><sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>str,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>chr)<sp/>{</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(*str<sp/>&amp;&amp;<sp/>*str<sp/>!=<sp/>chr)<sp/>str++;</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>*str;</highlight></codeline>
<codeline lineno="546"><highlight class="normal">}</highlight></codeline>
<codeline lineno="547"><highlight class="normal"></highlight></codeline>
<codeline lineno="548"><highlight class="normal"></highlight></codeline>
<codeline lineno="549"><highlight class="normal"></highlight></codeline>
<codeline lineno="550"><highlight class="normal"></highlight></codeline>
<codeline lineno="551"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="552"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Request/Release<sp/>grant<sp/>to<sp/>access<sp/>the<sp/>volume<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="553"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="554"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_REENTRANT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="555"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="556" refid="ff_8c_1af35d759ac2dbde3cef605901cab3a776" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="ff_8c_1af35d759ac2dbde3cef605901cab3a776" kindref="member">lock_fs</ref><sp/>(</highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref>*<sp/>fs<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>File<sp/>system<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="558"><highlight class="normal">)</highlight></codeline>
<codeline lineno="559"><highlight class="normal">{</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1aa0dd2bf38b270e6b39ff395f2d25a0ed" kindref="member">ff_req_grant</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1a1c2c369d5858a2d8b60e65431b0b1a85" kindref="member">sobj</ref>);</highlight></codeline>
<codeline lineno="561"><highlight class="normal">}</highlight></codeline>
<codeline lineno="562"><highlight class="normal"></highlight></codeline>
<codeline lineno="563"><highlight class="normal"></highlight></codeline>
<codeline lineno="564"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="565" refid="ff_8c_1a58c93c453ba943336cd24aa185cd72cf" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ff_8c_1a58c93c453ba943336cd24aa185cd72cf" kindref="member">unlock_fs</ref><sp/>(</highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref>*<sp/>fs,<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>File<sp/>system<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Result<sp/>code<sp/>to<sp/>be<sp/>returned<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="568"><highlight class="normal">)</highlight></codeline>
<codeline lineno="569"><highlight class="normal">{</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fs<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cafc56605c68aaffab4a428339a8bd600d" kindref="member">FR_NOT_ENABLED</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca487844af77de15f6932a3b41ef3a2d65" kindref="member">FR_INVALID_DRIVE</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca3dec4eba481cdf5e99d7cd6009e6dcf8" kindref="member">FR_INVALID_OBJECT</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca3f8ca7e51af8b129d14328de7243c5d4" kindref="member">FR_TIMEOUT</ref>)<sp/>{</highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a5bb37b1d2ec72388812e11003f2b508a" kindref="member">ff_rel_grant</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1a1c2c369d5858a2d8b60e65431b0b1a85" kindref="member">sobj</ref>);</highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="577"><highlight class="normal">}</highlight></codeline>
<codeline lineno="578"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="579"><highlight class="normal"></highlight></codeline>
<codeline lineno="580"><highlight class="normal"></highlight></codeline>
<codeline lineno="581"><highlight class="normal"></highlight></codeline>
<codeline lineno="582"><highlight class="normal"></highlight></codeline>
<codeline lineno="583"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="584"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>File<sp/>lock<sp/>control<sp/>functions<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="585"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="586"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_LOCK</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="587"><highlight class="normal"></highlight></codeline>
<codeline lineno="588"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="589"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>chk_lock<sp/>(<sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>if<sp/>the<sp/>file<sp/>can<sp/>be<sp/>accessed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref>*<sp/>dp,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Directory<sp/>object<sp/>pointing<sp/>the<sp/>file<sp/>to<sp/>be<sp/>checked<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>acc<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Desired<sp/>access<sp/>type<sp/>(0:Read,<sp/>1:Write,<sp/>2:Delete/Rename)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="592"><highlight class="normal">)</highlight></codeline>
<codeline lineno="593"><highlight class="normal">{</highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>i,<sp/>be;</highlight></codeline>
<codeline lineno="595"><highlight class="normal"></highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Search<sp/>file<sp/>semaphore<sp/>table<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>be<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="group___f_f_c_o_n_f_i_g_1ga01410fcb45c2d2d2c5692c56d4f0a481" kindref="member">_FS_LOCK</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Files[i].fs)<sp/>{<sp/><sp/></highlight><highlight class="comment">/*<sp/>Existing<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Files[i].fs<sp/>==<sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref><sp/>&amp;&amp;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>if<sp/>the<sp/>object<sp/>matched<sp/>with<sp/>an<sp/>open<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Files[i].clu<sp/>==<sp/>dp-&gt;<ref refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Files[i].idx<sp/>==<sp/>dp-&gt;<ref refid="struct_d_i_r_1ab7c5089b70ce76bcd61abe615ed2a42b" kindref="member">index</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Blank<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>be<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="606"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>==<sp/>_FS_LOCK)<sp/><sp/></highlight><highlight class="comment">/*<sp/>The<sp/>object<sp/>is<sp/>not<sp/>opened<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(be<sp/>||<sp/>acc<sp/>==<sp/>2)<sp/>?<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref><sp/>:<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca50dd3c3c274ccebb2cfbddde9d065bb9" kindref="member">FR_TOO_MANY_OPEN_FILES</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Is<sp/>there<sp/>a<sp/>blank<sp/>entry<sp/>for<sp/>new<sp/>object?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="608"><highlight class="normal"></highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>The<sp/>object<sp/>has<sp/>been<sp/>opened.<sp/>Reject<sp/>any<sp/>open<sp/>against<sp/>writing<sp/>file<sp/>and<sp/>all<sp/>write<sp/>mode<sp/>open<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(acc<sp/>||<sp/>Files[i].ctr<sp/>==<sp/>0x100)<sp/>?<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca7db5afaaa2af591bd4a208b2967075d7" kindref="member">FR_LOCKED</ref><sp/>:<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>;</highlight></codeline>
<codeline lineno="611"><highlight class="normal">}</highlight></codeline>
<codeline lineno="612"><highlight class="normal"></highlight></codeline>
<codeline lineno="613"><highlight class="normal"></highlight></codeline>
<codeline lineno="614"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="615"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>enq_lock<sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)<sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>if<sp/>an<sp/>entry<sp/>is<sp/>available<sp/>for<sp/>a<sp/>new<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="616"><highlight class="normal">{</highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>i;</highlight></codeline>
<codeline lineno="618"><highlight class="normal"></highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>_FS_LOCK<sp/>&amp;&amp;<sp/>Files[i].fs;<sp/>i++)<sp/>;</highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(i<sp/>==<sp/>_FS_LOCK)<sp/>?<sp/>0<sp/>:<sp/>1;</highlight></codeline>
<codeline lineno="621"><highlight class="normal">}</highlight></codeline>
<codeline lineno="622"><highlight class="normal"></highlight></codeline>
<codeline lineno="623"><highlight class="normal"></highlight></codeline>
<codeline lineno="624"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="625"><highlight class="normal"><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>inc_lock<sp/>(<sp/></highlight><highlight class="comment">/*<sp/>Increment<sp/>object<sp/>open<sp/>counter<sp/>and<sp/>returns<sp/>its<sp/>index<sp/>(0:Internal<sp/>error)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref>*<sp/>dp,<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Directory<sp/>object<sp/>pointing<sp/>the<sp/>file<sp/>to<sp/>register<sp/>or<sp/>increment<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>acc<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Desired<sp/>access<sp/>(0:Read,<sp/>1:Write,<sp/>2:Delete/Rename)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="628"><highlight class="normal">)</highlight></codeline>
<codeline lineno="629"><highlight class="normal">{</highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>i;</highlight></codeline>
<codeline lineno="631"><highlight class="normal"></highlight></codeline>
<codeline lineno="632"><highlight class="normal"></highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="group___f_f_c_o_n_f_i_g_1ga01410fcb45c2d2d2c5692c56d4f0a481" kindref="member">_FS_LOCK</ref>;<sp/>i++)<sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Find<sp/>the<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Files[i].fs<sp/>==<sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Files[i].clu<sp/>==<sp/>dp-&gt;<ref refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Files[i].idx<sp/>==<sp/>dp-&gt;<ref refid="struct_d_i_r_1ab7c5089b70ce76bcd61abe615ed2a42b" kindref="member">index</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="638"><highlight class="normal"></highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>==<sp/>_FS_LOCK)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Not<sp/>opened.<sp/>Register<sp/>it<sp/>as<sp/>new.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>_FS_LOCK<sp/>&amp;&amp;<sp/>Files[i].fs;<sp/>i++)<sp/>;</highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>==<sp/>_FS_LOCK)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>No<sp/>free<sp/>entry<sp/>to<sp/>register<sp/>(int<sp/>err)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Files[i].fs<sp/>=<sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>;</highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Files[i].clu<sp/>=<sp/>dp-&gt;<ref refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref>;</highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Files[i].idx<sp/>=<sp/>dp-&gt;<ref refid="struct_d_i_r_1ab7c5089b70ce76bcd61abe615ed2a42b" kindref="member">index</ref>;</highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Files[i].ctr<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="647"><highlight class="normal"></highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(acc<sp/>&amp;&amp;<sp/>Files[i].ctr)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Access<sp/>violation<sp/>(int<sp/>err)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="649"><highlight class="normal"></highlight></codeline>
<codeline lineno="650"><highlight class="normal"><sp/><sp/><sp/><sp/>Files[i].ctr<sp/>=<sp/>acc<sp/>?<sp/>0x100<sp/>:<sp/>Files[i].ctr<sp/>+<sp/>1;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>semaphore<sp/>value<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="651"><highlight class="normal"></highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>i<sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="653"><highlight class="normal">}</highlight></codeline>
<codeline lineno="654"><highlight class="normal"></highlight></codeline>
<codeline lineno="655"><highlight class="normal"></highlight></codeline>
<codeline lineno="656"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="657"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>dec_lock<sp/>(<sp/><sp/></highlight><highlight class="comment">/*<sp/>Decrement<sp/>object<sp/>open<sp/>counter<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>i<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Semaphore<sp/>index<sp/>(1..)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="659"><highlight class="normal">)</highlight></codeline>
<codeline lineno="660"><highlight class="normal">{</highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a197942eefa7db30960ae396d68339b97" kindref="member">WORD</ref><sp/>n;</highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="663"><highlight class="normal"></highlight></codeline>
<codeline lineno="664"><highlight class="normal"></highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(--i<sp/>&lt;<sp/>_FS_LOCK)<sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Shift<sp/>index<sp/>number<sp/>origin<sp/>from<sp/>0<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>=<sp/>Files[i].ctr;</highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n<sp/>==<sp/>0x100)<sp/>n<sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>write<sp/>mode<sp/>open,<sp/>delete<sp/>the<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n)<sp/>n--;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Decrement<sp/>read<sp/>mode<sp/>open<sp/>count<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Files[i].ctr<sp/>=<sp/>n;</highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!n)<sp/>Files[i].fs<sp/>=<sp/>0;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Delete<sp/>the<sp/>entry<sp/>if<sp/>open<sp/>count<sp/>gets<sp/>zero<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>;</highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Invalid<sp/>index<sp/>nunber<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="676"><highlight class="normal">}</highlight></codeline>
<codeline lineno="677"><highlight class="normal"></highlight></codeline>
<codeline lineno="678"><highlight class="normal"></highlight></codeline>
<codeline lineno="679"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="680"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>clear_lock<sp/>(<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Clear<sp/>lock<sp/>entries<sp/>of<sp/>the<sp/>volume<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref><sp/>*fs</highlight></codeline>
<codeline lineno="682"><highlight class="normal">)</highlight></codeline>
<codeline lineno="683"><highlight class="normal">{</highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>i;</highlight></codeline>
<codeline lineno="685"><highlight class="normal"></highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="group___f_f_c_o_n_f_i_g_1ga01410fcb45c2d2d2c5692c56d4f0a481" kindref="member">_FS_LOCK</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Files[i].fs<sp/>==<sp/>fs)<sp/>Files[i].fs<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="689"><highlight class="normal">}</highlight></codeline>
<codeline lineno="690"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="691"><highlight class="normal"></highlight></codeline>
<codeline lineno="692"><highlight class="normal"></highlight></codeline>
<codeline lineno="693"><highlight class="normal"></highlight></codeline>
<codeline lineno="694"><highlight class="normal"></highlight></codeline>
<codeline lineno="695"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="696"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Move/Flush<sp/>disk<sp/>access<sp/>window<sp/>in<sp/>the<sp/>file<sp/>system<sp/>object<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="697"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="698"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="699"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="700" refid="ff_8c_1a5e18753404354b210096f9af99e31bc1" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="ff_8c_1a5e18753404354b210096f9af99e31bc1" kindref="member">sync_window</ref><sp/>(<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FR_OK:succeeded,<sp/>!=0:error<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref>*<sp/>fs<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>File<sp/>system<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="702"><highlight class="normal">)</highlight></codeline>
<codeline lineno="703"><highlight class="normal">{</highlight></codeline>
<codeline lineno="704"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>wsect;</highlight></codeline>
<codeline lineno="705"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>nf;</highlight></codeline>
<codeline lineno="706"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>;</highlight></codeline>
<codeline lineno="707"><highlight class="normal"></highlight></codeline>
<codeline lineno="708"><highlight class="normal"></highlight></codeline>
<codeline lineno="709"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fs-&gt;<ref refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" kindref="member">wflag</ref>)<sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Write<sp/>back<sp/>the<sp/>sector<sp/>if<sp/>it<sp/>is<sp/>dirty<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wsect<sp/>=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" kindref="member">winsect</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Current<sp/>sector<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" kindref="member">disk_write</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" kindref="member">drv</ref>,<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>,<sp/>wsect,<sp/>1)<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>;</highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" kindref="member">wflag</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(wsect<sp/>-<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a74e60540a346de6eb9f0c13d6203efa1" kindref="member">fatbase</ref><sp/>&lt;<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1af70a0afd16367837984d6205cbfca308" kindref="member">fsize</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Is<sp/>it<sp/>in<sp/>the<sp/>FAT<sp/>area?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(nf<sp/>=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1af18fdbb9dec86b70abc6ee2a1217ac47" kindref="member">n_fats</ref>;<sp/>nf<sp/>&gt;=<sp/>2;<sp/>nf--)<sp/>{<sp/><sp/></highlight><highlight class="comment">/*<sp/>Reflect<sp/>the<sp/>change<sp/>to<sp/>all<sp/>FAT<sp/>copies<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wsect<sp/>+=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1af70a0afd16367837984d6205cbfca308" kindref="member">fsize</ref>;</highlight></codeline>
<codeline lineno="718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" kindref="member">disk_write</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" kindref="member">drv</ref>,<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>,<sp/>wsect,<sp/>1);</highlight></codeline>
<codeline lineno="719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="722"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="723"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="724"><highlight class="normal">}</highlight></codeline>
<codeline lineno="725"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="726"><highlight class="normal"></highlight></codeline>
<codeline lineno="727"><highlight class="normal"></highlight></codeline>
<codeline lineno="728"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="729" refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" kindref="member">move_window</ref><sp/>(<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FR_OK(0):succeeded,<sp/>!=0:error<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref>*<sp/>fs,<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>File<sp/>system<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="731"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>sector<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Sector<sp/>number<sp/>to<sp/>make<sp/>appearance<sp/>in<sp/>the<sp/>fs-&gt;win[]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="732"><highlight class="normal">)</highlight></codeline>
<codeline lineno="733"><highlight class="normal">{</highlight></codeline>
<codeline lineno="734"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>;</highlight></codeline>
<codeline lineno="735"><highlight class="normal"></highlight></codeline>
<codeline lineno="736"><highlight class="normal"></highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sector<sp/>!=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" kindref="member">winsect</ref>)<sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Window<sp/>offset<sp/>changed?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="738"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a5e18753404354b210096f9af99e31bc1" kindref="member">sync_window</ref>(fs);<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Write-back<sp/>changes<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="740"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Fill<sp/>sector<sp/>window<sp/>with<sp/>new<sp/>data<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1gae55155170bc9b99f73b440b93cc1c9e2" kindref="member">disk_read</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" kindref="member">drv</ref>,<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>,<sp/>sector,<sp/>1)<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sector<sp/>=<sp/>0xFFFFFFFF;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Invalidate<sp/>window<sp/>if<sp/>data<sp/>is<sp/>not<sp/>reliable<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>;</highlight></codeline>
<codeline lineno="745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" kindref="member">winsect</ref><sp/>=<sp/>sector;</highlight></codeline>
<codeline lineno="747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="748"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="749"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="750"><highlight class="normal">}</highlight></codeline>
<codeline lineno="751"><highlight class="normal"></highlight></codeline>
<codeline lineno="752"><highlight class="normal"></highlight></codeline>
<codeline lineno="753"><highlight class="normal"></highlight></codeline>
<codeline lineno="754"><highlight class="normal"></highlight></codeline>
<codeline lineno="755"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="756"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Synchronize<sp/>file<sp/>system<sp/>and<sp/>strage<sp/>device<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="757"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="758"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="759"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="760" refid="ff_8c_1aec6b108298553219ebb2b960b528459d" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="ff_8c_1aec6b108298553219ebb2b960b528459d" kindref="member">sync_fs</ref><sp/>(<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FR_OK:succeeded,<sp/>!=0:error<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="761"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref>*<sp/>fs<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>File<sp/>system<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="762"><highlight class="normal">)</highlight></codeline>
<codeline lineno="763"><highlight class="normal">{</highlight></codeline>
<codeline lineno="764"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="765"><highlight class="normal"></highlight></codeline>
<codeline lineno="766"><highlight class="normal"></highlight></codeline>
<codeline lineno="767"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a5e18753404354b210096f9af99e31bc1" kindref="member">sync_window</ref>(fs);</highlight></codeline>
<codeline lineno="768"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Update<sp/>FSInfo<sp/>sector<sp/>if<sp/>needed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fs-&gt;<ref refid="struct_f_a_t_f_s_1a3630ef0b29c45ef8e0c1de639efab754" kindref="member">fs_type</ref><sp/>==<sp/><ref refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" kindref="member">FS_FAT32</ref><sp/>&amp;&amp;<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a66c4d8e68262d5542852e2aed6ce69b4" kindref="member">fsi_flag</ref><sp/>==<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>FSInfo<sp/>structure<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a02eb5189e43056a9ddc8a59cbe89be93" kindref="member">mem_set</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>,<sp/>0,<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs));</highlight></codeline>
<codeline lineno="773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" kindref="member">ST_WORD</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref><sp/>+<sp/><ref refid="ff_8c_1a74b810b3f3583c1eb54bd4305c0f261a" kindref="member">BS_55AA</ref>,<sp/>0xAA55);</highlight></codeline>
<codeline lineno="774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref><sp/>+<sp/><ref refid="ff_8c_1a318e58c1966aba52b90ab98dcb649883" kindref="member">FSI_LeadSig</ref>,<sp/>0x41615252);</highlight></codeline>
<codeline lineno="775"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref><sp/>+<sp/><ref refid="ff_8c_1a3bac0e6ff5907873030db1d0a7c4ebef" kindref="member">FSI_StrucSig</ref>,<sp/>0x61417272);</highlight></codeline>
<codeline lineno="776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref><sp/>+<sp/><ref refid="ff_8c_1ab711e50459aba01b11c6b46a7cc1410b" kindref="member">FSI_Free_Count</ref>,<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a509defa217cfb2eb777ed3c74c4ef426" kindref="member">free_clust</ref>);</highlight></codeline>
<codeline lineno="777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref><sp/>+<sp/><ref refid="ff_8c_1a320700cedf300c9b418edf56e5e6b086" kindref="member">FSI_Nxt_Free</ref>,<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a10cd8b80b3b6474bf0d6432c8fb9d2d2" kindref="member">last_clust</ref>);</highlight></codeline>
<codeline lineno="778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Write<sp/>it<sp/>into<sp/>the<sp/>FSInfo<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" kindref="member">winsect</ref><sp/>=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a3e3472628262823af495681702709e8e" kindref="member">volbase</ref><sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" kindref="member">disk_write</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" kindref="member">drv</ref>,<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>,<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" kindref="member">winsect</ref>,<sp/>1);</highlight></codeline>
<codeline lineno="781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a66c4d8e68262d5542852e2aed6ce69b4" kindref="member">fsi_flag</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Make<sp/>sure<sp/>that<sp/>no<sp/>pending<sp/>write<sp/>process<sp/>in<sp/>the<sp/>physical<sp/>drive<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga3051f51f1cccb103d145804d5d91b04d" kindref="member">disk_ioctl</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" kindref="member">drv</ref>,<sp/><ref refid="diskio_8h_1a1b3c492f9aec325f0655941b75256f3c" kindref="member">CTRL_SYNC</ref>,<sp/>0)<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref>)</highlight></codeline>
<codeline lineno="785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>;</highlight></codeline>
<codeline lineno="786"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="787"><highlight class="normal"></highlight></codeline>
<codeline lineno="788"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="789"><highlight class="normal">}</highlight></codeline>
<codeline lineno="790"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="791"><highlight class="normal"></highlight></codeline>
<codeline lineno="792"><highlight class="normal"></highlight></codeline>
<codeline lineno="793"><highlight class="normal"></highlight></codeline>
<codeline lineno="794"><highlight class="normal"></highlight></codeline>
<codeline lineno="795"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="796"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Get<sp/>sector#<sp/>from<sp/>cluster#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="797"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="798"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Hidden<sp/>API<sp/>for<sp/>hacks<sp/>and<sp/>disk<sp/>tools<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="799"><highlight class="normal"></highlight></codeline>
<codeline lineno="800" refid="ff_8c_1a7519abb60fe91f6aa1d17f64fbae123a" refkind="member"><highlight class="normal"><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/><ref refid="ff_8c_1a7519abb60fe91f6aa1d17f64fbae123a" kindref="member">clust2sect</ref><sp/>(<sp/><sp/></highlight><highlight class="comment">/*<sp/>!=0:Sector<sp/>number,<sp/>0:Failed<sp/>(invalid<sp/>cluster#)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="801"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref>*<sp/>fs,<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>File<sp/>system<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="802"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>clst<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Cluster#<sp/>to<sp/>be<sp/>converted<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="803"><highlight class="normal">)</highlight></codeline>
<codeline lineno="804"><highlight class="normal">{</highlight></codeline>
<codeline lineno="805"><highlight class="normal"><sp/><sp/><sp/><sp/>clst<sp/>-=<sp/>2;</highlight></codeline>
<codeline lineno="806"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>&gt;=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" kindref="member">n_fatent</ref><sp/>-<sp/>2)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Invalid<sp/>cluster#<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="807"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>clst<sp/>*<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" kindref="member">csize</ref><sp/>+<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a112ba7d33529e5c9fda3b950fff01180" kindref="member">database</ref>;</highlight></codeline>
<codeline lineno="808"><highlight class="normal">}</highlight></codeline>
<codeline lineno="809"><highlight class="normal"></highlight></codeline>
<codeline lineno="810"><highlight class="normal"></highlight></codeline>
<codeline lineno="811"><highlight class="normal"></highlight></codeline>
<codeline lineno="812"><highlight class="normal"></highlight></codeline>
<codeline lineno="813"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="814"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>FAT<sp/>access<sp/>-<sp/>Read<sp/>value<sp/>of<sp/>a<sp/>FAT<sp/>entry<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="815"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="816"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Hidden<sp/>API<sp/>for<sp/>hacks<sp/>and<sp/>disk<sp/>tools<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="817"><highlight class="normal"></highlight></codeline>
<codeline lineno="818" refid="ff_8c_1a65611adf1626e5e08da77cd33a98dd8b" refkind="member"><highlight class="normal"><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/><ref refid="ff_8c_1a65611adf1626e5e08da77cd33a98dd8b" kindref="member">get_fat</ref><sp/>(<sp/></highlight><highlight class="comment">/*<sp/>0xFFFFFFFF:Disk<sp/>error,<sp/>1:Internal<sp/>error,<sp/>2..0x0FFFFFFF:Cluster<sp/>status<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="819"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref>*<sp/>fs,<sp/><sp/></highlight><highlight class="comment">/*<sp/>File<sp/>system<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="820"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>clst<sp/><sp/></highlight><highlight class="comment">/*<sp/>FAT<sp/>index<sp/>number<sp/>(cluster<sp/>number)<sp/>to<sp/>get<sp/>the<sp/>value<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="821"><highlight class="normal">)</highlight></codeline>
<codeline lineno="822"><highlight class="normal">{</highlight></codeline>
<codeline lineno="823"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>wc,<sp/>bc;</highlight></codeline>
<codeline lineno="824"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>*p;</highlight></codeline>
<codeline lineno="825"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>val;</highlight></codeline>
<codeline lineno="826"><highlight class="normal"></highlight></codeline>
<codeline lineno="827"><highlight class="normal"></highlight></codeline>
<codeline lineno="828"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>&lt;<sp/>2<sp/>||<sp/>clst<sp/>&gt;=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" kindref="member">n_fatent</ref>)<sp/>{<sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>if<sp/>in<sp/>valid<sp/>range<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>val<sp/>=<sp/>1;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Internal<sp/>error<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="830"><highlight class="normal"></highlight></codeline>
<codeline lineno="831"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>val<sp/>=<sp/>0xFFFFFFFF;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Default<sp/>value<sp/>falls<sp/>on<sp/>disk<sp/>error<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="833"><highlight class="normal"></highlight></codeline>
<codeline lineno="834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(fs-&gt;<ref refid="struct_f_a_t_f_s_1a3630ef0b29c45ef8e0c1de639efab754" kindref="member">fs_type</ref>)<sp/>{</highlight></codeline>
<codeline lineno="835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1aab755aa1b4f81f4aabee4a5d4738cfb0" kindref="member">FS_FAT12</ref><sp/>:</highlight></codeline>
<codeline lineno="836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bc<sp/>=<sp/>(<ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref>)clst;<sp/>bc<sp/>+=<sp/>bc<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" kindref="member">move_window</ref>(fs,<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a74e60540a346de6eb9f0c13d6203efa1" kindref="member">fatbase</ref><sp/>+<sp/>(bc<sp/>/<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs)))<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wc<sp/>=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>[bc++<sp/>%<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs)];</highlight></codeline>
<codeline lineno="839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" kindref="member">move_window</ref>(fs,<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a74e60540a346de6eb9f0c13d6203efa1" kindref="member">fatbase</ref><sp/>+<sp/>(bc<sp/>/<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs)))<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="840"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wc<sp/>|=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>[bc<sp/>%<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs)]<sp/>&lt;&lt;<sp/>8;</highlight></codeline>
<codeline lineno="841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>val<sp/>=<sp/>clst<sp/>&amp;<sp/>1<sp/>?<sp/>wc<sp/>&gt;&gt;<sp/>4<sp/>:<sp/>(wc<sp/>&amp;<sp/>0xFFF);</highlight></codeline>
<codeline lineno="842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="843"><highlight class="normal"></highlight></codeline>
<codeline lineno="844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a7ef90a36d99edfc0138a2155a17a79b9" kindref="member">FS_FAT16</ref><sp/>:</highlight></codeline>
<codeline lineno="845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" kindref="member">move_window</ref>(fs,<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a74e60540a346de6eb9f0c13d6203efa1" kindref="member">fatbase</ref><sp/>+<sp/>(clst<sp/>/<sp/>(<ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs)<sp/>/<sp/>2)))<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="846"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/>&amp;fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>[clst<sp/>*<sp/>2<sp/>%<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs)];</highlight></codeline>
<codeline lineno="847"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>val<sp/>=<sp/><ref refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" kindref="member">LD_WORD</ref>(p);</highlight></codeline>
<codeline lineno="848"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="849"><highlight class="normal"></highlight></codeline>
<codeline lineno="850"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" kindref="member">FS_FAT32</ref><sp/>:</highlight></codeline>
<codeline lineno="851"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" kindref="member">move_window</ref>(fs,<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a74e60540a346de6eb9f0c13d6203efa1" kindref="member">fatbase</ref><sp/>+<sp/>(clst<sp/>/<sp/>(<ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs)<sp/>/<sp/>4)))<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="852"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/>&amp;fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>[clst<sp/>*<sp/>4<sp/>%<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs)];</highlight></codeline>
<codeline lineno="853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>val<sp/>=<sp/><ref refid="ff_8h_1a4690304ddc975516f7dc02575c96e34e" kindref="member">LD_DWORD</ref>(p)<sp/>&amp;<sp/>0x0FFFFFFF;</highlight></codeline>
<codeline lineno="854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="855"><highlight class="normal"></highlight></codeline>
<codeline lineno="856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>val<sp/>=<sp/>1;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Internal<sp/>error<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="859"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="860"><highlight class="normal"></highlight></codeline>
<codeline lineno="861"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>val;</highlight></codeline>
<codeline lineno="862"><highlight class="normal">}</highlight></codeline>
<codeline lineno="863"><highlight class="normal"></highlight></codeline>
<codeline lineno="864"><highlight class="normal"></highlight></codeline>
<codeline lineno="865"><highlight class="normal"></highlight></codeline>
<codeline lineno="866"><highlight class="normal"></highlight></codeline>
<codeline lineno="867"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="868"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>FAT<sp/>access<sp/>-<sp/>Change<sp/>value<sp/>of<sp/>a<sp/>FAT<sp/>entry<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="869"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="870"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Hidden<sp/>API<sp/>for<sp/>hacks<sp/>and<sp/>disk<sp/>tools<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="871"><highlight class="normal"></highlight></codeline>
<codeline lineno="872"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="873" refid="ff_8c_1abd4b6b071a8d728a88727051c12bc6d7" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="ff_8c_1abd4b6b071a8d728a88727051c12bc6d7" kindref="member">put_fat</ref><sp/>(<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FR_OK(0):succeeded,<sp/>!=0:error<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="874"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref>*<sp/>fs,<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>File<sp/>system<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="875"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>clst,<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FAT<sp/>index<sp/>number<sp/>(cluster<sp/>number)<sp/>to<sp/>be<sp/>changed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="876"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>val<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>New<sp/>value<sp/>to<sp/>be<sp/>set<sp/>to<sp/>the<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="877"><highlight class="normal">)</highlight></codeline>
<codeline lineno="878"><highlight class="normal">{</highlight></codeline>
<codeline lineno="879"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>bc;</highlight></codeline>
<codeline lineno="880"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>*p;</highlight></codeline>
<codeline lineno="881"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="882"><highlight class="normal"></highlight></codeline>
<codeline lineno="883"><highlight class="normal"></highlight></codeline>
<codeline lineno="884"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>&lt;<sp/>2<sp/>||<sp/>clst<sp/>&gt;=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" kindref="member">n_fatent</ref>)<sp/>{<sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>if<sp/>in<sp/>valid<sp/>range<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>;</highlight></codeline>
<codeline lineno="886"><highlight class="normal"></highlight></codeline>
<codeline lineno="887"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(fs-&gt;<ref refid="struct_f_a_t_f_s_1a3630ef0b29c45ef8e0c1de639efab754" kindref="member">fs_type</ref>)<sp/>{</highlight></codeline>
<codeline lineno="889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1aab755aa1b4f81f4aabee4a5d4738cfb0" kindref="member">FS_FAT12</ref><sp/>:</highlight></codeline>
<codeline lineno="890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bc<sp/>=<sp/>(<ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref>)clst;<sp/>bc<sp/>+=<sp/>bc<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" kindref="member">move_window</ref>(fs,<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a74e60540a346de6eb9f0c13d6203efa1" kindref="member">fatbase</ref><sp/>+<sp/>(bc<sp/>/<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs)));</highlight></codeline>
<codeline lineno="892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/>&amp;fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>[bc++<sp/>%<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs)];</highlight></codeline>
<codeline lineno="894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*p<sp/>=<sp/>(clst<sp/>&amp;<sp/>1)<sp/>?<sp/>((*p<sp/>&amp;<sp/>0x0F)<sp/>|<sp/>((<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)val<sp/>&lt;&lt;<sp/>4))<sp/>:<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)val;</highlight></codeline>
<codeline lineno="895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" kindref="member">wflag</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" kindref="member">move_window</ref>(fs,<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a74e60540a346de6eb9f0c13d6203efa1" kindref="member">fatbase</ref><sp/>+<sp/>(bc<sp/>/<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs)));</highlight></codeline>
<codeline lineno="897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/>&amp;fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>[bc<sp/>%<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs)];</highlight></codeline>
<codeline lineno="899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*p<sp/>=<sp/>(clst<sp/>&amp;<sp/>1)<sp/>?<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)(val<sp/>&gt;&gt;<sp/>4)<sp/>:<sp/>((*p<sp/>&amp;<sp/>0xF0)<sp/>|<sp/>((<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)(val<sp/>&gt;&gt;<sp/>8)<sp/>&amp;<sp/>0x0F));</highlight></codeline>
<codeline lineno="900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" kindref="member">wflag</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="902"><highlight class="normal"></highlight></codeline>
<codeline lineno="903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a7ef90a36d99edfc0138a2155a17a79b9" kindref="member">FS_FAT16</ref><sp/>:</highlight></codeline>
<codeline lineno="904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" kindref="member">move_window</ref>(fs,<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a74e60540a346de6eb9f0c13d6203efa1" kindref="member">fatbase</ref><sp/>+<sp/>(clst<sp/>/<sp/>(<ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs)<sp/>/<sp/>2)));</highlight></codeline>
<codeline lineno="905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/>&amp;fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>[clst<sp/>*<sp/>2<sp/>%<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs)];</highlight></codeline>
<codeline lineno="907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" kindref="member">ST_WORD</ref>(p,<sp/>(<ref refid="integer_8h_1a197942eefa7db30960ae396d68339b97" kindref="member">WORD</ref>)val);</highlight></codeline>
<codeline lineno="908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" kindref="member">wflag</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="910"><highlight class="normal"></highlight></codeline>
<codeline lineno="911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" kindref="member">FS_FAT32</ref><sp/>:</highlight></codeline>
<codeline lineno="912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" kindref="member">move_window</ref>(fs,<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a74e60540a346de6eb9f0c13d6203efa1" kindref="member">fatbase</ref><sp/>+<sp/>(clst<sp/>/<sp/>(<ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs)<sp/>/<sp/>4)));</highlight></codeline>
<codeline lineno="913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/>&amp;fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>[clst<sp/>*<sp/>4<sp/>%<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs)];</highlight></codeline>
<codeline lineno="915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>val<sp/>|=<sp/><ref refid="ff_8h_1a4690304ddc975516f7dc02575c96e34e" kindref="member">LD_DWORD</ref>(p)<sp/>&amp;<sp/>0xF0000000;</highlight></codeline>
<codeline lineno="916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(p,<sp/>val);</highlight></codeline>
<codeline lineno="917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" kindref="member">wflag</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="919"><highlight class="normal"></highlight></codeline>
<codeline lineno="920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal"><sp/>:</highlight></codeline>
<codeline lineno="921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>;</highlight></codeline>
<codeline lineno="922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="923"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="924"><highlight class="normal"></highlight></codeline>
<codeline lineno="925"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="926"><highlight class="normal">}</highlight></codeline>
<codeline lineno="927"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>!_FS_READONLY<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="928"><highlight class="normal"></highlight></codeline>
<codeline lineno="929"><highlight class="normal"></highlight></codeline>
<codeline lineno="930"><highlight class="normal"></highlight></codeline>
<codeline lineno="931"><highlight class="normal"></highlight></codeline>
<codeline lineno="932"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="933"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>FAT<sp/>handling<sp/>-<sp/>Remove<sp/>a<sp/>cluster<sp/>chain<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="934"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="935"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="936"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="937" refid="ff_8c_1ab88651d19a5597dec220fe7538cccf23" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="ff_8c_1ab88651d19a5597dec220fe7538cccf23" kindref="member">remove_chain</ref><sp/>(<sp/><sp/></highlight><highlight class="comment">/*<sp/>FR_OK(0):succeeded,<sp/>!=0:error<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="938"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref>*<sp/>fs,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>File<sp/>system<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="939"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>clst<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Cluster#<sp/>to<sp/>remove<sp/>a<sp/>chain<sp/>from<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="940"><highlight class="normal">)</highlight></codeline>
<codeline lineno="941"><highlight class="normal">{</highlight></codeline>
<codeline lineno="942"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="943"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>nxt;</highlight></codeline>
<codeline lineno="944"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_TRIM</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="945"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>scl<sp/>=<sp/>clst,<sp/>ecl<sp/>=<sp/>clst,<sp/>rt[2];</highlight></codeline>
<codeline lineno="946"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="947"><highlight class="normal"></highlight></codeline>
<codeline lineno="948"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>&lt;<sp/>2<sp/>||<sp/>clst<sp/>&gt;=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" kindref="member">n_fatent</ref>)<sp/>{<sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>if<sp/>in<sp/>valid<sp/>range<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>;</highlight></codeline>
<codeline lineno="950"><highlight class="normal"></highlight></codeline>
<codeline lineno="951"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="952"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>;</highlight></codeline>
<codeline lineno="953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(clst<sp/>&lt;<sp/>fs-&gt;n_fatent)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Not<sp/>a<sp/>last<sp/>link?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="954"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nxt<sp/>=<sp/><ref refid="ff_8c_1a65611adf1626e5e08da77cd33a98dd8b" kindref="member">get_fat</ref>(fs,<sp/>clst);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>cluster<sp/>status<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nxt<sp/>==<sp/>0)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Empty<sp/>cluster?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nxt<sp/>==<sp/>1)<sp/>{<sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/>}<sp/><sp/></highlight><highlight class="comment">/*<sp/>Internal<sp/>error?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nxt<sp/>==<sp/>0xFFFFFFFF)<sp/>{<sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/>}<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Disk<sp/>error?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1abd4b6b071a8d728a88727051c12bc6d7" kindref="member">put_fat</ref>(fs,<sp/>clst,<sp/>0);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Mark<sp/>the<sp/>cluster<sp/>&quot;empty&quot;<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fs-&gt;<ref refid="struct_f_a_t_f_s_1a509defa217cfb2eb777ed3c74c4ef426" kindref="member">free_clust</ref><sp/>!=<sp/>0xFFFFFFFF)<sp/>{<sp/></highlight><highlight class="comment">/*<sp/>Update<sp/>FSINFO<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a509defa217cfb2eb777ed3c74c4ef426" kindref="member">free_clust</ref>++;</highlight></codeline>
<codeline lineno="962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a66c4d8e68262d5542852e2aed6ce69b4" kindref="member">fsi_flag</ref><sp/>|=<sp/>1;</highlight></codeline>
<codeline lineno="963"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="964"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_TRIM</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ecl<sp/>+<sp/>1<sp/>==<sp/>nxt)<sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Is<sp/>next<sp/>cluster<sp/>contiguous?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ecl<sp/>=<sp/>nxt;</highlight></codeline>
<codeline lineno="967"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>End<sp/>of<sp/>contiguous<sp/>clusters<sp/>*/</highlight><highlight class="normal"><sp/></highlight></codeline>
<codeline lineno="968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rt[0]<sp/>=<sp/><ref refid="ff_8c_1a7519abb60fe91f6aa1d17f64fbae123a" kindref="member">clust2sect</ref>(fs,<sp/>scl);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Start<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rt[1]<sp/>=<sp/><ref refid="ff_8c_1a7519abb60fe91f6aa1d17f64fbae123a" kindref="member">clust2sect</ref>(fs,<sp/>ecl)<sp/>+<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" kindref="member">csize</ref><sp/>-<sp/>1;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>End<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga3051f51f1cccb103d145804d5d91b04d" kindref="member">disk_ioctl</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" kindref="member">drv</ref>,<sp/><ref refid="diskio_8h_1af09fd84bea8d4e889e272471f44d60d6" kindref="member">CTRL_TRIM</ref>,<sp/>rt);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Erase<sp/>the<sp/>block<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>scl<sp/>=<sp/>ecl<sp/>=<sp/>nxt;</highlight></codeline>
<codeline lineno="972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="973"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clst<sp/>=<sp/>nxt;<sp/></highlight><highlight class="comment">/*<sp/>Next<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="976"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="977"><highlight class="normal"></highlight></codeline>
<codeline lineno="978"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="979"><highlight class="normal">}</highlight></codeline>
<codeline lineno="980"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="981"><highlight class="normal"></highlight></codeline>
<codeline lineno="982"><highlight class="normal"></highlight></codeline>
<codeline lineno="983"><highlight class="normal"></highlight></codeline>
<codeline lineno="984"><highlight class="normal"></highlight></codeline>
<codeline lineno="985"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="986"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>FAT<sp/>handling<sp/>-<sp/>Stretch<sp/>or<sp/>Create<sp/>a<sp/>cluster<sp/>chain<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="987"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="988"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="989"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="990" refid="ff_8c_1acbd0a20a17c6f9b6d536490d1cc3c5ac" refkind="member"><highlight class="normal"><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/><ref refid="ff_8c_1acbd0a20a17c6f9b6d536490d1cc3c5ac" kindref="member">create_chain</ref><sp/>(<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>0:No<sp/>free<sp/>cluster,<sp/>1:Internal<sp/>error,<sp/>0xFFFFFFFF:Disk<sp/>error,<sp/>&gt;=2:New<sp/>cluster#<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="991"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref>*<sp/>fs,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>File<sp/>system<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="992"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>clst<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Cluster#<sp/>to<sp/>stretch,<sp/>0:Create<sp/>a<sp/>new<sp/>chain<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="993"><highlight class="normal">)</highlight></codeline>
<codeline lineno="994"><highlight class="normal">{</highlight></codeline>
<codeline lineno="995"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>cs,<sp/>ncl,<sp/>scl;</highlight></codeline>
<codeline lineno="996"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="997"><highlight class="normal"></highlight></codeline>
<codeline lineno="998"><highlight class="normal"></highlight></codeline>
<codeline lineno="999"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>==<sp/>0)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>a<sp/>new<sp/>chain<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>scl<sp/>=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a10cd8b80b3b6474bf0d6432c8fb9d2d2" kindref="member">last_clust</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>suggested<sp/>start<sp/>point<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!scl<sp/>||<sp/>scl<sp/>&gt;=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" kindref="member">n_fatent</ref>)<sp/>scl<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1002"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1003"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Stretch<sp/>the<sp/>current<sp/>chain<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cs<sp/>=<sp/><ref refid="ff_8c_1a65611adf1626e5e08da77cd33a98dd8b" kindref="member">get_fat</ref>(fs,<sp/>clst);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>the<sp/>cluster<sp/>status<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(cs<sp/>&lt;<sp/>2)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Invalid<sp/>value<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(cs<sp/>==<sp/>0xFFFFFFFF)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>cs;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>A<sp/>disk<sp/>error<sp/>occurred<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(cs<sp/>&lt;<sp/>fs-&gt;n_fatent)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>cs;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>It<sp/>is<sp/>already<sp/>followed<sp/>by<sp/>next<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>scl<sp/>=<sp/>clst;</highlight></codeline>
<codeline lineno="1009"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1010"><highlight class="normal"></highlight></codeline>
<codeline lineno="1011"><highlight class="normal"><sp/><sp/><sp/><sp/>ncl<sp/>=<sp/>scl;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Start<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1012"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(;;)<sp/>{</highlight></codeline>
<codeline lineno="1013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ncl++;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Next<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ncl<sp/>&gt;=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" kindref="member">n_fatent</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>wrap<sp/>around<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ncl<sp/>=<sp/>2;</highlight></codeline>
<codeline lineno="1016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ncl<sp/>&gt;<sp/>scl)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>No<sp/>free<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cs<sp/>=<sp/><ref refid="ff_8c_1a65611adf1626e5e08da77cd33a98dd8b" kindref="member">get_fat</ref>(fs,<sp/>ncl);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>the<sp/>cluster<sp/>status<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(cs<sp/>==<sp/>0)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Found<sp/>a<sp/>free<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(cs<sp/>==<sp/>0xFFFFFFFF<sp/>||<sp/>cs<sp/>==<sp/>1)</highlight><highlight class="comment">/*<sp/>An<sp/>error<sp/>occurred<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>cs;</highlight></codeline>
<codeline lineno="1022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ncl<sp/>==<sp/>scl)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>No<sp/>free<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1023"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1024"><highlight class="normal"></highlight></codeline>
<codeline lineno="1025"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1abd4b6b071a8d728a88727051c12bc6d7" kindref="member">put_fat</ref>(fs,<sp/>ncl,<sp/>0x0FFFFFFF);<sp/></highlight><highlight class="comment">/*<sp/>Mark<sp/>the<sp/>new<sp/>cluster<sp/>&quot;last<sp/>link&quot;<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1026"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref><sp/>&amp;&amp;<sp/>clst<sp/>!=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1abd4b6b071a8d728a88727051c12bc6d7" kindref="member">put_fat</ref>(fs,<sp/>clst,<sp/>ncl);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Link<sp/>it<sp/>to<sp/>the<sp/>previous<sp/>one<sp/>if<sp/>needed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1028"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1029"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a10cd8b80b3b6474bf0d6432c8fb9d2d2" kindref="member">last_clust</ref><sp/>=<sp/>ncl;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Update<sp/>FSINFO<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fs-&gt;<ref refid="struct_f_a_t_f_s_1a509defa217cfb2eb777ed3c74c4ef426" kindref="member">free_clust</ref><sp/>!=<sp/>0xFFFFFFFF)<sp/>{</highlight></codeline>
<codeline lineno="1032"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a509defa217cfb2eb777ed3c74c4ef426" kindref="member">free_clust</ref>--;</highlight></codeline>
<codeline lineno="1033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a66c4d8e68262d5542852e2aed6ce69b4" kindref="member">fsi_flag</ref><sp/>|=<sp/>1;</highlight></codeline>
<codeline lineno="1034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1035"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ncl<sp/>=<sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>)<sp/>?<sp/>0xFFFFFFFF<sp/>:<sp/>1;</highlight></codeline>
<codeline lineno="1037"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1038"><highlight class="normal"></highlight></codeline>
<codeline lineno="1039"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ncl;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Return<sp/>new<sp/>cluster<sp/>number<sp/>or<sp/>error<sp/>code<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1040"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1041"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>!_FS_READONLY<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1042"><highlight class="normal"></highlight></codeline>
<codeline lineno="1043"><highlight class="normal"></highlight></codeline>
<codeline lineno="1044"><highlight class="normal"></highlight></codeline>
<codeline lineno="1045"><highlight class="normal"></highlight></codeline>
<codeline lineno="1046"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1047"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>FAT<sp/>handling<sp/>-<sp/>Convert<sp/>offset<sp/>into<sp/>cluster<sp/>with<sp/>link<sp/>map<sp/>table<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1048"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1049"><highlight class="normal"></highlight></codeline>
<codeline lineno="1050"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_FASTSEEK</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1051"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1052"><highlight class="normal"><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>clmt_clust<sp/>(<sp/><sp/></highlight><highlight class="comment">/*<sp/>&lt;2:Error,<sp/>&gt;=2:Cluster<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1053"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_i_l" kindref="compound">FIL</ref>*<sp/>fp,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>file<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1054"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>ofs<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>File<sp/>offset<sp/>to<sp/>be<sp/>converted<sp/>to<sp/>cluster#<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1055"><highlight class="normal">)</highlight></codeline>
<codeline lineno="1056"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1057"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>cl,<sp/>ncl,<sp/>*tbl;</highlight></codeline>
<codeline lineno="1058"><highlight class="normal"></highlight></codeline>
<codeline lineno="1059"><highlight class="normal"></highlight></codeline>
<codeline lineno="1060"><highlight class="normal"><sp/><sp/><sp/><sp/>tbl<sp/>=<sp/>fp-&gt;cltbl<sp/>+<sp/>1;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Top<sp/>of<sp/>CLMT<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1061"><highlight class="normal"><sp/><sp/><sp/><sp/>cl<sp/>=<sp/>ofs<sp/>/<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)<sp/>/<sp/>fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" kindref="member">csize</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Cluster<sp/>order<sp/>from<sp/>top<sp/>of<sp/>the<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1062"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(;;)<sp/>{</highlight></codeline>
<codeline lineno="1063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ncl<sp/>=<sp/>*tbl++;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>cluters<sp/>in<sp/>the<sp/>fragment<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!ncl)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>End<sp/>of<sp/>table?<sp/>(error)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(cl<sp/>&lt;<sp/>ncl)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>In<sp/>this<sp/>fragment?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cl<sp/>-=<sp/>ncl;<sp/>tbl++;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Next<sp/>fragment<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1067"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1068"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>cl<sp/>+<sp/>*tbl;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Return<sp/>the<sp/>cluster<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1069"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1070"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/><sp/></highlight><highlight class="comment">/*<sp/>_USE_FASTSEEK<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1071"><highlight class="normal"></highlight></codeline>
<codeline lineno="1072"><highlight class="normal"></highlight></codeline>
<codeline lineno="1073"><highlight class="normal"></highlight></codeline>
<codeline lineno="1074"><highlight class="normal"></highlight></codeline>
<codeline lineno="1075"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1076"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Directory<sp/>handling<sp/>-<sp/>Set<sp/>directory<sp/>index<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1077"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1078"><highlight class="normal"></highlight></codeline>
<codeline lineno="1079"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1080" refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" kindref="member">dir_sdi</ref><sp/>(<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FR_OK(0):succeeded,<sp/>!=0:error<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1081"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref>*<sp/>dp,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>directory<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1082"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>idx<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Index<sp/>of<sp/>directory<sp/>table<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1083"><highlight class="normal">)</highlight></codeline>
<codeline lineno="1084"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1085"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>clst,<sp/>sect;</highlight></codeline>
<codeline lineno="1086"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>ic;</highlight></codeline>
<codeline lineno="1087"><highlight class="normal"></highlight></codeline>
<codeline lineno="1088"><highlight class="normal"></highlight></codeline>
<codeline lineno="1089"><highlight class="normal"><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1ab7c5089b70ce76bcd61abe615ed2a42b" kindref="member">index</ref><sp/>=<sp/>(<ref refid="integer_8h_1a197942eefa7db30960ae396d68339b97" kindref="member">WORD</ref>)idx;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Current<sp/>index<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1090"><highlight class="normal"><sp/><sp/><sp/><sp/>clst<sp/>=<sp/>dp-&gt;<ref refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref>;<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Table<sp/>start<sp/>cluster<sp/>(0:root)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1091"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>==<sp/>1<sp/>||<sp/>clst<sp/>&gt;=<sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" kindref="member">n_fatent</ref>)<sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>start<sp/>cluster<sp/>range<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>;</highlight></codeline>
<codeline lineno="1093"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!clst<sp/>&amp;&amp;<sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1a3630ef0b29c45ef8e0c1de639efab754" kindref="member">fs_type</ref><sp/>==<sp/><ref refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" kindref="member">FS_FAT32</ref>)<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Replace<sp/>cluster#<sp/>0<sp/>with<sp/>root<sp/>cluster#<sp/>if<sp/>in<sp/>FAT32<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clst<sp/>=<sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1aebfa6556d8f94e951a8b2c1eb740e9a1" kindref="member">dirbase</ref>;</highlight></codeline>
<codeline lineno="1095"><highlight class="normal"></highlight></codeline>
<codeline lineno="1096"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>==<sp/>0)<sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Static<sp/>table<sp/>(root-directory<sp/>in<sp/>FAT12/16)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(idx<sp/>&gt;=<sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1a22e74fc44cd5274ba7c3b18d5e357697" kindref="member">n_rootdir</ref>)<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Is<sp/>index<sp/>out<sp/>of<sp/>range?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>;</highlight></codeline>
<codeline lineno="1099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sect<sp/>=<sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1aebfa6556d8f94e951a8b2c1eb740e9a1" kindref="member">dirbase</ref>;</highlight></codeline>
<codeline lineno="1100"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1101"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Dynamic<sp/>table<sp/>(root-directory<sp/>in<sp/>FAT32<sp/>or<sp/>sub-directory)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ic<sp/>=<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)<sp/>/<sp/><ref refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" kindref="member">SZ_DIRE</ref><sp/>*<sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" kindref="member">csize</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Entries<sp/>per<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(idx<sp/>&gt;=<sp/>ic)<sp/>{<sp/></highlight><highlight class="comment">/*<sp/>Follow<sp/>cluster<sp/>chain<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clst<sp/>=<sp/><ref refid="ff_8c_1a65611adf1626e5e08da77cd33a98dd8b" kindref="member">get_fat</ref>(dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>clst);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>next<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>==<sp/>0xFFFFFFFF)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>;<sp/></highlight><highlight class="comment">/*<sp/>Disk<sp/>error<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>&lt;<sp/>2<sp/>||<sp/>clst<sp/>&gt;=<sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" kindref="member">n_fatent</ref>)<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Reached<sp/>to<sp/>end<sp/>of<sp/>table<sp/>or<sp/>internal<sp/>error<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>;</highlight></codeline>
<codeline lineno="1108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>idx<sp/>-=<sp/>ic;</highlight></codeline>
<codeline lineno="1109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sect<sp/>=<sp/><ref refid="ff_8c_1a7519abb60fe91f6aa1d17f64fbae123a" kindref="member">clust2sect</ref>(dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>clst);</highlight></codeline>
<codeline lineno="1111"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1112"><highlight class="normal"><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1ac134c1b4645be670eb5207032e714616" kindref="member">clust</ref><sp/>=<sp/>clst;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Current<sp/>cluster#<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1113"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!sect)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>;</highlight></codeline>
<codeline lineno="1114"><highlight class="normal"><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1a3e49e0860170e0fd9fc3e891b0d59975" kindref="member">sect</ref><sp/>=<sp/>sect<sp/>+<sp/>idx<sp/>/<sp/>(<ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)<sp/>/<sp/><ref refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" kindref="member">SZ_DIRE</ref>);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Sector#<sp/>of<sp/>the<sp/>directory<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1115"><highlight class="normal"><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref><sp/>=<sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref><sp/>+<sp/>(idx<sp/>%<sp/>(<ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)<sp/>/<sp/><ref refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" kindref="member">SZ_DIRE</ref>))<sp/>*<sp/><ref refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" kindref="member">SZ_DIRE</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Ptr<sp/>to<sp/>the<sp/>entry<sp/>in<sp/>the<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1116"><highlight class="normal"></highlight></codeline>
<codeline lineno="1117"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>;</highlight></codeline>
<codeline lineno="1118"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1119"><highlight class="normal"></highlight></codeline>
<codeline lineno="1120"><highlight class="normal"></highlight></codeline>
<codeline lineno="1121"><highlight class="normal"></highlight></codeline>
<codeline lineno="1122"><highlight class="normal"></highlight></codeline>
<codeline lineno="1123"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1124"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Directory<sp/>handling<sp/>-<sp/>Move<sp/>directory<sp/>table<sp/>index<sp/>next<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1125"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1126"><highlight class="normal"></highlight></codeline>
<codeline lineno="1127"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1128" refid="ff_8c_1a2edd26ac71869f25be5fce12eec58171" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="ff_8c_1a2edd26ac71869f25be5fce12eec58171" kindref="member">dir_next</ref><sp/>(<sp/><sp/></highlight><highlight class="comment">/*<sp/>FR_OK(0):succeeded,<sp/>FR_NO_FILE:End<sp/>of<sp/>table,<sp/>FR_DENIED:Could<sp/>not<sp/>stretch<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1129"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref>*<sp/>dp,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>directory<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1130"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>stretch<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>0:<sp/>Do<sp/>not<sp/>stretch<sp/>table,<sp/>1:<sp/>Stretch<sp/>table<sp/>if<sp/>needed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1131"><highlight class="normal">)</highlight></codeline>
<codeline lineno="1132"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1133"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>clst;</highlight></codeline>
<codeline lineno="1134"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>i;</highlight></codeline>
<codeline lineno="1135"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1136"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>c;</highlight></codeline>
<codeline lineno="1137"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1138"><highlight class="normal"></highlight></codeline>
<codeline lineno="1139"><highlight class="normal"></highlight></codeline>
<codeline lineno="1140"><highlight class="normal"><sp/><sp/><sp/><sp/>i<sp/>=<sp/>dp-&gt;<ref refid="struct_d_i_r_1ab7c5089b70ce76bcd61abe615ed2a42b" kindref="member">index</ref><sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="1141"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!(i<sp/>&amp;<sp/>0xFFFF)<sp/>||<sp/>!dp-&gt;<ref refid="struct_d_i_r_1a3e49e0860170e0fd9fc3e891b0d59975" kindref="member">sect</ref>)<sp/></highlight><highlight class="comment">/*<sp/>Report<sp/>EOT<sp/>when<sp/>index<sp/>has<sp/>reached<sp/>65535<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref>;</highlight></codeline>
<codeline lineno="1143"><highlight class="normal"></highlight></codeline>
<codeline lineno="1144"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!(i<sp/>%<sp/>(<ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)<sp/>/<sp/><ref refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" kindref="member">SZ_DIRE</ref>)))<sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Sector<sp/>changed?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1a3e49e0860170e0fd9fc3e891b0d59975" kindref="member">sect</ref>++;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Next<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1146"><highlight class="normal"></highlight></codeline>
<codeline lineno="1147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!dp-&gt;<ref refid="struct_d_i_r_1ac134c1b4645be670eb5207032e714616" kindref="member">clust</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Static<sp/>table<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>&gt;=<sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1a22e74fc44cd5274ba7c3b18d5e357697" kindref="member">n_rootdir</ref>)<sp/></highlight><highlight class="comment">/*<sp/>Report<sp/>EOT<sp/>if<sp/>it<sp/>reached<sp/>end<sp/>of<sp/>static<sp/>table<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref>;</highlight></codeline>
<codeline lineno="1150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Dynamic<sp/>table<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(((i<sp/>/<sp/>(<ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)<sp/>/<sp/><ref refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" kindref="member">SZ_DIRE</ref>))<sp/>&amp;<sp/>(dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" kindref="member">csize</ref><sp/>-<sp/>1))<sp/>==<sp/>0)<sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Cluster<sp/>changed?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clst<sp/>=<sp/><ref refid="ff_8c_1a65611adf1626e5e08da77cd33a98dd8b" kindref="member">get_fat</ref>(dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>dp-&gt;<ref refid="struct_d_i_r_1ac134c1b4645be670eb5207032e714616" kindref="member">clust</ref>);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>next<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>&lt;=<sp/>1)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>;</highlight></codeline>
<codeline lineno="1155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>==<sp/>0xFFFFFFFF)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>;</highlight></codeline>
<codeline lineno="1156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>&gt;=<sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" kindref="member">n_fatent</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>it<sp/>reached<sp/>end<sp/>of<sp/>dynamic<sp/>table,<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1157"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!stretch)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>do<sp/>not<sp/>stretch,<sp/>report<sp/>EOT<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clst<sp/>=<sp/><ref refid="ff_8c_1acbd0a20a17c6f9b6d536490d1cc3c5ac" kindref="member">create_chain</ref>(dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>dp-&gt;<ref refid="struct_d_i_r_1ac134c1b4645be670eb5207032e714616" kindref="member">clust</ref>);<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Stretch<sp/>cluster<sp/>chain<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>==<sp/>0)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d" kindref="member">FR_DENIED</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>No<sp/>free<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>==<sp/>1)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>;</highlight></codeline>
<codeline lineno="1162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>==<sp/>0xFFFFFFFF)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>;</highlight></codeline>
<codeline lineno="1163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Clean-up<sp/>stretched<sp/>table<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1a5e18753404354b210096f9af99e31bc1" kindref="member">sync_window</ref>(dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>))<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>;</highlight><highlight class="comment">/*<sp/>Flush<sp/>disk<sp/>access<sp/>window<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a02eb5189e43056a9ddc8a59cbe89be93" kindref="member">mem_set</ref>(dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>,<sp/>0,<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>));<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Clear<sp/>window<sp/>buffer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" kindref="member">winsect</ref><sp/>=<sp/><ref refid="ff_8c_1a7519abb60fe91f6aa1d17f64fbae123a" kindref="member">clust2sect</ref>(dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>clst);<sp/></highlight><highlight class="comment">/*<sp/>Cluster<sp/>start<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(c<sp/>=<sp/>0;<sp/>c<sp/>&lt;<sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" kindref="member">csize</ref>;<sp/>c++)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Fill<sp/>the<sp/>new<sp/>cluster<sp/>with<sp/>0<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" kindref="member">wflag</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1a5e18753404354b210096f9af99e31bc1" kindref="member">sync_window</ref>(dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>))<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>;</highlight></codeline>
<codeline lineno="1170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" kindref="member">winsect</ref>++;</highlight></codeline>
<codeline lineno="1171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" kindref="member">winsect</ref><sp/>-=<sp/>c;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Rewind<sp/>window<sp/>offset<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1173"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!stretch)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>do<sp/>not<sp/>stretch,<sp/>report<sp/>EOT<sp/>(this<sp/>is<sp/>to<sp/>suppress<sp/>warning)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Report<sp/>EOT<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1176"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1ac134c1b4645be670eb5207032e714616" kindref="member">clust</ref><sp/>=<sp/>clst;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Initialize<sp/>data<sp/>for<sp/>new<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1a3e49e0860170e0fd9fc3e891b0d59975" kindref="member">sect</ref><sp/>=<sp/><ref refid="ff_8c_1a7519abb60fe91f6aa1d17f64fbae123a" kindref="member">clust2sect</ref>(dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>clst);</highlight></codeline>
<codeline lineno="1180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1182"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1183"><highlight class="normal"></highlight></codeline>
<codeline lineno="1184"><highlight class="normal"><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1ab7c5089b70ce76bcd61abe615ed2a42b" kindref="member">index</ref><sp/>=<sp/>(<ref refid="integer_8h_1a197942eefa7db30960ae396d68339b97" kindref="member">WORD</ref>)i;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Current<sp/>index<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1185"><highlight class="normal"><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref><sp/>=<sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref><sp/>+<sp/>(i<sp/>%<sp/>(<ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)<sp/>/<sp/><ref refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" kindref="member">SZ_DIRE</ref>))<sp/>*<sp/><ref refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" kindref="member">SZ_DIRE</ref>;<sp/></highlight><highlight class="comment">/*<sp/>Current<sp/>entry<sp/>in<sp/>the<sp/>window<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1186"><highlight class="normal"></highlight></codeline>
<codeline lineno="1187"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>;</highlight></codeline>
<codeline lineno="1188"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1189"><highlight class="normal"></highlight></codeline>
<codeline lineno="1190"><highlight class="normal"></highlight></codeline>
<codeline lineno="1191"><highlight class="normal"></highlight></codeline>
<codeline lineno="1192"><highlight class="normal"></highlight></codeline>
<codeline lineno="1193"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1194"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Directory<sp/>handling<sp/>-<sp/>Reserve<sp/>directory<sp/>entry<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1195"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1196"><highlight class="normal"></highlight></codeline>
<codeline lineno="1197"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1198"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1199" refid="ff_8c_1a23ff0594686ccbd8f8d987547931ef04" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="ff_8c_1a23ff0594686ccbd8f8d987547931ef04" kindref="member">dir_alloc</ref><sp/>(<sp/></highlight><highlight class="comment">/*<sp/>FR_OK(0):succeeded,<sp/>!=0:error<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1200"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref>*<sp/>dp,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>directory<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1201"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>nent<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>contiguous<sp/>entries<sp/>to<sp/>allocate<sp/>(1-21)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1202"><highlight class="normal">)</highlight></codeline>
<codeline lineno="1203"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1204"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="1205"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>n;</highlight></codeline>
<codeline lineno="1206"><highlight class="normal"></highlight></codeline>
<codeline lineno="1207"><highlight class="normal"></highlight></codeline>
<codeline lineno="1208"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" kindref="member">dir_sdi</ref>(dp,<sp/>0);</highlight></codeline>
<codeline lineno="1209"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" kindref="member">move_window</ref>(dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>dp-&gt;<ref refid="struct_d_i_r_1a3e49e0860170e0fd9fc3e891b0d59975" kindref="member">sect</ref>);</highlight></codeline>
<codeline lineno="1213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dp-&gt;<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>[0]<sp/>==<sp/><ref refid="ff_8c_1a0f2455f7318e6d56318c62f5e4048e1e" kindref="member">DDEM</ref><sp/>||<sp/>dp-&gt;<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>[0]<sp/>==<sp/>0)<sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Is<sp/>it<sp/>a<sp/>free<sp/>entry?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(++n<sp/>==<sp/>nent)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/></highlight><highlight class="comment">/*<sp/>A<sp/>block<sp/>of<sp/>contiguous<sp/>free<sp/>entries<sp/>is<sp/>found<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Not<sp/>a<sp/>blank<sp/>entry.<sp/>Restart<sp/>to<sp/>search<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a2edd26ac71869f25be5fce12eec58171" kindref="member">dir_next</ref>(dp,<sp/>1);<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Next<sp/>entry<sp/>with<sp/>table<sp/>stretch<sp/>enabled<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>);</highlight></codeline>
<codeline lineno="1221"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1222"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref>)<sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d" kindref="member">FR_DENIED</ref>;<sp/></highlight><highlight class="comment">/*<sp/>No<sp/>directory<sp/>entry<sp/>to<sp/>allocate<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1223"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="1224"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1225"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1226"><highlight class="normal"></highlight></codeline>
<codeline lineno="1227"><highlight class="normal"></highlight></codeline>
<codeline lineno="1228"><highlight class="normal"></highlight></codeline>
<codeline lineno="1229"><highlight class="normal"></highlight></codeline>
<codeline lineno="1230"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1231"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Directory<sp/>handling<sp/>-<sp/>Load/Store<sp/>start<sp/>cluster<sp/>number<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1232"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1233"><highlight class="normal"></highlight></codeline>
<codeline lineno="1234"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1235" refid="ff_8c_1ad1b3343c92d0f0e58ba448c3c11b1f39" refkind="member"><highlight class="normal"><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/><ref refid="ff_8c_1ad1b3343c92d0f0e58ba448c3c11b1f39" kindref="member">ld_clust</ref><sp/>(<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Returns<sp/>the<sp/>top<sp/>cluster<sp/>value<sp/>of<sp/>the<sp/>SFN<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1236"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref>*<sp/>fs,<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>fs<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1237"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>*<sp/>dir<sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>SFN<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1238"><highlight class="normal">)</highlight></codeline>
<codeline lineno="1239"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1240"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>cl;</highlight></codeline>
<codeline lineno="1241"><highlight class="normal"></highlight></codeline>
<codeline lineno="1242"><highlight class="normal"><sp/><sp/><sp/><sp/>cl<sp/>=<sp/><ref refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" kindref="member">LD_WORD</ref>(dir<sp/>+<sp/><ref refid="ff_8c_1aebe0e913bff75a89d38dbcb04baf5dff" kindref="member">DIR_FstClusLO</ref>);</highlight></codeline>
<codeline lineno="1243"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fs-&gt;<ref refid="struct_f_a_t_f_s_1a3630ef0b29c45ef8e0c1de639efab754" kindref="member">fs_type</ref><sp/>==<sp/><ref refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" kindref="member">FS_FAT32</ref>)</highlight></codeline>
<codeline lineno="1244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cl<sp/>|=<sp/>(<ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref>)<ref refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" kindref="member">LD_WORD</ref>(dir<sp/>+<sp/><ref refid="ff_8c_1a0bc29c3f09e1e9c40c414f7d50d7905c" kindref="member">DIR_FstClusHI</ref>)<sp/>&lt;&lt;<sp/>16;</highlight></codeline>
<codeline lineno="1245"><highlight class="normal"></highlight></codeline>
<codeline lineno="1246"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>cl;</highlight></codeline>
<codeline lineno="1247"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1248"><highlight class="normal"></highlight></codeline>
<codeline lineno="1249"><highlight class="normal"></highlight></codeline>
<codeline lineno="1250"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1251"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1252" refid="ff_8c_1a357e5a36452e057d68378c98cd61018c" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ff_8c_1a357e5a36452e057d68378c98cd61018c" kindref="member">st_clust</ref><sp/>(</highlight></codeline>
<codeline lineno="1253"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>*<sp/>dir,<sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>SFN<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1254"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>cl<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Value<sp/>to<sp/>be<sp/>set<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1255"><highlight class="normal">)</highlight></codeline>
<codeline lineno="1256"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1257"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" kindref="member">ST_WORD</ref>(dir<sp/>+<sp/><ref refid="ff_8c_1aebe0e913bff75a89d38dbcb04baf5dff" kindref="member">DIR_FstClusLO</ref>,<sp/>cl);</highlight></codeline>
<codeline lineno="1258"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" kindref="member">ST_WORD</ref>(dir<sp/>+<sp/><ref refid="ff_8c_1a0bc29c3f09e1e9c40c414f7d50d7905c" kindref="member">DIR_FstClusHI</ref>,<sp/>cl<sp/>&gt;&gt;<sp/>16);</highlight></codeline>
<codeline lineno="1259"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1260"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1261"><highlight class="normal"></highlight></codeline>
<codeline lineno="1262"><highlight class="normal"></highlight></codeline>
<codeline lineno="1263"><highlight class="normal"></highlight></codeline>
<codeline lineno="1264"><highlight class="normal"></highlight></codeline>
<codeline lineno="1265"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1266"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>LFN<sp/>handling<sp/>-<sp/>Test/Pick/Fit<sp/>an<sp/>LFN<sp/>segment<sp/>from/to<sp/>directory<sp/>entry<sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1267"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1268"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1269"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1270" refid="ff_8c_1a3b4d3baf920ca4a0ac8731e7b3e680c4" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/><ref refid="ff_8c_1a3b4d3baf920ca4a0ac8731e7b3e680c4" kindref="member">LfnOfs</ref>[]<sp/>=<sp/>{1,3,5,7,9,14,16,18,20,22,24,28,30};<sp/><sp/></highlight><highlight class="comment">/*<sp/>Offset<sp/>of<sp/>LFN<sp/>characters<sp/>in<sp/>the<sp/>directory<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1271"><highlight class="normal"></highlight></codeline>
<codeline lineno="1272"><highlight class="normal"></highlight></codeline>
<codeline lineno="1273"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1274" refid="ff_8c_1a7ce4d4f3aa55873dc160d76778536a5f" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="ff_8c_1a7ce4d4f3aa55873dc160d76778536a5f" kindref="member">cmp_lfn</ref><sp/>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>1:matched,<sp/>0:not<sp/>matched<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1275"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a570001c92f314285ad3e7139d8c58cf7" kindref="member">WCHAR</ref>*<sp/>lfnbuf,<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>LFN<sp/>working<sp/>buffer<sp/>to<sp/>be<sp/>compared<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1276"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>*<sp/>dir<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>directory<sp/>entry<sp/>containing<sp/>the<sp/>part<sp/>of<sp/>LFN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1277"><highlight class="normal">)</highlight></codeline>
<codeline lineno="1278"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1279"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>i,<sp/>s;</highlight></codeline>
<codeline lineno="1280"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a570001c92f314285ad3e7139d8c58cf7" kindref="member">WCHAR</ref><sp/>wc,<sp/>uc;</highlight></codeline>
<codeline lineno="1281"><highlight class="normal"></highlight></codeline>
<codeline lineno="1282"><highlight class="normal"></highlight></codeline>
<codeline lineno="1283"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" kindref="member">LD_WORD</ref>(dir<sp/>+<sp/><ref refid="ff_8c_1ad73024151eff6baea94e680f7928969d" kindref="member">LDIR_FstClusLO</ref>)<sp/>!=<sp/>0)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>LDIR_FstClusLO<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1284"><highlight class="normal"></highlight></codeline>
<codeline lineno="1285"><highlight class="normal"><sp/><sp/><sp/><sp/>i<sp/>=<sp/>((dir[<ref refid="ff_8c_1a6c97d545619e6586b02b5d4f39f7be25" kindref="member">LDIR_Ord</ref>]<sp/>&amp;<sp/>0x3F)<sp/>-<sp/>1)<sp/>*<sp/>13;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Offset<sp/>in<sp/>the<sp/>LFN<sp/>buffer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1286"><highlight class="normal"></highlight></codeline>
<codeline lineno="1287"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(wc<sp/>=<sp/>1,<sp/>s<sp/>=<sp/>0;<sp/>s<sp/>&lt;<sp/>13;<sp/>s++)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Process<sp/>all<sp/>characters<sp/>in<sp/>the<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uc<sp/>=<sp/><ref refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" kindref="member">LD_WORD</ref>(dir<sp/>+<sp/>LfnOfs[s]);<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pick<sp/>an<sp/>LFN<sp/>character<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(wc)<sp/>{</highlight></codeline>
<codeline lineno="1290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>&gt;=<sp/><ref refid="group___f_f_c_o_n_f_i_g_1ga14e73a5c703a586c614b3e40b849f82c" kindref="member">_MAX_LFN</ref><sp/>||<sp/><ref refid="ff_8h_1af3555c2976dfadc4f1e5cbacc275a012" kindref="member">ff_wtoupper</ref>(uc)<sp/>!=<sp/><ref refid="ff_8h_1af3555c2976dfadc4f1e5cbacc275a012" kindref="member">ff_wtoupper</ref>(lfnbuf[i++]))<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Compare<sp/>it<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Not<sp/>matched<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wc<sp/>=<sp/>uc;</highlight></codeline>
<codeline lineno="1293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(uc<sp/>!=<sp/>0xFFFF)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>filler<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1296"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1297"><highlight class="normal"></highlight></codeline>
<codeline lineno="1298"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((dir[<ref refid="ff_8c_1a6c97d545619e6586b02b5d4f39f7be25" kindref="member">LDIR_Ord</ref>]<sp/>&amp;<sp/><ref refid="ff_8c_1a31ec96cd263bb14418cb8b7b2b54b3ca" kindref="member">LLEF</ref>)<sp/>&amp;&amp;<sp/>wc<sp/>&amp;&amp;<sp/>lfnbuf[i])<sp/><sp/></highlight><highlight class="comment">/*<sp/>Last<sp/>segment<sp/>matched<sp/>but<sp/>different<sp/>length<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="1300"><highlight class="normal"></highlight></codeline>
<codeline lineno="1301"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>The<sp/>part<sp/>of<sp/>LFN<sp/>matched<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1302"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1303"><highlight class="normal"></highlight></codeline>
<codeline lineno="1304"><highlight class="normal"></highlight></codeline>
<codeline lineno="1305"><highlight class="normal"></highlight></codeline>
<codeline lineno="1306"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1307" refid="ff_8c_1a2a2c96233e92d8abe12c4496caec85cf" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="ff_8c_1a2a2c96233e92d8abe12c4496caec85cf" kindref="member">pick_lfn</ref><sp/>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>1:succeeded,<sp/>0:buffer<sp/>overflow<sp/>or<sp/>invalid<sp/>LFN<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1308"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a570001c92f314285ad3e7139d8c58cf7" kindref="member">WCHAR</ref>*<sp/>lfnbuf,<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>LFN<sp/>working<sp/>buffer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1309"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>*<sp/>dir<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>LFN<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1310"><highlight class="normal">)</highlight></codeline>
<codeline lineno="1311"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1312"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>i,<sp/>s;</highlight></codeline>
<codeline lineno="1313"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a570001c92f314285ad3e7139d8c58cf7" kindref="member">WCHAR</ref><sp/>wc,<sp/>uc;</highlight></codeline>
<codeline lineno="1314"><highlight class="normal"></highlight></codeline>
<codeline lineno="1315"><highlight class="normal"></highlight></codeline>
<codeline lineno="1316"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" kindref="member">LD_WORD</ref>(dir<sp/>+<sp/><ref refid="ff_8c_1ad73024151eff6baea94e680f7928969d" kindref="member">LDIR_FstClusLO</ref>)<sp/>!=<sp/>0)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>LDIR_FstClusLO<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1317"><highlight class="normal"></highlight></codeline>
<codeline lineno="1318"><highlight class="normal"><sp/><sp/><sp/><sp/>i<sp/>=<sp/>((dir[<ref refid="ff_8c_1a6c97d545619e6586b02b5d4f39f7be25" kindref="member">LDIR_Ord</ref>]<sp/>&amp;<sp/>0x3F)<sp/>-<sp/>1)<sp/>*<sp/>13;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Offset<sp/>in<sp/>the<sp/>LFN<sp/>buffer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1319"><highlight class="normal"></highlight></codeline>
<codeline lineno="1320"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(wc<sp/>=<sp/>1,<sp/>s<sp/>=<sp/>0;<sp/>s<sp/>&lt;<sp/>13;<sp/>s++)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Process<sp/>all<sp/>characters<sp/>in<sp/>the<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uc<sp/>=<sp/><ref refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" kindref="member">LD_WORD</ref>(dir<sp/>+<sp/>LfnOfs[s]);<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pick<sp/>an<sp/>LFN<sp/>character<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(wc)<sp/>{</highlight></codeline>
<codeline lineno="1323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>&gt;=<sp/><ref refid="group___f_f_c_o_n_f_i_g_1ga14e73a5c703a586c614b3e40b849f82c" kindref="member">_MAX_LFN</ref>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Buffer<sp/>overflow?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lfnbuf[i++]<sp/>=<sp/>wc<sp/>=<sp/>uc;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Store<sp/>it<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(uc<sp/>!=<sp/>0xFFFF)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>filler<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1328"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1329"><highlight class="normal"></highlight></codeline>
<codeline lineno="1330"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dir[<ref refid="ff_8c_1a6c97d545619e6586b02b5d4f39f7be25" kindref="member">LDIR_Ord</ref>]<sp/>&amp;<sp/><ref refid="ff_8c_1a31ec96cd263bb14418cb8b7b2b54b3ca" kindref="member">LLEF</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Put<sp/>terminator<sp/>if<sp/>it<sp/>is<sp/>the<sp/>last<sp/>LFN<sp/>part<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>&gt;=<sp/><ref refid="group___f_f_c_o_n_f_i_g_1ga14e73a5c703a586c614b3e40b849f82c" kindref="member">_MAX_LFN</ref>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Buffer<sp/>overflow?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lfnbuf[i]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1333"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1334"><highlight class="normal"></highlight></codeline>
<codeline lineno="1335"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>The<sp/>part<sp/>of<sp/>LFN<sp/>is<sp/>valid<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1336"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1337"><highlight class="normal"></highlight></codeline>
<codeline lineno="1338"><highlight class="normal"></highlight></codeline>
<codeline lineno="1339"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1340"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1341" refid="ff_8c_1a3fe23e7983a2974b8002a8e57c1c06e9" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ff_8c_1a3fe23e7983a2974b8002a8e57c1c06e9" kindref="member">fit_lfn</ref><sp/>(</highlight></codeline>
<codeline lineno="1342"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="integer_8h_1a570001c92f314285ad3e7139d8c58cf7" kindref="member">WCHAR</ref>*<sp/>lfnbuf,<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>LFN<sp/>working<sp/>buffer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1343"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>*<sp/>dir,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>LFN<sp/>entry<sp/>to<sp/>be<sp/>processed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1344"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>ord,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>LFN<sp/>order<sp/>(1-20)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1345"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>sum<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Checksum<sp/>of<sp/>the<sp/>corresponding<sp/>SFN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1346"><highlight class="normal">)</highlight></codeline>
<codeline lineno="1347"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1348"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>i,<sp/>s;</highlight></codeline>
<codeline lineno="1349"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a570001c92f314285ad3e7139d8c58cf7" kindref="member">WCHAR</ref><sp/>wc;</highlight></codeline>
<codeline lineno="1350"><highlight class="normal"></highlight></codeline>
<codeline lineno="1351"><highlight class="normal"></highlight></codeline>
<codeline lineno="1352"><highlight class="normal"><sp/><sp/><sp/><sp/>dir[<ref refid="ff_8c_1ade1d529763d2d097a6d1410956c8a84f" kindref="member">LDIR_Chksum</ref>]<sp/>=<sp/>sum;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>checksum<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1353"><highlight class="normal"><sp/><sp/><sp/><sp/>dir[<ref refid="ff_8c_1a28dcd75633b49e40b42a31f0cf5f5929" kindref="member">LDIR_Attr</ref>]<sp/>=<sp/><ref refid="ff_8h_1a91161ef62e0e85ba3c2876d3d339473d" kindref="member">AM_LFN</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>attribute.<sp/>LFN<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1354"><highlight class="normal"><sp/><sp/><sp/><sp/>dir[<ref refid="ff_8c_1acb98a052a9be81564b56854df35480a0" kindref="member">LDIR_Type</ref>]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1355"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" kindref="member">ST_WORD</ref>(dir<sp/>+<sp/><ref refid="ff_8c_1ad73024151eff6baea94e680f7928969d" kindref="member">LDIR_FstClusLO</ref>,<sp/>0);</highlight></codeline>
<codeline lineno="1356"><highlight class="normal"></highlight></codeline>
<codeline lineno="1357"><highlight class="normal"><sp/><sp/><sp/><sp/>i<sp/>=<sp/>(ord<sp/>-<sp/>1)<sp/>*<sp/>13;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>offset<sp/>in<sp/>the<sp/>LFN<sp/>working<sp/>buffer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1358"><highlight class="normal"><sp/><sp/><sp/><sp/>s<sp/>=<sp/>wc<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1359"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(wc<sp/>!=<sp/>0xFFFF)<sp/>wc<sp/>=<sp/>lfnbuf[i++];<sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>an<sp/>effective<sp/>character<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" kindref="member">ST_WORD</ref>(dir+LfnOfs[s],<sp/>wc);<sp/></highlight><highlight class="comment">/*<sp/>Put<sp/>it<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!wc)<sp/>wc<sp/>=<sp/>0xFFFF;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Padding<sp/>characters<sp/>following<sp/>last<sp/>character<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1363"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(++s<sp/>&lt;<sp/>13);</highlight></codeline>
<codeline lineno="1364"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(wc<sp/>==<sp/>0xFFFF<sp/>||<sp/>!lfnbuf[i])<sp/>ord<sp/>|=<sp/><ref refid="ff_8c_1a31ec96cd263bb14418cb8b7b2b54b3ca" kindref="member">LLEF</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Bottom<sp/>LFN<sp/>part<sp/>is<sp/>the<sp/>start<sp/>of<sp/>LFN<sp/>sequence<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1365"><highlight class="normal"><sp/><sp/><sp/><sp/>dir[<ref refid="ff_8c_1a6c97d545619e6586b02b5d4f39f7be25" kindref="member">LDIR_Ord</ref>]<sp/>=<sp/>ord;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>the<sp/>LFN<sp/>order<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1366"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1367"><highlight class="normal"></highlight></codeline>
<codeline lineno="1368"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1369"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1370"><highlight class="normal"></highlight></codeline>
<codeline lineno="1371"><highlight class="normal"></highlight></codeline>
<codeline lineno="1372"><highlight class="normal"></highlight></codeline>
<codeline lineno="1373"><highlight class="normal"></highlight></codeline>
<codeline lineno="1374"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1375"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Create<sp/>numbered<sp/>name<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1376"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1377"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1378"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1379" refid="ff_8c_1a01f02bd7a6b0835c15c4978cad7977dd" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ff_8c_1a01f02bd7a6b0835c15c4978cad7977dd" kindref="member">gen_numname</ref><sp/>(</highlight></codeline>
<codeline lineno="1380"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>*<sp/>dst,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>buffer<sp/>to<sp/>store<sp/>numbered<sp/>SFN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1381"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>*<sp/>src,<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>SFN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1382"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="integer_8h_1a570001c92f314285ad3e7139d8c58cf7" kindref="member">WCHAR</ref>*<sp/>lfn,<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>LFN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1383"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>seq<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Sequence<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1384"><highlight class="normal">)</highlight></codeline>
<codeline lineno="1385"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1386"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>ns[8],<sp/>c;</highlight></codeline>
<codeline lineno="1387"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>i,<sp/>j;</highlight></codeline>
<codeline lineno="1388"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a570001c92f314285ad3e7139d8c58cf7" kindref="member">WCHAR</ref><sp/>wc;</highlight></codeline>
<codeline lineno="1389"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>sr;</highlight></codeline>
<codeline lineno="1390"><highlight class="normal"></highlight></codeline>
<codeline lineno="1391"><highlight class="normal"></highlight></codeline>
<codeline lineno="1392"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a8941d573d16af92c8570950d53164f30" kindref="member">mem_cpy</ref>(dst,<sp/>src,<sp/>11);</highlight></codeline>
<codeline lineno="1393"><highlight class="normal"></highlight></codeline>
<codeline lineno="1394"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(seq<sp/>&gt;<sp/>5)<sp/>{<sp/><sp/></highlight><highlight class="comment">/*<sp/>On<sp/>many<sp/>collisions,<sp/>generate<sp/>a<sp/>hash<sp/>number<sp/>instead<sp/>of<sp/>sequential<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sr<sp/>=<sp/>seq;</highlight></codeline>
<codeline lineno="1396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(*lfn)<sp/>{<sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>a<sp/>CRC<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wc<sp/>=<sp/>*lfn++;</highlight></codeline>
<codeline lineno="1398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>16;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sr<sp/>=<sp/>(sr<sp/>&lt;&lt;<sp/>1)<sp/>+<sp/>(wc<sp/>&amp;<sp/>1);</highlight></codeline>
<codeline lineno="1400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wc<sp/>&gt;&gt;=<sp/>1;</highlight></codeline>
<codeline lineno="1401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sr<sp/>&amp;<sp/>0x10000)<sp/>sr<sp/>^=<sp/>0x11021;</highlight></codeline>
<codeline lineno="1402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seq<sp/>=<sp/>(<ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref>)sr;</highlight></codeline>
<codeline lineno="1405"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1406"><highlight class="normal"></highlight></codeline>
<codeline lineno="1407"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>itoa<sp/>(hexdecimal)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1408"><highlight class="normal"><sp/><sp/><sp/><sp/>i<sp/>=<sp/>7;</highlight></codeline>
<codeline lineno="1409"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>=<sp/>(seq<sp/>%<sp/>16)<sp/>+<sp/></highlight><highlight class="charliteral">&apos;0&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>&gt;<sp/></highlight><highlight class="charliteral">&apos;9&apos;</highlight><highlight class="normal">)<sp/>c<sp/>+=<sp/>7;</highlight></codeline>
<codeline lineno="1412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ns[i--]<sp/>=<sp/>c;</highlight></codeline>
<codeline lineno="1413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seq<sp/>/=<sp/>16;</highlight></codeline>
<codeline lineno="1414"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(seq);</highlight></codeline>
<codeline lineno="1415"><highlight class="normal"><sp/><sp/><sp/><sp/>ns[i]<sp/>=<sp/></highlight><highlight class="charliteral">&apos;~&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1416"><highlight class="normal"></highlight></codeline>
<codeline lineno="1417"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Append<sp/>the<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1418"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>i<sp/>&amp;&amp;<sp/>dst[j]<sp/>!=<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">;<sp/>j++)<sp/>{</highlight></codeline>
<codeline lineno="1419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1a58d63a832a117f179e41c7373d013dd6" kindref="member">IsDBCS1</ref>(dst[j]))<sp/>{</highlight></codeline>
<codeline lineno="1420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(j<sp/>==<sp/>i<sp/>-<sp/>1)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>j++;</highlight></codeline>
<codeline lineno="1422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1423"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1424"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dst[j++]<sp/>=<sp/>(i<sp/>&lt;<sp/>8)<sp/>?<sp/>ns[i++]<sp/>:<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1426"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(j<sp/>&lt;<sp/>8);</highlight></codeline>
<codeline lineno="1427"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1428"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1429"><highlight class="normal"></highlight></codeline>
<codeline lineno="1430"><highlight class="normal"></highlight></codeline>
<codeline lineno="1431"><highlight class="normal"></highlight></codeline>
<codeline lineno="1432"><highlight class="normal"></highlight></codeline>
<codeline lineno="1433"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1434"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Calculate<sp/>checksum<sp/>of<sp/>an<sp/>SFN<sp/>entry<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1435"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1436"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1437"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1438" refid="ff_8c_1a6d9c1b908dec282bedd5d1ee4b1f434e" refkind="member"><highlight class="normal"><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/><ref refid="ff_8c_1a6d9c1b908dec282bedd5d1ee4b1f434e" kindref="member">sum_sfn</ref><sp/>(</highlight></codeline>
<codeline lineno="1439"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>*<sp/>dir<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>SFN<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1440"><highlight class="normal">)</highlight></codeline>
<codeline lineno="1441"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1442"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>sum<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1443"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>n<sp/>=<sp/>11;</highlight></codeline>
<codeline lineno="1444"><highlight class="normal"></highlight></codeline>
<codeline lineno="1445"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>sum<sp/>=<sp/>(sum<sp/>&gt;&gt;<sp/>1)<sp/>+<sp/>(sum<sp/>&lt;&lt;<sp/>7)<sp/>+<sp/>*dir++;<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(--n);</highlight></codeline>
<codeline lineno="1446"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>sum;</highlight></codeline>
<codeline lineno="1447"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1448"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1449"><highlight class="normal"></highlight></codeline>
<codeline lineno="1450"><highlight class="normal"></highlight></codeline>
<codeline lineno="1451"><highlight class="normal"></highlight></codeline>
<codeline lineno="1452"><highlight class="normal"></highlight></codeline>
<codeline lineno="1453"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1454"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Directory<sp/>handling<sp/>-<sp/>Find<sp/>an<sp/>object<sp/>in<sp/>the<sp/>directory<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1455"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1456"><highlight class="normal"></highlight></codeline>
<codeline lineno="1457"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1458" refid="ff_8c_1abf87976453ebce0af60fa7bf4a6e21df" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="ff_8c_1abf87976453ebce0af60fa7bf4a6e21df" kindref="member">dir_find</ref><sp/>(<sp/><sp/></highlight><highlight class="comment">/*<sp/>FR_OK(0):succeeded,<sp/>!=0:error<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1459"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref>*<sp/>dp<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>directory<sp/>object<sp/>linked<sp/>to<sp/>the<sp/>file<sp/>name<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1460"><highlight class="normal">)</highlight></codeline>
<codeline lineno="1461"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1462"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="1463"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>c,<sp/>*dir;</highlight></codeline>
<codeline lineno="1464"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1465"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>a,<sp/>ord,<sp/>sum;</highlight></codeline>
<codeline lineno="1466"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1467"><highlight class="normal"></highlight></codeline>
<codeline lineno="1468"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" kindref="member">dir_sdi</ref>(dp,<sp/>0);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Rewind<sp/>directory<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1469"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="1470"><highlight class="normal"></highlight></codeline>
<codeline lineno="1471"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1472"><highlight class="normal"><sp/><sp/><sp/><sp/>ord<sp/>=<sp/>sum<sp/>=<sp/>0xFF;<sp/>dp-&gt;<ref refid="struct_d_i_r_1a7f94c0148d9e604278c77e10ab0140cb" kindref="member">lfn_idx</ref><sp/>=<sp/>0xFFFF;<sp/></highlight><highlight class="comment">/*<sp/>Reset<sp/>LFN<sp/>sequence<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1473"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1474"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" kindref="member">move_window</ref>(dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>dp-&gt;<ref refid="struct_d_i_r_1a3e49e0860170e0fd9fc3e891b0d59975" kindref="member">sect</ref>);</highlight></codeline>
<codeline lineno="1476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dir<sp/>=<sp/>dp-&gt;<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Ptr<sp/>to<sp/>the<sp/>directory<sp/>entry<sp/>of<sp/>current<sp/>index<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>=<sp/>dir[<ref refid="ff_8c_1afa89348e9fc2de82ae9e12c661366b0e" kindref="member">DIR_Name</ref>];</highlight></codeline>
<codeline lineno="1479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>==<sp/>0)<sp/>{<sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref>;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/>}<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Reached<sp/>to<sp/>end<sp/>of<sp/>table<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1480"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>LFN<sp/>configuration<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>a<sp/>=<sp/>dir[<ref refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" kindref="member">DIR_Attr</ref>]<sp/>&amp;<sp/><ref refid="ff_8h_1aefa78fd6b130faaca4e115602869b57c" kindref="member">AM_MASK</ref>;</highlight></codeline>
<codeline lineno="1482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>==<sp/><ref refid="ff_8c_1a0f2455f7318e6d56318c62f5e4048e1e" kindref="member">DDEM</ref><sp/>||<sp/>((a<sp/>&amp;<sp/><ref refid="ff_8h_1a5cfae62dabae0a54809e43b36685ce7c" kindref="member">AM_VOL</ref>)<sp/>&amp;&amp;<sp/>a<sp/>!=<sp/><ref refid="ff_8h_1a91161ef62e0e85ba3c2876d3d339473d" kindref="member">AM_LFN</ref>))<sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>An<sp/>entry<sp/>without<sp/>valid<sp/>data<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ord<sp/>=<sp/>0xFF;<sp/>dp-&gt;<ref refid="struct_d_i_r_1a7f94c0148d9e604278c77e10ab0140cb" kindref="member">lfn_idx</ref><sp/>=<sp/>0xFFFF;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Reset<sp/>LFN<sp/>sequence<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(a<sp/>==<sp/><ref refid="ff_8h_1a91161ef62e0e85ba3c2876d3d339473d" kindref="member">AM_LFN</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>An<sp/>LFN<sp/>entry<sp/>is<sp/>found<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dp-&gt;<ref refid="struct_d_i_r_1a95ac58da8ca4254c6923552f1a9ca92d" kindref="member">lfn</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>&amp;<sp/><ref refid="ff_8c_1a31ec96cd263bb14418cb8b7b2b54b3ca" kindref="member">LLEF</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Is<sp/>it<sp/>start<sp/>of<sp/>LFN<sp/>sequence?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sum<sp/>=<sp/>dir[<ref refid="ff_8c_1ade1d529763d2d097a6d1410956c8a84f" kindref="member">LDIR_Chksum</ref>];</highlight></codeline>
<codeline lineno="1489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>&amp;=<sp/>~LLEF;<sp/>ord<sp/>=<sp/>c;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>LFN<sp/>start<sp/>order<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1a7f94c0148d9e604278c77e10ab0140cb" kindref="member">lfn_idx</ref><sp/>=<sp/>dp-&gt;<ref refid="struct_d_i_r_1ab7c5089b70ce76bcd61abe615ed2a42b" kindref="member">index</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Start<sp/>index<sp/>of<sp/>LFN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>validity<sp/>of<sp/>the<sp/>LFN<sp/>entry<sp/>and<sp/>compare<sp/>it<sp/>with<sp/>given<sp/>name<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ord<sp/>=<sp/>(c<sp/>==<sp/>ord<sp/>&amp;&amp;<sp/>sum<sp/>==<sp/>dir[<ref refid="ff_8c_1ade1d529763d2d097a6d1410956c8a84f" kindref="member">LDIR_Chksum</ref>]<sp/>&amp;&amp;<sp/><ref refid="ff_8c_1a7ce4d4f3aa55873dc160d76778536a5f" kindref="member">cmp_lfn</ref>(dp-&gt;<ref refid="struct_d_i_r_1a95ac58da8ca4254c6923552f1a9ca92d" kindref="member">lfn</ref>,<sp/>dir))<sp/>?<sp/>ord<sp/>-<sp/>1<sp/>:<sp/>0xFF;</highlight></codeline>
<codeline lineno="1494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>An<sp/>SFN<sp/>entry<sp/>is<sp/>found<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!ord<sp/>&amp;&amp;<sp/>sum<sp/>==<sp/><ref refid="ff_8c_1a6d9c1b908dec282bedd5d1ee4b1f434e" kindref="member">sum_sfn</ref>(dir))<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/></highlight><highlight class="comment">/*<sp/>LFN<sp/>matched?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!(dp-&gt;<ref refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" kindref="member">fn</ref>[<ref refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" kindref="member">NSFLAG</ref>]<sp/>&amp;<sp/><ref refid="ff_8c_1ac92c92c3a3d6b9235ac98feeb00e565a" kindref="member">NS_LOSS</ref>)<sp/>&amp;&amp;<sp/>!<ref refid="ff_8c_1a38b4f223d18bd4416d8bce0f07a63c01" kindref="member">mem_cmp</ref>(dir,<sp/>dp-&gt;<ref refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" kindref="member">fn</ref>,<sp/>11))<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>SFN<sp/>matched?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ord<sp/>=<sp/>0xFF;<sp/>dp-&gt;<ref refid="struct_d_i_r_1a7f94c0148d9e604278c77e10ab0140cb" kindref="member">lfn_idx</ref><sp/>=<sp/>0xFFFF;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Reset<sp/>LFN<sp/>sequence<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1501"><highlight class="normal"></highlight><highlight class="preprocessor">#else<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Non<sp/>LFN<sp/>configuration<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!(dir[<ref refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" kindref="member">DIR_Attr</ref>]<sp/>&amp;<sp/>AM_VOL)<sp/>&amp;&amp;<sp/>!<ref refid="ff_8c_1a38b4f223d18bd4416d8bce0f07a63c01" kindref="member">mem_cmp</ref>(dir,<sp/>dp-&gt;<ref refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" kindref="member">fn</ref>,<sp/>11))<sp/></highlight><highlight class="comment">/*<sp/>Is<sp/>it<sp/>a<sp/>valid<sp/>entry?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1504"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a2edd26ac71869f25be5fce12eec58171" kindref="member">dir_next</ref>(dp,<sp/>0);<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Next<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1506"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>);</highlight></codeline>
<codeline lineno="1507"><highlight class="normal"></highlight></codeline>
<codeline lineno="1508"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="1509"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1510"><highlight class="normal"></highlight></codeline>
<codeline lineno="1511"><highlight class="normal"></highlight></codeline>
<codeline lineno="1512"><highlight class="normal"></highlight></codeline>
<codeline lineno="1513"><highlight class="normal"></highlight></codeline>
<codeline lineno="1514"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1515"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Read<sp/>an<sp/>object<sp/>from<sp/>the<sp/>directory<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1516"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1517"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_MINIMIZE<sp/>&lt;=<sp/>1<sp/>||<sp/>_USE_LABEL<sp/>||<sp/>_FS_RPATH<sp/>&gt;=<sp/>2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1518"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1519" refid="ff_8c_1a3a47a08609e77266bc1928af812e06df" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="ff_8c_1a3a47a08609e77266bc1928af812e06df" kindref="member">dir_read</ref><sp/>(</highlight></codeline>
<codeline lineno="1520"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref>*<sp/>dp,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>directory<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1521"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>vol<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Filtered<sp/>by<sp/>0:file/directory<sp/>or<sp/>1:volume<sp/>label<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1522"><highlight class="normal">)</highlight></codeline>
<codeline lineno="1523"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1524"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="1525"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>a,<sp/>c,<sp/>*dir;</highlight></codeline>
<codeline lineno="1526"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1527"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>ord<sp/>=<sp/>0xFF,<sp/>sum<sp/>=<sp/>0xFF;</highlight></codeline>
<codeline lineno="1528"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1529"><highlight class="normal"></highlight></codeline>
<codeline lineno="1530"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref>;</highlight></codeline>
<codeline lineno="1531"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(dp-&gt;<ref refid="struct_d_i_r_1a3e49e0860170e0fd9fc3e891b0d59975" kindref="member">sect</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" kindref="member">move_window</ref>(dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>dp-&gt;<ref refid="struct_d_i_r_1a3e49e0860170e0fd9fc3e891b0d59975" kindref="member">sect</ref>);</highlight></codeline>
<codeline lineno="1533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dir<sp/>=<sp/>dp-&gt;<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Ptr<sp/>to<sp/>the<sp/>directory<sp/>entry<sp/>of<sp/>current<sp/>index<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>=<sp/>dir[<ref refid="ff_8c_1afa89348e9fc2de82ae9e12c661366b0e" kindref="member">DIR_Name</ref>];</highlight></codeline>
<codeline lineno="1536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>==<sp/>0)<sp/>{<sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref>;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/>}<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Reached<sp/>to<sp/>end<sp/>of<sp/>table<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>a<sp/>=<sp/>dir[<ref refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" kindref="member">DIR_Attr</ref>]<sp/>&amp;<sp/><ref refid="ff_8h_1aefa78fd6b130faaca4e115602869b57c" kindref="member">AM_MASK</ref>;</highlight></codeline>
<codeline lineno="1538"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>LFN<sp/>configuration<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>==<sp/><ref refid="ff_8c_1a0f2455f7318e6d56318c62f5e4048e1e" kindref="member">DDEM</ref><sp/>||<sp/>(!<ref refid="group___f_f_c_o_n_f_i_g_1ga52faf11025401372f71e9d81905b7af4" kindref="member">_FS_RPATH</ref><sp/>&amp;&amp;<sp/>c<sp/>==<sp/></highlight><highlight class="charliteral">&apos;.&apos;</highlight><highlight class="normal">)<sp/>||<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)((a<sp/>&amp;<sp/>~<ref refid="ff_8h_1ae8174d00798e34e7c9e95898cb9e1a09" kindref="member">AM_ARC</ref>)<sp/>==<sp/><ref refid="ff_8h_1a5cfae62dabae0a54809e43b36685ce7c" kindref="member">AM_VOL</ref>)<sp/>!=<sp/>vol)<sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>An<sp/>entry<sp/>without<sp/>valid<sp/>data<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ord<sp/>=<sp/>0xFF;</highlight></codeline>
<codeline lineno="1541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(a<sp/>==<sp/><ref refid="ff_8h_1a91161ef62e0e85ba3c2876d3d339473d" kindref="member">AM_LFN</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>An<sp/>LFN<sp/>entry<sp/>is<sp/>found<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>&amp;<sp/><ref refid="ff_8c_1a31ec96cd263bb14418cb8b7b2b54b3ca" kindref="member">LLEF</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Is<sp/>it<sp/>start<sp/>of<sp/>LFN<sp/>sequence?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sum<sp/>=<sp/>dir[<ref refid="ff_8c_1ade1d529763d2d097a6d1410956c8a84f" kindref="member">LDIR_Chksum</ref>];</highlight></codeline>
<codeline lineno="1545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>&amp;=<sp/>~LLEF;<sp/>ord<sp/>=<sp/>c;</highlight></codeline>
<codeline lineno="1546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1a7f94c0148d9e604278c77e10ab0140cb" kindref="member">lfn_idx</ref><sp/>=<sp/>dp-&gt;<ref refid="struct_d_i_r_1ab7c5089b70ce76bcd61abe615ed2a42b" kindref="member">index</ref>;</highlight></codeline>
<codeline lineno="1547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>LFN<sp/>validity<sp/>and<sp/>capture<sp/>it<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ord<sp/>=<sp/>(c<sp/>==<sp/>ord<sp/>&amp;&amp;<sp/>sum<sp/>==<sp/>dir[<ref refid="ff_8c_1ade1d529763d2d097a6d1410956c8a84f" kindref="member">LDIR_Chksum</ref>]<sp/>&amp;&amp;<sp/><ref refid="ff_8c_1a2a2c96233e92d8abe12c4496caec85cf" kindref="member">pick_lfn</ref>(dp-&gt;<ref refid="struct_d_i_r_1a95ac58da8ca4254c6923552f1a9ca92d" kindref="member">lfn</ref>,<sp/>dir))<sp/>?<sp/>ord<sp/>-<sp/>1<sp/>:<sp/>0xFF;</highlight></codeline>
<codeline lineno="1550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>An<sp/>SFN<sp/>entry<sp/>is<sp/>found<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ord<sp/>||<sp/>sum<sp/>!=<sp/><ref refid="ff_8c_1a6d9c1b908dec282bedd5d1ee4b1f434e" kindref="member">sum_sfn</ref>(dir))<sp/></highlight><highlight class="comment">/*<sp/>Is<sp/>there<sp/>a<sp/>valid<sp/>LFN?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1a7f94c0148d9e604278c77e10ab0140cb" kindref="member">lfn_idx</ref><sp/>=<sp/>0xFFFF;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>It<sp/>has<sp/>no<sp/>LFN.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1556"><highlight class="normal"></highlight><highlight class="preprocessor">#else<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Non<sp/>LFN<sp/>configuration<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>!=<sp/><ref refid="ff_8c_1a0f2455f7318e6d56318c62f5e4048e1e" kindref="member">DDEM</ref><sp/>&amp;&amp;<sp/>(<ref refid="group___f_f_c_o_n_f_i_g_1ga52faf11025401372f71e9d81905b7af4" kindref="member">_FS_RPATH</ref><sp/>||<sp/>c<sp/>!=<sp/></highlight><highlight class="charliteral">&apos;.&apos;</highlight><highlight class="normal">)<sp/>&amp;&amp;<sp/>a<sp/>!=<sp/><ref refid="ff_8h_1a91161ef62e0e85ba3c2876d3d339473d" kindref="member">AM_LFN</ref><sp/>&amp;&amp;<sp/>(int)((a<sp/>&amp;<sp/>~<ref refid="ff_8h_1ae8174d00798e34e7c9e95898cb9e1a09" kindref="member">AM_ARC</ref>)<sp/>==<sp/><ref refid="ff_8h_1a5cfae62dabae0a54809e43b36685ce7c" kindref="member">AM_VOL</ref>)<sp/>==<sp/>vol)<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Is<sp/>it<sp/>a<sp/>valid<sp/>entry?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1559"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a2edd26ac71869f25be5fce12eec58171" kindref="member">dir_next</ref>(dp,<sp/>0);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Next<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1562"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1563"><highlight class="normal"></highlight></codeline>
<codeline lineno="1564"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>dp-&gt;<ref refid="struct_d_i_r_1a3e49e0860170e0fd9fc3e891b0d59975" kindref="member">sect</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1565"><highlight class="normal"></highlight></codeline>
<codeline lineno="1566"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="1567"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1568"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/><sp/></highlight><highlight class="comment">/*<sp/>_FS_MINIMIZE<sp/>&lt;=<sp/>1<sp/>||<sp/>_USE_LABEL<sp/>||<sp/>_FS_RPATH<sp/>&gt;=<sp/>2<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1569"><highlight class="normal"></highlight></codeline>
<codeline lineno="1570"><highlight class="normal"></highlight></codeline>
<codeline lineno="1571"><highlight class="normal"></highlight></codeline>
<codeline lineno="1572"><highlight class="normal"></highlight></codeline>
<codeline lineno="1573"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1574"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Register<sp/>an<sp/>object<sp/>to<sp/>the<sp/>directory<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1575"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1576"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1577"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1578" refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" kindref="member">dir_register</ref><sp/>(<sp/><sp/></highlight><highlight class="comment">/*<sp/>FR_OK:succeeded,<sp/>FR_DENIED:no<sp/>free<sp/>entry<sp/>or<sp/>too<sp/>many<sp/>SFN<sp/>collision,<sp/>FR_DISK_ERR:disk<sp/>error<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1579"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref>*<sp/>dp<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Target<sp/>directory<sp/>with<sp/>object<sp/>name<sp/>to<sp/>be<sp/>created<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1580"><highlight class="normal">)</highlight></codeline>
<codeline lineno="1581"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1582"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="1583"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>LFN<sp/>configuration<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1584"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>n,<sp/>nent;</highlight></codeline>
<codeline lineno="1585"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>sn[12],<sp/>*fn,<sp/>sum;</highlight></codeline>
<codeline lineno="1586"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a570001c92f314285ad3e7139d8c58cf7" kindref="member">WCHAR</ref><sp/>*lfn;</highlight></codeline>
<codeline lineno="1587"><highlight class="normal"></highlight></codeline>
<codeline lineno="1588"><highlight class="normal"></highlight></codeline>
<codeline lineno="1589"><highlight class="normal"><sp/><sp/><sp/><sp/>fn<sp/>=<sp/>dp-&gt;<ref refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" kindref="member">fn</ref>;<sp/>lfn<sp/>=<sp/>dp-&gt;<ref refid="struct_d_i_r_1a95ac58da8ca4254c6923552f1a9ca92d" kindref="member">lfn</ref>;</highlight></codeline>
<codeline lineno="1590"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a8941d573d16af92c8570950d53164f30" kindref="member">mem_cpy</ref>(sn,<sp/>fn,<sp/>12);</highlight></codeline>
<codeline lineno="1591"><highlight class="normal"></highlight></codeline>
<codeline lineno="1592"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___f_f_c_o_n_f_i_g_1ga52faf11025401372f71e9d81905b7af4" kindref="member">_FS_RPATH</ref><sp/>&amp;&amp;<sp/>(sn[<ref refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" kindref="member">NSFLAG</ref>]<sp/>&amp;<sp/><ref refid="ff_8c_1a2db528782a021797b34bdc6e9e9de1c3" kindref="member">NS_DOT</ref>))<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Cannot<sp/>create<sp/>dot<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" kindref="member">FR_INVALID_NAME</ref>;</highlight></codeline>
<codeline lineno="1594"><highlight class="normal"></highlight></codeline>
<codeline lineno="1595"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sn[<ref refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" kindref="member">NSFLAG</ref>]<sp/>&amp;<sp/><ref refid="ff_8c_1ac92c92c3a3d6b9235ac98feeb00e565a" kindref="member">NS_LOSS</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>When<sp/>LFN<sp/>is<sp/>out<sp/>of<sp/>8.3<sp/>format,<sp/>generate<sp/>a<sp/>numbered<sp/>name<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fn[<ref refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" kindref="member">NSFLAG</ref>]<sp/>=<sp/>0;<sp/>dp-&gt;<ref refid="struct_d_i_r_1a95ac58da8ca4254c6923552f1a9ca92d" kindref="member">lfn</ref><sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Find<sp/>only<sp/>SFN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(n<sp/>=<sp/>1;<sp/>n<sp/>&lt;<sp/>100;<sp/>n++)<sp/>{</highlight></codeline>
<codeline lineno="1598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a01f02bd7a6b0835c15c4978cad7977dd" kindref="member">gen_numname</ref>(fn,<sp/>sn,<sp/>lfn,<sp/>n);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Generate<sp/>a<sp/>numbered<sp/>name<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1abf87976453ebce0af60fa7bf4a6e21df" kindref="member">dir_find</ref>(dp);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>if<sp/>the<sp/>name<sp/>collides<sp/>with<sp/>existing<sp/>SFN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n<sp/>==<sp/>100)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d" kindref="member">FR_DENIED</ref>;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Abort<sp/>if<sp/>too<sp/>many<sp/>collisions<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Abort<sp/>if<sp/>the<sp/>result<sp/>is<sp/>other<sp/>than<sp/>&apos;not<sp/>collided&apos;<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fn[<ref refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" kindref="member">NSFLAG</ref>]<sp/>=<sp/>sn[<ref refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" kindref="member">NSFLAG</ref>];<sp/>dp-&gt;<ref refid="struct_d_i_r_1a95ac58da8ca4254c6923552f1a9ca92d" kindref="member">lfn</ref><sp/>=<sp/>lfn;</highlight></codeline>
<codeline lineno="1605"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1606"><highlight class="normal"></highlight></codeline>
<codeline lineno="1607"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sn[<ref refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" kindref="member">NSFLAG</ref>]<sp/>&amp;<sp/><ref refid="ff_8c_1ae957b8d4065ea0b3eed822aec5368d29" kindref="member">NS_LFN</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>When<sp/>LFN<sp/>is<sp/>to<sp/>be<sp/>created,<sp/>allocate<sp/>entries<sp/>for<sp/>an<sp/>SFN<sp/>+<sp/>LFNs.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(n<sp/>=<sp/>0;<sp/>lfn[n];<sp/>n++)<sp/>;</highlight></codeline>
<codeline lineno="1609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nent<sp/>=<sp/>(n<sp/>+<sp/>25)<sp/>/<sp/>13;</highlight></codeline>
<codeline lineno="1610"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Otherwise<sp/>allocate<sp/>an<sp/>entry<sp/>for<sp/>an<sp/>SFN<sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nent<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1612"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1613"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a23ff0594686ccbd8f8d987547931ef04" kindref="member">dir_alloc</ref>(dp,<sp/>nent);<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Allocate<sp/>entries<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1614"><highlight class="normal"></highlight></codeline>
<codeline lineno="1615"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref><sp/>&amp;&amp;<sp/>--nent)<sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>LFN<sp/>entry<sp/>if<sp/>needed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" kindref="member">dir_sdi</ref>(dp,<sp/>dp-&gt;<ref refid="struct_d_i_r_1ab7c5089b70ce76bcd61abe615ed2a42b" kindref="member">index</ref><sp/>-<sp/>nent);</highlight></codeline>
<codeline lineno="1617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sum<sp/>=<sp/><ref refid="ff_8c_1a6d9c1b908dec282bedd5d1ee4b1f434e" kindref="member">sum_sfn</ref>(dp-&gt;<ref refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" kindref="member">fn</ref>);<sp/><sp/></highlight><highlight class="comment">/*<sp/>Checksum<sp/>value<sp/>of<sp/>the<sp/>SFN<sp/>tied<sp/>to<sp/>the<sp/>LFN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Store<sp/>LFN<sp/>entries<sp/>in<sp/>bottom<sp/>first<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" kindref="member">move_window</ref>(dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>dp-&gt;<ref refid="struct_d_i_r_1a3e49e0860170e0fd9fc3e891b0d59975" kindref="member">sect</ref>);</highlight></codeline>
<codeline lineno="1621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a3fe23e7983a2974b8002a8e57c1c06e9" kindref="member">fit_lfn</ref>(dp-&gt;<ref refid="struct_d_i_r_1a95ac58da8ca4254c6923552f1a9ca92d" kindref="member">lfn</ref>,<sp/>dp-&gt;<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>,<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)nent,<sp/>sum);</highlight></codeline>
<codeline lineno="1623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" kindref="member">wflag</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a2edd26ac71869f25be5fce12eec58171" kindref="member">dir_next</ref>(dp,<sp/>0);<sp/><sp/></highlight><highlight class="comment">/*<sp/>Next<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref><sp/>&amp;&amp;<sp/>--nent);</highlight></codeline>
<codeline lineno="1626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1627"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1628"><highlight class="normal"></highlight><highlight class="preprocessor">#else<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Non<sp/>LFN<sp/>configuration<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1629"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a23ff0594686ccbd8f8d987547931ef04" kindref="member">dir_alloc</ref>(dp,<sp/>1);<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Allocate<sp/>an<sp/>entry<sp/>for<sp/>SFN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1630"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1631"><highlight class="normal"></highlight></codeline>
<codeline lineno="1632"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>SFN<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" kindref="member">move_window</ref>(dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>dp-&gt;<ref refid="struct_d_i_r_1a3e49e0860170e0fd9fc3e891b0d59975" kindref="member">sect</ref>);</highlight></codeline>
<codeline lineno="1634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a02eb5189e43056a9ddc8a59cbe89be93" kindref="member">mem_set</ref>(dp-&gt;<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>,<sp/>0,<sp/><ref refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" kindref="member">SZ_DIRE</ref>);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Clean<sp/>the<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a8941d573d16af92c8570950d53164f30" kindref="member">mem_cpy</ref>(dp-&gt;<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>,<sp/>dp-&gt;<ref refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" kindref="member">fn</ref>,<sp/>11);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Put<sp/>SFN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1637"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>[<ref refid="ff_8c_1a87ee1f701c2ab941862e3ce00c1c1e9d" kindref="member">DIR_NTres</ref>]<sp/>=<sp/>dp-&gt;<ref refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" kindref="member">fn</ref>[<ref refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" kindref="member">NSFLAG</ref>]<sp/>&amp;<sp/>(<ref refid="ff_8c_1a4a0e89b504dece19e2e4b02c83782ca2" kindref="member">NS_BODY</ref><sp/>|<sp/><ref refid="ff_8c_1a3b7fad0942e816fdb84d869c1f7a613e" kindref="member">NS_EXT</ref>);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Put<sp/>NT<sp/>flag<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1639"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" kindref="member">wflag</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1642"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1643"><highlight class="normal"></highlight></codeline>
<codeline lineno="1644"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="1645"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1646"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>!_FS_READONLY<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1647"><highlight class="normal"></highlight></codeline>
<codeline lineno="1648"><highlight class="normal"></highlight></codeline>
<codeline lineno="1649"><highlight class="normal"></highlight></codeline>
<codeline lineno="1650"><highlight class="normal"></highlight></codeline>
<codeline lineno="1651"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1652"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Remove<sp/>an<sp/>object<sp/>from<sp/>the<sp/>directory<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1653"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1654"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY<sp/>&amp;&amp;<sp/>!_FS_MINIMIZE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1655"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1656" refid="ff_8c_1a724c260af4783a0ecf0db8d0687e7bd6" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="ff_8c_1a724c260af4783a0ecf0db8d0687e7bd6" kindref="member">dir_remove</ref><sp/>(<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FR_OK:Succeeded,<sp/>FR_DISK_ERR:A<sp/>disk<sp/>error<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1657"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref>*<sp/>dp<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Directory<sp/>object<sp/>pointing<sp/>the<sp/>entry<sp/>to<sp/>be<sp/>removed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1658"><highlight class="normal">)</highlight></codeline>
<codeline lineno="1659"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1660"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="1661"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>LFN<sp/>configuration<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1662"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>i;</highlight></codeline>
<codeline lineno="1663"><highlight class="normal"></highlight></codeline>
<codeline lineno="1664"><highlight class="normal"><sp/><sp/><sp/><sp/>i<sp/>=<sp/>dp-&gt;<ref refid="struct_d_i_r_1ab7c5089b70ce76bcd61abe615ed2a42b" kindref="member">index</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>SFN<sp/>index<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1665"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" kindref="member">dir_sdi</ref>(dp,<sp/>(dp-&gt;<ref refid="struct_d_i_r_1a7f94c0148d9e604278c77e10ab0140cb" kindref="member">lfn_idx</ref><sp/>==<sp/>0xFFFF)<sp/>?<sp/>i<sp/>:<sp/>dp-&gt;<ref refid="struct_d_i_r_1a7f94c0148d9e604278c77e10ab0140cb" kindref="member">lfn_idx</ref>);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Goto<sp/>the<sp/>SFN<sp/>or<sp/>top<sp/>of<sp/>the<sp/>LFN<sp/>entries<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1666"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" kindref="member">move_window</ref>(dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>dp-&gt;<ref refid="struct_d_i_r_1a3e49e0860170e0fd9fc3e891b0d59975" kindref="member">sect</ref>);</highlight></codeline>
<codeline lineno="1669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a02eb5189e43056a9ddc8a59cbe89be93" kindref="member">mem_set</ref>(dp-&gt;<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>,<sp/>0,<sp/><ref refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" kindref="member">SZ_DIRE</ref>);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Clear<sp/>and<sp/>mark<sp/>the<sp/>entry<sp/>&quot;deleted&quot;<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*dp-&gt;<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref><sp/>=<sp/><ref refid="ff_8c_1a0f2455f7318e6d56318c62f5e4048e1e" kindref="member">DDEM</ref>;</highlight></codeline>
<codeline lineno="1672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" kindref="member">wflag</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dp-&gt;<ref refid="struct_d_i_r_1ab7c5089b70ce76bcd61abe615ed2a42b" kindref="member">index</ref><sp/>&gt;=<sp/>i)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/><sp/></highlight><highlight class="comment">/*<sp/>When<sp/>reached<sp/>SFN,<sp/>all<sp/>entries<sp/>of<sp/>the<sp/>object<sp/>has<sp/>been<sp/>deleted.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a2edd26ac71869f25be5fce12eec58171" kindref="member">dir_next</ref>(dp,<sp/>0);<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Next<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>);</highlight></codeline>
<codeline lineno="1676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref>)<sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>;</highlight></codeline>
<codeline lineno="1677"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1678"><highlight class="normal"></highlight></codeline>
<codeline lineno="1679"><highlight class="normal"></highlight><highlight class="preprocessor">#else<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Non<sp/>LFN<sp/>configuration<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1680"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" kindref="member">dir_sdi</ref>(dp,<sp/>dp-&gt;<ref refid="struct_d_i_r_1ab7c5089b70ce76bcd61abe615ed2a42b" kindref="member">index</ref>);</highlight></codeline>
<codeline lineno="1681"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" kindref="member">move_window</ref>(dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>dp-&gt;<ref refid="struct_d_i_r_1a3e49e0860170e0fd9fc3e891b0d59975" kindref="member">sect</ref>);</highlight></codeline>
<codeline lineno="1683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a02eb5189e43056a9ddc8a59cbe89be93" kindref="member">mem_set</ref>(dp-&gt;<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>,<sp/>0,<sp/><ref refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" kindref="member">SZ_DIRE</ref>);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Clear<sp/>and<sp/>mark<sp/>the<sp/>entry<sp/>&quot;deleted&quot;<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*dp-&gt;<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref><sp/>=<sp/><ref refid="ff_8c_1a0f2455f7318e6d56318c62f5e4048e1e" kindref="member">DDEM</ref>;</highlight></codeline>
<codeline lineno="1686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" kindref="member">wflag</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1688"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1689"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1690"><highlight class="normal"></highlight></codeline>
<codeline lineno="1691"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="1692"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1693"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>!_FS_READONLY<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1694"><highlight class="normal"></highlight></codeline>
<codeline lineno="1695"><highlight class="normal"></highlight></codeline>
<codeline lineno="1696"><highlight class="normal"></highlight></codeline>
<codeline lineno="1697"><highlight class="normal"></highlight></codeline>
<codeline lineno="1698"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1699"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Get<sp/>file<sp/>information<sp/>from<sp/>directory<sp/>entry<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1700"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1701"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_MINIMIZE<sp/>&lt;=<sp/>1<sp/>||<sp/>_FS_RPATH<sp/>&gt;=<sp/>2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1702"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1703" refid="ff_8c_1a2bc1b9d8567181c23b4720f4fb6076f5" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ff_8c_1a2bc1b9d8567181c23b4720f4fb6076f5" kindref="member">get_fileinfo</ref><sp/>(<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>No<sp/>return<sp/>code<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1704"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref>*<sp/>dp,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>directory<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1705"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_i_l_i_n_f_o" kindref="compound">FILINFO</ref>*<sp/>fno<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>file<sp/>information<sp/>to<sp/>be<sp/>filled<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1706"><highlight class="normal">)</highlight></codeline>
<codeline lineno="1707"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1708"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>i;</highlight></codeline>
<codeline lineno="1709"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref><sp/>*p,<sp/>c;</highlight></codeline>
<codeline lineno="1710"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>*dir;</highlight></codeline>
<codeline lineno="1711"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1712"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a570001c92f314285ad3e7139d8c58cf7" kindref="member">WCHAR</ref><sp/>w,<sp/>*lfn;</highlight></codeline>
<codeline lineno="1713"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1714"><highlight class="normal"></highlight></codeline>
<codeline lineno="1715"><highlight class="normal"><sp/><sp/><sp/><sp/>p<sp/>=<sp/>fno-&gt;<ref refid="struct_f_i_l_i_n_f_o_1a7c33845207b44ca3b394052ad6724e72" kindref="member">fname</ref>;</highlight></codeline>
<codeline lineno="1716"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dp-&gt;<ref refid="struct_d_i_r_1a3e49e0860170e0fd9fc3e891b0d59975" kindref="member">sect</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>SFN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dir<sp/>=<sp/>dp-&gt;<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>;</highlight></codeline>
<codeline lineno="1718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(i<sp/>&lt;<sp/>11)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Copy<sp/>name<sp/>body<sp/>and<sp/>extension<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>=<sp/>(<ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>)dir[i++];</highlight></codeline>
<codeline lineno="1721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>==<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">)<sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Skip<sp/>padding<sp/>spaces<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>==<sp/><ref refid="ff_8c_1a24b6bc427cbd37fbe76e087f7f188abb" kindref="member">RDDEM</ref>)<sp/>c<sp/>=<sp/>(<ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>)<ref refid="ff_8c_1a0f2455f7318e6d56318c62f5e4048e1e" kindref="member">DDEM</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Restore<sp/>replaced<sp/>DDEM<sp/>character<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>==<sp/>9)<sp/>*p++<sp/>=<sp/></highlight><highlight class="charliteral">&apos;.&apos;</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Insert<sp/>a<sp/>.<sp/>if<sp/>extension<sp/>is<sp/>exist<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1724"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1a89b2514198590e139dd064c5d534f302" kindref="member">IsUpper</ref>(c)<sp/>&amp;&amp;<sp/>(dir[<ref refid="ff_8c_1a87ee1f701c2ab941862e3ce00c1c1e9d" kindref="member">DIR_NTres</ref>]<sp/>&amp;<sp/>(i<sp/>&gt;=<sp/>9<sp/>?<sp/><ref refid="ff_8c_1a3b7fad0942e816fdb84d869c1f7a613e" kindref="member">NS_EXT</ref><sp/>:<sp/><ref refid="ff_8c_1a4a0e89b504dece19e2e4b02c83782ca2" kindref="member">NS_BODY</ref>)))</highlight></codeline>
<codeline lineno="1726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>+=<sp/>0x20;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>To<sp/>lower<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1727"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_LFN_UNICODE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1a58d63a832a117f179e41c7373d013dd6" kindref="member">IsDBCS1</ref>(c)<sp/>&amp;&amp;<sp/>i<sp/>!=<sp/>8<sp/>&amp;&amp;<sp/>i<sp/>!=<sp/>11<sp/>&amp;&amp;<sp/><ref refid="ff_8c_1a66a3fa880af6078ef181656c1d7d8ef1" kindref="member">IsDBCS2</ref>(dir[i]))</highlight></codeline>
<codeline lineno="1729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>=<sp/>c<sp/>&lt;&lt;<sp/>8<sp/>|<sp/>dir[i++];</highlight></codeline>
<codeline lineno="1730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>=<sp/><ref refid="ff_8h_1ae5146230b88ddb4a6a69340e0fd1eabd" kindref="member">ff_convert</ref>(c,<sp/>1);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>OEM<sp/>-&gt;<sp/>Unicode<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!c)<sp/>c<sp/>=<sp/></highlight><highlight class="charliteral">&apos;?&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1732"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1733"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*p++<sp/>=<sp/>c;</highlight></codeline>
<codeline lineno="1735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fno-&gt;<ref refid="struct_f_i_l_i_n_f_o_1a8d28e8b20d001f36bf6099d312384fbd" kindref="member">fattrib</ref><sp/>=<sp/>dir[<ref refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" kindref="member">DIR_Attr</ref>];<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Attribute<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fno-&gt;<ref refid="struct_f_i_l_i_n_f_o_1af70a0afd16367837984d6205cbfca308" kindref="member">fsize</ref><sp/>=<sp/><ref refid="ff_8h_1a4690304ddc975516f7dc02575c96e34e" kindref="member">LD_DWORD</ref>(dir<sp/>+<sp/><ref refid="ff_8c_1abfbfa613864a02a65f0bf70ead6672c7" kindref="member">DIR_FileSize</ref>);<sp/><sp/></highlight><highlight class="comment">/*<sp/>Size<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fno-&gt;<ref refid="struct_f_i_l_i_n_f_o_1af49edeb97b10af8854cc15a05947a7d4" kindref="member">fdate</ref><sp/>=<sp/><ref refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" kindref="member">LD_WORD</ref>(dir<sp/>+<sp/><ref refid="ff_8c_1abed17fa699511b09cbf64961373d63a4" kindref="member">DIR_WrtDate</ref>);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Date<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fno-&gt;<ref refid="struct_f_i_l_i_n_f_o_1adb685b4c58c087d1cd790afb710001cb" kindref="member">ftime</ref><sp/>=<sp/><ref refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" kindref="member">LD_WORD</ref>(dir<sp/>+<sp/><ref refid="ff_8c_1ab9452d336adeece2a1b0b54ab35b8a59" kindref="member">DIR_WrtTime</ref>);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Time<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1740"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1741"><highlight class="normal"><sp/><sp/><sp/><sp/>*p<sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Terminate<sp/>SFN<sp/>string<sp/>by<sp/>a<sp/>\0<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1742"><highlight class="normal"></highlight></codeline>
<codeline lineno="1743"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1744"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fno-&gt;<ref refid="struct_f_i_l_i_n_f_o_1ac40e23991a0616f2573d7856cdbba9ea" kindref="member">lfname</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/>0;<sp/>p<sp/>=<sp/>fno-&gt;<ref refid="struct_f_i_l_i_n_f_o_1ac40e23991a0616f2573d7856cdbba9ea" kindref="member">lfname</ref>;</highlight></codeline>
<codeline lineno="1746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dp-&gt;<ref refid="struct_d_i_r_1a3e49e0860170e0fd9fc3e891b0d59975" kindref="member">sect</ref><sp/>&amp;&amp;<sp/>fno-&gt;<ref refid="struct_f_i_l_i_n_f_o_1a28ec94b667e705d5eb0ec0bc7b5e32ec" kindref="member">lfsize</ref><sp/>&amp;&amp;<sp/>dp-&gt;<ref refid="struct_d_i_r_1a7f94c0148d9e604278c77e10ab0140cb" kindref="member">lfn_idx</ref><sp/>!=<sp/>0xFFFF)<sp/>{<sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>LFN<sp/>if<sp/>available<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lfn<sp/>=<sp/>dp-&gt;<ref refid="struct_d_i_r_1a95ac58da8ca4254c6923552f1a9ca92d" kindref="member">lfn</ref>;</highlight></codeline>
<codeline lineno="1748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((w<sp/>=<sp/>*lfn++)<sp/>!=<sp/>0)<sp/>{<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>an<sp/>LFN<sp/>character<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1749"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_LFN_UNICODE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/><ref refid="ff_8h_1ae5146230b88ddb4a6a69340e0fd1eabd" kindref="member">ff_convert</ref>(w,<sp/>0);<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Unicode<sp/>-&gt;<sp/>OEM<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!w)<sp/>{<sp/>i<sp/>=<sp/>0;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/>}<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>No<sp/>LFN<sp/>if<sp/>it<sp/>could<sp/>not<sp/>be<sp/>converted<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1a228bfd2cabe490c8567aaf08b8b2cc14" kindref="member">_DF1S</ref><sp/>&amp;&amp;<sp/>w<sp/>&gt;=<sp/>0x100)<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Put<sp/>1st<sp/>byte<sp/>if<sp/>it<sp/>is<sp/>a<sp/>DBC<sp/>(always<sp/>false<sp/>on<sp/>SBCS<sp/>cfg)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p[i++]<sp/>=<sp/>(<ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>)(w<sp/>&gt;&gt;<sp/>8);</highlight></codeline>
<codeline lineno="1754"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>&gt;=<sp/>fno-&gt;<ref refid="struct_f_i_l_i_n_f_o_1a28ec94b667e705d5eb0ec0bc7b5e32ec" kindref="member">lfsize</ref><sp/>-<sp/>1)<sp/>{<sp/>i<sp/>=<sp/>0;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/>}<sp/></highlight><highlight class="comment">/*<sp/>No<sp/>LFN<sp/>if<sp/>buffer<sp/>overflow<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p[i++]<sp/>=<sp/>(<ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>)w;</highlight></codeline>
<codeline lineno="1757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p[i]<sp/>=<sp/>0;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Terminate<sp/>LFN<sp/>string<sp/>by<sp/>a<sp/>\0<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1760"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1761"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1762"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1763"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>_FS_MINIMIZE<sp/>&lt;=<sp/>1<sp/>||<sp/>_FS_RPATH<sp/>&gt;=<sp/>2<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1764"><highlight class="normal"></highlight></codeline>
<codeline lineno="1765"><highlight class="normal"></highlight></codeline>
<codeline lineno="1766"><highlight class="normal"></highlight></codeline>
<codeline lineno="1767"><highlight class="normal"></highlight></codeline>
<codeline lineno="1768"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1769"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Pattern<sp/>matching<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1770"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1771"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_FIND<sp/>&amp;&amp;<sp/>_FS_MINIMIZE<sp/>&lt;=<sp/>1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1772"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1773"><highlight class="normal"><ref refid="integer_8h_1a570001c92f314285ad3e7139d8c58cf7" kindref="member">WCHAR</ref><sp/>get_achar<sp/>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>a<sp/>character<sp/>and<sp/>advances<sp/>ptr<sp/>1<sp/>or<sp/>2<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1774"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>**<sp/>ptr<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>pointer<sp/>to<sp/>the<sp/>SBCS/DBCS/Unicode<sp/>string<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1775"><highlight class="normal">)</highlight></codeline>
<codeline lineno="1776"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1777"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a570001c92f314285ad3e7139d8c58cf7" kindref="member">WCHAR</ref><sp/>chr;</highlight></codeline>
<codeline lineno="1778"><highlight class="normal"></highlight></codeline>
<codeline lineno="1779"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_LFN_UNICODE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1780"><highlight class="normal"><sp/><sp/><sp/><sp/>chr<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)*(*ptr)++;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>a<sp/>byte<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1781"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1a4a9d454724926bd51a3aed589a97f08b" kindref="member">IsLower</ref>(chr))<sp/>chr<sp/>-=<sp/>0x20;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>To<sp/>upper<sp/>ASCII<sp/>char<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1782"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1a58d63a832a117f179e41c7373d013dd6" kindref="member">IsDBCS1</ref>(chr)<sp/>&amp;&amp;<sp/><ref refid="ff_8c_1a66a3fa880af6078ef181656c1d7d8ef1" kindref="member">IsDBCS2</ref>(**ptr))<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>DBC<sp/>2nd<sp/>byte<sp/>if<sp/>needed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>chr<sp/>=<sp/>chr<sp/>&lt;&lt;<sp/>8<sp/>|<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)*(*ptr)++;</highlight></codeline>
<codeline lineno="1784"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>_EXCVT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1785"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(chr<sp/>&gt;=<sp/>0x80)<sp/>chr<sp/>=<sp/>ExCvt[chr<sp/>-<sp/>0x80];<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>To<sp/>upper<sp/>SBCS<sp/>extended<sp/>char<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1786"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1787"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1788"><highlight class="normal"><sp/><sp/><sp/><sp/>chr<sp/>=<sp/><ref refid="ff_8h_1af3555c2976dfadc4f1e5cbacc275a012" kindref="member">ff_wtoupper</ref>(*(*ptr)++);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>a<sp/>word<sp/>and<sp/>to<sp/>upper<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1789"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1790"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>chr;</highlight></codeline>
<codeline lineno="1791"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1792"><highlight class="normal"></highlight></codeline>
<codeline lineno="1793"><highlight class="normal"></highlight></codeline>
<codeline lineno="1794"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1795"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>pattern_matching<sp/>(<sp/><sp/></highlight><highlight class="comment">/*<sp/>0:mismatched,<sp/>1:matched<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1796"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/>pat,<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Matching<sp/>pattern<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1797"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/>nam,<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>String<sp/>to<sp/>be<sp/>tested<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1798"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="c_j_s_o_n_8c_1ad1c991ebe6cb88144a8e06e6443c36c9" kindref="member">skip</ref>,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>pre-skip<sp/>chars<sp/>(number<sp/>of<sp/>?s)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1799"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>inf<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Infinite<sp/>search<sp/>(*<sp/>specified)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1800"><highlight class="normal">)</highlight></codeline>
<codeline lineno="1801"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1802"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref><sp/>*pp,<sp/>*np;</highlight></codeline>
<codeline lineno="1803"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a570001c92f314285ad3e7139d8c58cf7" kindref="member">WCHAR</ref><sp/><ref refid="_fault_handler_8c_1a64b917f8da4b760f3b3bf89efc9f59c9" kindref="member">pc</ref>,<sp/>nc;</highlight></codeline>
<codeline lineno="1804"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nm,<sp/>nx;</highlight></codeline>
<codeline lineno="1805"><highlight class="normal"></highlight></codeline>
<codeline lineno="1806"><highlight class="normal"></highlight></codeline>
<codeline lineno="1807"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(skip--)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pre-skip<sp/>name<sp/>chars<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!get_achar(&amp;nam))<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;<sp/></highlight><highlight class="comment">/*<sp/>Branch<sp/>mismatched<sp/>if<sp/>less<sp/>name<sp/>chars<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1809"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1810"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!*pat<sp/>&amp;&amp;<sp/>inf)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>(short<sp/>circuit)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1811"><highlight class="normal"></highlight></codeline>
<codeline lineno="1812"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pp<sp/>=<sp/>pat;<sp/>np<sp/>=<sp/>nam;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Top<sp/>of<sp/>pattern<sp/>and<sp/>name<sp/>to<sp/>match<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(;;)<sp/>{</highlight></codeline>
<codeline lineno="1815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(*pp<sp/>==<sp/></highlight><highlight class="charliteral">&apos;?&apos;</highlight><highlight class="normal"><sp/>||<sp/>*pp<sp/>==<sp/></highlight><highlight class="charliteral">&apos;*&apos;</highlight><highlight class="normal">)<sp/>{<sp/></highlight><highlight class="comment">/*<sp/>Wildcard?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nm<sp/>=<sp/>nx<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Analyze<sp/>the<sp/>wildcard<sp/>chars<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(*pp++<sp/>==<sp/></highlight><highlight class="charliteral">&apos;?&apos;</highlight><highlight class="normal">)<sp/>nm++;<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>nx<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1819"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(*pp<sp/>==<sp/></highlight><highlight class="charliteral">&apos;?&apos;</highlight><highlight class="normal"><sp/>||<sp/>*pp<sp/>==<sp/></highlight><highlight class="charliteral">&apos;*&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pattern_matching(pp,<sp/>np,<sp/>nm,<sp/>nx))<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;<sp/></highlight><highlight class="comment">/*<sp/>Test<sp/>new<sp/>branch<sp/>(recurs<sp/>upto<sp/>number<sp/>of<sp/>wildcard<sp/>blocks<sp/>in<sp/>the<sp/>pattern)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1821"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nc<sp/>=<sp/>*np;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Branch<sp/>mismatched<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1822"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pc<sp/>=<sp/>get_achar(&amp;pp);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>a<sp/>pattern<sp/>char<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1824"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nc<sp/>=<sp/>get_achar(&amp;np);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>a<sp/>name<sp/>char<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pc<sp/>!=<sp/>nc)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Branch<sp/>mismatched?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pc)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Branch<sp/>matched?<sp/>(matched<sp/>at<sp/>end<sp/>of<sp/>both<sp/>strings)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1827"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1828"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>get_achar(&amp;nam);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>nam++<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1829"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(inf<sp/>&amp;&amp;<sp/>nc);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Retry<sp/>until<sp/>end<sp/>of<sp/>name<sp/>if<sp/>infinite<sp/>search<sp/>is<sp/>specified<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1830"><highlight class="normal"></highlight></codeline>
<codeline lineno="1831"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="1832"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1833"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>_USE_FIND<sp/>&amp;&amp;<sp/>_FS_MINIMIZE<sp/>&lt;=<sp/>1<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1834"><highlight class="normal"></highlight></codeline>
<codeline lineno="1835"><highlight class="normal"></highlight></codeline>
<codeline lineno="1836"><highlight class="normal"></highlight></codeline>
<codeline lineno="1837"><highlight class="normal"></highlight></codeline>
<codeline lineno="1838"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1839"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Pick<sp/>a<sp/>top<sp/>segment<sp/>and<sp/>create<sp/>the<sp/>object<sp/>name<sp/>in<sp/>directory<sp/>form<sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1840"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1841"><highlight class="normal"></highlight></codeline>
<codeline lineno="1842"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1843" refid="ff_8c_1a1407adce52a966e786c7d37f9643a800" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="ff_8c_1a1407adce52a966e786c7d37f9643a800" kindref="member">create_name</ref><sp/>(<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FR_OK:<sp/>successful,<sp/>FR_INVALID_NAME:<sp/>could<sp/>not<sp/>create<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1844"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref>*<sp/>dp,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>directory<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1845"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>**<sp/>path<sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>pointer<sp/>to<sp/>the<sp/>segment<sp/>in<sp/>the<sp/>path<sp/>string<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1846"><highlight class="normal">)</highlight></codeline>
<codeline lineno="1847"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1848"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>LFN<sp/>configuration<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1849"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>b,<sp/>cf;</highlight></codeline>
<codeline lineno="1850"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a570001c92f314285ad3e7139d8c58cf7" kindref="member">WCHAR</ref><sp/>w,<sp/>*lfn;</highlight></codeline>
<codeline lineno="1851"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>i,<sp/>ni,<sp/>si,<sp/>di;</highlight></codeline>
<codeline lineno="1852"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref><sp/>*p;</highlight></codeline>
<codeline lineno="1853"><highlight class="normal"></highlight></codeline>
<codeline lineno="1854"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>LFN<sp/>in<sp/>Unicode<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1855"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(p<sp/>=<sp/>*path;<sp/>*p<sp/>==<sp/></highlight><highlight class="charliteral">&apos;/&apos;</highlight><highlight class="normal"><sp/>||<sp/>*p<sp/>==<sp/></highlight><highlight class="charliteral">&apos;\\&apos;</highlight><highlight class="normal">;<sp/>p++)<sp/>;<sp/></highlight><highlight class="comment">/*<sp/>Strip<sp/>duplicated<sp/>separator<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1856"><highlight class="normal"><sp/><sp/><sp/><sp/>lfn<sp/>=<sp/>dp-&gt;<ref refid="struct_d_i_r_1a95ac58da8ca4254c6923552f1a9ca92d" kindref="member">lfn</ref>;</highlight></codeline>
<codeline lineno="1857"><highlight class="normal"><sp/><sp/><sp/><sp/>si<sp/>=<sp/>di<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1858"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(;;)<sp/>{</highlight></codeline>
<codeline lineno="1859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/>p[si++];<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>a<sp/>character<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(w<sp/>&lt;<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal"><sp/>||<sp/>w<sp/>==<sp/></highlight><highlight class="charliteral">&apos;/&apos;</highlight><highlight class="normal"><sp/>||<sp/>w<sp/>==<sp/></highlight><highlight class="charliteral">&apos;\\&apos;</highlight><highlight class="normal">)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Break<sp/>on<sp/>end<sp/>of<sp/>segment<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(di<sp/>&gt;=<sp/><ref refid="group___f_f_c_o_n_f_i_g_1ga14e73a5c703a586c614b3e40b849f82c" kindref="member">_MAX_LFN</ref>)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Reject<sp/>too<sp/>long<sp/>name<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1862"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" kindref="member">FR_INVALID_NAME</ref>;</highlight></codeline>
<codeline lineno="1863"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_LFN_UNICODE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1864"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>&amp;=<sp/>0xFF;</highlight></codeline>
<codeline lineno="1865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1a58d63a832a117f179e41c7373d013dd6" kindref="member">IsDBCS1</ref>(w))<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>if<sp/>it<sp/>is<sp/>a<sp/>DBC<sp/>1st<sp/>byte<sp/>(always<sp/>false<sp/>on<sp/>SBCS<sp/>cfg)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>b<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)p[si++];<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>2nd<sp/>byte<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/>(w<sp/>&lt;&lt;<sp/>8)<sp/>+<sp/>b;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>a<sp/>DBC<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="ff_8c_1a66a3fa880af6078ef181656c1d7d8ef1" kindref="member">IsDBCS2</ref>(b))</highlight></codeline>
<codeline lineno="1869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" kindref="member">FR_INVALID_NAME</ref>;<sp/></highlight><highlight class="comment">/*<sp/>Reject<sp/>invalid<sp/>sequence<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/><ref refid="ff_8h_1ae5146230b88ddb4a6a69340e0fd1eabd" kindref="member">ff_convert</ref>(w,<sp/>1);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Convert<sp/>ANSI/OEM<sp/>to<sp/>Unicode<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!w)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" kindref="member">FR_INVALID_NAME</ref>;<sp/></highlight><highlight class="comment">/*<sp/>Reject<sp/>invalid<sp/>code<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1873"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(w<sp/>&lt;<sp/>0x80<sp/>&amp;&amp;<sp/><ref refid="ff_8c_1a1a60c4200d040e4f47e87dc927f23d14" kindref="member">chk_chr</ref>(</highlight><highlight class="stringliteral">&quot;\&quot;*:&lt;&gt;\?|\x7F&quot;</highlight><highlight class="normal">,<sp/>w))<sp/></highlight><highlight class="comment">/*<sp/>Reject<sp/>illegal<sp/>characters<sp/>for<sp/>LFN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" kindref="member">FR_INVALID_NAME</ref>;</highlight></codeline>
<codeline lineno="1876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lfn[di++]<sp/>=<sp/>w;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Store<sp/>the<sp/>Unicode<sp/>character<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1877"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1878"><highlight class="normal"><sp/><sp/><sp/><sp/>*path<sp/>=<sp/>&amp;p[si];<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Return<sp/>pointer<sp/>to<sp/>the<sp/>next<sp/>segment<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1879"><highlight class="normal"><sp/><sp/><sp/><sp/>cf<sp/>=<sp/>(w<sp/>&lt;<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">)<sp/>?<sp/><ref refid="ff_8c_1a5a0742bfc1d94f0c3baa5ede485048c4" kindref="member">NS_LAST</ref><sp/>:<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>last<sp/>segment<sp/>flag<sp/>if<sp/>end<sp/>of<sp/>path<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1880"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_RPATH</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1881"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((di<sp/>==<sp/>1<sp/>&amp;&amp;<sp/>lfn[di<sp/>-<sp/>1]<sp/>==<sp/></highlight><highlight class="charliteral">&apos;.&apos;</highlight><highlight class="normal">)<sp/>||</highlight></codeline>
<codeline lineno="1882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(di<sp/>==<sp/>2<sp/>&amp;&amp;<sp/>lfn[di<sp/>-<sp/>1]<sp/>==<sp/></highlight><highlight class="charliteral">&apos;.&apos;</highlight><highlight class="normal"><sp/>&amp;&amp;<sp/>lfn[di<sp/>-<sp/>2]<sp/>==<sp/></highlight><highlight class="charliteral">&apos;.&apos;</highlight><highlight class="normal">))<sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Is<sp/>this<sp/>segment<sp/>a<sp/>dot<sp/>entry?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lfn[di]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>11;<sp/>i++)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>dot<sp/>name<sp/>for<sp/>SFN<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" kindref="member">fn</ref>[i]<sp/>=<sp/>(i<sp/>&lt;<sp/>di)<sp/>?<sp/></highlight><highlight class="charliteral">&apos;.&apos;</highlight><highlight class="normal"><sp/>:<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" kindref="member">fn</ref>[i]<sp/>=<sp/>cf<sp/>|<sp/><ref refid="ff_8c_1a2db528782a021797b34bdc6e9e9de1c3" kindref="member">NS_DOT</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>This<sp/>is<sp/>a<sp/>dot<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>;</highlight></codeline>
<codeline lineno="1888"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1889"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1890"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(di)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Snip<sp/>off<sp/>trailing<sp/>spaces<sp/>and<sp/>dots<sp/>if<sp/>exist<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/>lfn[di<sp/>-<sp/>1];</highlight></codeline>
<codeline lineno="1892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(w<sp/>!=<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal"><sp/>&amp;&amp;<sp/>w<sp/>!=<sp/></highlight><highlight class="charliteral">&apos;.&apos;</highlight><highlight class="normal">)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>di--;</highlight></codeline>
<codeline lineno="1894"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1895"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!di)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" kindref="member">FR_INVALID_NAME</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Reject<sp/>nul<sp/>string<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1896"><highlight class="normal"><sp/><sp/><sp/><sp/>lfn[di]<sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>LFN<sp/>is<sp/>created<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1897"><highlight class="normal"></highlight></codeline>
<codeline lineno="1898"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>SFN<sp/>in<sp/>directory<sp/>form<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1899"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a02eb5189e43056a9ddc8a59cbe89be93" kindref="member">mem_set</ref>(dp-&gt;<ref refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" kindref="member">fn</ref>,<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">,<sp/>11);</highlight></codeline>
<codeline lineno="1900"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(si<sp/>=<sp/>0;<sp/>lfn[si]<sp/>==<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal"><sp/>||<sp/>lfn[si]<sp/>==<sp/></highlight><highlight class="charliteral">&apos;.&apos;</highlight><highlight class="normal">;<sp/>si++)<sp/>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Strip<sp/>leading<sp/>spaces<sp/>and<sp/>dots<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1901"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(si)<sp/>cf<sp/>|=<sp/><ref refid="ff_8c_1ac92c92c3a3d6b9235ac98feeb00e565a" kindref="member">NS_LOSS</ref><sp/>|<sp/><ref refid="ff_8c_1ae957b8d4065ea0b3eed822aec5368d29" kindref="member">NS_LFN</ref>;</highlight></codeline>
<codeline lineno="1902"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(di<sp/>&amp;&amp;<sp/>lfn[di<sp/>-<sp/>1]<sp/>!=<sp/></highlight><highlight class="charliteral">&apos;.&apos;</highlight><highlight class="normal">)<sp/>di--;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Find<sp/>extension<sp/>(di&lt;=si:<sp/>no<sp/>extension)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1903"><highlight class="normal"></highlight></codeline>
<codeline lineno="1904"><highlight class="normal"><sp/><sp/><sp/><sp/>b<sp/>=<sp/>i<sp/>=<sp/>0;<sp/>ni<sp/>=<sp/>8;</highlight></codeline>
<codeline lineno="1905"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(;;)<sp/>{</highlight></codeline>
<codeline lineno="1906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/>lfn[si++];<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>an<sp/>LFN<sp/>character<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!w)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Break<sp/>on<sp/>end<sp/>of<sp/>the<sp/>LFN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(w<sp/>==<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal"><sp/>||<sp/>(w<sp/>==<sp/></highlight><highlight class="charliteral">&apos;.&apos;</highlight><highlight class="normal"><sp/>&amp;&amp;<sp/>si<sp/>!=<sp/>di))<sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Remove<sp/>spaces<sp/>and<sp/>dots<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cf<sp/>|=<sp/><ref refid="ff_8c_1ac92c92c3a3d6b9235ac98feeb00e565a" kindref="member">NS_LOSS</ref><sp/>|<sp/><ref refid="ff_8c_1ae957b8d4065ea0b3eed822aec5368d29" kindref="member">NS_LFN</ref>;<sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1911"><highlight class="normal"></highlight></codeline>
<codeline lineno="1912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>&gt;=<sp/>ni<sp/>||<sp/>si<sp/>==<sp/>di)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Extension<sp/>or<sp/>end<sp/>of<sp/>SFN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ni<sp/>==<sp/>11)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Long<sp/>extension<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cf<sp/>|=<sp/><ref refid="ff_8c_1ac92c92c3a3d6b9235ac98feeb00e565a" kindref="member">NS_LOSS</ref><sp/>|<sp/><ref refid="ff_8c_1ae957b8d4065ea0b3eed822aec5368d29" kindref="member">NS_LFN</ref>;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(si<sp/>!=<sp/>di)<sp/>cf<sp/>|=<sp/><ref refid="ff_8c_1ac92c92c3a3d6b9235ac98feeb00e565a" kindref="member">NS_LOSS</ref><sp/>|<sp/><ref refid="ff_8c_1ae957b8d4065ea0b3eed822aec5368d29" kindref="member">NS_LFN</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Out<sp/>of<sp/>8.3<sp/>format<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(si<sp/>&gt;<sp/>di)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>No<sp/>extension<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>si<sp/>=<sp/>di;<sp/>i<sp/>=<sp/>8;<sp/>ni<sp/>=<sp/>11;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Enter<sp/>extension<sp/>section<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>b<sp/>&lt;&lt;=<sp/>2;<sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1921"><highlight class="normal"></highlight></codeline>
<codeline lineno="1922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(w<sp/>&gt;=<sp/>0x80)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Non<sp/>ASCII<sp/>character<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1923"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>_EXCVT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/><ref refid="ff_8h_1ae5146230b88ddb4a6a69340e0fd1eabd" kindref="member">ff_convert</ref>(w,<sp/>0);<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Unicode<sp/>-&gt;<sp/>OEM<sp/>code<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(w)<sp/>w<sp/>=<sp/>ExCvt[w<sp/>-<sp/>0x80];<sp/></highlight><highlight class="comment">/*<sp/>Convert<sp/>extended<sp/>character<sp/>to<sp/>upper<sp/>(SBCS)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1926"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/><ref refid="ff_8h_1ae5146230b88ddb4a6a69340e0fd1eabd" kindref="member">ff_convert</ref>(<ref refid="ff_8h_1af3555c2976dfadc4f1e5cbacc275a012" kindref="member">ff_wtoupper</ref>(w),<sp/>0);<sp/><sp/></highlight><highlight class="comment">/*<sp/>Upper<sp/>converted<sp/>Unicode<sp/>-&gt;<sp/>OEM<sp/>code<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1928"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cf<sp/>|=<sp/><ref refid="ff_8c_1ae957b8d4065ea0b3eed822aec5368d29" kindref="member">NS_LFN</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Force<sp/>create<sp/>LFN<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1931"><highlight class="normal"></highlight></codeline>
<codeline lineno="1932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1a228bfd2cabe490c8567aaf08b8b2cc14" kindref="member">_DF1S</ref><sp/>&amp;&amp;<sp/>w<sp/>&gt;=<sp/>0x100)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Is<sp/>this<sp/>DBC?<sp/>(always<sp/>false<sp/>at<sp/>SBCS<sp/>cfg)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1933"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>&gt;=<sp/>ni<sp/>-<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="1934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cf<sp/>|=<sp/><ref refid="ff_8c_1ac92c92c3a3d6b9235ac98feeb00e565a" kindref="member">NS_LOSS</ref><sp/>|<sp/><ref refid="ff_8c_1ae957b8d4065ea0b3eed822aec5368d29" kindref="member">NS_LFN</ref>;<sp/>i<sp/>=<sp/>ni;<sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" kindref="member">fn</ref>[i++]<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)(w<sp/>&gt;&gt;<sp/>8);</highlight></codeline>
<codeline lineno="1937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>SBC<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!w<sp/>||<sp/><ref refid="ff_8c_1a1a60c4200d040e4f47e87dc927f23d14" kindref="member">chk_chr</ref>(</highlight><highlight class="stringliteral">&quot;+,;=[]&quot;</highlight><highlight class="normal">,<sp/>w))<sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Replace<sp/>illegal<sp/>characters<sp/>for<sp/>SFN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/></highlight><highlight class="charliteral">&apos;_&apos;</highlight><highlight class="normal">;<sp/>cf<sp/>|=<sp/><ref refid="ff_8c_1ac92c92c3a3d6b9235ac98feeb00e565a" kindref="member">NS_LOSS</ref><sp/>|<sp/><ref refid="ff_8c_1ae957b8d4065ea0b3eed822aec5368d29" kindref="member">NS_LFN</ref>;</highlight><highlight class="comment">/*<sp/>Lossy<sp/>conversion<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1a89b2514198590e139dd064c5d534f302" kindref="member">IsUpper</ref>(w))<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>ASCII<sp/>large<sp/>capital<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>b<sp/>|=<sp/>2;</highlight></codeline>
<codeline lineno="1943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1a4a9d454724926bd51a3aed589a97f08b" kindref="member">IsLower</ref>(w))<sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>ASCII<sp/>small<sp/>capital<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>b<sp/>|=<sp/>1;<sp/>w<sp/>-=<sp/>0x20;</highlight></codeline>
<codeline lineno="1946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" kindref="member">fn</ref>[i++]<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)w;</highlight></codeline>
<codeline lineno="1951"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1952"><highlight class="normal"></highlight></codeline>
<codeline lineno="1953"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dp-&gt;<ref refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" kindref="member">fn</ref>[0]<sp/>==<sp/><ref refid="ff_8c_1a0f2455f7318e6d56318c62f5e4048e1e" kindref="member">DDEM</ref>)<sp/>dp-&gt;<ref refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" kindref="member">fn</ref>[0]<sp/>=<sp/><ref refid="ff_8c_1a24b6bc427cbd37fbe76e087f7f188abb" kindref="member">RDDEM</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>the<sp/>first<sp/>character<sp/>collides<sp/>with<sp/>DDEM,<sp/>replace<sp/>it<sp/>with<sp/>RDDEM<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1954"><highlight class="normal"></highlight></codeline>
<codeline lineno="1955"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ni<sp/>==<sp/>8)<sp/>b<sp/>&lt;&lt;=<sp/>2;</highlight></codeline>
<codeline lineno="1956"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((b<sp/>&amp;<sp/>0x0C)<sp/>==<sp/>0x0C<sp/>||<sp/>(b<sp/>&amp;<sp/>0x03)<sp/>==<sp/>0x03)<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>LFN<sp/>entry<sp/>when<sp/>there<sp/>are<sp/>composite<sp/>capitals<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cf<sp/>|=<sp/><ref refid="ff_8c_1ae957b8d4065ea0b3eed822aec5368d29" kindref="member">NS_LFN</ref>;</highlight></codeline>
<codeline lineno="1958"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!(cf<sp/>&amp;<sp/><ref refid="ff_8c_1ae957b8d4065ea0b3eed822aec5368d29" kindref="member">NS_LFN</ref>))<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>When<sp/>LFN<sp/>is<sp/>in<sp/>8.3<sp/>format<sp/>without<sp/>extended<sp/>character,<sp/>NT<sp/>flags<sp/>are<sp/>created<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((b<sp/>&amp;<sp/>0x03)<sp/>==<sp/>0x01)<sp/>cf<sp/>|=<sp/><ref refid="ff_8c_1a3b7fad0942e816fdb84d869c1f7a613e" kindref="member">NS_EXT</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>NT<sp/>flag<sp/>(Extension<sp/>has<sp/>only<sp/>small<sp/>capital)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((b<sp/>&amp;<sp/>0x0C)<sp/>==<sp/>0x04)<sp/>cf<sp/>|=<sp/><ref refid="ff_8c_1a4a0e89b504dece19e2e4b02c83782ca2" kindref="member">NS_BODY</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>NT<sp/>flag<sp/>(Filename<sp/>has<sp/>only<sp/>small<sp/>capital)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1961"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1962"><highlight class="normal"></highlight></codeline>
<codeline lineno="1963"><highlight class="normal"><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" kindref="member">fn</ref>[<ref refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" kindref="member">NSFLAG</ref>]<sp/>=<sp/>cf;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>SFN<sp/>is<sp/>created<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1964"><highlight class="normal"></highlight></codeline>
<codeline lineno="1965"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>;</highlight></codeline>
<codeline lineno="1966"><highlight class="normal"></highlight></codeline>
<codeline lineno="1967"><highlight class="normal"></highlight></codeline>
<codeline lineno="1968"><highlight class="normal"></highlight><highlight class="preprocessor">#else<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Non-LFN<sp/>configuration<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1969"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>b,<sp/>c,<sp/>d,<sp/>*sfn;</highlight></codeline>
<codeline lineno="1970"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>ni,<sp/>si,<sp/>i;</highlight></codeline>
<codeline lineno="1971"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*p;</highlight></codeline>
<codeline lineno="1972"><highlight class="normal"></highlight></codeline>
<codeline lineno="1973"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>file<sp/>name<sp/>in<sp/>directory<sp/>form<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1974"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(p<sp/>=<sp/>*path;<sp/>*p<sp/>==<sp/></highlight><highlight class="charliteral">&apos;/&apos;</highlight><highlight class="normal"><sp/>||<sp/>*p<sp/>==<sp/></highlight><highlight class="charliteral">&apos;\\&apos;</highlight><highlight class="normal">;<sp/>p++)<sp/>;<sp/></highlight><highlight class="comment">/*<sp/>Skip<sp/>duplicated<sp/>separator<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1975"><highlight class="normal"><sp/><sp/><sp/><sp/>sfn<sp/>=<sp/>dp-&gt;<ref refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" kindref="member">fn</ref>;</highlight></codeline>
<codeline lineno="1976"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a02eb5189e43056a9ddc8a59cbe89be93" kindref="member">mem_set</ref>(sfn,<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">,<sp/>11);</highlight></codeline>
<codeline lineno="1977"><highlight class="normal"><sp/><sp/><sp/><sp/>si<sp/>=<sp/>i<sp/>=<sp/>b<sp/>=<sp/>0;<sp/>ni<sp/>=<sp/>8;</highlight></codeline>
<codeline lineno="1978"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_RPATH</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1979"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(p[si]<sp/>==<sp/></highlight><highlight class="charliteral">&apos;.&apos;</highlight><highlight class="normal">)<sp/>{<sp/></highlight><highlight class="comment">/*<sp/>Is<sp/>this<sp/>a<sp/>dot<sp/>entry?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(;;)<sp/>{</highlight></codeline>
<codeline lineno="1981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)p[si++];</highlight></codeline>
<codeline lineno="1982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>!=<sp/></highlight><highlight class="charliteral">&apos;.&apos;</highlight><highlight class="normal"><sp/>||<sp/>si<sp/>&gt;=<sp/>3)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sfn[i++]<sp/>=<sp/>c;</highlight></codeline>
<codeline lineno="1984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>!=<sp/></highlight><highlight class="charliteral">&apos;/&apos;</highlight><highlight class="normal"><sp/>&amp;&amp;<sp/>c<sp/>!=<sp/></highlight><highlight class="charliteral">&apos;\\&apos;</highlight><highlight class="normal"><sp/>&amp;&amp;<sp/>c<sp/>&gt;<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" kindref="member">FR_INVALID_NAME</ref>;</highlight></codeline>
<codeline lineno="1986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*path<sp/>=<sp/>&amp;p[si];<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Return<sp/>pointer<sp/>to<sp/>the<sp/>next<sp/>segment<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sfn[<ref refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" kindref="member">NSFLAG</ref>]<sp/>=<sp/>(c<sp/>&lt;=<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">)<sp/>?<sp/><ref refid="ff_8c_1a5a0742bfc1d94f0c3baa5ede485048c4" kindref="member">NS_LAST</ref><sp/>|<sp/><ref refid="ff_8c_1a2db528782a021797b34bdc6e9e9de1c3" kindref="member">NS_DOT</ref><sp/>:<sp/><ref refid="ff_8c_1a2db528782a021797b34bdc6e9e9de1c3" kindref="member">NS_DOT</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>last<sp/>segment<sp/>flag<sp/>if<sp/>end<sp/>of<sp/>path<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>;</highlight></codeline>
<codeline lineno="1989"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1990"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1991"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(;;)<sp/>{</highlight></codeline>
<codeline lineno="1992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)p[si++];</highlight></codeline>
<codeline lineno="1993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>&lt;=<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal"><sp/>||<sp/>c<sp/>==<sp/></highlight><highlight class="charliteral">&apos;/&apos;</highlight><highlight class="normal"><sp/>||<sp/>c<sp/>==<sp/></highlight><highlight class="charliteral">&apos;\\&apos;</highlight><highlight class="normal">)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Break<sp/>on<sp/>end<sp/>of<sp/>segment<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>==<sp/></highlight><highlight class="charliteral">&apos;.&apos;</highlight><highlight class="normal"><sp/>||<sp/>i<sp/>&gt;=<sp/>ni)<sp/>{</highlight></codeline>
<codeline lineno="1995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ni<sp/>!=<sp/>8<sp/>||<sp/>c<sp/>!=<sp/></highlight><highlight class="charliteral">&apos;.&apos;</highlight><highlight class="normal">)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" kindref="member">FR_INVALID_NAME</ref>;</highlight></codeline>
<codeline lineno="1996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/>8;<sp/>ni<sp/>=<sp/>11;</highlight></codeline>
<codeline lineno="1997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>b<sp/>&lt;&lt;=<sp/>2;<sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>&gt;=<sp/>0x80)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Extended<sp/>character?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>b<sp/>|=<sp/>3;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Eliminate<sp/>NT<sp/>flag<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2001"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>_EXCVT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>=<sp/>ExCvt[c<sp/>-<sp/>0x80];<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>To<sp/>upper<sp/>extended<sp/>characters<sp/>(SBCS<sp/>cfg)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2003"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2004"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_DF1S</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" kindref="member">FR_INVALID_NAME</ref>;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Reject<sp/>extended<sp/>characters<sp/>(ASCII<sp/>cfg)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2006"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2007"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1a58d63a832a117f179e41c7373d013dd6" kindref="member">IsDBCS1</ref>(c))<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>if<sp/>it<sp/>is<sp/>a<sp/>DBC<sp/>1st<sp/>byte<sp/>(always<sp/>false<sp/>at<sp/>SBCS<sp/>cfg.)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)p[si++];<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>2nd<sp/>byte<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="ff_8c_1a66a3fa880af6078ef181656c1d7d8ef1" kindref="member">IsDBCS2</ref>(d)<sp/>||<sp/>i<sp/>&gt;=<sp/>ni<sp/>-<sp/>1)<sp/></highlight><highlight class="comment">/*<sp/>Reject<sp/>invalid<sp/>DBC<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" kindref="member">FR_INVALID_NAME</ref>;</highlight></codeline>
<codeline lineno="2013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sfn[i++]<sp/>=<sp/>c;</highlight></codeline>
<codeline lineno="2014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sfn[i++]<sp/>=<sp/>d;</highlight></codeline>
<codeline lineno="2015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>SBC<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1a1a60c4200d040e4f47e87dc927f23d14" kindref="member">chk_chr</ref>(</highlight><highlight class="stringliteral">&quot;\&quot;*+,:;&lt;=&gt;\?[]|\x7F&quot;</highlight><highlight class="normal">,<sp/>c))<sp/><sp/></highlight><highlight class="comment">/*<sp/>Reject<sp/>illegal<sp/>chrs<sp/>for<sp/>SFN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" kindref="member">FR_INVALID_NAME</ref>;</highlight></codeline>
<codeline lineno="2018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1a89b2514198590e139dd064c5d534f302" kindref="member">IsUpper</ref>(c))<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>ASCII<sp/>large<sp/>capital?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>b<sp/>|=<sp/>2;</highlight></codeline>
<codeline lineno="2020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1a4a9d454724926bd51a3aed589a97f08b" kindref="member">IsLower</ref>(c))<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>ASCII<sp/>small<sp/>capital?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>b<sp/>|=<sp/>1;<sp/>c<sp/>-=<sp/>0x20;</highlight></codeline>
<codeline lineno="2023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sfn[i++]<sp/>=<sp/>c;</highlight></codeline>
<codeline lineno="2026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2027"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2028"><highlight class="normal"><sp/><sp/><sp/><sp/>*path<sp/>=<sp/>&amp;p[si];<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Return<sp/>pointer<sp/>to<sp/>the<sp/>next<sp/>segment<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2029"><highlight class="normal"><sp/><sp/><sp/><sp/>c<sp/>=<sp/>(c<sp/>&lt;=<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">)<sp/>?<sp/><ref refid="ff_8c_1a5a0742bfc1d94f0c3baa5ede485048c4" kindref="member">NS_LAST</ref><sp/>:<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>last<sp/>segment<sp/>flag<sp/>if<sp/>end<sp/>of<sp/>path<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2030"><highlight class="normal"></highlight></codeline>
<codeline lineno="2031"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!i)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" kindref="member">FR_INVALID_NAME</ref>;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Reject<sp/>nul<sp/>string<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2032"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sfn[0]<sp/>==<sp/><ref refid="ff_8c_1a0f2455f7318e6d56318c62f5e4048e1e" kindref="member">DDEM</ref>)<sp/>sfn[0]<sp/>=<sp/><ref refid="ff_8c_1a24b6bc427cbd37fbe76e087f7f188abb" kindref="member">RDDEM</ref>;<sp/></highlight><highlight class="comment">/*<sp/>When<sp/>first<sp/>character<sp/>collides<sp/>with<sp/>DDEM,<sp/>replace<sp/>it<sp/>with<sp/>RDDEM<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2033"><highlight class="normal"></highlight></codeline>
<codeline lineno="2034"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ni<sp/>==<sp/>8)<sp/>b<sp/>&lt;&lt;=<sp/>2;</highlight></codeline>
<codeline lineno="2035"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((b<sp/>&amp;<sp/>0x03)<sp/>==<sp/>0x01)<sp/>c<sp/>|=<sp/><ref refid="ff_8c_1a3b7fad0942e816fdb84d869c1f7a613e" kindref="member">NS_EXT</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>NT<sp/>flag<sp/>(Name<sp/>extension<sp/>has<sp/>only<sp/>small<sp/>capital)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2036"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((b<sp/>&amp;<sp/>0x0C)<sp/>==<sp/>0x04)<sp/>c<sp/>|=<sp/><ref refid="ff_8c_1a4a0e89b504dece19e2e4b02c83782ca2" kindref="member">NS_BODY</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>NT<sp/>flag<sp/>(Name<sp/>body<sp/>has<sp/>only<sp/>small<sp/>capital)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2037"><highlight class="normal"></highlight></codeline>
<codeline lineno="2038"><highlight class="normal"><sp/><sp/><sp/><sp/>sfn[<ref refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" kindref="member">NSFLAG</ref>]<sp/>=<sp/>c;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Store<sp/>NT<sp/>flag,<sp/>File<sp/>name<sp/>is<sp/>created<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2039"><highlight class="normal"></highlight></codeline>
<codeline lineno="2040"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>;</highlight></codeline>
<codeline lineno="2041"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2042"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2043"><highlight class="normal"></highlight></codeline>
<codeline lineno="2044"><highlight class="normal"></highlight></codeline>
<codeline lineno="2045"><highlight class="normal"></highlight></codeline>
<codeline lineno="2046"><highlight class="normal"></highlight></codeline>
<codeline lineno="2047"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2048"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Follow<sp/>a<sp/>file<sp/>path<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2049"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2050"><highlight class="normal"></highlight></codeline>
<codeline lineno="2051"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2052" refid="ff_8c_1af194524672491a522f041278b9b74e94" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="ff_8c_1af194524672491a522f041278b9b74e94" kindref="member">follow_path</ref><sp/>(<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FR_OK(0):<sp/>successful,<sp/>!=0:<sp/>error<sp/>code<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2053"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref>*<sp/>dp,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Directory<sp/>object<sp/>to<sp/>return<sp/>last<sp/>directory<sp/>and<sp/>found<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2054"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/>path<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Full-path<sp/>string<sp/>to<sp/>find<sp/>a<sp/>file<sp/>or<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2055"><highlight class="normal">)</highlight></codeline>
<codeline lineno="2056"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2057"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="2058"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>*dir,<sp/>ns;</highlight></codeline>
<codeline lineno="2059"><highlight class="normal"></highlight></codeline>
<codeline lineno="2060"><highlight class="normal"></highlight></codeline>
<codeline lineno="2061"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_RPATH</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2062"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(*path<sp/>==<sp/></highlight><highlight class="charliteral">&apos;/&apos;</highlight><highlight class="normal"><sp/>||<sp/>*path<sp/>==<sp/></highlight><highlight class="charliteral">&apos;\\&apos;</highlight><highlight class="normal">)<sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>There<sp/>is<sp/>a<sp/>heading<sp/>separator<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path++;<sp/>dp-&gt;<ref refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref><sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Strip<sp/>it<sp/>and<sp/>start<sp/>from<sp/>the<sp/>root<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2064"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>No<sp/>heading<sp/>separator<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref><sp/>=<sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;cdir;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Start<sp/>from<sp/>the<sp/>current<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2066"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2067"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2068"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(*path<sp/>==<sp/></highlight><highlight class="charliteral">&apos;/&apos;</highlight><highlight class="normal"><sp/>||<sp/>*path<sp/>==<sp/></highlight><highlight class="charliteral">&apos;\\&apos;</highlight><highlight class="normal">)<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Strip<sp/>heading<sp/>separator<sp/>if<sp/>exist<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path++;</highlight></codeline>
<codeline lineno="2070"><highlight class="normal"><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref><sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Always<sp/>start<sp/>from<sp/>the<sp/>root<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2071"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2072"><highlight class="normal"></highlight></codeline>
<codeline lineno="2073"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((<ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref>)*path<sp/>&lt;<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Null<sp/>path<sp/>name<sp/>is<sp/>the<sp/>origin<sp/>directory<sp/>itself<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" kindref="member">dir_sdi</ref>(dp,<sp/>0);</highlight></codeline>
<codeline lineno="2075"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2076"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Follow<sp/>path<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(;;)<sp/>{</highlight></codeline>
<codeline lineno="2078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a1407adce52a966e786c7d37f9643a800" kindref="member">create_name</ref>(dp,<sp/>&amp;path);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>a<sp/>segment<sp/>name<sp/>of<sp/>the<sp/>path<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1abf87976453ebce0af60fa7bf4a6e21df" kindref="member">dir_find</ref>(dp);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Find<sp/>an<sp/>object<sp/>with<sp/>the<sp/>sagment<sp/>name<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2081"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ns<sp/>=<sp/>dp-&gt;<ref refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" kindref="member">fn</ref>[<ref refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" kindref="member">NSFLAG</ref>];</highlight></codeline>
<codeline lineno="2082"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Failed<sp/>to<sp/>find<sp/>the<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref>)<sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Object<sp/>is<sp/>not<sp/>found<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___f_f_c_o_n_f_i_g_1ga52faf11025401372f71e9d81905b7af4" kindref="member">_FS_RPATH</ref><sp/>&amp;&amp;<sp/>(ns<sp/>&amp;<sp/><ref refid="ff_8c_1a2db528782a021797b34bdc6e9e9de1c3" kindref="member">NS_DOT</ref>))<sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>dot<sp/>entry<sp/>is<sp/>not<sp/>exist,<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2085"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref><sp/>=<sp/>0;<sp/>dp-&gt;<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref><sp/>=<sp/>0;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>it<sp/>is<sp/>the<sp/>root<sp/>directory<sp/>and<sp/>stay<sp/>there<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!(ns<sp/>&amp;<sp/><ref refid="ff_8c_1a5a0742bfc1d94f0c3baa5ede485048c4" kindref="member">NS_LAST</ref>))<sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Continue<sp/>to<sp/>follow<sp/>if<sp/>not<sp/>last<sp/>segment<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2087"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Ended<sp/>at<sp/>the<sp/>root<sp/>directroy.<sp/>Function<sp/>completed.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Could<sp/>not<sp/>find<sp/>the<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!(ns<sp/>&amp;<sp/><ref refid="ff_8c_1a5a0742bfc1d94f0c3baa5ede485048c4" kindref="member">NS_LAST</ref>))<sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cae4529c8cc8b59783d6efc9ba4f574532" kindref="member">FR_NO_PATH</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Adjust<sp/>error<sp/>code<sp/>if<sp/>not<sp/>last<sp/>segment<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ns<sp/>&amp;<sp/><ref refid="ff_8c_1a5a0742bfc1d94f0c3baa5ede485048c4" kindref="member">NS_LAST</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Last<sp/>segment<sp/>matched.<sp/>Function<sp/>completed.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dir<sp/>=<sp/>dp-&gt;<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Follow<sp/>the<sp/>sub-directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!(dir[<ref refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" kindref="member">DIR_Attr</ref>]<sp/>&amp;<sp/><ref refid="ff_8h_1a3a9db44e978ed6c13b641e092d4cd7d3" kindref="member">AM_DIR</ref>))<sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>It<sp/>is<sp/>not<sp/>a<sp/>sub-directory<sp/>and<sp/>cannot<sp/>follow<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cae4529c8cc8b59783d6efc9ba4f574532" kindref="member">FR_NO_PATH</ref>;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref><sp/>=<sp/><ref refid="ff_8c_1ad1b3343c92d0f0e58ba448c3c11b1f39" kindref="member">ld_clust</ref>(dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>dir);</highlight></codeline>
<codeline lineno="2100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2101"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2102"><highlight class="normal"></highlight></codeline>
<codeline lineno="2103"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="2104"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2105"><highlight class="normal"></highlight></codeline>
<codeline lineno="2106"><highlight class="normal"></highlight></codeline>
<codeline lineno="2107"><highlight class="normal"></highlight></codeline>
<codeline lineno="2108"><highlight class="normal"></highlight></codeline>
<codeline lineno="2109"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2110"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Get<sp/>logical<sp/>drive<sp/>number<sp/>from<sp/>path<sp/>name<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2111"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2112"><highlight class="normal"></highlight></codeline>
<codeline lineno="2113"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2114" refid="ff_8c_1a88ad7e4b1bc98d1a2673a136283dc7ee" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="ff_8c_1a88ad7e4b1bc98d1a2673a136283dc7ee" kindref="member">get_ldnumber</ref><sp/>(<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Returns<sp/>logical<sp/>drive<sp/>number<sp/>(-1:invalid<sp/>drive)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2115"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>**<sp/>path<sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>pointer<sp/>to<sp/>the<sp/>path<sp/>name<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2116"><highlight class="normal">)</highlight></codeline>
<codeline lineno="2117"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2118"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref><sp/>*tp,<sp/>*tt;</highlight></codeline>
<codeline lineno="2119"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>i;</highlight></codeline>
<codeline lineno="2120"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>vol<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="2121"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_STR_VOLUME_ID<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Find<sp/>string<sp/>drive<sp/>id<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2122"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>str[]<sp/>=<sp/>{<ref refid="group___f_f_c_o_n_f_i_g_1ga75c97afb8b06935364e42e3ec3fdc6c4" kindref="member">_VOLUME_STRS</ref>};</highlight></codeline>
<codeline lineno="2123"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*sp;</highlight></codeline>
<codeline lineno="2124"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>c;</highlight></codeline>
<codeline lineno="2125"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref><sp/>tc;</highlight></codeline>
<codeline lineno="2126"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2127"><highlight class="normal"></highlight></codeline>
<codeline lineno="2128"><highlight class="normal"></highlight></codeline>
<codeline lineno="2129"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(*path)<sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>the<sp/>pointer<sp/>is<sp/>not<sp/>a<sp/>null<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(tt<sp/>=<sp/>*path;<sp/>(<ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref>)*tt<sp/>&gt;=<sp/>(<ref refid="group___f_f_c_o_n_f_i_g_1gae471cce284bf1888f9e991f5a811fc11" kindref="member">_USE_LFN</ref><sp/>?<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal"><sp/>:<sp/></highlight><highlight class="charliteral">&apos;!&apos;</highlight><highlight class="normal">)<sp/>&amp;&amp;<sp/>*tt<sp/>!=<sp/></highlight><highlight class="charliteral">&apos;:&apos;</highlight><highlight class="normal">;<sp/>tt++)<sp/>;<sp/></highlight><highlight class="comment">/*<sp/>Find<sp/>&apos;:&apos;<sp/>in<sp/>the<sp/>path<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(*tt<sp/>==<sp/></highlight><highlight class="charliteral">&apos;:&apos;</highlight><highlight class="normal">)<sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>a<sp/>&apos;:&apos;<sp/>is<sp/>exist<sp/>in<sp/>the<sp/>path<sp/>name<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tp<sp/>=<sp/>*path;</highlight></codeline>
<codeline lineno="2133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/>*tp++<sp/>-<sp/></highlight><highlight class="charliteral">&apos;0&apos;</highlight><highlight class="normal">;<sp/></highlight></codeline>
<codeline lineno="2134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>&lt;<sp/>10<sp/>&amp;&amp;<sp/>tp<sp/>==<sp/>tt)<sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Is<sp/>there<sp/>a<sp/>numeric<sp/>drive<sp/>id?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>&lt;<sp/><ref refid="group___f_f_c_o_n_f_i_g_1ga366da9a40c8ceb3103a6b72ca02b9969" kindref="member">_VOLUMES</ref>)<sp/>{<sp/></highlight><highlight class="comment">/*<sp/>If<sp/>a<sp/>drive<sp/>id<sp/>is<sp/>found,<sp/>get<sp/>the<sp/>value<sp/>and<sp/>strip<sp/>it<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vol<sp/>=<sp/>(int)i;</highlight></codeline>
<codeline lineno="2137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*path<sp/>=<sp/>++tt;</highlight></codeline>
<codeline lineno="2138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2140"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_STR_VOLUME_ID</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="comment">/*<sp/>No<sp/>numeric<sp/>drive<sp/>number,<sp/>find<sp/>string<sp/>drive<sp/>id<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/>0;<sp/>tt++;</highlight></codeline>
<codeline lineno="2143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sp<sp/>=<sp/>str[i];<sp/>tp<sp/>=<sp/>*path;</highlight></codeline>
<codeline lineno="2145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Compare<sp/>a<sp/>string<sp/>drive<sp/>id<sp/>with<sp/>path<sp/>name<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>=<sp/>*sp++;<sp/>tc<sp/>=<sp/>*tp++;</highlight></codeline>
<codeline lineno="2147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1a4a9d454724926bd51a3aed589a97f08b" kindref="member">IsLower</ref>(tc))<sp/>tc<sp/>-=<sp/>0x20;</highlight></codeline>
<codeline lineno="2148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(c<sp/>&amp;&amp;<sp/>(<ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>)c<sp/>==<sp/>tc);</highlight></codeline>
<codeline lineno="2149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((c<sp/>||<sp/>tp<sp/>!=<sp/>tt)<sp/>&amp;&amp;<sp/>++i<sp/>&lt;<sp/><ref refid="group___f_f_c_o_n_f_i_g_1ga366da9a40c8ceb3103a6b72ca02b9969" kindref="member">_VOLUMES</ref>);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Repeat<sp/>for<sp/>each<sp/>id<sp/>until<sp/>pattern<sp/>match<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>&lt;<sp/><ref refid="group___f_f_c_o_n_f_i_g_1ga366da9a40c8ceb3103a6b72ca02b9969" kindref="member">_VOLUMES</ref>)<sp/>{<sp/></highlight><highlight class="comment">/*<sp/>If<sp/>a<sp/>drive<sp/>id<sp/>is<sp/>found,<sp/>get<sp/>the<sp/>value<sp/>and<sp/>strip<sp/>it<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vol<sp/>=<sp/>(int)i;</highlight></codeline>
<codeline lineno="2152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*path<sp/>=<sp/>tt;</highlight></codeline>
<codeline lineno="2153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2155"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>vol;</highlight></codeline>
<codeline lineno="2157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2158"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_RPATH<sp/>&amp;&amp;<sp/>_VOLUMES<sp/>&gt;=<sp/>2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vol<sp/>=<sp/>CurrVol;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Current<sp/>drive<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2160"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vol<sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Drive<sp/>0<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2162"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2163"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2164"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>vol;</highlight></codeline>
<codeline lineno="2165"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2166"><highlight class="normal"></highlight></codeline>
<codeline lineno="2167"><highlight class="normal"></highlight></codeline>
<codeline lineno="2168"><highlight class="normal"></highlight></codeline>
<codeline lineno="2169"><highlight class="normal"></highlight></codeline>
<codeline lineno="2170"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2171"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Load<sp/>a<sp/>sector<sp/>and<sp/>check<sp/>if<sp/>it<sp/>is<sp/>an<sp/>FAT<sp/>boot<sp/>sector<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2172"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2173"><highlight class="normal"></highlight></codeline>
<codeline lineno="2174"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2175" refid="ff_8c_1a55626c76a1556af5dc5345e2c0841a65" refkind="member"><highlight class="normal"><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/><ref refid="ff_8c_1a55626c76a1556af5dc5345e2c0841a65" kindref="member">check_fs</ref><sp/>(<sp/></highlight><highlight class="comment">/*<sp/>0:Valid<sp/>FAT-BS,<sp/>1:Valid<sp/>BS<sp/>but<sp/>not<sp/>FAT,<sp/>2:Not<sp/>a<sp/>BS,<sp/>3:Disk<sp/>error<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2176"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref>*<sp/>fs,<sp/><sp/></highlight><highlight class="comment">/*<sp/>File<sp/>system<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2177"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>sect<sp/><sp/></highlight><highlight class="comment">/*<sp/>Sector#<sp/>(lba)<sp/>to<sp/>check<sp/>if<sp/>it<sp/>is<sp/>an<sp/>FAT<sp/>boot<sp/>record<sp/>or<sp/>not<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2178"><highlight class="normal">)</highlight></codeline>
<codeline lineno="2179"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2180"><highlight class="normal"><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" kindref="member">wflag</ref><sp/>=<sp/>0;<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" kindref="member">winsect</ref><sp/>=<sp/>0xFFFFFFFF;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Invaidate<sp/>window<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2181"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" kindref="member">move_window</ref>(fs,<sp/>sect)<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Load<sp/>boot<sp/>record<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>3;</highlight></codeline>
<codeline lineno="2183"><highlight class="normal"></highlight></codeline>
<codeline lineno="2184"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" kindref="member">LD_WORD</ref>(&amp;fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>[<ref refid="ff_8c_1a74b810b3f3583c1eb54bd4305c0f261a" kindref="member">BS_55AA</ref>])<sp/>!=<sp/>0xAA55)<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>boot<sp/>record<sp/>signature<sp/>(always<sp/>placed<sp/>at<sp/>offset<sp/>510<sp/>even<sp/>if<sp/>the<sp/>sector<sp/>size<sp/>is<sp/>&gt;512)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>2;</highlight></codeline>
<codeline lineno="2186"><highlight class="normal"></highlight></codeline>
<codeline lineno="2187"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((<ref refid="ff_8h_1a4690304ddc975516f7dc02575c96e34e" kindref="member">LD_DWORD</ref>(&amp;fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>[<ref refid="ff_8c_1a2264848692d36c1b2499c9b6a10acf75" kindref="member">BS_FilSysType</ref>])<sp/>&amp;<sp/>0xFFFFFF)<sp/>==<sp/>0x544146)<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>&quot;FAT&quot;<sp/>string<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="2189"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((<ref refid="ff_8h_1a4690304ddc975516f7dc02575c96e34e" kindref="member">LD_DWORD</ref>(&amp;fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>[<ref refid="ff_8c_1a8d8786452966cd0ce579f2575a54a348" kindref="member">BS_FilSysType32</ref>])<sp/>&amp;<sp/>0xFFFFFF)<sp/>==<sp/>0x544146)<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>&quot;FAT&quot;<sp/>string<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="2191"><highlight class="normal"></highlight></codeline>
<codeline lineno="2192"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;</highlight></codeline>
<codeline lineno="2193"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2194"><highlight class="normal"></highlight></codeline>
<codeline lineno="2195"><highlight class="normal"></highlight></codeline>
<codeline lineno="2196"><highlight class="normal"></highlight></codeline>
<codeline lineno="2197"><highlight class="normal"></highlight></codeline>
<codeline lineno="2198"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2199"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Find<sp/>logical<sp/>drive<sp/>and<sp/>check<sp/>if<sp/>the<sp/>volume<sp/>is<sp/>mounted<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2200"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2201"><highlight class="normal"></highlight></codeline>
<codeline lineno="2202"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2203" refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" kindref="member">find_volume</ref><sp/>(<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FR_OK(0):<sp/>successful,<sp/>!=0:<sp/>any<sp/>error<sp/>occurred<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2204"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref>**<sp/>rfs,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>pointer<sp/>to<sp/>the<sp/>found<sp/>file<sp/>system<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2205"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>**<sp/>path,<sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>pointer<sp/>to<sp/>the<sp/>path<sp/>name<sp/>(drive<sp/>number)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2206"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>wmode<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>!=0:<sp/>Check<sp/>write<sp/>protection<sp/>for<sp/>write<sp/>access<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2207"><highlight class="normal">)</highlight></codeline>
<codeline lineno="2208"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2209"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>fmt,<sp/>*pt;</highlight></codeline>
<codeline lineno="2210"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>vol;</highlight></codeline>
<codeline lineno="2211"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="diskio_8h_1adba6790898ce4029c20a34b898ce73c1" kindref="member">DSTATUS</ref><sp/>stat;</highlight></codeline>
<codeline lineno="2212"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>bsect,<sp/>fasize,<sp/>tsect,<sp/>sysect,<sp/>nclst,<sp/>szbfat,<sp/>br[4];</highlight></codeline>
<codeline lineno="2213"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a197942eefa7db30960ae396d68339b97" kindref="member">WORD</ref><sp/>nrsv;</highlight></codeline>
<codeline lineno="2214"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref><sp/>*fs;</highlight></codeline>
<codeline lineno="2215"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>i;</highlight></codeline>
<codeline lineno="2216"><highlight class="normal"></highlight></codeline>
<codeline lineno="2217"><highlight class="normal"></highlight></codeline>
<codeline lineno="2218"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>logical<sp/>drive<sp/>number<sp/>from<sp/>the<sp/>path<sp/>name<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2219"><highlight class="normal"><sp/><sp/><sp/><sp/>*rfs<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2220"><highlight class="normal"><sp/><sp/><sp/><sp/>vol<sp/>=<sp/><ref refid="ff_8c_1a88ad7e4b1bc98d1a2673a136283dc7ee" kindref="member">get_ldnumber</ref>(path);</highlight></codeline>
<codeline lineno="2221"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(vol<sp/>&lt;<sp/>0)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca487844af77de15f6932a3b41ef3a2d65" kindref="member">FR_INVALID_DRIVE</ref>;</highlight></codeline>
<codeline lineno="2222"><highlight class="normal"></highlight></codeline>
<codeline lineno="2223"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>if<sp/>the<sp/>file<sp/>system<sp/>object<sp/>is<sp/>valid<sp/>or<sp/>not<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2224"><highlight class="normal"><sp/><sp/><sp/><sp/>fs<sp/>=<sp/>FatFs[vol];<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>pointer<sp/>to<sp/>the<sp/>file<sp/>system<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2225"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!fs)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cafc56605c68aaffab4a428339a8bd600d" kindref="member">FR_NOT_ENABLED</ref>;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Is<sp/>the<sp/>file<sp/>system<sp/>object<sp/>available?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2226"><highlight class="normal"></highlight></codeline>
<codeline lineno="2227"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a458e336ac53f8249ed02d844469b7076" kindref="member">ENTER_FF</ref>(fs);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Lock<sp/>the<sp/>volume<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2228"><highlight class="normal"><sp/><sp/><sp/><sp/>*rfs<sp/>=<sp/>fs;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Return<sp/>pointer<sp/>to<sp/>the<sp/>file<sp/>system<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2229"><highlight class="normal"></highlight></codeline>
<codeline lineno="2230"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fs-&gt;<ref refid="struct_f_a_t_f_s_1a3630ef0b29c45ef8e0c1de639efab754" kindref="member">fs_type</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>the<sp/>volume<sp/>has<sp/>been<sp/>mounted<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stat<sp/>=<sp/><ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga0b8d23a060415e85133803b8fcc6f42a" kindref="member">disk_status</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" kindref="member">drv</ref>);</highlight></codeline>
<codeline lineno="2232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!(stat<sp/>&amp;<sp/><ref refid="diskio_8h_1abd6503c70d862b979a3f7080a59e9acd" kindref="member">STA_NOINIT</ref>))<sp/>{<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>and<sp/>the<sp/>physical<sp/>drive<sp/>is<sp/>kept<sp/>initialized<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="group___f_f_c_o_n_f_i_g_1gafb8d35370cfe0c23832ac2d82e854ec6" kindref="member">_FS_READONLY</ref><sp/>&amp;&amp;<sp/>wmode<sp/>&amp;&amp;<sp/>(stat<sp/>&amp;<sp/><ref refid="diskio_8h_1a9ec6dc5f6620a33fabe388d3a111ca8c" kindref="member">STA_PROTECT</ref>))<sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>write<sp/>protection<sp/>if<sp/>needed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cac3afbb423b1d4497229416812aff383b" kindref="member">FR_WRITE_PROTECTED</ref>;</highlight></codeline>
<codeline lineno="2235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>The<sp/>file<sp/>system<sp/>object<sp/>is<sp/>valid<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2237"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2238"><highlight class="normal"></highlight></codeline>
<codeline lineno="2239"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>The<sp/>file<sp/>system<sp/>object<sp/>is<sp/>not<sp/>valid.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2240"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Following<sp/>code<sp/>attempts<sp/>to<sp/>mount<sp/>the<sp/>volume.<sp/>(analyze<sp/>BPB<sp/>and<sp/>initialize<sp/>the<sp/>fs<sp/>object)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2241"><highlight class="normal"></highlight></codeline>
<codeline lineno="2242"><highlight class="normal"><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a3630ef0b29c45ef8e0c1de639efab754" kindref="member">fs_type</ref><sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Clear<sp/>the<sp/>file<sp/>system<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2243"><highlight class="normal"><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" kindref="member">drv</ref><sp/>=<sp/><ref refid="ff_8h_1a6577ed2f95527745bf4d27c53488b9a7" kindref="member">LD2PD</ref>(vol);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Bind<sp/>the<sp/>logical<sp/>drive<sp/>and<sp/>a<sp/>physical<sp/>drive<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2244"><highlight class="normal"><sp/><sp/><sp/><sp/>stat<sp/>=<sp/><ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga45e4ba27a706ed2421edd501406a6496" kindref="member">disk_initialize</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" kindref="member">drv</ref>);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Initialize<sp/>the<sp/>physical<sp/>drive<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2245"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(stat<sp/>&amp;<sp/><ref refid="diskio_8h_1abd6503c70d862b979a3f7080a59e9acd" kindref="member">STA_NOINIT</ref>)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>if<sp/>the<sp/>initialization<sp/>succeeded<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cac9894bed3e8632ede8d2712235fa8e45" kindref="member">FR_NOT_READY</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Failed<sp/>to<sp/>initialize<sp/>due<sp/>to<sp/>no<sp/>medium<sp/>or<sp/>hard<sp/>error<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2247"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="group___f_f_c_o_n_f_i_g_1gafb8d35370cfe0c23832ac2d82e854ec6" kindref="member">_FS_READONLY</ref><sp/>&amp;&amp;<sp/>wmode<sp/>&amp;&amp;<sp/>(stat<sp/>&amp;<sp/><ref refid="diskio_8h_1a9ec6dc5f6620a33fabe388d3a111ca8c" kindref="member">STA_PROTECT</ref>))<sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>disk<sp/>write<sp/>protection<sp/>if<sp/>needed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cac3afbb423b1d4497229416812aff383b" kindref="member">FR_WRITE_PROTECTED</ref>;</highlight></codeline>
<codeline lineno="2249"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_MAX_SS<sp/>!=<sp/>_MIN_SS<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>sector<sp/>size<sp/>(multiple<sp/>sector<sp/>size<sp/>cfg<sp/>only)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2250"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga3051f51f1cccb103d145804d5d91b04d" kindref="member">disk_ioctl</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" kindref="member">drv</ref>,<sp/><ref refid="diskio_8h_1ac73b5cf2135cbd459d109b96c9aa346a" kindref="member">GET_SECTOR_SIZE</ref>,<sp/>&amp;<ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs))<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref></highlight></codeline>
<codeline lineno="2251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>||<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs)<sp/>&lt;<sp/><ref refid="group___f_f_c_o_n_f_i_g_1gad03aa6d0e294709ae15898ee2c14dc3a" kindref="member">_MIN_SS</ref><sp/>||<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs)<sp/>&gt;<sp/><ref refid="group___f_f_c_o_n_f_i_g_1gac271b697378912f17132cb9c7d0de024" kindref="member">_MAX_SS</ref>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>;</highlight></codeline>
<codeline lineno="2252"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2253"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Find<sp/>an<sp/>FAT<sp/>partition<sp/>on<sp/>the<sp/>drive.<sp/>Supports<sp/>only<sp/>generic<sp/>partitioning,<sp/>FDISK<sp/>and<sp/>SFD.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2254"><highlight class="normal"><sp/><sp/><sp/><sp/>bsect<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2255"><highlight class="normal"><sp/><sp/><sp/><sp/>fmt<sp/>=<sp/><ref refid="ff_8c_1a55626c76a1556af5dc5345e2c0841a65" kindref="member">check_fs</ref>(fs,<sp/>bsect);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Load<sp/>sector<sp/>0<sp/>and<sp/>check<sp/>if<sp/>it<sp/>is<sp/>an<sp/>FAT<sp/>boot<sp/>sector<sp/>as<sp/>SFD<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2256"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fmt<sp/>==<sp/>1<sp/>||<sp/>(!fmt<sp/>&amp;&amp;<sp/>(<ref refid="ff_8h_1aadc4a9aefaf2588bdd7565549f5d91e7" kindref="member">LD2PT</ref>(vol))))<sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Not<sp/>an<sp/>FAT<sp/>boot<sp/>sector<sp/>or<sp/>forced<sp/>partition<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>4;<sp/>i++)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>partition<sp/>offset<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pt<sp/>=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref><sp/>+<sp/><ref refid="ff_8c_1ac3f187bf0ba891551f594af6b61f3188" kindref="member">MBR_Table</ref><sp/>+<sp/>i<sp/>*<sp/><ref refid="ff_8c_1af133060c47366e7e557d4085d931183f" kindref="member">SZ_PTE</ref>;</highlight></codeline>
<codeline lineno="2259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>br[i]<sp/>=<sp/>pt[4]<sp/>?<sp/><ref refid="ff_8h_1a4690304ddc975516f7dc02575c96e34e" kindref="member">LD_DWORD</ref>(&amp;pt[8])<sp/>:<sp/>0;</highlight></codeline>
<codeline lineno="2260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/><ref refid="ff_8h_1aadc4a9aefaf2588bdd7565549f5d91e7" kindref="member">LD2PT</ref>(vol);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Partition<sp/>number:<sp/>0:auto,<sp/>1-4:forced<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i)<sp/>i--;</highlight></codeline>
<codeline lineno="2263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Find<sp/>an<sp/>FAT<sp/>volume<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bsect<sp/>=<sp/>br[i];</highlight></codeline>
<codeline lineno="2265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fmt<sp/>=<sp/>bsect<sp/>?<sp/><ref refid="ff_8c_1a55626c76a1556af5dc5345e2c0841a65" kindref="member">check_fs</ref>(fs,<sp/>bsect)<sp/>:<sp/>2;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>the<sp/>partition<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!<ref refid="ff_8h_1aadc4a9aefaf2588bdd7565549f5d91e7" kindref="member">LD2PT</ref>(vol)<sp/>&amp;&amp;<sp/>fmt<sp/>&amp;&amp;<sp/>++i<sp/>&lt;<sp/>4);</highlight></codeline>
<codeline lineno="2267"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2268"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fmt<sp/>==<sp/>3)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>An<sp/>error<sp/>occured<sp/>in<sp/>the<sp/>disk<sp/>I/O<sp/>layer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2269"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fmt)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca086154b5fee763f28c49fd0e2c1cb463" kindref="member">FR_NO_FILESYSTEM</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>No<sp/>FAT<sp/>volume<sp/>is<sp/>found<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2270"><highlight class="normal"></highlight></codeline>
<codeline lineno="2271"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>An<sp/>FAT<sp/>volume<sp/>is<sp/>found.<sp/>Following<sp/>code<sp/>initializes<sp/>the<sp/>file<sp/>system<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2272"><highlight class="normal"></highlight></codeline>
<codeline lineno="2273"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" kindref="member">LD_WORD</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref><sp/>+<sp/><ref refid="ff_8c_1a8551844b4eb4e15aecd8cc9aa3585fa2" kindref="member">BPB_BytsPerSec</ref>)<sp/>!=<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs))<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>(BPB_BytsPerSec<sp/>must<sp/>be<sp/>equal<sp/>to<sp/>the<sp/>physical<sp/>sector<sp/>size)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca086154b5fee763f28c49fd0e2c1cb463" kindref="member">FR_NO_FILESYSTEM</ref>;</highlight></codeline>
<codeline lineno="2275"><highlight class="normal"></highlight></codeline>
<codeline lineno="2276"><highlight class="normal"><sp/><sp/><sp/><sp/>fasize<sp/>=<sp/><ref refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" kindref="member">LD_WORD</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref><sp/>+<sp/><ref refid="ff_8c_1a60a2f6efeb6a4c7cb2da1e5def6ca43b" kindref="member">BPB_FATSz16</ref>);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>sectors<sp/>per<sp/>FAT<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2277"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!fasize)<sp/>fasize<sp/>=<sp/><ref refid="ff_8h_1a4690304ddc975516f7dc02575c96e34e" kindref="member">LD_DWORD</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref><sp/>+<sp/><ref refid="ff_8c_1a6e6340030dc29e7da2e9f92e472a763d" kindref="member">BPB_FATSz32</ref>);</highlight></codeline>
<codeline lineno="2278"><highlight class="normal"><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1af70a0afd16367837984d6205cbfca308" kindref="member">fsize</ref><sp/>=<sp/>fasize;</highlight></codeline>
<codeline lineno="2279"><highlight class="normal"></highlight></codeline>
<codeline lineno="2280"><highlight class="normal"><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1af18fdbb9dec86b70abc6ee2a1217ac47" kindref="member">n_fats</ref><sp/>=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>[<ref refid="ff_8c_1af44a1e8c89ec5502595f23496d24cbf1" kindref="member">BPB_NumFATs</ref>];<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>FAT<sp/>copies<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2281"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fs-&gt;<ref refid="struct_f_a_t_f_s_1af18fdbb9dec86b70abc6ee2a1217ac47" kindref="member">n_fats</ref><sp/>!=<sp/>1<sp/>&amp;&amp;<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1af18fdbb9dec86b70abc6ee2a1217ac47" kindref="member">n_fats</ref><sp/>!=<sp/>2)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>(Must<sp/>be<sp/>1<sp/>or<sp/>2)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca086154b5fee763f28c49fd0e2c1cb463" kindref="member">FR_NO_FILESYSTEM</ref>;</highlight></codeline>
<codeline lineno="2283"><highlight class="normal"><sp/><sp/><sp/><sp/>fasize<sp/>*=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1af18fdbb9dec86b70abc6ee2a1217ac47" kindref="member">n_fats</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>sectors<sp/>for<sp/>FAT<sp/>area<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2284"><highlight class="normal"></highlight></codeline>
<codeline lineno="2285"><highlight class="normal"><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" kindref="member">csize</ref><sp/>=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>[<ref refid="ff_8c_1aab78e41c617a14b9540c0563d6b957fa" kindref="member">BPB_SecPerClus</ref>];<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>sectors<sp/>per<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2286"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!fs-&gt;<ref refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" kindref="member">csize</ref><sp/>||<sp/>(fs-&gt;<ref refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" kindref="member">csize</ref><sp/>&amp;<sp/>(fs-&gt;<ref refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" kindref="member">csize</ref><sp/>-<sp/>1)))<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>(Must<sp/>be<sp/>power<sp/>of<sp/>2)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca086154b5fee763f28c49fd0e2c1cb463" kindref="member">FR_NO_FILESYSTEM</ref>;</highlight></codeline>
<codeline lineno="2288"><highlight class="normal"></highlight></codeline>
<codeline lineno="2289"><highlight class="normal"><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a22e74fc44cd5274ba7c3b18d5e357697" kindref="member">n_rootdir</ref><sp/>=<sp/><ref refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" kindref="member">LD_WORD</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref><sp/>+<sp/><ref refid="ff_8c_1aaa667f14c87c45dc128f2ab208e92f98" kindref="member">BPB_RootEntCnt</ref>);<sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>root<sp/>directory<sp/>entries<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2290"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fs-&gt;<ref refid="struct_f_a_t_f_s_1a22e74fc44cd5274ba7c3b18d5e357697" kindref="member">n_rootdir</ref><sp/>%<sp/>(<ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs)<sp/>/<sp/><ref refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" kindref="member">SZ_DIRE</ref>))<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>(Must<sp/>be<sp/>sector<sp/>aligned)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca086154b5fee763f28c49fd0e2c1cb463" kindref="member">FR_NO_FILESYSTEM</ref>;</highlight></codeline>
<codeline lineno="2292"><highlight class="normal"></highlight></codeline>
<codeline lineno="2293"><highlight class="normal"><sp/><sp/><sp/><sp/>tsect<sp/>=<sp/><ref refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" kindref="member">LD_WORD</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref><sp/>+<sp/><ref refid="ff_8c_1a4eb540eecde0f2df26fa8c7969341d68" kindref="member">BPB_TotSec16</ref>);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>sectors<sp/>on<sp/>the<sp/>volume<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2294"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!tsect)<sp/>tsect<sp/>=<sp/><ref refid="ff_8h_1a4690304ddc975516f7dc02575c96e34e" kindref="member">LD_DWORD</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref><sp/>+<sp/><ref refid="ff_8c_1a7723a9f0da553e8879d60909d85ccb7b" kindref="member">BPB_TotSec32</ref>);</highlight></codeline>
<codeline lineno="2295"><highlight class="normal"></highlight></codeline>
<codeline lineno="2296"><highlight class="normal"><sp/><sp/><sp/><sp/>nrsv<sp/>=<sp/><ref refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" kindref="member">LD_WORD</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref><sp/>+<sp/><ref refid="ff_8c_1ab3ec444c8457c9bc98aa07e846f5c1b7" kindref="member">BPB_RsvdSecCnt</ref>);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>reserved<sp/>sectors<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2297"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!nrsv)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca086154b5fee763f28c49fd0e2c1cb463" kindref="member">FR_NO_FILESYSTEM</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>(Must<sp/>not<sp/>be<sp/>0)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2298"><highlight class="normal"></highlight></codeline>
<codeline lineno="2299"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Determine<sp/>the<sp/>FAT<sp/>sub<sp/>type<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2300"><highlight class="normal"><sp/><sp/><sp/><sp/>sysect<sp/>=<sp/>nrsv<sp/>+<sp/>fasize<sp/>+<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a22e74fc44cd5274ba7c3b18d5e357697" kindref="member">n_rootdir</ref><sp/>/<sp/>(<ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs)<sp/>/<sp/><ref refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" kindref="member">SZ_DIRE</ref>);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>RSV<sp/>+<sp/>FAT<sp/>+<sp/>DIR<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2301"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(tsect<sp/>&lt;<sp/>sysect)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca086154b5fee763f28c49fd0e2c1cb463" kindref="member">FR_NO_FILESYSTEM</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>(Invalid<sp/>volume<sp/>size)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2302"><highlight class="normal"><sp/><sp/><sp/><sp/>nclst<sp/>=<sp/>(tsect<sp/>-<sp/>sysect)<sp/>/<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" kindref="member">csize</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>clusters<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2303"><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(!nclst)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca086154b5fee763f28c49fd0e2c1cb463" kindref="member">FR_NO_FILESYSTEM</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>(Invalid<sp/>volume<sp/>size)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2304"><highlight class="normal"><sp/><sp/><sp/><sp/>fmt<sp/>=<sp/><ref refid="ff_8h_1aab755aa1b4f81f4aabee4a5d4738cfb0" kindref="member">FS_FAT12</ref>;</highlight></codeline>
<codeline lineno="2305"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nclst<sp/>&gt;=<sp/><ref refid="ff_8c_1aeec02d5ae07ede32b7d74155bf0fda15" kindref="member">MIN_FAT16</ref>)<sp/>fmt<sp/>=<sp/><ref refid="ff_8h_1a7ef90a36d99edfc0138a2155a17a79b9" kindref="member">FS_FAT16</ref>;</highlight></codeline>
<codeline lineno="2306"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nclst<sp/>&gt;=<sp/><ref refid="ff_8c_1a483625319f3e3bd5ac6502b46c375aed" kindref="member">MIN_FAT32</ref>)<sp/>fmt<sp/>=<sp/><ref refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" kindref="member">FS_FAT32</ref>;</highlight></codeline>
<codeline lineno="2307"><highlight class="normal"></highlight></codeline>
<codeline lineno="2308"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Boundaries<sp/>and<sp/>Limits<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2309"><highlight class="normal"><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" kindref="member">n_fatent</ref><sp/>=<sp/>nclst<sp/>+<sp/>2;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>FAT<sp/>entries<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2310"><highlight class="normal"><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a3e3472628262823af495681702709e8e" kindref="member">volbase</ref><sp/>=<sp/>bsect;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Volume<sp/>start<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2311"><highlight class="normal"><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a74e60540a346de6eb9f0c13d6203efa1" kindref="member">fatbase</ref><sp/>=<sp/>bsect<sp/>+<sp/>nrsv;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FAT<sp/>start<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2312"><highlight class="normal"><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a112ba7d33529e5c9fda3b950fff01180" kindref="member">database</ref><sp/>=<sp/>bsect<sp/>+<sp/>sysect;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Data<sp/>start<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2313"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fmt<sp/>==<sp/><ref refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" kindref="member">FS_FAT32</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fs-&gt;<ref refid="struct_f_a_t_f_s_1a22e74fc44cd5274ba7c3b18d5e357697" kindref="member">n_rootdir</ref>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca086154b5fee763f28c49fd0e2c1cb463" kindref="member">FR_NO_FILESYSTEM</ref>;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>(BPB_RootEntCnt<sp/>must<sp/>be<sp/>0)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1aebfa6556d8f94e951a8b2c1eb740e9a1" kindref="member">dirbase</ref><sp/>=<sp/><ref refid="ff_8h_1a4690304ddc975516f7dc02575c96e34e" kindref="member">LD_DWORD</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref><sp/>+<sp/><ref refid="ff_8c_1a7add0104bd20083d6940d616faecd45a" kindref="member">BPB_RootClus</ref>);<sp/></highlight><highlight class="comment">/*<sp/>Root<sp/>directory<sp/>start<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>szbfat<sp/>=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" kindref="member">n_fatent</ref><sp/>*<sp/>4;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>(Needed<sp/>FAT<sp/>size)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2317"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!fs-&gt;<ref refid="struct_f_a_t_f_s_1a22e74fc44cd5274ba7c3b18d5e357697" kindref="member">n_rootdir</ref>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca086154b5fee763f28c49fd0e2c1cb463" kindref="member">FR_NO_FILESYSTEM</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>(BPB_RootEntCnt<sp/>must<sp/>not<sp/>be<sp/>0)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1aebfa6556d8f94e951a8b2c1eb740e9a1" kindref="member">dirbase</ref><sp/>=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a74e60540a346de6eb9f0c13d6203efa1" kindref="member">fatbase</ref><sp/>+<sp/>fasize;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Root<sp/>directory<sp/>start<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>szbfat<sp/>=<sp/>(fmt<sp/>==<sp/><ref refid="ff_8h_1a7ef90a36d99edfc0138a2155a17a79b9" kindref="member">FS_FAT16</ref>)<sp/>?<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>(Needed<sp/>FAT<sp/>size)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" kindref="member">n_fatent</ref><sp/>*<sp/>2<sp/>:<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" kindref="member">n_fatent</ref><sp/>*<sp/>3<sp/>/<sp/>2<sp/>+<sp/>(fs-&gt;<ref refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" kindref="member">n_fatent</ref><sp/>&amp;<sp/>1);</highlight></codeline>
<codeline lineno="2322"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2323"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fs-&gt;<ref refid="struct_f_a_t_f_s_1af70a0afd16367837984d6205cbfca308" kindref="member">fsize</ref><sp/>&lt;<sp/>(szbfat<sp/>+<sp/>(<ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs)<sp/>-<sp/>1))<sp/>/<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs))<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>(BPB_FATSz<sp/>must<sp/>not<sp/>be<sp/>less<sp/>than<sp/>the<sp/>size<sp/>needed)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca086154b5fee763f28c49fd0e2c1cb463" kindref="member">FR_NO_FILESYSTEM</ref>;</highlight></codeline>
<codeline lineno="2325"><highlight class="normal"></highlight></codeline>
<codeline lineno="2326"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2327"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Initialize<sp/>cluster<sp/>allocation<sp/>information<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2328"><highlight class="normal"><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a10cd8b80b3b6474bf0d6432c8fb9d2d2" kindref="member">last_clust</ref><sp/>=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a509defa217cfb2eb777ed3c74c4ef426" kindref="member">free_clust</ref><sp/>=<sp/>0xFFFFFFFF;</highlight></codeline>
<codeline lineno="2329"><highlight class="normal"></highlight></codeline>
<codeline lineno="2330"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>fsinfo<sp/>if<sp/>available<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2331"><highlight class="normal"><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a66c4d8e68262d5542852e2aed6ce69b4" kindref="member">fsi_flag</ref><sp/>=<sp/>0x80;</highlight></codeline>
<codeline lineno="2332"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>(_FS_NOFSINFO<sp/>&amp;<sp/>3)<sp/>!=<sp/>3</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2333"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fmt<sp/>==<sp/><ref refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" kindref="member">FS_FAT32</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Enable<sp/>FSINFO<sp/>only<sp/>if<sp/>FAT32<sp/>and<sp/>BPB_FSInfo<sp/>==<sp/>1<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/><ref refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" kindref="member">LD_WORD</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref><sp/>+<sp/><ref refid="ff_8c_1a51c45669282b9ce9da5152231df9f3ac" kindref="member">BPB_FSInfo</ref>)<sp/>==<sp/>1</highlight></codeline>
<codeline lineno="2335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/><ref refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" kindref="member">move_window</ref>(fs,<sp/>bsect<sp/>+<sp/>1)<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)</highlight></codeline>
<codeline lineno="2336"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a66c4d8e68262d5542852e2aed6ce69b4" kindref="member">fsi_flag</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" kindref="member">LD_WORD</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref><sp/>+<sp/><ref refid="ff_8c_1a74b810b3f3583c1eb54bd4305c0f261a" kindref="member">BS_55AA</ref>)<sp/>==<sp/>0xAA55<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Load<sp/>FSINFO<sp/>data<sp/>if<sp/>available<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/><ref refid="ff_8h_1a4690304ddc975516f7dc02575c96e34e" kindref="member">LD_DWORD</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref><sp/>+<sp/><ref refid="ff_8c_1a318e58c1966aba52b90ab98dcb649883" kindref="member">FSI_LeadSig</ref>)<sp/>==<sp/>0x41615252</highlight></codeline>
<codeline lineno="2340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/><ref refid="ff_8h_1a4690304ddc975516f7dc02575c96e34e" kindref="member">LD_DWORD</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref><sp/>+<sp/><ref refid="ff_8c_1a3bac0e6ff5907873030db1d0a7c4ebef" kindref="member">FSI_StrucSig</ref>)<sp/>==<sp/>0x61417272)</highlight></codeline>
<codeline lineno="2341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2342"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>(_FS_NOFSINFO<sp/>&amp;<sp/>1)<sp/>==<sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a509defa217cfb2eb777ed3c74c4ef426" kindref="member">free_clust</ref><sp/>=<sp/><ref refid="ff_8h_1a4690304ddc975516f7dc02575c96e34e" kindref="member">LD_DWORD</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref><sp/>+<sp/><ref refid="ff_8c_1ab711e50459aba01b11c6b46a7cc1410b" kindref="member">FSI_Free_Count</ref>);</highlight></codeline>
<codeline lineno="2344"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2345"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>(_FS_NOFSINFO<sp/>&amp;<sp/>2)<sp/>==<sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a10cd8b80b3b6474bf0d6432c8fb9d2d2" kindref="member">last_clust</ref><sp/>=<sp/><ref refid="ff_8h_1a4690304ddc975516f7dc02575c96e34e" kindref="member">LD_DWORD</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref><sp/>+<sp/><ref refid="ff_8c_1a320700cedf300c9b418edf56e5e6b086" kindref="member">FSI_Nxt_Free</ref>);</highlight></codeline>
<codeline lineno="2347"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2349"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2350"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2351"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2352"><highlight class="normal"><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a3630ef0b29c45ef8e0c1de639efab754" kindref="member">fs_type</ref><sp/>=<sp/>fmt;<sp/><sp/></highlight><highlight class="comment">/*<sp/>FAT<sp/>sub-type<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2353"><highlight class="normal"><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a7b7a6396b2c82ad46c6d8b2bf141a8dd" kindref="member">id</ref><sp/>=<sp/>++<ref refid="ff_8c_1a0b3f41d8c416222e9b1c16e36d66e18b" kindref="member">Fsid</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>File<sp/>system<sp/>mount<sp/>ID<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2354"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_RPATH</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2355"><highlight class="normal"><sp/><sp/><sp/><sp/>fs-&gt;cdir<sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>current<sp/>directory<sp/>to<sp/>root<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2356"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2357"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_LOCK<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Clear<sp/>file<sp/>lock<sp/>semaphores<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2358"><highlight class="normal"><sp/><sp/><sp/><sp/>clear_lock(fs);</highlight></codeline>
<codeline lineno="2359"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2360"><highlight class="normal"></highlight></codeline>
<codeline lineno="2361"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>;</highlight></codeline>
<codeline lineno="2362"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2363"><highlight class="normal"></highlight></codeline>
<codeline lineno="2364"><highlight class="normal"></highlight></codeline>
<codeline lineno="2365"><highlight class="normal"></highlight></codeline>
<codeline lineno="2366"><highlight class="normal"></highlight></codeline>
<codeline lineno="2367"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2368"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Check<sp/>if<sp/>the<sp/>file/directory<sp/>object<sp/>is<sp/>valid<sp/>or<sp/>not<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2369"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2370"><highlight class="normal"></highlight></codeline>
<codeline lineno="2371"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2372" refid="ff_8c_1aa7193f5b86c3996b5312043a0c26da5f" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="ff_8c_1aa7193f5b86c3996b5312043a0c26da5f" kindref="member">validate</ref><sp/>(<sp/><sp/></highlight><highlight class="comment">/*<sp/>FR_OK(0):<sp/>The<sp/>object<sp/>is<sp/>valid,<sp/>!=0:<sp/>Invalid<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2373"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>obj<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>object<sp/>FIL/DIR<sp/>to<sp/>check<sp/>validity<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2374"><highlight class="normal">)</highlight></codeline>
<codeline lineno="2375"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2376"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_i_l" kindref="compound">FIL</ref><sp/>*fil<sp/>=<sp/>(<ref refid="struct_f_i_l" kindref="compound">FIL</ref>*)obj;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Assuming<sp/>offset<sp/>of<sp/>.fs<sp/>and<sp/>.id<sp/>in<sp/>the<sp/>FIL/DIR<sp/>structure<sp/>is<sp/>identical<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2377"><highlight class="normal"></highlight></codeline>
<codeline lineno="2378"><highlight class="normal"></highlight></codeline>
<codeline lineno="2379"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!fil<sp/>||<sp/>!fil-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref><sp/>||<sp/>!fil-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1a3630ef0b29c45ef8e0c1de639efab754" kindref="member">fs_type</ref><sp/>||<sp/>fil-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1a7b7a6396b2c82ad46c6d8b2bf141a8dd" kindref="member">id</ref><sp/>!=<sp/>fil-&gt;<ref refid="struct_f_i_l_1a7b7a6396b2c82ad46c6d8b2bf141a8dd" kindref="member">id</ref><sp/>||<sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga0b8d23a060415e85133803b8fcc6f42a" kindref="member">disk_status</ref>(fil-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" kindref="member">drv</ref>)<sp/>&amp;<sp/><ref refid="diskio_8h_1abd6503c70d862b979a3f7080a59e9acd" kindref="member">STA_NOINIT</ref>))</highlight></codeline>
<codeline lineno="2380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca3dec4eba481cdf5e99d7cd6009e6dcf8" kindref="member">FR_INVALID_OBJECT</ref>;</highlight></codeline>
<codeline lineno="2381"><highlight class="normal"></highlight></codeline>
<codeline lineno="2382"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a458e336ac53f8249ed02d844469b7076" kindref="member">ENTER_FF</ref>(fil-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>);<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Lock<sp/>file<sp/>system<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2383"><highlight class="normal"></highlight></codeline>
<codeline lineno="2384"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>;</highlight></codeline>
<codeline lineno="2385"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2386"><highlight class="normal"></highlight></codeline>
<codeline lineno="2387"><highlight class="normal"></highlight></codeline>
<codeline lineno="2388"><highlight class="normal"></highlight></codeline>
<codeline lineno="2389"><highlight class="normal"></highlight></codeline>
<codeline lineno="2390"><highlight class="normal"></highlight><highlight class="comment">/*--------------------------------------------------------------------------</highlight></codeline>
<codeline lineno="2391"><highlight class="comment"></highlight></codeline>
<codeline lineno="2392"><highlight class="comment"><sp/><sp/><sp/>Public<sp/>Functions</highlight></codeline>
<codeline lineno="2393"><highlight class="comment"></highlight></codeline>
<codeline lineno="2394"><highlight class="comment">---------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2395"><highlight class="normal"></highlight></codeline>
<codeline lineno="2396"><highlight class="normal"></highlight></codeline>
<codeline lineno="2397"><highlight class="normal"></highlight></codeline>
<codeline lineno="2398"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2399"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Mount/Unmount<sp/>a<sp/>Logical<sp/>Drive<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2400"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2401"><highlight class="normal"></highlight></codeline>
<codeline lineno="2402" refid="group__filesystem_1ga16a934c2bbfa2160295810adc49d5509" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="group__filesystem_1ga16a934c2bbfa2160295810adc49d5509" kindref="member">f_mount</ref><sp/>(</highlight></codeline>
<codeline lineno="2403"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref>*<sp/>fs,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>file<sp/>system<sp/>object<sp/>(NULL:unmount)*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2404"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/>path,<sp/><sp/></highlight><highlight class="comment">/*<sp/>Logical<sp/>drive<sp/>number<sp/>to<sp/>be<sp/>mounted/unmounted<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2405"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>opt<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>0:Do<sp/>not<sp/>mount<sp/>(delayed<sp/>mount),<sp/>1:Mount<sp/>immediately<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2406"><highlight class="normal">)</highlight></codeline>
<codeline lineno="2407"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2408"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref><sp/>*cfs;</highlight></codeline>
<codeline lineno="2409"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>vol;</highlight></codeline>
<codeline lineno="2410"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="2411"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref><sp/>*rp<sp/>=<sp/>path;</highlight></codeline>
<codeline lineno="2412"><highlight class="normal"></highlight></codeline>
<codeline lineno="2413"><highlight class="normal"></highlight></codeline>
<codeline lineno="2414"><highlight class="normal"><sp/><sp/><sp/><sp/>vol<sp/>=<sp/><ref refid="ff_8c_1a88ad7e4b1bc98d1a2673a136283dc7ee" kindref="member">get_ldnumber</ref>(&amp;rp);</highlight></codeline>
<codeline lineno="2415"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(vol<sp/>&lt;<sp/>0)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca487844af77de15f6932a3b41ef3a2d65" kindref="member">FR_INVALID_DRIVE</ref>;</highlight></codeline>
<codeline lineno="2416"><highlight class="normal"><sp/><sp/><sp/><sp/>cfs<sp/>=<sp/>FatFs[vol];<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>fs<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2417"><highlight class="normal"></highlight></codeline>
<codeline lineno="2418"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(cfs)<sp/>{</highlight></codeline>
<codeline lineno="2419"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_LOCK</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clear_lock(cfs);</highlight></codeline>
<codeline lineno="2421"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2422"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_REENTRANT<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Discard<sp/>sync<sp/>object<sp/>of<sp/>the<sp/>current<sp/>volume<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="ff_8h_1a9184443f4d0a50b0f9a7fdb241613119" kindref="member">ff_del_syncobj</ref>(cfs-&gt;<ref refid="struct_f_a_t_f_s_1a1c2c369d5858a2d8b60e65431b0b1a85" kindref="member">sobj</ref>))<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>;</highlight></codeline>
<codeline lineno="2424"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfs-&gt;<ref refid="struct_f_a_t_f_s_1a3630ef0b29c45ef8e0c1de639efab754" kindref="member">fs_type</ref><sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Clear<sp/>old<sp/>fs<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2426"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2427"><highlight class="normal"></highlight></codeline>
<codeline lineno="2428"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fs)<sp/>{</highlight></codeline>
<codeline lineno="2429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a3630ef0b29c45ef8e0c1de639efab754" kindref="member">fs_type</ref><sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Clear<sp/>new<sp/>fs<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2430"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_REENTRANT<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>sync<sp/>object<sp/>for<sp/>the<sp/>new<sp/>volume<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="ff_8h_1a2593b7acfe680686184f9ecb1be50323" kindref="member">ff_cre_syncobj</ref>((<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)vol,<sp/>&amp;fs-&gt;<ref refid="struct_f_a_t_f_s_1a1c2c369d5858a2d8b60e65431b0b1a85" kindref="member">sobj</ref>))<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>;</highlight></codeline>
<codeline lineno="2432"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2433"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2434"><highlight class="normal"><sp/><sp/><sp/><sp/>FatFs[vol]<sp/>=<sp/>fs;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Register<sp/>new<sp/>fs<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2435"><highlight class="normal"></highlight></codeline>
<codeline lineno="2436"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!fs<sp/>||<sp/>opt<sp/>!=<sp/>1)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Do<sp/>not<sp/>mount<sp/>now,<sp/>it<sp/>will<sp/>be<sp/>mounted<sp/>later<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2437"><highlight class="normal"></highlight></codeline>
<codeline lineno="2438"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" kindref="member">find_volume</ref>(&amp;fs,<sp/>&amp;path,<sp/>0);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Force<sp/>mounted<sp/>the<sp/>volume<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2439"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(fs,<sp/>res);</highlight></codeline>
<codeline lineno="2440"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2441"><highlight class="normal"></highlight></codeline>
<codeline lineno="2442"><highlight class="normal"></highlight></codeline>
<codeline lineno="2443"><highlight class="normal"></highlight></codeline>
<codeline lineno="2444"><highlight class="normal"></highlight></codeline>
<codeline lineno="2445"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2446"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Open<sp/>or<sp/>Create<sp/>a<sp/>File<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2447"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2448"><highlight class="normal"></highlight></codeline>
<codeline lineno="2449" refid="group__filesystem_1gaefdef7126128d99d0b3bd82c28e54d80" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="group__filesystem_1gaefdef7126128d99d0b3bd82c28e54d80" kindref="member">f_open</ref><sp/>(</highlight></codeline>
<codeline lineno="2450"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_i_l" kindref="compound">FIL</ref>*<sp/>fp,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>blank<sp/>file<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2451"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/>path,<sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>file<sp/>name<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2452"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>mode<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Access<sp/>mode<sp/>and<sp/>file<sp/>open<sp/>mode<sp/>flags<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2453"><highlight class="normal">)</highlight></codeline>
<codeline lineno="2454"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2455"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="2456"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref><sp/>dj;</highlight></codeline>
<codeline lineno="2457"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>*dir;</highlight></codeline>
<codeline lineno="2458"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7cc27142421bd12be623072288599791" kindref="member">DEFINE_NAMEBUF</ref>;</highlight></codeline>
<codeline lineno="2459"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2460"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>dw,<sp/>cl;</highlight></codeline>
<codeline lineno="2461"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2462"><highlight class="normal"></highlight></codeline>
<codeline lineno="2463"><highlight class="normal"></highlight></codeline>
<codeline lineno="2464"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!fp)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca3dec4eba481cdf5e99d7cd6009e6dcf8" kindref="member">FR_INVALID_OBJECT</ref>;</highlight></codeline>
<codeline lineno="2465"><highlight class="normal"><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref><sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Clear<sp/>file<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2466"><highlight class="normal"></highlight></codeline>
<codeline lineno="2467"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>logical<sp/>drive<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2468"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2469"><highlight class="normal"><sp/><sp/><sp/><sp/>mode<sp/>&amp;=<sp/><ref refid="ff_8h_1a1f4f3530ff03abbd979b072536e72290" kindref="member">FA_READ</ref><sp/>|<sp/><ref refid="ff_8h_1afa366963220c89b882c0361794020c14" kindref="member">FA_WRITE</ref><sp/>|<sp/><ref refid="ff_8h_1afba4546b131dea4b24727fa20a80e29f" kindref="member">FA_CREATE_ALWAYS</ref><sp/>|<sp/><ref refid="ff_8h_1a17b01553029920ac0468912b4bcb16c7" kindref="member">FA_OPEN_ALWAYS</ref><sp/>|<sp/><ref refid="ff_8h_1a417bb1babd1785fd181a806b5613eba3" kindref="member">FA_CREATE_NEW</ref>;</highlight></codeline>
<codeline lineno="2470"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" kindref="member">find_volume</ref>(&amp;dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>&amp;path,<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)(mode<sp/>&amp;<sp/>~<ref refid="ff_8h_1a1f4f3530ff03abbd979b072536e72290" kindref="member">FA_READ</ref>));</highlight></codeline>
<codeline lineno="2471"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2472"><highlight class="normal"><sp/><sp/><sp/><sp/>mode<sp/>&amp;=<sp/><ref refid="ff_8h_1a1f4f3530ff03abbd979b072536e72290" kindref="member">FA_READ</ref>;</highlight></codeline>
<codeline lineno="2473"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" kindref="member">find_volume</ref>(&amp;dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>&amp;path,<sp/>0);</highlight></codeline>
<codeline lineno="2474"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2475"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a966fe5792671b39db1ccf655a8c1af8d" kindref="member">INIT_BUF</ref>(dj);</highlight></codeline>
<codeline lineno="2477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1af194524672491a522f041278b9b74e94" kindref="member">follow_path</ref>(&amp;dj,<sp/>path);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Follow<sp/>the<sp/>file<sp/>path<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dir<sp/>=<sp/>dj.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>;</highlight></codeline>
<codeline lineno="2479"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>R/W<sp/>configuration<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!dir)<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Default<sp/>directory<sp/>itself<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" kindref="member">FR_INVALID_NAME</ref>;</highlight></codeline>
<codeline lineno="2483"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_LOCK</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>chk_lock(&amp;dj,<sp/>(mode<sp/>&amp;<sp/>~<ref refid="ff_8h_1a1f4f3530ff03abbd979b072536e72290" kindref="member">FA_READ</ref>)<sp/>?<sp/>1<sp/>:<sp/>0);</highlight></codeline>
<codeline lineno="2486"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>or<sp/>Open<sp/>a<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(mode<sp/>&amp;<sp/>(<ref refid="ff_8h_1afba4546b131dea4b24727fa20a80e29f" kindref="member">FA_CREATE_ALWAYS</ref><sp/>|<sp/><ref refid="ff_8h_1a17b01553029920ac0468912b4bcb16c7" kindref="member">FA_OPEN_ALWAYS</ref><sp/>|<sp/><ref refid="ff_8h_1a417bb1babd1785fd181a806b5613eba3" kindref="member">FA_CREATE_NEW</ref>))<sp/>{</highlight></codeline>
<codeline lineno="2490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>No<sp/>file,<sp/>create<sp/>new<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref>)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>There<sp/>is<sp/>no<sp/>file<sp/>to<sp/>open,<sp/>create<sp/>a<sp/>new<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2492"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_LOCK</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>enq_lock()<sp/>?<sp/><ref refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" kindref="member">dir_register</ref>(&amp;dj)<sp/>:<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca50dd3c3c274ccebb2cfbddde9d065bb9" kindref="member">FR_TOO_MANY_OPEN_FILES</ref>;</highlight></codeline>
<codeline lineno="2494"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" kindref="member">dir_register</ref>(&amp;dj);</highlight></codeline>
<codeline lineno="2496"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mode<sp/>|=<sp/><ref refid="ff_8h_1afba4546b131dea4b24727fa20a80e29f" kindref="member">FA_CREATE_ALWAYS</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>File<sp/>is<sp/>created<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dir<sp/>=<sp/>dj.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>New<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Any<sp/>object<sp/>is<sp/>already<sp/>existing<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dir[<ref refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" kindref="member">DIR_Attr</ref>]<sp/>&amp;<sp/>(<ref refid="ff_8h_1add6d85d1e7a02b4f6188783ef91a5f1e" kindref="member">AM_RDO</ref><sp/>|<sp/><ref refid="ff_8h_1a3a9db44e978ed6c13b641e092d4cd7d3" kindref="member">AM_DIR</ref>))<sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Cannot<sp/>overwrite<sp/>it<sp/>(R/O<sp/>or<sp/>DIR)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d" kindref="member">FR_DENIED</ref>;</highlight></codeline>
<codeline lineno="2503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(mode<sp/>&amp;<sp/><ref refid="ff_8h_1a417bb1babd1785fd181a806b5613eba3" kindref="member">FA_CREATE_NEW</ref>)<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Cannot<sp/>create<sp/>as<sp/>new<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca0d8f024d256df76e84782b95018a2450" kindref="member">FR_EXIST</ref>;</highlight></codeline>
<codeline lineno="2506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref><sp/>&amp;&amp;<sp/>(mode<sp/>&amp;<sp/><ref refid="ff_8h_1afba4546b131dea4b24727fa20a80e29f" kindref="member">FA_CREATE_ALWAYS</ref>))<sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Truncate<sp/>it<sp/>if<sp/>overwrite<sp/>mode<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dw<sp/>=<sp/><ref refid="ff_8c_1a72589f5bbb514c0b222ab8b292764418" kindref="member">GET_FATTIME</ref>();</highlight></codeline>
<codeline lineno="2510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(dir<sp/>+<sp/><ref refid="ff_8c_1a47fb1881ea71d860db9b8280564cb4d5" kindref="member">DIR_CrtTime</ref>,<sp/>dw);</highlight><highlight class="comment">/*<sp/>Set<sp/>created<sp/>time<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(dir<sp/>+<sp/><ref refid="ff_8c_1ab9452d336adeece2a1b0b54ab35b8a59" kindref="member">DIR_WrtTime</ref>,<sp/>dw);</highlight><highlight class="comment">/*<sp/>Set<sp/>modified<sp/>time<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dir[<ref refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" kindref="member">DIR_Attr</ref>]<sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Reset<sp/>attribute<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(dir<sp/>+<sp/><ref refid="ff_8c_1abfbfa613864a02a65f0bf70ead6672c7" kindref="member">DIR_FileSize</ref>,<sp/>0);</highlight><highlight class="comment">/*<sp/>Reset<sp/>file<sp/>size<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cl<sp/>=<sp/><ref refid="ff_8c_1ad1b3343c92d0f0e58ba448c3c11b1f39" kindref="member">ld_clust</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>dir);<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>cluster<sp/>chain<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a357e5a36452e057d68378c98cd61018c" kindref="member">st_clust</ref>(dir,<sp/>0);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Reset<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" kindref="member">wflag</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="2517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(cl)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Remove<sp/>the<sp/>cluster<sp/>chain<sp/>if<sp/>exist<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dw<sp/>=<sp/>dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" kindref="member">winsect</ref>;</highlight></codeline>
<codeline lineno="2519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1ab88651d19a5597dec220fe7538cccf23" kindref="member">remove_chain</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>cl);</highlight></codeline>
<codeline lineno="2520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1a10cd8b80b3b6474bf0d6432c8fb9d2d2" kindref="member">last_clust</ref><sp/>=<sp/>cl<sp/>-<sp/>1;<sp/></highlight><highlight class="comment">/*<sp/>Reuse<sp/>the<sp/>cluster<sp/>hole<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" kindref="member">move_window</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>dw);</highlight></codeline>
<codeline lineno="2523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/></highlight><highlight class="comment">/*<sp/>Open<sp/>an<sp/>existing<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Following<sp/>succeeded<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dir[<ref refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" kindref="member">DIR_Attr</ref>]<sp/>&amp;<sp/><ref refid="ff_8h_1a3a9db44e978ed6c13b641e092d4cd7d3" kindref="member">AM_DIR</ref>)<sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>It<sp/>is<sp/>a<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref>;</highlight></codeline>
<codeline lineno="2531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((mode<sp/>&amp;<sp/><ref refid="ff_8h_1afa366963220c89b882c0361794020c14" kindref="member">FA_WRITE</ref>)<sp/>&amp;&amp;<sp/>(dir[<ref refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" kindref="member">DIR_Attr</ref>]<sp/>&amp;<sp/><ref refid="ff_8h_1add6d85d1e7a02b4f6188783ef91a5f1e" kindref="member">AM_RDO</ref>))<sp/></highlight><highlight class="comment">/*<sp/>R/O<sp/>violation<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d" kindref="member">FR_DENIED</ref>;</highlight></codeline>
<codeline lineno="2534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(mode<sp/>&amp;<sp/><ref refid="ff_8h_1afba4546b131dea4b24727fa20a80e29f" kindref="member">FA_CREATE_ALWAYS</ref>)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>file<sp/>change<sp/>flag<sp/>if<sp/>created<sp/>or<sp/>overwritten<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mode<sp/>|=<sp/><ref refid="ff_8h_1ac4b7d5223f84df91c306ffbff536fae4" kindref="member">FA__WRITTEN</ref>;</highlight></codeline>
<codeline lineno="2540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1a5e11faf537370889c867127205f26ad1" kindref="member">dir_sect</ref><sp/>=<sp/>dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" kindref="member">winsect</ref>;<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>directory<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1a0071755a7d2cacd3bafbb1bf2dab98a0" kindref="member">dir_ptr</ref><sp/>=<sp/>dir;</highlight></codeline>
<codeline lineno="2542"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_LOCK</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;lockid<sp/>=<sp/>inc_lock(&amp;dj,<sp/>(mode<sp/>&amp;<sp/>~<ref refid="ff_8h_1a1f4f3530ff03abbd979b072536e72290" kindref="member">FA_READ</ref>)<sp/>?<sp/>1<sp/>:<sp/>0);</highlight></codeline>
<codeline lineno="2544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!fp-&gt;lockid)<sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>;</highlight></codeline>
<codeline lineno="2545"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2547"><highlight class="normal"></highlight></codeline>
<codeline lineno="2548"><highlight class="normal"></highlight><highlight class="preprocessor">#else<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>R/O<sp/>configuration<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Follow<sp/>succeeded<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dir<sp/>=<sp/>dj.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>;</highlight></codeline>
<codeline lineno="2551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!dir)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Current<sp/>directory<sp/>itself<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" kindref="member">FR_INVALID_NAME</ref>;</highlight></codeline>
<codeline lineno="2553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dir[<ref refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" kindref="member">DIR_Attr</ref>]<sp/>&amp;<sp/><ref refid="ff_8h_1a3a9db44e978ed6c13b641e092d4cd7d3" kindref="member">AM_DIR</ref>)<sp/></highlight><highlight class="comment">/*<sp/>It<sp/>is<sp/>a<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref>;</highlight></codeline>
<codeline lineno="2556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2558"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1aba6d6942b59f11cf285bdbfb7e38f1fa" kindref="member">FREE_BUF</ref>();</highlight></codeline>
<codeline lineno="2560"><highlight class="normal"></highlight></codeline>
<codeline lineno="2561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>=<sp/>mode;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>File<sp/>access<sp/>mode<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1a32b2a186af2cab58af8114c05386b9f6" kindref="member">err</ref><sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Clear<sp/>error<sp/>flag<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref><sp/>=<sp/><ref refid="ff_8c_1ad1b3343c92d0f0e58ba448c3c11b1f39" kindref="member">ld_clust</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>dir);<sp/><sp/></highlight><highlight class="comment">/*<sp/>File<sp/>start<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1af70a0afd16367837984d6205cbfca308" kindref="member">fsize</ref><sp/>=<sp/><ref refid="ff_8h_1a4690304ddc975516f7dc02575c96e34e" kindref="member">LD_DWORD</ref>(dir<sp/>+<sp/><ref refid="ff_8c_1abfbfa613864a02a65f0bf70ead6672c7" kindref="member">DIR_FileSize</ref>);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>File<sp/>size<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>File<sp/>pointer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" kindref="member">dsect</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2568"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_FASTSEEK</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;cltbl<sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Normal<sp/>seek<sp/>mode<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2570"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref><sp/>=<sp/>dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Validate<sp/>file<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1a7b7a6396b2c82ad46c6d8b2bf141a8dd" kindref="member">id</ref><sp/>=<sp/>fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1a7b7a6396b2c82ad46c6d8b2bf141a8dd" kindref="member">id</ref>;</highlight></codeline>
<codeline lineno="2573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2574"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2575"><highlight class="normal"></highlight></codeline>
<codeline lineno="2576"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>res);</highlight></codeline>
<codeline lineno="2577"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2578"><highlight class="normal"></highlight></codeline>
<codeline lineno="2579"><highlight class="normal"></highlight></codeline>
<codeline lineno="2580"><highlight class="normal"></highlight></codeline>
<codeline lineno="2581"><highlight class="normal"></highlight></codeline>
<codeline lineno="2582"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2583"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Read<sp/>File<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2584"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2585"><highlight class="normal"></highlight></codeline>
<codeline lineno="2586" refid="group__filesystem_1gac4c3dcb6869ca252888eebabe39727b3" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="group__filesystem_1gac4c3dcb6869ca252888eebabe39727b3" kindref="member">f_read</ref><sp/>(</highlight></codeline>
<codeline lineno="2587"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_i_l" kindref="compound">FIL</ref>*<sp/>fp,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>file<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2588"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>buff,<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>data<sp/>buffer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2589"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>btr,<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>bytes<sp/>to<sp/>read<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2590"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref>*<sp/>br<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>number<sp/>of<sp/>bytes<sp/>read<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2591"><highlight class="normal">)</highlight></codeline>
<codeline lineno="2592"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2593"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="2594"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>clst,<sp/>sect,<sp/>remain;</highlight></codeline>
<codeline lineno="2595"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>rcnt,<sp/>cc;</highlight></codeline>
<codeline lineno="2596"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>csect,<sp/>*rbuff<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>*)buff;</highlight></codeline>
<codeline lineno="2597"><highlight class="normal"></highlight></codeline>
<codeline lineno="2598"><highlight class="normal"></highlight></codeline>
<codeline lineno="2599"><highlight class="normal"><sp/><sp/><sp/><sp/>*br<sp/>=<sp/>0;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Clear<sp/>read<sp/>byte<sp/>counter<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2600"><highlight class="normal"></highlight></codeline>
<codeline lineno="2601"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1aa7193f5b86c3996b5312043a0c26da5f" kindref="member">validate</ref>(fp);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>validity<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2602"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>res);</highlight></codeline>
<codeline lineno="2603"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1a32b2a186af2cab58af8114c05386b9f6" kindref="member">err</ref>)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>error<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>(<ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref>)fp-&gt;<ref refid="struct_f_i_l_1a32b2a186af2cab58af8114c05386b9f6" kindref="member">err</ref>);</highlight></codeline>
<codeline lineno="2605"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!(fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>&amp;<sp/><ref refid="ff_8h_1a1f4f3530ff03abbd979b072536e72290" kindref="member">FA_READ</ref>))<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>access<sp/>mode<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d" kindref="member">FR_DENIED</ref>);</highlight></codeline>
<codeline lineno="2607"><highlight class="normal"><sp/><sp/><sp/><sp/>remain<sp/>=<sp/>fp-&gt;<ref refid="struct_f_i_l_1af70a0afd16367837984d6205cbfca308" kindref="member">fsize</ref><sp/>-<sp/>fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref>;</highlight></codeline>
<codeline lineno="2608"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(btr<sp/>&gt;<sp/>remain)<sp/>btr<sp/>=<sp/>(<ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref>)remain;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Truncate<sp/>btr<sp/>by<sp/>remaining<sp/>bytes<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2609"><highlight class="normal"></highlight></codeline>
<codeline lineno="2610"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<sp/>;<sp/><sp/>btr;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Repeat<sp/>until<sp/>all<sp/>data<sp/>read<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rbuff<sp/>+=<sp/>rcnt,<sp/>fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>+=<sp/>rcnt,<sp/>*br<sp/>+=<sp/>rcnt,<sp/>btr<sp/>-=<sp/>rcnt)<sp/>{</highlight></codeline>
<codeline lineno="2612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>%<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>))<sp/>==<sp/>0)<sp/>{<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>On<sp/>the<sp/>sector<sp/>boundary?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>csect<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)(fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>/<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)<sp/>&amp;<sp/>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" kindref="member">csize</ref><sp/>-<sp/>1));<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Sector<sp/>offset<sp/>in<sp/>the<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!csect)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>On<sp/>the<sp/>cluster<sp/>boundary?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>==<sp/>0)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>On<sp/>the<sp/>top<sp/>of<sp/>the<sp/>file?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clst<sp/>=<sp/>fp-&gt;<ref refid="struct_f_i_l_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Follow<sp/>from<sp/>the<sp/>origin<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Middle<sp/>or<sp/>end<sp/>of<sp/>the<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2618"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_FASTSEEK</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;cltbl)</highlight></codeline>
<codeline lineno="2620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clst<sp/>=<sp/>clmt_clust(fp,<sp/>fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref>);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>cluster#<sp/>from<sp/>the<sp/>CLMT<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2622"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clst<sp/>=<sp/><ref refid="ff_8c_1a65611adf1626e5e08da77cd33a98dd8b" kindref="member">get_fat</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1ac134c1b4645be670eb5207032e714616" kindref="member">clust</ref>);<sp/><sp/></highlight><highlight class="comment">/*<sp/>Follow<sp/>cluster<sp/>chain<sp/>on<sp/>the<sp/>FAT<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>&lt;<sp/>2)<sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>);</highlight></codeline>
<codeline lineno="2626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>==<sp/>0xFFFFFFFF)<sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>);</highlight></codeline>
<codeline lineno="2627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1ac134c1b4645be670eb5207032e714616" kindref="member">clust</ref><sp/>=<sp/>clst;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Update<sp/>current<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sect<sp/>=<sp/><ref refid="ff_8c_1a7519abb60fe91f6aa1d17f64fbae123a" kindref="member">clust2sect</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1ac134c1b4645be670eb5207032e714616" kindref="member">clust</ref>);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>current<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!sect)<sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>);</highlight></codeline>
<codeline lineno="2631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sect<sp/>+=<sp/>csect;</highlight></codeline>
<codeline lineno="2632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cc<sp/>=<sp/>btr<sp/>/<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>When<sp/>remaining<sp/>bytes<sp/>&gt;=<sp/>sector<sp/>size,<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(cc)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>maximum<sp/>contiguous<sp/>sectors<sp/>directly<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(csect<sp/>+<sp/>cc<sp/>&gt;<sp/>fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" kindref="member">csize</ref>)<sp/></highlight><highlight class="comment">/*<sp/>Clip<sp/>at<sp/>cluster<sp/>boundary<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cc<sp/>=<sp/>fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" kindref="member">csize</ref><sp/>-<sp/>csect;</highlight></codeline>
<codeline lineno="2636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1gae55155170bc9b99f73b440b93cc1c9e2" kindref="member">disk_read</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" kindref="member">drv</ref>,<sp/>rbuff,<sp/>sect,<sp/>cc)<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref>)</highlight></codeline>
<codeline lineno="2637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>);</highlight></codeline>
<codeline lineno="2638"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY<sp/>&amp;&amp;<sp/>_FS_MINIMIZE<sp/>&lt;=<sp/>2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Replace<sp/>one<sp/>of<sp/>the<sp/>read<sp/>sectors<sp/>with<sp/>cached<sp/>data<sp/>if<sp/>it<sp/>contains<sp/>a<sp/>dirty<sp/>sector<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2639"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_TINY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" kindref="member">wflag</ref><sp/>&amp;&amp;<sp/>fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" kindref="member">winsect</ref><sp/>-<sp/>sect<sp/>&lt;<sp/>cc)</highlight></codeline>
<codeline lineno="2641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a8941d573d16af92c8570950d53164f30" kindref="member">mem_cpy</ref>(rbuff<sp/>+<sp/>((fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" kindref="member">winsect</ref><sp/>-<sp/>sect)<sp/>*<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)),<sp/>fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>,<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>));</highlight></codeline>
<codeline lineno="2642"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>&amp;<sp/><ref refid="ff_8h_1a5b2962e3616a1e9eb709d95f4c75c67c" kindref="member">FA__DIRTY</ref>)<sp/>&amp;&amp;<sp/>fp-&gt;<ref refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" kindref="member">dsect</ref><sp/>-<sp/>sect<sp/>&lt;<sp/>cc)</highlight></codeline>
<codeline lineno="2644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a8941d573d16af92c8570950d53164f30" kindref="member">mem_cpy</ref>(rbuff<sp/>+<sp/>((fp-&gt;<ref refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" kindref="member">dsect</ref><sp/>-<sp/>sect)<sp/>*<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)),<sp/>fp-&gt;<ref refid="struct_f_i_l_1a1602edc1ba9d9ae2b583cf55f3492325" kindref="member">buf</ref>,<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>));</highlight></codeline>
<codeline lineno="2645"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2646"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rcnt<sp/>=<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)<sp/>*<sp/>cc;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>bytes<sp/>transferred<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2650"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_TINY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" kindref="member">dsect</ref><sp/>!=<sp/>sect)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Load<sp/>data<sp/>sector<sp/>if<sp/>not<sp/>in<sp/>cache<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2652"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>&amp;<sp/><ref refid="ff_8h_1a5b2962e3616a1e9eb709d95f4c75c67c" kindref="member">FA__DIRTY</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Write-back<sp/>dirty<sp/>sector<sp/>cache<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" kindref="member">disk_write</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" kindref="member">drv</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1a1602edc1ba9d9ae2b583cf55f3492325" kindref="member">buf</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" kindref="member">dsect</ref>,<sp/>1)<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref>)</highlight></codeline>
<codeline lineno="2655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>);</highlight></codeline>
<codeline lineno="2656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>&amp;=<sp/>~<ref refid="ff_8h_1a5b2962e3616a1e9eb709d95f4c75c67c" kindref="member">FA__DIRTY</ref>;</highlight></codeline>
<codeline lineno="2657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2658"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1gae55155170bc9b99f73b440b93cc1c9e2" kindref="member">disk_read</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" kindref="member">drv</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1a1602edc1ba9d9ae2b583cf55f3492325" kindref="member">buf</ref>,<sp/>sect,<sp/>1)<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref>)<sp/></highlight><highlight class="comment">/*<sp/>Fill<sp/>sector<sp/>cache<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>);</highlight></codeline>
<codeline lineno="2661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2662"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" kindref="member">dsect</ref><sp/>=<sp/>sect;</highlight></codeline>
<codeline lineno="2664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rcnt<sp/>=<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)<sp/>-<sp/>((<ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref>)fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>%<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>));<sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>partial<sp/>sector<sp/>data<sp/>from<sp/>sector<sp/>buffer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rcnt<sp/>&gt;<sp/>btr)<sp/>rcnt<sp/>=<sp/>btr;</highlight></codeline>
<codeline lineno="2667"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_TINY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" kindref="member">move_window</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" kindref="member">dsect</ref>)<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Move<sp/>sector<sp/>window<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>);</highlight></codeline>
<codeline lineno="2670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a8941d573d16af92c8570950d53164f30" kindref="member">mem_cpy</ref>(rbuff,<sp/>&amp;fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>[fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>%<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)],<sp/>rcnt);<sp/><sp/></highlight><highlight class="comment">/*<sp/>Pick<sp/>partial<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2671"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a8941d573d16af92c8570950d53164f30" kindref="member">mem_cpy</ref>(rbuff,<sp/>&amp;fp-&gt;<ref refid="struct_f_i_l_1a1602edc1ba9d9ae2b583cf55f3492325" kindref="member">buf</ref>[fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>%<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)],<sp/>rcnt);<sp/><sp/></highlight><highlight class="comment">/*<sp/>Pick<sp/>partial<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2673"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2674"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2675"><highlight class="normal"></highlight></codeline>
<codeline lineno="2676"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>);</highlight></codeline>
<codeline lineno="2677"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2678"><highlight class="normal"></highlight></codeline>
<codeline lineno="2679"><highlight class="normal"></highlight></codeline>
<codeline lineno="2680"><highlight class="normal"></highlight></codeline>
<codeline lineno="2681"><highlight class="normal"></highlight></codeline>
<codeline lineno="2682"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2683"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2684"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Write<sp/>File<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2685"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2686"><highlight class="normal"></highlight></codeline>
<codeline lineno="2687" refid="group__filesystem_1gae6a4dfae8a9e308bdb2283a37ef680f2" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="group__filesystem_1gae6a4dfae8a9e308bdb2283a37ef680f2" kindref="member">f_write</ref><sp/>(</highlight></codeline>
<codeline lineno="2688"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_i_l" kindref="compound">FIL</ref>*<sp/>fp,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>file<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2689"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*buff,<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>data<sp/>to<sp/>be<sp/>written<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2690"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>btw,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>bytes<sp/>to<sp/>write<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2691"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref>*<sp/>bw<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>number<sp/>of<sp/>bytes<sp/>written<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2692"><highlight class="normal">)</highlight></codeline>
<codeline lineno="2693"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2694"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="2695"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>clst,<sp/>sect;</highlight></codeline>
<codeline lineno="2696"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>wcnt,<sp/>cc;</highlight></codeline>
<codeline lineno="2697"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>*wbuff<sp/>=<sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>*)buff;</highlight></codeline>
<codeline lineno="2698"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>csect;</highlight></codeline>
<codeline lineno="2699"><highlight class="normal"></highlight></codeline>
<codeline lineno="2700"><highlight class="normal"></highlight></codeline>
<codeline lineno="2701"><highlight class="normal"><sp/><sp/><sp/><sp/>*bw<sp/>=<sp/>0;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Clear<sp/>write<sp/>byte<sp/>counter<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2702"><highlight class="normal"></highlight></codeline>
<codeline lineno="2703"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1aa7193f5b86c3996b5312043a0c26da5f" kindref="member">validate</ref>(fp);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>validity<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2704"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>res);</highlight></codeline>
<codeline lineno="2705"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1a32b2a186af2cab58af8114c05386b9f6" kindref="member">err</ref>)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>error<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>(<ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref>)fp-&gt;<ref refid="struct_f_i_l_1a32b2a186af2cab58af8114c05386b9f6" kindref="member">err</ref>);</highlight></codeline>
<codeline lineno="2707"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!(fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>&amp;<sp/><ref refid="ff_8h_1afa366963220c89b882c0361794020c14" kindref="member">FA_WRITE</ref>))<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>access<sp/>mode<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d" kindref="member">FR_DENIED</ref>);</highlight></codeline>
<codeline lineno="2709"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>+<sp/>btw<sp/>&lt;<sp/>fp-&gt;fptr)<sp/>btw<sp/>=<sp/>0;<sp/></highlight><highlight class="comment">/*<sp/>File<sp/>size<sp/>cannot<sp/>reach<sp/>4GB<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2710"><highlight class="normal"></highlight></codeline>
<codeline lineno="2711"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<sp/>;<sp/><sp/>btw;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Repeat<sp/>until<sp/>all<sp/>data<sp/>written<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wbuff<sp/>+=<sp/>wcnt,<sp/>fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>+=<sp/>wcnt,<sp/>*bw<sp/>+=<sp/>wcnt,<sp/>btw<sp/>-=<sp/>wcnt)<sp/>{</highlight></codeline>
<codeline lineno="2713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>%<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>))<sp/>==<sp/>0)<sp/>{<sp/></highlight><highlight class="comment">/*<sp/>On<sp/>the<sp/>sector<sp/>boundary?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>csect<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)(fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>/<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)<sp/>&amp;<sp/>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" kindref="member">csize</ref><sp/>-<sp/>1));<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Sector<sp/>offset<sp/>in<sp/>the<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!csect)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>On<sp/>the<sp/>cluster<sp/>boundary?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>==<sp/>0)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>On<sp/>the<sp/>top<sp/>of<sp/>the<sp/>file?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clst<sp/>=<sp/>fp-&gt;<ref refid="struct_f_i_l_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref>;<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Follow<sp/>from<sp/>the<sp/>origin<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>==<sp/>0)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>When<sp/>no<sp/>cluster<sp/>is<sp/>allocated,<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clst<sp/>=<sp/><ref refid="ff_8c_1acbd0a20a17c6f9b6d536490d1cc3c5ac" kindref="member">create_chain</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>0);<sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>a<sp/>new<sp/>cluster<sp/>chain<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Middle<sp/>or<sp/>end<sp/>of<sp/>the<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2721"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_FASTSEEK</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;cltbl)</highlight></codeline>
<codeline lineno="2723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clst<sp/>=<sp/>clmt_clust(fp,<sp/>fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref>);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>cluster#<sp/>from<sp/>the<sp/>CLMT<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2725"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clst<sp/>=<sp/><ref refid="ff_8c_1acbd0a20a17c6f9b6d536490d1cc3c5ac" kindref="member">create_chain</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1ac134c1b4645be670eb5207032e714616" kindref="member">clust</ref>);<sp/></highlight><highlight class="comment">/*<sp/>Follow<sp/>or<sp/>stretch<sp/>cluster<sp/>chain<sp/>on<sp/>the<sp/>FAT<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>==<sp/>0)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Could<sp/>not<sp/>allocate<sp/>a<sp/>new<sp/>cluster<sp/>(disk<sp/>full)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>==<sp/>1)<sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>);</highlight></codeline>
<codeline lineno="2730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>==<sp/>0xFFFFFFFF)<sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>);</highlight></codeline>
<codeline lineno="2731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1ac134c1b4645be670eb5207032e714616" kindref="member">clust</ref><sp/>=<sp/>clst;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Update<sp/>current<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref><sp/>==<sp/>0)<sp/>fp-&gt;<ref refid="struct_f_i_l_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref><sp/>=<sp/>clst;<sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>start<sp/>cluster<sp/>if<sp/>the<sp/>first<sp/>write<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2734"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_TINY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" kindref="member">winsect</ref><sp/>==<sp/>fp-&gt;<ref refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" kindref="member">dsect</ref><sp/>&amp;&amp;<sp/><ref refid="ff_8c_1a5e18753404354b210096f9af99e31bc1" kindref="member">sync_window</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>))<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Write-back<sp/>sector<sp/>cache<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>);</highlight></codeline>
<codeline lineno="2737"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>&amp;<sp/><ref refid="ff_8h_1a5b2962e3616a1e9eb709d95f4c75c67c" kindref="member">FA__DIRTY</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Write-back<sp/>sector<sp/>cache<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" kindref="member">disk_write</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" kindref="member">drv</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1a1602edc1ba9d9ae2b583cf55f3492325" kindref="member">buf</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" kindref="member">dsect</ref>,<sp/>1)<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref>)</highlight></codeline>
<codeline lineno="2740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>);</highlight></codeline>
<codeline lineno="2741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>&amp;=<sp/>~<ref refid="ff_8h_1a5b2962e3616a1e9eb709d95f4c75c67c" kindref="member">FA__DIRTY</ref>;</highlight></codeline>
<codeline lineno="2742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2743"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sect<sp/>=<sp/><ref refid="ff_8c_1a7519abb60fe91f6aa1d17f64fbae123a" kindref="member">clust2sect</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1ac134c1b4645be670eb5207032e714616" kindref="member">clust</ref>);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>current<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!sect)<sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>);</highlight></codeline>
<codeline lineno="2746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sect<sp/>+=<sp/>csect;</highlight></codeline>
<codeline lineno="2747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cc<sp/>=<sp/>btw<sp/>/<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>When<sp/>remaining<sp/>bytes<sp/>&gt;=<sp/>sector<sp/>size,<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(cc)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Write<sp/>maximum<sp/>contiguous<sp/>sectors<sp/>directly<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(csect<sp/>+<sp/>cc<sp/>&gt;<sp/>fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" kindref="member">csize</ref>)<sp/></highlight><highlight class="comment">/*<sp/>Clip<sp/>at<sp/>cluster<sp/>boundary<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cc<sp/>=<sp/>fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" kindref="member">csize</ref><sp/>-<sp/>csect;</highlight></codeline>
<codeline lineno="2751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" kindref="member">disk_write</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" kindref="member">drv</ref>,<sp/>wbuff,<sp/>sect,<sp/>cc)<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref>)</highlight></codeline>
<codeline lineno="2752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>);</highlight></codeline>
<codeline lineno="2753"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_MINIMIZE<sp/>&lt;=<sp/>2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2754"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_TINY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" kindref="member">winsect</ref><sp/>-<sp/>sect<sp/>&lt;<sp/>cc)<sp/>{<sp/><sp/></highlight><highlight class="comment">/*<sp/>Refill<sp/>sector<sp/>cache<sp/>if<sp/>it<sp/>gets<sp/>invalidated<sp/>by<sp/>the<sp/>direct<sp/>write<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a8941d573d16af92c8570950d53164f30" kindref="member">mem_cpy</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>,<sp/>wbuff<sp/>+<sp/>((fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" kindref="member">winsect</ref><sp/>-<sp/>sect)<sp/>*<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)),<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>));</highlight></codeline>
<codeline lineno="2757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" kindref="member">wflag</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2759"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" kindref="member">dsect</ref><sp/>-<sp/>sect<sp/>&lt;<sp/>cc)<sp/>{<sp/></highlight><highlight class="comment">/*<sp/>Refill<sp/>sector<sp/>cache<sp/>if<sp/>it<sp/>gets<sp/>invalidated<sp/>by<sp/>the<sp/>direct<sp/>write<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a8941d573d16af92c8570950d53164f30" kindref="member">mem_cpy</ref>(fp-&gt;<ref refid="struct_f_i_l_1a1602edc1ba9d9ae2b583cf55f3492325" kindref="member">buf</ref>,<sp/>wbuff<sp/>+<sp/>((fp-&gt;<ref refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" kindref="member">dsect</ref><sp/>-<sp/>sect)<sp/>*<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)),<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>));</highlight></codeline>
<codeline lineno="2762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>&amp;=<sp/>~<ref refid="ff_8h_1a5b2962e3616a1e9eb709d95f4c75c67c" kindref="member">FA__DIRTY</ref>;</highlight></codeline>
<codeline lineno="2763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2764"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2765"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wcnt<sp/>=<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)<sp/>*<sp/>cc;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>bytes<sp/>transferred<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2769"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_TINY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>&gt;=<sp/>fp-&gt;<ref refid="struct_f_i_l_1af70a0afd16367837984d6205cbfca308" kindref="member">fsize</ref>)<sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Avoid<sp/>silly<sp/>cache<sp/>filling<sp/>at<sp/>growing<sp/>edge<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1a5e18753404354b210096f9af99e31bc1" kindref="member">sync_window</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>))<sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>);</highlight></codeline>
<codeline lineno="2772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" kindref="member">winsect</ref><sp/>=<sp/>sect;</highlight></codeline>
<codeline lineno="2773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2774"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2775"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" kindref="member">dsect</ref><sp/>!=<sp/>sect)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Fill<sp/>sector<sp/>cache<sp/>with<sp/>file<sp/>data<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>&lt;<sp/>fp-&gt;<ref refid="struct_f_i_l_1af70a0afd16367837984d6205cbfca308" kindref="member">fsize</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="2777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1gae55155170bc9b99f73b440b93cc1c9e2" kindref="member">disk_read</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" kindref="member">drv</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1a1602edc1ba9d9ae2b583cf55f3492325" kindref="member">buf</ref>,<sp/>sect,<sp/>1)<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref>)</highlight></codeline>
<codeline lineno="2778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>);</highlight></codeline>
<codeline lineno="2779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2780"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" kindref="member">dsect</ref><sp/>=<sp/>sect;</highlight></codeline>
<codeline lineno="2782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wcnt<sp/>=<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)<sp/>-<sp/>((<ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref>)fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>%<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>));</highlight><highlight class="comment">/*<sp/>Put<sp/>partial<sp/>sector<sp/>into<sp/>file<sp/>I/O<sp/>buffer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(wcnt<sp/>&gt;<sp/>btw)<sp/>wcnt<sp/>=<sp/>btw;</highlight></codeline>
<codeline lineno="2785"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_TINY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" kindref="member">move_window</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" kindref="member">dsect</ref>)<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Move<sp/>sector<sp/>window<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>);</highlight></codeline>
<codeline lineno="2788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a8941d573d16af92c8570950d53164f30" kindref="member">mem_cpy</ref>(&amp;fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>[fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>%<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)],<sp/>wbuff,<sp/>wcnt);<sp/><sp/></highlight><highlight class="comment">/*<sp/>Fit<sp/>partial<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2789"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" kindref="member">wflag</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="2790"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a8941d573d16af92c8570950d53164f30" kindref="member">mem_cpy</ref>(&amp;fp-&gt;<ref refid="struct_f_i_l_1a1602edc1ba9d9ae2b583cf55f3492325" kindref="member">buf</ref>[fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>%<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)],<sp/>wbuff,<sp/>wcnt);<sp/><sp/></highlight><highlight class="comment">/*<sp/>Fit<sp/>partial<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>|=<sp/><ref refid="ff_8h_1a5b2962e3616a1e9eb709d95f4c75c67c" kindref="member">FA__DIRTY</ref>;</highlight></codeline>
<codeline lineno="2793"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2794"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2795"><highlight class="normal"></highlight></codeline>
<codeline lineno="2796"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>&gt;<sp/>fp-&gt;<ref refid="struct_f_i_l_1af70a0afd16367837984d6205cbfca308" kindref="member">fsize</ref>)<sp/>fp-&gt;<ref refid="struct_f_i_l_1af70a0afd16367837984d6205cbfca308" kindref="member">fsize</ref><sp/>=<sp/>fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref>;<sp/></highlight><highlight class="comment">/*<sp/>Update<sp/>file<sp/>size<sp/>if<sp/>needed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2797"><highlight class="normal"><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>|=<sp/><ref refid="ff_8h_1ac4b7d5223f84df91c306ffbff536fae4" kindref="member">FA__WRITTEN</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>file<sp/>change<sp/>flag<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2798"><highlight class="normal"></highlight></codeline>
<codeline lineno="2799"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>);</highlight></codeline>
<codeline lineno="2800"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2801"><highlight class="normal"></highlight></codeline>
<codeline lineno="2802"><highlight class="normal"></highlight></codeline>
<codeline lineno="2803"><highlight class="normal"></highlight></codeline>
<codeline lineno="2804"><highlight class="normal"></highlight></codeline>
<codeline lineno="2805"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2806"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Synchronize<sp/>the<sp/>File<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2807"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2808"><highlight class="normal"></highlight></codeline>
<codeline lineno="2809" refid="group__filesystem_1gad69c7246b122ba56a134939ee0eaf847" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="group__filesystem_1gad69c7246b122ba56a134939ee0eaf847" kindref="member">f_sync</ref><sp/>(</highlight></codeline>
<codeline lineno="2810"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_i_l" kindref="compound">FIL</ref>*<sp/>fp<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>file<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2811"><highlight class="normal">)</highlight></codeline>
<codeline lineno="2812"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2813"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="2814"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>tm;</highlight></codeline>
<codeline lineno="2815"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>*dir;</highlight></codeline>
<codeline lineno="2816"><highlight class="normal"></highlight></codeline>
<codeline lineno="2817"><highlight class="normal"></highlight></codeline>
<codeline lineno="2818"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1aa7193f5b86c3996b5312043a0c26da5f" kindref="member">validate</ref>(fp);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>validity<sp/>of<sp/>the<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2819"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>&amp;<sp/><ref refid="ff_8h_1ac4b7d5223f84df91c306ffbff536fae4" kindref="member">FA__WRITTEN</ref>)<sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Is<sp/>there<sp/>any<sp/>change<sp/>to<sp/>the<sp/>file?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2821"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_TINY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2822"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>&amp;<sp/><ref refid="ff_8h_1a5b2962e3616a1e9eb709d95f4c75c67c" kindref="member">FA__DIRTY</ref>)<sp/>{<sp/></highlight><highlight class="comment">/*<sp/>Write-back<sp/>cached<sp/>data<sp/>if<sp/>needed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" kindref="member">disk_write</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" kindref="member">drv</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1a1602edc1ba9d9ae2b583cf55f3492325" kindref="member">buf</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" kindref="member">dsect</ref>,<sp/>1)<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref>)</highlight></codeline>
<codeline lineno="2824"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>);</highlight></codeline>
<codeline lineno="2825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>&amp;=<sp/>~<ref refid="ff_8h_1a5b2962e3616a1e9eb709d95f4c75c67c" kindref="member">FA__DIRTY</ref>;</highlight></codeline>
<codeline lineno="2826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2827"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2828"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Update<sp/>the<sp/>directory<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" kindref="member">move_window</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1a5e11faf537370889c867127205f26ad1" kindref="member">dir_sect</ref>);</highlight></codeline>
<codeline lineno="2830"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dir<sp/>=<sp/>fp-&gt;<ref refid="struct_f_i_l_1a0071755a7d2cacd3bafbb1bf2dab98a0" kindref="member">dir_ptr</ref>;</highlight></codeline>
<codeline lineno="2832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dir[<ref refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" kindref="member">DIR_Attr</ref>]<sp/>|=<sp/><ref refid="ff_8h_1ae8174d00798e34e7c9e95898cb9e1a09" kindref="member">AM_ARC</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>archive<sp/>bit<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(dir<sp/>+<sp/><ref refid="ff_8c_1abfbfa613864a02a65f0bf70ead6672c7" kindref="member">DIR_FileSize</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1af70a0afd16367837984d6205cbfca308" kindref="member">fsize</ref>);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Update<sp/>file<sp/>size<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a357e5a36452e057d68378c98cd61018c" kindref="member">st_clust</ref>(dir,<sp/>fp-&gt;<ref refid="struct_f_i_l_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref>);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Update<sp/>start<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tm<sp/>=<sp/><ref refid="ff_8c_1a72589f5bbb514c0b222ab8b292764418" kindref="member">GET_FATTIME</ref>();<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Update<sp/>modified<sp/>time<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(dir<sp/>+<sp/><ref refid="ff_8c_1ab9452d336adeece2a1b0b54ab35b8a59" kindref="member">DIR_WrtTime</ref>,<sp/>tm);</highlight></codeline>
<codeline lineno="2837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" kindref="member">ST_WORD</ref>(dir<sp/>+<sp/><ref refid="ff_8c_1afa0625d73f4683df24345f51e7a43da3" kindref="member">DIR_LstAccDate</ref>,<sp/>0);</highlight></codeline>
<codeline lineno="2838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>&amp;=<sp/>~<ref refid="ff_8h_1ac4b7d5223f84df91c306ffbff536fae4" kindref="member">FA__WRITTEN</ref>;</highlight></codeline>
<codeline lineno="2839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" kindref="member">wflag</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="2840"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1aec6b108298553219ebb2b960b528459d" kindref="member">sync_fs</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>);</highlight></codeline>
<codeline lineno="2841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2843"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2844"><highlight class="normal"></highlight></codeline>
<codeline lineno="2845"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>res);</highlight></codeline>
<codeline lineno="2846"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2847"><highlight class="normal"></highlight></codeline>
<codeline lineno="2848"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>!_FS_READONLY<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2849"><highlight class="normal"></highlight></codeline>
<codeline lineno="2850"><highlight class="normal"></highlight></codeline>
<codeline lineno="2851"><highlight class="normal"></highlight></codeline>
<codeline lineno="2852"><highlight class="normal"></highlight></codeline>
<codeline lineno="2853"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2854"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Close<sp/>File<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2855"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2856"><highlight class="normal"></highlight></codeline>
<codeline lineno="2857" refid="group__filesystem_1ga53882db20ef4323dcfd1874d7733ffc3" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="group__filesystem_1ga53882db20ef4323dcfd1874d7733ffc3" kindref="member">f_close</ref><sp/>(</highlight></codeline>
<codeline lineno="2858"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_i_l" kindref="compound">FIL</ref><sp/>*fp<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>file<sp/>object<sp/>to<sp/>be<sp/>closed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2859"><highlight class="normal">)</highlight></codeline>
<codeline lineno="2860"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2861"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="2862"><highlight class="normal"></highlight></codeline>
<codeline lineno="2863"><highlight class="normal"></highlight></codeline>
<codeline lineno="2864"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2865"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="group__filesystem_1gad69c7246b122ba56a134939ee0eaf847" kindref="member">f_sync</ref>(fp);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Flush<sp/>cached<sp/>data<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2866"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)</highlight></codeline>
<codeline lineno="2867"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2868"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1aa7193f5b86c3996b5312043a0c26da5f" kindref="member">validate</ref>(fp);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Lock<sp/>volume<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2871"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_REENTRANT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref><sp/>*fs<sp/>=<sp/>fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>;</highlight></codeline>
<codeline lineno="2873"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2874"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_LOCK</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>dec_lock(fp-&gt;lockid);<sp/></highlight><highlight class="comment">/*<sp/>Decrement<sp/>file<sp/>open<sp/>counter<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)</highlight></codeline>
<codeline lineno="2877"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref><sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Invalidate<sp/>file<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2879"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_REENTRANT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a58c93c453ba943336cd24aa185cd72cf" kindref="member">unlock_fs</ref>(fs,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>);<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Unlock<sp/>volume<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2881"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2883"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2884"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="2885"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2886"><highlight class="normal"></highlight></codeline>
<codeline lineno="2887"><highlight class="normal"></highlight></codeline>
<codeline lineno="2888"><highlight class="normal"></highlight></codeline>
<codeline lineno="2889"><highlight class="normal"></highlight></codeline>
<codeline lineno="2890"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2891"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Change<sp/>Current<sp/>Directory<sp/>or<sp/>Current<sp/>Drive,<sp/>Get<sp/>Current<sp/>Directory<sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2892"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2893"><highlight class="normal"></highlight></codeline>
<codeline lineno="2894"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_RPATH<sp/>&gt;=<sp/>1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2895"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_VOLUMES<sp/>&gt;=<sp/>2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2896"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="group__filesystem_1ga13e5933f851b436890361189f64261cd" kindref="member">f_chdrive</ref><sp/>(</highlight></codeline>
<codeline lineno="2897"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/>path<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Drive<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2898"><highlight class="normal">)</highlight></codeline>
<codeline lineno="2899"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2900"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>vol;</highlight></codeline>
<codeline lineno="2901"><highlight class="normal"></highlight></codeline>
<codeline lineno="2902"><highlight class="normal"></highlight></codeline>
<codeline lineno="2903"><highlight class="normal"><sp/><sp/><sp/><sp/>vol<sp/>=<sp/><ref refid="ff_8c_1a88ad7e4b1bc98d1a2673a136283dc7ee" kindref="member">get_ldnumber</ref>(&amp;path);</highlight></codeline>
<codeline lineno="2904"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(vol<sp/>&lt;<sp/>0)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca487844af77de15f6932a3b41ef3a2d65" kindref="member">FR_INVALID_DRIVE</ref>;</highlight></codeline>
<codeline lineno="2905"><highlight class="normal"></highlight></codeline>
<codeline lineno="2906"><highlight class="normal"><sp/><sp/><sp/><sp/>CurrVol<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)vol;</highlight></codeline>
<codeline lineno="2907"><highlight class="normal"></highlight></codeline>
<codeline lineno="2908"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>;</highlight></codeline>
<codeline lineno="2909"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2910"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2911"><highlight class="normal"></highlight></codeline>
<codeline lineno="2912"><highlight class="normal"></highlight></codeline>
<codeline lineno="2913"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="group__filesystem_1ga53c7e9a7fb3c279254cd2d0445667e2f" kindref="member">f_chdir</ref><sp/>(</highlight></codeline>
<codeline lineno="2914"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/>path<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>directory<sp/>path<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2915"><highlight class="normal">)</highlight></codeline>
<codeline lineno="2916"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2917"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="2918"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref><sp/>dj;</highlight></codeline>
<codeline lineno="2919"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7cc27142421bd12be623072288599791" kindref="member">DEFINE_NAMEBUF</ref>;</highlight></codeline>
<codeline lineno="2920"><highlight class="normal"></highlight></codeline>
<codeline lineno="2921"><highlight class="normal"></highlight></codeline>
<codeline lineno="2922"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>logical<sp/>drive<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2923"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" kindref="member">find_volume</ref>(&amp;dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>&amp;path,<sp/>0);</highlight></codeline>
<codeline lineno="2924"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a966fe5792671b39db1ccf655a8c1af8d" kindref="member">INIT_BUF</ref>(dj);</highlight></codeline>
<codeline lineno="2926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1af194524672491a522f041278b9b74e94" kindref="member">follow_path</ref>(&amp;dj,<sp/>path);<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Follow<sp/>the<sp/>path<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1aba6d6942b59f11cf285bdbfb7e38f1fa" kindref="member">FREE_BUF</ref>();</highlight></codeline>
<codeline lineno="2928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Follow<sp/>completed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!dj.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;cdir<sp/>=<sp/>dj.<ref refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Start<sp/>directory<sp/>itself<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dj.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>[<ref refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" kindref="member">DIR_Attr</ref>]<sp/>&amp;<sp/><ref refid="ff_8h_1a3a9db44e978ed6c13b641e092d4cd7d3" kindref="member">AM_DIR</ref>)<sp/><sp/></highlight><highlight class="comment">/*<sp/>Reached<sp/>to<sp/>the<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2933"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;cdir<sp/>=<sp/><ref refid="ff_8c_1ad1b3343c92d0f0e58ba448c3c11b1f39" kindref="member">ld_clust</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>dj.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>);</highlight></codeline>
<codeline lineno="2934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cae4529c8cc8b59783d6efc9ba4f574532" kindref="member">FR_NO_PATH</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Reached<sp/>but<sp/>a<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref>)<sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cae4529c8cc8b59783d6efc9ba4f574532" kindref="member">FR_NO_PATH</ref>;</highlight></codeline>
<codeline lineno="2939"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2940"><highlight class="normal"></highlight></codeline>
<codeline lineno="2941"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>res);</highlight></codeline>
<codeline lineno="2942"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2943"><highlight class="normal"></highlight></codeline>
<codeline lineno="2944"><highlight class="normal"></highlight></codeline>
<codeline lineno="2945"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_RPATH<sp/>&gt;=<sp/>2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2946"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="group__filesystem_1gacb865a03dbac0031ac5cb8a031f7b71c" kindref="member">f_getcwd</ref><sp/>(</highlight></codeline>
<codeline lineno="2947"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/>buff,<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>directory<sp/>path<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2948"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>len<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Size<sp/>of<sp/>path<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2949"><highlight class="normal">)</highlight></codeline>
<codeline lineno="2950"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2951"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="2952"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref><sp/>dj;</highlight></codeline>
<codeline lineno="2953"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>i,<sp/>n;</highlight></codeline>
<codeline lineno="2954"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>ccl;</highlight></codeline>
<codeline lineno="2955"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref><sp/>*tp;</highlight></codeline>
<codeline lineno="2956"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_i_l_i_n_f_o" kindref="compound">FILINFO</ref><sp/>fno;</highlight></codeline>
<codeline lineno="2957"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7cc27142421bd12be623072288599791" kindref="member">DEFINE_NAMEBUF</ref>;</highlight></codeline>
<codeline lineno="2958"><highlight class="normal"></highlight></codeline>
<codeline lineno="2959"><highlight class="normal"></highlight></codeline>
<codeline lineno="2960"><highlight class="normal"><sp/><sp/><sp/><sp/>*buff<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2961"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>logical<sp/>drive<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2962"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" kindref="member">find_volume</ref>(&amp;dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>**)&amp;buff,<sp/>0);<sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>current<sp/>volume<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2963"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2964"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a966fe5792671b39db1ccf655a8c1af8d" kindref="member">INIT_BUF</ref>(dj);</highlight></codeline>
<codeline lineno="2965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/>len;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Bottom<sp/>of<sp/>buffer<sp/>(directory<sp/>stack<sp/>base)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dj.<ref refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref><sp/>=<sp/>dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;cdir;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Start<sp/>to<sp/>follow<sp/>upper<sp/>directory<sp/>from<sp/>current<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2967"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((ccl<sp/>=<sp/>dj.<ref refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref>)<sp/>!=<sp/>0)<sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Repeat<sp/>while<sp/>current<sp/>directory<sp/>is<sp/>a<sp/>sub-directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" kindref="member">dir_sdi</ref>(&amp;dj,<sp/>1);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>parent<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a3a47a08609e77266bc1928af812e06df" kindref="member">dir_read</ref>(&amp;dj,<sp/>0);</highlight></codeline>
<codeline lineno="2971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dj.<ref refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref><sp/>=<sp/><ref refid="ff_8c_1ad1b3343c92d0f0e58ba448c3c11b1f39" kindref="member">ld_clust</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>dj.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Goto<sp/>parent<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" kindref="member">dir_sdi</ref>(&amp;dj,<sp/>0);</highlight></codeline>
<codeline lineno="2974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Find<sp/>the<sp/>entry<sp/>links<sp/>to<sp/>the<sp/>child<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a3a47a08609e77266bc1928af812e06df" kindref="member">dir_read</ref>(&amp;dj,<sp/>0);</highlight></codeline>
<codeline lineno="2977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ccl<sp/>==<sp/><ref refid="ff_8c_1ad1b3343c92d0f0e58ba448c3c11b1f39" kindref="member">ld_clust</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>dj.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>))<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Found<sp/>the<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a2edd26ac71869f25be5fce12eec58171" kindref="member">dir_next</ref>(&amp;dj,<sp/>0);<sp/></highlight></codeline>
<codeline lineno="2980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>);</highlight></codeline>
<codeline lineno="2981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref>)<sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>;</highlight><highlight class="comment">/*<sp/>It<sp/>cannot<sp/>be<sp/>&apos;not<sp/>found&apos;.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2983"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fno.<ref refid="struct_f_i_l_i_n_f_o_1ac40e23991a0616f2573d7856cdbba9ea" kindref="member">lfname</ref><sp/>=<sp/>buff;</highlight></codeline>
<codeline lineno="2985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fno.<ref refid="struct_f_i_l_i_n_f_o_1a28ec94b667e705d5eb0ec0bc7b5e32ec" kindref="member">lfsize</ref><sp/>=<sp/>i;</highlight></codeline>
<codeline lineno="2986"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a2bc1b9d8567181c23b4720f4fb6076f5" kindref="member">get_fileinfo</ref>(&amp;dj,<sp/>&amp;fno);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>the<sp/>directory<sp/>name<sp/>and<sp/>push<sp/>it<sp/>to<sp/>the<sp/>buffer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tp<sp/>=<sp/>fno.<ref refid="struct_f_i_l_i_n_f_o_1a7c33845207b44ca3b394052ad6724e72" kindref="member">fname</ref>;</highlight></codeline>
<codeline lineno="2989"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(*buff)<sp/>tp<sp/>=<sp/>buff;</highlight></codeline>
<codeline lineno="2991"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(n<sp/>=<sp/>0;<sp/>tp[n];<sp/>n++)<sp/>;</highlight></codeline>
<codeline lineno="2993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>&lt;<sp/>n<sp/>+<sp/>3)<sp/>{</highlight></codeline>
<codeline lineno="2994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44caf56a76a86602cbdeb2c4f3d00cfad21c" kindref="member">FR_NOT_ENOUGH_CORE</ref>;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(n)<sp/>buff[--i]<sp/>=<sp/>tp[--n];</highlight></codeline>
<codeline lineno="2997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>buff[--i]<sp/>=<sp/></highlight><highlight class="charliteral">&apos;/&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tp<sp/>=<sp/>buff;</highlight></codeline>
<codeline lineno="3000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3001"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_VOLUMES<sp/>&gt;=<sp/>2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*tp++<sp/>=<sp/></highlight><highlight class="charliteral">&apos;0&apos;</highlight><highlight class="normal"><sp/>+<sp/>CurrVol;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Put<sp/>drive<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*tp++<sp/>=<sp/></highlight><highlight class="charliteral">&apos;:&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="3004"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>==<sp/>len)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Root-directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*tp++<sp/>=<sp/></highlight><highlight class="charliteral">&apos;/&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="3007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Sub-directroy<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Add<sp/>stacked<sp/>path<sp/>str<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*tp++<sp/>=<sp/>buff[i++];</highlight></codeline>
<codeline lineno="3010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(i<sp/>&lt;<sp/>len);</highlight></codeline>
<codeline lineno="3011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*tp<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="3014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1aba6d6942b59f11cf285bdbfb7e38f1fa" kindref="member">FREE_BUF</ref>();</highlight></codeline>
<codeline lineno="3015"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3016"><highlight class="normal"></highlight></codeline>
<codeline lineno="3017"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>res);</highlight></codeline>
<codeline lineno="3018"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3019"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>_FS_RPATH<sp/>&gt;=<sp/>2<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3020"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>_FS_RPATH<sp/>&gt;=<sp/>1<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3021"><highlight class="normal"></highlight></codeline>
<codeline lineno="3022"><highlight class="normal"></highlight></codeline>
<codeline lineno="3023"><highlight class="normal"></highlight></codeline>
<codeline lineno="3024"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_MINIMIZE<sp/>&lt;=<sp/>2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3025"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3026"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Seek<sp/>File<sp/>R/W<sp/>Pointer<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3027"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3028"><highlight class="normal"></highlight></codeline>
<codeline lineno="3029" refid="group__filesystem_1ga5df0ac672ada972e89ef4b003e57f964" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="group__filesystem_1ga5df0ac672ada972e89ef4b003e57f964" kindref="member">f_lseek</ref><sp/>(</highlight></codeline>
<codeline lineno="3030"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_i_l" kindref="compound">FIL</ref>*<sp/>fp,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>file<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3031"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>ofs<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>File<sp/>pointer<sp/>from<sp/>top<sp/>of<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3032"><highlight class="normal">)</highlight></codeline>
<codeline lineno="3033"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3034"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="3035"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>clst,<sp/>bcs,<sp/>nsect,<sp/>ifptr;</highlight></codeline>
<codeline lineno="3036"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_FASTSEEK</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3037"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>cl,<sp/>pcl,<sp/>ncl,<sp/>tcl,<sp/>dsc,<sp/>tlen,<sp/>ulen,<sp/>*tbl;</highlight></codeline>
<codeline lineno="3038"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3039"><highlight class="normal"></highlight></codeline>
<codeline lineno="3040"><highlight class="normal"></highlight></codeline>
<codeline lineno="3041"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1aa7193f5b86c3996b5312043a0c26da5f" kindref="member">validate</ref>(fp);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>validity<sp/>of<sp/>the<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3042"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>res);</highlight></codeline>
<codeline lineno="3043"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1a32b2a186af2cab58af8114c05386b9f6" kindref="member">err</ref>)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>error<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>(<ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref>)fp-&gt;<ref refid="struct_f_i_l_1a32b2a186af2cab58af8114c05386b9f6" kindref="member">err</ref>);</highlight></codeline>
<codeline lineno="3045"><highlight class="normal"></highlight></codeline>
<codeline lineno="3046"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_FASTSEEK</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3047"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;cltbl)<sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Fast<sp/>seek<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ofs<sp/>==<sp/><ref refid="ff_8h_1aee297a9011164cf485a4df2a72758b08" kindref="member">CREATE_LINKMAP</ref>)<sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>CLMT<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tbl<sp/>=<sp/>fp-&gt;cltbl;</highlight></codeline>
<codeline lineno="3050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tlen<sp/>=<sp/>*tbl++;<sp/>ulen<sp/>=<sp/>2;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Given<sp/>table<sp/>size<sp/>and<sp/>required<sp/>table<sp/>size<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cl<sp/>=<sp/>fp-&gt;<ref refid="struct_f_i_l_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Top<sp/>of<sp/>the<sp/>chain<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(cl)<sp/>{</highlight></codeline>
<codeline lineno="3053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3054"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>a<sp/>fragment<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3055"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tcl<sp/>=<sp/>cl;<sp/>ncl<sp/>=<sp/>0;<sp/>ulen<sp/>+=<sp/>2;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Top,<sp/>length<sp/>and<sp/>used<sp/>items<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pcl<sp/>=<sp/>cl;<sp/>ncl++;</highlight></codeline>
<codeline lineno="3058"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cl<sp/>=<sp/><ref refid="ff_8c_1a65611adf1626e5e08da77cd33a98dd8b" kindref="member">get_fat</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>cl);</highlight></codeline>
<codeline lineno="3059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(cl<sp/>&lt;=<sp/>1)<sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>);</highlight></codeline>
<codeline lineno="3060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(cl<sp/>==<sp/>0xFFFFFFFF)<sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>);</highlight></codeline>
<codeline lineno="3061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(cl<sp/>==<sp/>pcl<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="3062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ulen<sp/>&lt;=<sp/>tlen)<sp/>{<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Store<sp/>the<sp/>length<sp/>and<sp/>top<sp/>of<sp/>the<sp/>fragment<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*tbl++<sp/>=<sp/>ncl;<sp/>*tbl++<sp/>=<sp/>tcl;</highlight></codeline>
<codeline lineno="3064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(cl<sp/>&lt;<sp/>fp-&gt;fs-&gt;<ref refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" kindref="member">n_fatent</ref>);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Repeat<sp/>until<sp/>end<sp/>of<sp/>chain<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*fp-&gt;cltbl<sp/>=<sp/>ulen;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>items<sp/>used<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ulen<sp/>&lt;=<sp/>tlen)</highlight></codeline>
<codeline lineno="3069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*tbl<sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Terminate<sp/>table<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44caf56a76a86602cbdeb2c4f3d00cfad21c" kindref="member">FR_NOT_ENOUGH_CORE</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Given<sp/>table<sp/>size<sp/>is<sp/>smaller<sp/>than<sp/>required<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3072"><highlight class="normal"></highlight></codeline>
<codeline lineno="3073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Fast<sp/>seek<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ofs<sp/>&gt;<sp/>fp-&gt;<ref refid="struct_f_i_l_1af70a0afd16367837984d6205cbfca308" kindref="member">fsize</ref>)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Clip<sp/>offset<sp/>at<sp/>the<sp/>file<sp/>size<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3075"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ofs<sp/>=<sp/>fp-&gt;<ref refid="struct_f_i_l_1af70a0afd16367837984d6205cbfca308" kindref="member">fsize</ref>;</highlight></codeline>
<codeline lineno="3076"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>=<sp/>ofs;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>file<sp/>pointer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ofs)<sp/>{</highlight></codeline>
<codeline lineno="3078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1ac134c1b4645be670eb5207032e714616" kindref="member">clust</ref><sp/>=<sp/>clmt_clust(fp,<sp/>ofs<sp/>-<sp/>1);</highlight></codeline>
<codeline lineno="3079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dsc<sp/>=<sp/><ref refid="ff_8c_1a7519abb60fe91f6aa1d17f64fbae123a" kindref="member">clust2sect</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1ac134c1b4645be670eb5207032e714616" kindref="member">clust</ref>);</highlight></codeline>
<codeline lineno="3080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!dsc)<sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>);</highlight></codeline>
<codeline lineno="3081"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dsc<sp/>+=<sp/>(ofs<sp/>-<sp/>1)<sp/>/<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)<sp/>&amp;<sp/>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" kindref="member">csize</ref><sp/>-<sp/>1);</highlight></codeline>
<codeline lineno="3082"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>%<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)<sp/>&amp;&amp;<sp/>dsc<sp/>!=<sp/>fp-&gt;<ref refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" kindref="member">dsect</ref>)<sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Refill<sp/>sector<sp/>cache<sp/>if<sp/>needed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3083"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_TINY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3084"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3085"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>&amp;<sp/><ref refid="ff_8h_1a5b2962e3616a1e9eb709d95f4c75c67c" kindref="member">FA__DIRTY</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Write-back<sp/>dirty<sp/>sector<sp/>cache<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" kindref="member">disk_write</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" kindref="member">drv</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1a1602edc1ba9d9ae2b583cf55f3492325" kindref="member">buf</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" kindref="member">dsect</ref>,<sp/>1)<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref>)</highlight></codeline>
<codeline lineno="3087"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>);</highlight></codeline>
<codeline lineno="3088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>&amp;=<sp/>~<ref refid="ff_8h_1a5b2962e3616a1e9eb709d95f4c75c67c" kindref="member">FA__DIRTY</ref>;</highlight></codeline>
<codeline lineno="3089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3090"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1gae55155170bc9b99f73b440b93cc1c9e2" kindref="member">disk_read</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" kindref="member">drv</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1a1602edc1ba9d9ae2b583cf55f3492325" kindref="member">buf</ref>,<sp/>dsc,<sp/>1)<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref>)<sp/><sp/></highlight><highlight class="comment">/*<sp/>Load<sp/>current<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>);</highlight></codeline>
<codeline lineno="3093"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" kindref="member">dsect</ref><sp/>=<sp/>dsc;</highlight></codeline>
<codeline lineno="3095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3098"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3099"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3100"><highlight class="normal"></highlight></codeline>
<codeline lineno="3101"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Normal<sp/>Seek<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3102"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="3103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ofs<sp/>&gt;<sp/>fp-&gt;<ref refid="struct_f_i_l_1af70a0afd16367837984d6205cbfca308" kindref="member">fsize</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>In<sp/>read-only<sp/>mode,<sp/>clip<sp/>offset<sp/>with<sp/>the<sp/>file<sp/>size<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3104"><highlight class="normal">#</highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>!<ref refid="group___f_f_c_o_n_f_i_g_1gafb8d35370cfe0c23832ac2d82e854ec6" kindref="member">_FS_READONLY</ref></highlight></codeline>
<codeline lineno="3105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>!(fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>&amp;<sp/><ref refid="ff_8h_1afa366963220c89b882c0361794020c14" kindref="member">FA_WRITE</ref>)</highlight></codeline>
<codeline lineno="3106"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)<sp/>ofs<sp/>=<sp/>fp-&gt;<ref refid="struct_f_i_l_1af70a0afd16367837984d6205cbfca308" kindref="member">fsize</ref>;</highlight></codeline>
<codeline lineno="3108"><highlight class="normal"></highlight></codeline>
<codeline lineno="3109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ifptr<sp/>=<sp/>fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref>;</highlight></codeline>
<codeline lineno="3110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>=<sp/>nsect<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="3111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(ofs)<sp/>{</highlight></codeline>
<codeline lineno="3112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bcs<sp/>=<sp/>(<ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref>)fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" kindref="member">csize</ref><sp/>*<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Cluster<sp/>size<sp/>(byte)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ifptr<sp/>&gt;<sp/>0<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="3114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(ofs<sp/>-<sp/>1)<sp/>/<sp/>bcs<sp/>&gt;=<sp/>(ifptr<sp/>-<sp/>1)<sp/>/<sp/>bcs)<sp/>{<sp/></highlight><highlight class="comment">/*<sp/>When<sp/>seek<sp/>to<sp/>same<sp/>or<sp/>following<sp/>cluster,<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>=<sp/>(ifptr<sp/>-<sp/>1)<sp/>&amp;<sp/>~(bcs<sp/>-<sp/>1);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>start<sp/>from<sp/>the<sp/>current<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ofs<sp/>-=<sp/>fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref>;</highlight></codeline>
<codeline lineno="3117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clst<sp/>=<sp/>fp-&gt;<ref refid="struct_f_i_l_1ac134c1b4645be670eb5207032e714616" kindref="member">clust</ref>;</highlight></codeline>
<codeline lineno="3118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>When<sp/>seek<sp/>to<sp/>back<sp/>cluster,<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clst<sp/>=<sp/>fp-&gt;<ref refid="struct_f_i_l_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>start<sp/>from<sp/>the<sp/>first<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3120"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>==<sp/>0)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>no<sp/>cluster<sp/>chain,<sp/>create<sp/>a<sp/>new<sp/>chain<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clst<sp/>=<sp/><ref refid="ff_8c_1acbd0a20a17c6f9b6d536490d1cc3c5ac" kindref="member">create_chain</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>0);</highlight></codeline>
<codeline lineno="3123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>==<sp/>1)<sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>);</highlight></codeline>
<codeline lineno="3124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>==<sp/>0xFFFFFFFF)<sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>);</highlight></codeline>
<codeline lineno="3125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref><sp/>=<sp/>clst;</highlight></codeline>
<codeline lineno="3126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3127"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1ac134c1b4645be670eb5207032e714616" kindref="member">clust</ref><sp/>=<sp/>clst;</highlight></codeline>
<codeline lineno="3129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>!=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="3131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(ofs<sp/>&gt;<sp/>bcs)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Cluster<sp/>following<sp/>loop<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3132"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>&amp;<sp/><ref refid="ff_8h_1afa366963220c89b882c0361794020c14" kindref="member">FA_WRITE</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>if<sp/>in<sp/>write<sp/>mode<sp/>or<sp/>not<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clst<sp/>=<sp/><ref refid="ff_8c_1acbd0a20a17c6f9b6d536490d1cc3c5ac" kindref="member">create_chain</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>clst);<sp/><sp/></highlight><highlight class="comment">/*<sp/>Force<sp/>stretch<sp/>if<sp/>in<sp/>write<sp/>mode<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>==<sp/>0)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>When<sp/>disk<sp/>gets<sp/>full,<sp/>clip<sp/>file<sp/>size<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ofs<sp/>=<sp/>bcs;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="3137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3139"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clst<sp/>=<sp/><ref refid="ff_8c_1a65611adf1626e5e08da77cd33a98dd8b" kindref="member">get_fat</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>clst);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Follow<sp/>cluster<sp/>chain<sp/>if<sp/>not<sp/>in<sp/>write<sp/>mode<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>==<sp/>0xFFFFFFFF)<sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>);</highlight></codeline>
<codeline lineno="3142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>&lt;=<sp/>1<sp/>||<sp/>clst<sp/>&gt;=<sp/>fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" kindref="member">n_fatent</ref>)<sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>);</highlight></codeline>
<codeline lineno="3143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1ac134c1b4645be670eb5207032e714616" kindref="member">clust</ref><sp/>=<sp/>clst;</highlight></codeline>
<codeline lineno="3144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>+=<sp/>bcs;</highlight></codeline>
<codeline lineno="3145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ofs<sp/>-=<sp/>bcs;</highlight></codeline>
<codeline lineno="3146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>+=<sp/>ofs;</highlight></codeline>
<codeline lineno="3148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ofs<sp/>%<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>))<sp/>{</highlight></codeline>
<codeline lineno="3149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nsect<sp/>=<sp/><ref refid="ff_8c_1a7519abb60fe91f6aa1d17f64fbae123a" kindref="member">clust2sect</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>clst);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Current<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!nsect)<sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>);</highlight></codeline>
<codeline lineno="3151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nsect<sp/>+=<sp/>ofs<sp/>/<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>);</highlight></codeline>
<codeline lineno="3152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>%<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)<sp/>&amp;&amp;<sp/>nsect<sp/>!=<sp/>fp-&gt;<ref refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" kindref="member">dsect</ref>)<sp/>{<sp/><sp/></highlight><highlight class="comment">/*<sp/>Fill<sp/>sector<sp/>cache<sp/>if<sp/>needed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3156"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_TINY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3157"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>&amp;<sp/><ref refid="ff_8h_1a5b2962e3616a1e9eb709d95f4c75c67c" kindref="member">FA__DIRTY</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Write-back<sp/>dirty<sp/>sector<sp/>cache<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" kindref="member">disk_write</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" kindref="member">drv</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1a1602edc1ba9d9ae2b583cf55f3492325" kindref="member">buf</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" kindref="member">dsect</ref>,<sp/>1)<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref>)</highlight></codeline>
<codeline lineno="3160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>);</highlight></codeline>
<codeline lineno="3161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>&amp;=<sp/>~<ref refid="ff_8h_1a5b2962e3616a1e9eb709d95f4c75c67c" kindref="member">FA__DIRTY</ref>;</highlight></codeline>
<codeline lineno="3162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3163"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1gae55155170bc9b99f73b440b93cc1c9e2" kindref="member">disk_read</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" kindref="member">drv</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1a1602edc1ba9d9ae2b583cf55f3492325" kindref="member">buf</ref>,<sp/>nsect,<sp/>1)<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref>)<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Fill<sp/>sector<sp/>cache<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>);</highlight></codeline>
<codeline lineno="3166"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" kindref="member">dsect</ref><sp/>=<sp/>nsect;</highlight></codeline>
<codeline lineno="3168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3169"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>&gt;<sp/>fp-&gt;<ref refid="struct_f_i_l_1af70a0afd16367837984d6205cbfca308" kindref="member">fsize</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>file<sp/>change<sp/>flag<sp/>if<sp/>the<sp/>file<sp/>size<sp/>is<sp/>extended<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1af70a0afd16367837984d6205cbfca308" kindref="member">fsize</ref><sp/>=<sp/>fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref>;</highlight></codeline>
<codeline lineno="3172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>|=<sp/><ref refid="ff_8h_1ac4b7d5223f84df91c306ffbff536fae4" kindref="member">FA__WRITTEN</ref>;</highlight></codeline>
<codeline lineno="3173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3174"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3175"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3176"><highlight class="normal"></highlight></codeline>
<codeline lineno="3177"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>res);</highlight></codeline>
<codeline lineno="3178"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3179"><highlight class="normal"></highlight></codeline>
<codeline lineno="3180"><highlight class="normal"></highlight></codeline>
<codeline lineno="3181"><highlight class="normal"></highlight></codeline>
<codeline lineno="3182"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_MINIMIZE<sp/>&lt;=<sp/>1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3183"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3184"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Create<sp/>a<sp/>Directory<sp/>Object<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3185"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3186"><highlight class="normal"></highlight></codeline>
<codeline lineno="3187" refid="group__filesystem_1gab63b213c75f7335fbb63a1f3f70e5fc7" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="group__filesystem_1gab63b213c75f7335fbb63a1f3f70e5fc7" kindref="member">f_opendir</ref><sp/>(</highlight></codeline>
<codeline lineno="3188"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref>*<sp/>dp,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>directory<sp/>object<sp/>to<sp/>create<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3189"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/>path<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>directory<sp/>path<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3190"><highlight class="normal">)</highlight></codeline>
<codeline lineno="3191"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3192"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="3193"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref>*<sp/>fs;</highlight></codeline>
<codeline lineno="3194"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7cc27142421bd12be623072288599791" kindref="member">DEFINE_NAMEBUF</ref>;</highlight></codeline>
<codeline lineno="3195"><highlight class="normal"></highlight></codeline>
<codeline lineno="3196"><highlight class="normal"></highlight></codeline>
<codeline lineno="3197"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!dp)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca3dec4eba481cdf5e99d7cd6009e6dcf8" kindref="member">FR_INVALID_OBJECT</ref>;</highlight></codeline>
<codeline lineno="3198"><highlight class="normal"></highlight></codeline>
<codeline lineno="3199"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>logical<sp/>drive<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3200"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" kindref="member">find_volume</ref>(&amp;fs,<sp/>&amp;path,<sp/>0);</highlight></codeline>
<codeline lineno="3201"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref><sp/>=<sp/>fs;</highlight></codeline>
<codeline lineno="3203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a966fe5792671b39db1ccf655a8c1af8d" kindref="member">INIT_BUF</ref>(*dp);</highlight></codeline>
<codeline lineno="3204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1af194524672491a522f041278b9b74e94" kindref="member">follow_path</ref>(dp,<sp/>path);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Follow<sp/>the<sp/>path<sp/>to<sp/>the<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1aba6d6942b59f11cf285bdbfb7e38f1fa" kindref="member">FREE_BUF</ref>();</highlight></codeline>
<codeline lineno="3206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Follow<sp/>completed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dp-&gt;<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>It<sp/>is<sp/>not<sp/>the<sp/>origin<sp/>directory<sp/>itself<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dp-&gt;<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>[<ref refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" kindref="member">DIR_Attr</ref>]<sp/>&amp;<sp/><ref refid="ff_8h_1a3a9db44e978ed6c13b641e092d4cd7d3" kindref="member">AM_DIR</ref>)<sp/></highlight><highlight class="comment">/*<sp/>The<sp/>object<sp/>is<sp/>a<sp/>sub<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref><sp/>=<sp/><ref refid="ff_8c_1ad1b3343c92d0f0e58ba448c3c11b1f39" kindref="member">ld_clust</ref>(fs,<sp/>dp-&gt;<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>);</highlight></codeline>
<codeline lineno="3210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>The<sp/>object<sp/>is<sp/>a<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cae4529c8cc8b59783d6efc9ba4f574532" kindref="member">FR_NO_PATH</ref>;</highlight></codeline>
<codeline lineno="3212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1a7b7a6396b2c82ad46c6d8b2bf141a8dd" kindref="member">id</ref><sp/>=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a7b7a6396b2c82ad46c6d8b2bf141a8dd" kindref="member">id</ref>;</highlight></codeline>
<codeline lineno="3215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" kindref="member">dir_sdi</ref>(dp,<sp/>0);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Rewind<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3216"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_LOCK</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dp-&gt;<ref refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;lockid<sp/>=<sp/>inc_lock(dp,<sp/>0);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Lock<sp/>the<sp/>sub<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!dp-&gt;lockid)</highlight></codeline>
<codeline lineno="3221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca50dd3c3c274ccebb2cfbddde9d065bb9" kindref="member">FR_TOO_MANY_OPEN_FILES</ref>;</highlight></codeline>
<codeline lineno="3222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;lockid<sp/>=<sp/>0;<sp/></highlight><highlight class="comment">/*<sp/>Root<sp/>directory<sp/>need<sp/>not<sp/>to<sp/>be<sp/>locked<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3226"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref>)<sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cae4529c8cc8b59783d6efc9ba4f574532" kindref="member">FR_NO_PATH</ref>;</highlight></codeline>
<codeline lineno="3230"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3231"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref><sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Invalidate<sp/>the<sp/>directory<sp/>object<sp/>if<sp/>function<sp/>faild<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3232"><highlight class="normal"></highlight></codeline>
<codeline lineno="3233"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(fs,<sp/>res);</highlight></codeline>
<codeline lineno="3234"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3235"><highlight class="normal"></highlight></codeline>
<codeline lineno="3236"><highlight class="normal"></highlight></codeline>
<codeline lineno="3237"><highlight class="normal"></highlight></codeline>
<codeline lineno="3238"><highlight class="normal"></highlight></codeline>
<codeline lineno="3239"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3240"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Close<sp/>Directory<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3241"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3242"><highlight class="normal"></highlight></codeline>
<codeline lineno="3243" refid="group__filesystem_1gab5f7376b6f3e3bcc7f5ff5497c8b7364" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="group__filesystem_1gab5f7376b6f3e3bcc7f5ff5497c8b7364" kindref="member">f_closedir</ref><sp/>(</highlight></codeline>
<codeline lineno="3244"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref><sp/>*dp<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>directory<sp/>object<sp/>to<sp/>be<sp/>closed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3245"><highlight class="normal">)</highlight></codeline>
<codeline lineno="3246"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3247"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="3248"><highlight class="normal"></highlight></codeline>
<codeline lineno="3249"><highlight class="normal"></highlight></codeline>
<codeline lineno="3250"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1aa7193f5b86c3996b5312043a0c26da5f" kindref="member">validate</ref>(dp);</highlight></codeline>
<codeline lineno="3251"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3252"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_REENTRANT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref><sp/>*fs<sp/>=<sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>;</highlight></codeline>
<codeline lineno="3254"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3255"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_LOCK</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dp-&gt;lockid)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Decrement<sp/>sub-directory<sp/>open<sp/>counter<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>dec_lock(dp-&gt;lockid);</highlight></codeline>
<codeline lineno="3258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)</highlight></codeline>
<codeline lineno="3259"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref><sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Invalidate<sp/>directory<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3261"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_REENTRANT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a58c93c453ba943336cd24aa185cd72cf" kindref="member">unlock_fs</ref>(fs,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>);<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Unlock<sp/>volume<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3263"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3264"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3265"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="3266"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3267"><highlight class="normal"></highlight></codeline>
<codeline lineno="3268"><highlight class="normal"></highlight></codeline>
<codeline lineno="3269"><highlight class="normal"></highlight></codeline>
<codeline lineno="3270"><highlight class="normal"></highlight></codeline>
<codeline lineno="3271"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3272"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Read<sp/>Directory<sp/>Entries<sp/>in<sp/>Sequence<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3273"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3274"><highlight class="normal"></highlight></codeline>
<codeline lineno="3275" refid="group__filesystem_1gab39e82a110695de45f416f3149358012" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="group__filesystem_1gab39e82a110695de45f416f3149358012" kindref="member">f_readdir</ref><sp/>(</highlight></codeline>
<codeline lineno="3276"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref>*<sp/>dp,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>open<sp/>directory<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3277"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_i_l_i_n_f_o" kindref="compound">FILINFO</ref>*<sp/>fno<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>file<sp/>information<sp/>to<sp/>return<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3278"><highlight class="normal">)</highlight></codeline>
<codeline lineno="3279"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3280"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="3281"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7cc27142421bd12be623072288599791" kindref="member">DEFINE_NAMEBUF</ref>;</highlight></codeline>
<codeline lineno="3282"><highlight class="normal"></highlight></codeline>
<codeline lineno="3283"><highlight class="normal"></highlight></codeline>
<codeline lineno="3284"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1aa7193f5b86c3996b5312043a0c26da5f" kindref="member">validate</ref>(dp);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>validity<sp/>of<sp/>the<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3285"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!fno)<sp/>{</highlight></codeline>
<codeline lineno="3287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" kindref="member">dir_sdi</ref>(dp,<sp/>0);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Rewind<sp/>the<sp/>directory<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a966fe5792671b39db1ccf655a8c1af8d" kindref="member">INIT_BUF</ref>(*dp);</highlight></codeline>
<codeline lineno="3290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a3a47a08609e77266bc1928af812e06df" kindref="member">dir_read</ref>(dp,<sp/>0);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>an<sp/>item<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Reached<sp/>end<sp/>of<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1a3e49e0860170e0fd9fc3e891b0d59975" kindref="member">sect</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="3293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>;</highlight></codeline>
<codeline lineno="3294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>A<sp/>valid<sp/>entry<sp/>is<sp/>found<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a2bc1b9d8567181c23b4720f4fb6076f5" kindref="member">get_fileinfo</ref>(dp,<sp/>fno);<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>the<sp/>object<sp/>information<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a2edd26ac71869f25be5fce12eec58171" kindref="member">dir_next</ref>(dp,<sp/>0);<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Increment<sp/>index<sp/>for<sp/>next<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp-&gt;<ref refid="struct_d_i_r_1a3e49e0860170e0fd9fc3e891b0d59975" kindref="member">sect</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="3300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>;</highlight></codeline>
<codeline lineno="3301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1aba6d6942b59f11cf285bdbfb7e38f1fa" kindref="member">FREE_BUF</ref>();</highlight></codeline>
<codeline lineno="3304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3305"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3306"><highlight class="normal"></highlight></codeline>
<codeline lineno="3307"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(dp-&gt;<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>res);</highlight></codeline>
<codeline lineno="3308"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3309"><highlight class="normal"></highlight></codeline>
<codeline lineno="3310"><highlight class="normal"></highlight></codeline>
<codeline lineno="3311"><highlight class="normal"></highlight></codeline>
<codeline lineno="3312"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_FIND</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3313"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3314"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Find<sp/>next<sp/>file<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3315"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3316"><highlight class="normal"></highlight></codeline>
<codeline lineno="3317"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="ff_8h_1a013999e446481a607316b916441f8673" kindref="member">f_findnext</ref><sp/>(</highlight></codeline>
<codeline lineno="3318"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref>*<sp/>dp,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>open<sp/>directory<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3319"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_i_l_i_n_f_o" kindref="compound">FILINFO</ref>*<sp/>fno<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>file<sp/>information<sp/>structure<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3320"><highlight class="normal">)</highlight></codeline>
<codeline lineno="3321"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3322"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="3323"><highlight class="normal"></highlight></codeline>
<codeline lineno="3324"><highlight class="normal"></highlight></codeline>
<codeline lineno="3325"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(;;)<sp/>{</highlight></codeline>
<codeline lineno="3326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="group__filesystem_1gab39e82a110695de45f416f3149358012" kindref="member">f_readdir</ref>(dp,<sp/>fno);<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>a<sp/>directory<sp/>item<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref><sp/>||<sp/>!fno<sp/>||<sp/>!fno-&gt;<ref refid="struct_f_i_l_i_n_f_o_1a7c33845207b44ca3b394052ad6724e72" kindref="member">fname</ref>[0])<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Terminate<sp/>if<sp/>any<sp/>error<sp/>or<sp/>end<sp/>of<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3328"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fno-&gt;<ref refid="struct_f_i_l_i_n_f_o_1ac40e23991a0616f2573d7856cdbba9ea" kindref="member">lfname</ref><sp/>&amp;&amp;<sp/>pattern_matching(dp-&gt;pat,<sp/>fno-&gt;<ref refid="struct_f_i_l_i_n_f_o_1ac40e23991a0616f2573d7856cdbba9ea" kindref="member">lfname</ref>,<sp/>0,<sp/>0))<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/></highlight><highlight class="comment">/*<sp/>Test<sp/>for<sp/>LFN<sp/>if<sp/>exist<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3330"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pattern_matching(dp-&gt;pat,<sp/>fno-&gt;<ref refid="struct_f_i_l_i_n_f_o_1a7c33845207b44ca3b394052ad6724e72" kindref="member">fname</ref>,<sp/>0,<sp/>0))<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/></highlight><highlight class="comment">/*<sp/>Test<sp/>for<sp/>SFN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3332"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3333"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="3334"><highlight class="normal"></highlight></codeline>
<codeline lineno="3335"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3336"><highlight class="normal"></highlight></codeline>
<codeline lineno="3337"><highlight class="normal"></highlight></codeline>
<codeline lineno="3338"><highlight class="normal"></highlight></codeline>
<codeline lineno="3339"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3340"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Find<sp/>first<sp/>file<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3341"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3342"><highlight class="normal"></highlight></codeline>
<codeline lineno="3343"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="ff_8h_1a6db7bc3d037b51a9f205eacda6177a5f" kindref="member">f_findfirst</ref><sp/>(</highlight></codeline>
<codeline lineno="3344"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref>*<sp/>dp,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>blank<sp/>directory<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3345"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_i_l_i_n_f_o" kindref="compound">FILINFO</ref>*<sp/>fno,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>file<sp/>information<sp/>structure<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3346"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/>path,<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>directory<sp/>to<sp/>open<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3347"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/>pattern<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>matching<sp/>pattern<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3348"><highlight class="normal">)</highlight></codeline>
<codeline lineno="3349"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3350"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="3351"><highlight class="normal"></highlight></codeline>
<codeline lineno="3352"><highlight class="normal"></highlight></codeline>
<codeline lineno="3353"><highlight class="normal"><sp/><sp/><sp/><sp/>dp-&gt;pat<sp/>=<sp/>pattern;<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Save<sp/>pointer<sp/>to<sp/>pattern<sp/>string<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3354"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="group__filesystem_1gab63b213c75f7335fbb63a1f3f70e5fc7" kindref="member">f_opendir</ref>(dp,<sp/>path);<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Open<sp/>the<sp/>target<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3355"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)</highlight></codeline>
<codeline lineno="3356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1a013999e446481a607316b916441f8673" kindref="member">f_findnext</ref>(dp,<sp/>fno);<sp/><sp/></highlight><highlight class="comment">/*<sp/>Find<sp/>the<sp/>first<sp/>item<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3357"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res;</highlight></codeline>
<codeline lineno="3358"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3359"><highlight class="normal"></highlight></codeline>
<codeline lineno="3360"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/><sp/></highlight><highlight class="comment">/*<sp/>_USE_FIND<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3361"><highlight class="normal"></highlight></codeline>
<codeline lineno="3362"><highlight class="normal"></highlight></codeline>
<codeline lineno="3363"><highlight class="normal"></highlight></codeline>
<codeline lineno="3364"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_MINIMIZE<sp/>==<sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3365"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3366"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Get<sp/>File<sp/>Status<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3367"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3368"><highlight class="normal"></highlight></codeline>
<codeline lineno="3369" refid="group__filesystem_1gabe1f60daab5c7d11170c334fb832c798" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="group__filesystem_1gabe1f60daab5c7d11170c334fb832c798" kindref="member">f_stat</ref><sp/>(</highlight></codeline>
<codeline lineno="3370"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/>path,<sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>file<sp/>path<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3371"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_i_l_i_n_f_o" kindref="compound">FILINFO</ref>*<sp/>fno<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>file<sp/>information<sp/>to<sp/>return<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3372"><highlight class="normal">)</highlight></codeline>
<codeline lineno="3373"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3374"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="3375"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref><sp/>dj;</highlight></codeline>
<codeline lineno="3376"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7cc27142421bd12be623072288599791" kindref="member">DEFINE_NAMEBUF</ref>;</highlight></codeline>
<codeline lineno="3377"><highlight class="normal"></highlight></codeline>
<codeline lineno="3378"><highlight class="normal"></highlight></codeline>
<codeline lineno="3379"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>logical<sp/>drive<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3380"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" kindref="member">find_volume</ref>(&amp;dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>&amp;path,<sp/>0);</highlight></codeline>
<codeline lineno="3381"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a966fe5792671b39db1ccf655a8c1af8d" kindref="member">INIT_BUF</ref>(dj);</highlight></codeline>
<codeline lineno="3383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1af194524672491a522f041278b9b74e94" kindref="member">follow_path</ref>(&amp;dj,<sp/>path);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Follow<sp/>the<sp/>file<sp/>path<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Follow<sp/>completed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dj.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Found<sp/>an<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fno)<sp/><ref refid="ff_8c_1a2bc1b9d8567181c23b4720f4fb6076f5" kindref="member">get_fileinfo</ref>(&amp;dj,<sp/>fno);</highlight></codeline>
<codeline lineno="3387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>It<sp/>is<sp/>root<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" kindref="member">FR_INVALID_NAME</ref>;</highlight></codeline>
<codeline lineno="3389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1aba6d6942b59f11cf285bdbfb7e38f1fa" kindref="member">FREE_BUF</ref>();</highlight></codeline>
<codeline lineno="3392"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3393"><highlight class="normal"></highlight></codeline>
<codeline lineno="3394"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>res);</highlight></codeline>
<codeline lineno="3395"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3396"><highlight class="normal"></highlight></codeline>
<codeline lineno="3397"><highlight class="normal"></highlight></codeline>
<codeline lineno="3398"><highlight class="normal"></highlight></codeline>
<codeline lineno="3399"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3400"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3401"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Get<sp/>Number<sp/>of<sp/>Free<sp/>Clusters<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3402"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3403"><highlight class="normal"></highlight></codeline>
<codeline lineno="3404" refid="group__filesystem_1ga0ff39f75a87cbda9cd6ea65d83f16cec" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="group__filesystem_1ga0ff39f75a87cbda9cd6ea65d83f16cec" kindref="member">f_getfree</ref><sp/>(</highlight></codeline>
<codeline lineno="3405"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/>path,<sp/><sp/></highlight><highlight class="comment">/*<sp/>Path<sp/>name<sp/>of<sp/>the<sp/>logical<sp/>drive<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3406"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref>*<sp/>nclst,<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>a<sp/>variable<sp/>to<sp/>return<sp/>number<sp/>of<sp/>free<sp/>clusters<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3407"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref>**<sp/>fatfs<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>return<sp/>pointer<sp/>to<sp/>corresponding<sp/>file<sp/>system<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3408"><highlight class="normal">)</highlight></codeline>
<codeline lineno="3409"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3410"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="3411"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref><sp/>*fs;</highlight></codeline>
<codeline lineno="3412"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>nfree,<sp/>clst,<sp/>sect,<sp/>stat;</highlight></codeline>
<codeline lineno="3413"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>i;</highlight></codeline>
<codeline lineno="3414"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>fat,<sp/>*p;</highlight></codeline>
<codeline lineno="3415"><highlight class="normal"></highlight></codeline>
<codeline lineno="3416"><highlight class="normal"></highlight></codeline>
<codeline lineno="3417"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>logical<sp/>drive<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3418"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" kindref="member">find_volume</ref>(fatfs,<sp/>&amp;path,<sp/>0);</highlight></codeline>
<codeline lineno="3419"><highlight class="normal"><sp/><sp/><sp/><sp/>fs<sp/>=<sp/>*fatfs;</highlight></codeline>
<codeline lineno="3420"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>free_clust<sp/>is<sp/>valid,<sp/>return<sp/>it<sp/>without<sp/>full<sp/>cluster<sp/>scan<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fs-&gt;<ref refid="struct_f_a_t_f_s_1a509defa217cfb2eb777ed3c74c4ef426" kindref="member">free_clust</ref><sp/>&lt;=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" kindref="member">n_fatent</ref><sp/>-<sp/>2)<sp/>{</highlight></codeline>
<codeline lineno="3423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*nclst<sp/>=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a509defa217cfb2eb777ed3c74c4ef426" kindref="member">free_clust</ref>;</highlight></codeline>
<codeline lineno="3424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>number<sp/>of<sp/>free<sp/>clusters<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fat<sp/>=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a3630ef0b29c45ef8e0c1de639efab754" kindref="member">fs_type</ref>;</highlight></codeline>
<codeline lineno="3427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nfree<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="3428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fat<sp/>==<sp/><ref refid="ff_8h_1aab755aa1b4f81f4aabee4a5d4738cfb0" kindref="member">FS_FAT12</ref>)<sp/>{<sp/><sp/></highlight><highlight class="comment">/*<sp/>Sector<sp/>unalighed<sp/>entries:<sp/>Search<sp/>FAT<sp/>via<sp/>regular<sp/>routine.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clst<sp/>=<sp/>2;</highlight></codeline>
<codeline lineno="3430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stat<sp/>=<sp/><ref refid="ff_8c_1a65611adf1626e5e08da77cd33a98dd8b" kindref="member">get_fat</ref>(fs,<sp/>clst);</highlight></codeline>
<codeline lineno="3432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(stat<sp/>==<sp/>0xFFFFFFFF)<sp/>{<sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/>}</highlight></codeline>
<codeline lineno="3433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(stat<sp/>==<sp/>1)<sp/>{<sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/>}</highlight></codeline>
<codeline lineno="3434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(stat<sp/>==<sp/>0)<sp/>nfree++;</highlight></codeline>
<codeline lineno="3435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(++clst<sp/>&lt;<sp/>fs-&gt;n_fatent);</highlight></codeline>
<codeline lineno="3436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Sector<sp/>alighed<sp/>entries:<sp/>Accelerate<sp/>the<sp/>FAT<sp/>search.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clst<sp/>=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" kindref="member">n_fatent</ref>;<sp/>sect<sp/>=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a74e60540a346de6eb9f0c13d6203efa1" kindref="member">fatbase</ref>;</highlight></codeline>
<codeline lineno="3438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/>0;<sp/>p<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="3439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!i)<sp/>{</highlight></codeline>
<codeline lineno="3441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" kindref="member">move_window</ref>(fs,<sp/>sect++);</highlight></codeline>
<codeline lineno="3442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="3443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>;</highlight></codeline>
<codeline lineno="3444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs);</highlight></codeline>
<codeline lineno="3445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fat<sp/>==<sp/><ref refid="ff_8h_1a7ef90a36d99edfc0138a2155a17a79b9" kindref="member">FS_FAT16</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" kindref="member">LD_WORD</ref>(p)<sp/>==<sp/>0)<sp/>nfree++;</highlight></codeline>
<codeline lineno="3448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>+=<sp/>2;<sp/>i<sp/>-=<sp/>2;</highlight></codeline>
<codeline lineno="3449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((<ref refid="ff_8h_1a4690304ddc975516f7dc02575c96e34e" kindref="member">LD_DWORD</ref>(p)<sp/>&amp;<sp/>0x0FFFFFFF)<sp/>==<sp/>0)<sp/>nfree++;</highlight></codeline>
<codeline lineno="3451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>+=<sp/>4;<sp/>i<sp/>-=<sp/>4;</highlight></codeline>
<codeline lineno="3452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(--clst);</highlight></codeline>
<codeline lineno="3454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a509defa217cfb2eb777ed3c74c4ef426" kindref="member">free_clust</ref><sp/>=<sp/>nfree;<sp/></highlight><highlight class="comment">/*<sp/>free_clust<sp/>is<sp/>valid<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a66c4d8e68262d5542852e2aed6ce69b4" kindref="member">fsi_flag</ref><sp/>|=<sp/>1;<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FSInfo<sp/>is<sp/>to<sp/>be<sp/>updated<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*nclst<sp/>=<sp/>nfree;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Return<sp/>the<sp/>free<sp/>clusters<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3459"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3460"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(fs,<sp/>res);</highlight></codeline>
<codeline lineno="3461"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3462"><highlight class="normal"></highlight></codeline>
<codeline lineno="3463"><highlight class="normal"></highlight></codeline>
<codeline lineno="3464"><highlight class="normal"></highlight></codeline>
<codeline lineno="3465"><highlight class="normal"></highlight></codeline>
<codeline lineno="3466"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3467"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Truncate<sp/>File<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3468"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3469"><highlight class="normal"></highlight></codeline>
<codeline lineno="3470" refid="group__filesystem_1ga691a27b40c348f7c84b42e911636f38a" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="group__filesystem_1ga691a27b40c348f7c84b42e911636f38a" kindref="member">f_truncate</ref><sp/>(</highlight></codeline>
<codeline lineno="3471"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_i_l" kindref="compound">FIL</ref>*<sp/>fp<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>file<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3472"><highlight class="normal">)</highlight></codeline>
<codeline lineno="3473"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3474"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="3475"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>ncl;</highlight></codeline>
<codeline lineno="3476"><highlight class="normal"></highlight></codeline>
<codeline lineno="3477"><highlight class="normal"></highlight></codeline>
<codeline lineno="3478"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1aa7193f5b86c3996b5312043a0c26da5f" kindref="member">validate</ref>(fp);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>validity<sp/>of<sp/>the<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3479"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1a32b2a186af2cab58af8114c05386b9f6" kindref="member">err</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>error<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/>(<ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref>)fp-&gt;<ref refid="struct_f_i_l_1a32b2a186af2cab58af8114c05386b9f6" kindref="member">err</ref>;</highlight></codeline>
<codeline lineno="3482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!(fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>&amp;<sp/><ref refid="ff_8h_1afa366963220c89b882c0361794020c14" kindref="member">FA_WRITE</ref>))<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>access<sp/>mode<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d" kindref="member">FR_DENIED</ref>;</highlight></codeline>
<codeline lineno="3485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3486"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3487"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1af70a0afd16367837984d6205cbfca308" kindref="member">fsize</ref><sp/>&gt;<sp/>fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1af70a0afd16367837984d6205cbfca308" kindref="member">fsize</ref><sp/>=<sp/>fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>file<sp/>size<sp/>to<sp/>current<sp/>R/W<sp/>point<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>|=<sp/><ref refid="ff_8h_1ac4b7d5223f84df91c306ffbff536fae4" kindref="member">FA__WRITTEN</ref>;</highlight></codeline>
<codeline lineno="3491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>==<sp/>0)<sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>When<sp/>set<sp/>file<sp/>size<sp/>to<sp/>zero,<sp/>remove<sp/>entire<sp/>cluster<sp/>chain<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1ab88651d19a5597dec220fe7538cccf23" kindref="member">remove_chain</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref>);</highlight></codeline>
<codeline lineno="3493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="3494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>When<sp/>truncate<sp/>a<sp/>part<sp/>of<sp/>the<sp/>file,<sp/>remove<sp/>remaining<sp/>clusters<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ncl<sp/>=<sp/><ref refid="ff_8c_1a65611adf1626e5e08da77cd33a98dd8b" kindref="member">get_fat</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1ac134c1b4645be670eb5207032e714616" kindref="member">clust</ref>);</highlight></codeline>
<codeline lineno="3496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>;</highlight></codeline>
<codeline lineno="3497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ncl<sp/>==<sp/>0xFFFFFFFF)<sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>;</highlight></codeline>
<codeline lineno="3498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ncl<sp/>==<sp/>1)<sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>;</highlight></codeline>
<codeline lineno="3499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref><sp/>&amp;&amp;<sp/>ncl<sp/>&lt;<sp/>fp-&gt;fs-&gt;<ref refid="struct_f_a_t_f_s_1a388eb0fa0f3f1449a6ab88c6674e16fc" kindref="member">n_fatent</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1abd4b6b071a8d728a88727051c12bc6d7" kindref="member">put_fat</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1ac134c1b4645be670eb5207032e714616" kindref="member">clust</ref>,<sp/>0x0FFFFFFF);</highlight></codeline>
<codeline lineno="3501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>res<sp/>=<sp/><ref refid="ff_8c_1ab88651d19a5597dec220fe7538cccf23" kindref="member">remove_chain</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>ncl);</highlight></codeline>
<codeline lineno="3502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3504"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_TINY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref><sp/>&amp;&amp;<sp/>(fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>&amp;<sp/><ref refid="ff_8h_1a5b2962e3616a1e9eb709d95f4c75c67c" kindref="member">FA__DIRTY</ref>))<sp/>{</highlight></codeline>
<codeline lineno="3506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" kindref="member">disk_write</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1af46443bf86aaaff8d411814ed640e831" kindref="member">drv</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1a1602edc1ba9d9ae2b583cf55f3492325" kindref="member">buf</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" kindref="member">dsect</ref>,<sp/>1)<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref>)</highlight></codeline>
<codeline lineno="3507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>;</highlight></codeline>
<codeline lineno="3508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>&amp;=<sp/>~<ref refid="ff_8h_1a5b2962e3616a1e9eb709d95f4c75c67c" kindref="member">FA__DIRTY</ref>;</highlight></codeline>
<codeline lineno="3510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3511"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>fp-&gt;<ref refid="struct_f_i_l_1a32b2a186af2cab58af8114c05386b9f6" kindref="member">err</ref><sp/>=<sp/>(<ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref>)res;</highlight></codeline>
<codeline lineno="3514"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3515"><highlight class="normal"></highlight></codeline>
<codeline lineno="3516"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>res);</highlight></codeline>
<codeline lineno="3517"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3518"><highlight class="normal"></highlight></codeline>
<codeline lineno="3519"><highlight class="normal"></highlight></codeline>
<codeline lineno="3520"><highlight class="normal"></highlight></codeline>
<codeline lineno="3521"><highlight class="normal"></highlight></codeline>
<codeline lineno="3522"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3523"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Delete<sp/>a<sp/>File<sp/>or<sp/>Directory<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3524"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3525"><highlight class="normal"></highlight></codeline>
<codeline lineno="3526" refid="group__filesystem_1ga2858167fcd0bced48e9be434b3895efe" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="group__filesystem_1ga2858167fcd0bced48e9be434b3895efe" kindref="member">f_unlink</ref><sp/>(</highlight></codeline>
<codeline lineno="3527"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/>path<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>file<sp/>or<sp/>directory<sp/>path<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3528"><highlight class="normal">)</highlight></codeline>
<codeline lineno="3529"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3530"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="3531"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref><sp/>dj,<sp/>sdj;</highlight></codeline>
<codeline lineno="3532"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>*dir;</highlight></codeline>
<codeline lineno="3533"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>dclst<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="3534"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7cc27142421bd12be623072288599791" kindref="member">DEFINE_NAMEBUF</ref>;</highlight></codeline>
<codeline lineno="3535"><highlight class="normal"></highlight></codeline>
<codeline lineno="3536"><highlight class="normal"></highlight></codeline>
<codeline lineno="3537"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>logical<sp/>drive<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3538"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" kindref="member">find_volume</ref>(&amp;dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>&amp;path,<sp/>1);</highlight></codeline>
<codeline lineno="3539"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a966fe5792671b39db1ccf655a8c1af8d" kindref="member">INIT_BUF</ref>(dj);</highlight></codeline>
<codeline lineno="3541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1af194524672491a522f041278b9b74e94" kindref="member">follow_path</ref>(&amp;dj,<sp/>path);<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Follow<sp/>the<sp/>file<sp/>path<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___f_f_c_o_n_f_i_g_1ga52faf11025401372f71e9d81905b7af4" kindref="member">_FS_RPATH</ref><sp/>&amp;&amp;<sp/>res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref><sp/>&amp;&amp;<sp/>(dj.<ref refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" kindref="member">fn</ref>[<ref refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" kindref="member">NSFLAG</ref>]<sp/>&amp;<sp/><ref refid="ff_8c_1a2db528782a021797b34bdc6e9e9de1c3" kindref="member">NS_DOT</ref>))</highlight></codeline>
<codeline lineno="3543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" kindref="member">FR_INVALID_NAME</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Cannot<sp/>remove<sp/>dot<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3544"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_LOCK</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>res<sp/>=<sp/>chk_lock(&amp;dj,<sp/>2);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Cannot<sp/>remove<sp/>open<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3546"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>The<sp/>object<sp/>is<sp/>accessible<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dir<sp/>=<sp/>dj.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>;</highlight></codeline>
<codeline lineno="3549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!dir)<sp/>{</highlight></codeline>
<codeline lineno="3550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" kindref="member">FR_INVALID_NAME</ref>;<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Cannot<sp/>remove<sp/>the<sp/>origin<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dir[<ref refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" kindref="member">DIR_Attr</ref>]<sp/>&amp;<sp/><ref refid="ff_8h_1add6d85d1e7a02b4f6188783ef91a5f1e" kindref="member">AM_RDO</ref>)</highlight></codeline>
<codeline lineno="3553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d" kindref="member">FR_DENIED</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Cannot<sp/>remove<sp/>R/O<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dclst<sp/>=<sp/><ref refid="ff_8c_1ad1b3343c92d0f0e58ba448c3c11b1f39" kindref="member">ld_clust</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>dir);</highlight></codeline>
<codeline lineno="3557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dclst<sp/>&amp;&amp;<sp/>(dir[<ref refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" kindref="member">DIR_Attr</ref>]<sp/>&amp;<sp/><ref refid="ff_8h_1a3a9db44e978ed6c13b641e092d4cd7d3" kindref="member">AM_DIR</ref>))<sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Is<sp/>it<sp/>a<sp/>sub-directory<sp/>?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3558"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_RPATH</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dclst<sp/>==<sp/>dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;cdir)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Is<sp/>it<sp/>the<sp/>current<sp/>directory?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d" kindref="member">FR_DENIED</ref>;</highlight></codeline>
<codeline lineno="3561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3562"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="3564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a8941d573d16af92c8570950d53164f30" kindref="member">mem_cpy</ref>(&amp;sdj,<sp/>&amp;dj,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="struct_d_i_r" kindref="compound">DIR</ref>));<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Open<sp/>the<sp/>sub-directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sdj.<ref refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref><sp/>=<sp/>dclst;</highlight></codeline>
<codeline lineno="3566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" kindref="member">dir_sdi</ref>(&amp;sdj,<sp/>2);</highlight></codeline>
<codeline lineno="3567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a3a47a08609e77266bc1928af812e06df" kindref="member">dir_read</ref>(&amp;sdj,<sp/>0);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>an<sp/>item<sp/>(excluding<sp/>dot<sp/>entries)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d" kindref="member">FR_DENIED</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Not<sp/>empty?<sp/>(cannot<sp/>remove)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref>)<sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>;<sp/></highlight><highlight class="comment">/*<sp/>Empty?<sp/>(can<sp/>remove)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a724c260af4783a0ecf0db8d0687e7bd6" kindref="member">dir_remove</ref>(&amp;dj);<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Remove<sp/>the<sp/>directory<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref><sp/>&amp;&amp;<sp/>dclst)<sp/><sp/></highlight><highlight class="comment">/*<sp/>Remove<sp/>the<sp/>cluster<sp/>chain<sp/>if<sp/>exist<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1ab88651d19a5597dec220fe7538cccf23" kindref="member">remove_chain</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>dclst);</highlight></codeline>
<codeline lineno="3579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>res<sp/>=<sp/><ref refid="ff_8c_1aec6b108298553219ebb2b960b528459d" kindref="member">sync_fs</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>);</highlight></codeline>
<codeline lineno="3580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1aba6d6942b59f11cf285bdbfb7e38f1fa" kindref="member">FREE_BUF</ref>();</highlight></codeline>
<codeline lineno="3583"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3584"><highlight class="normal"></highlight></codeline>
<codeline lineno="3585"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>res);</highlight></codeline>
<codeline lineno="3586"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3587"><highlight class="normal"></highlight></codeline>
<codeline lineno="3588"><highlight class="normal"></highlight></codeline>
<codeline lineno="3589"><highlight class="normal"></highlight></codeline>
<codeline lineno="3590"><highlight class="normal"></highlight></codeline>
<codeline lineno="3591"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3592"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Create<sp/>a<sp/>Directory<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3593"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3594"><highlight class="normal"></highlight></codeline>
<codeline lineno="3595" refid="group__filesystem_1ga4b4d38db58e89c526cfcf53200d719d0" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="group__filesystem_1ga4b4d38db58e89c526cfcf53200d719d0" kindref="member">f_mkdir</ref><sp/>(</highlight></codeline>
<codeline lineno="3596"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/>path<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>directory<sp/>path<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3597"><highlight class="normal">)</highlight></codeline>
<codeline lineno="3598"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3599"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="3600"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref><sp/>dj;</highlight></codeline>
<codeline lineno="3601"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>*dir,<sp/>n;</highlight></codeline>
<codeline lineno="3602"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>dsc,<sp/>dcl,<sp/>pcl,<sp/>tm<sp/>=<sp/><ref refid="ff_8c_1a72589f5bbb514c0b222ab8b292764418" kindref="member">GET_FATTIME</ref>();</highlight></codeline>
<codeline lineno="3603"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7cc27142421bd12be623072288599791" kindref="member">DEFINE_NAMEBUF</ref>;</highlight></codeline>
<codeline lineno="3604"><highlight class="normal"></highlight></codeline>
<codeline lineno="3605"><highlight class="normal"></highlight></codeline>
<codeline lineno="3606"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>logical<sp/>drive<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3607"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" kindref="member">find_volume</ref>(&amp;dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>&amp;path,<sp/>1);</highlight></codeline>
<codeline lineno="3608"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a966fe5792671b39db1ccf655a8c1af8d" kindref="member">INIT_BUF</ref>(dj);</highlight></codeline>
<codeline lineno="3610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1af194524672491a522f041278b9b74e94" kindref="member">follow_path</ref>(&amp;dj,<sp/>path);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Follow<sp/>the<sp/>file<sp/>path<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca0d8f024d256df76e84782b95018a2450" kindref="member">FR_EXIST</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Any<sp/>object<sp/>with<sp/>same<sp/>name<sp/>is<sp/>already<sp/>existing<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___f_f_c_o_n_f_i_g_1ga52faf11025401372f71e9d81905b7af4" kindref="member">_FS_RPATH</ref><sp/>&amp;&amp;<sp/>res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref><sp/>&amp;&amp;<sp/>(dj.<ref refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" kindref="member">fn</ref>[<ref refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" kindref="member">NSFLAG</ref>]<sp/>&amp;<sp/><ref refid="ff_8c_1a2db528782a021797b34bdc6e9e9de1c3" kindref="member">NS_DOT</ref>))</highlight></codeline>
<codeline lineno="3613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" kindref="member">FR_INVALID_NAME</ref>;</highlight></codeline>
<codeline lineno="3614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Can<sp/>create<sp/>a<sp/>new<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dcl<sp/>=<sp/><ref refid="ff_8c_1acbd0a20a17c6f9b6d536490d1cc3c5ac" kindref="member">create_chain</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>0);<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Allocate<sp/>a<sp/>cluster<sp/>for<sp/>the<sp/>new<sp/>directory<sp/>table<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>;</highlight></codeline>
<codeline lineno="3617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dcl<sp/>==<sp/>0)<sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d" kindref="member">FR_DENIED</ref>;<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>No<sp/>space<sp/>to<sp/>allocate<sp/>a<sp/>new<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dcl<sp/>==<sp/>1)<sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>;</highlight></codeline>
<codeline lineno="3619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dcl<sp/>==<sp/>0xFFFFFFFF)<sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>;</highlight></codeline>
<codeline lineno="3620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Flush<sp/>FAT<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a5e18753404354b210096f9af99e31bc1" kindref="member">sync_window</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>);</highlight></codeline>
<codeline lineno="3622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Initialize<sp/>the<sp/>new<sp/>directory<sp/>table<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dsc<sp/>=<sp/><ref refid="ff_8c_1a7519abb60fe91f6aa1d17f64fbae123a" kindref="member">clust2sect</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>dcl);</highlight></codeline>
<codeline lineno="3624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dir<sp/>=<sp/>dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>;</highlight></codeline>
<codeline lineno="3625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a02eb5189e43056a9ddc8a59cbe89be93" kindref="member">mem_set</ref>(dir,<sp/>0,<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>));</highlight></codeline>
<codeline lineno="3626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a02eb5189e43056a9ddc8a59cbe89be93" kindref="member">mem_set</ref>(dir<sp/>+<sp/><ref refid="ff_8c_1afa89348e9fc2de82ae9e12c661366b0e" kindref="member">DIR_Name</ref>,<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">,<sp/>11);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>&quot;.&quot;<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dir[<ref refid="ff_8c_1afa89348e9fc2de82ae9e12c661366b0e" kindref="member">DIR_Name</ref>]<sp/>=<sp/></highlight><highlight class="charliteral">&apos;.&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="3628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dir[<ref refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" kindref="member">DIR_Attr</ref>]<sp/>=<sp/><ref refid="ff_8h_1a3a9db44e978ed6c13b641e092d4cd7d3" kindref="member">AM_DIR</ref>;</highlight></codeline>
<codeline lineno="3629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(dir<sp/>+<sp/><ref refid="ff_8c_1ab9452d336adeece2a1b0b54ab35b8a59" kindref="member">DIR_WrtTime</ref>,<sp/>tm);</highlight></codeline>
<codeline lineno="3630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a357e5a36452e057d68378c98cd61018c" kindref="member">st_clust</ref>(dir,<sp/>dcl);</highlight></codeline>
<codeline lineno="3631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a8941d573d16af92c8570950d53164f30" kindref="member">mem_cpy</ref>(dir<sp/>+<sp/><ref refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" kindref="member">SZ_DIRE</ref>,<sp/>dir,<sp/><ref refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" kindref="member">SZ_DIRE</ref>);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>&quot;..&quot;<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dir[<ref refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" kindref="member">SZ_DIRE</ref><sp/>+<sp/>1]<sp/>=<sp/></highlight><highlight class="charliteral">&apos;.&apos;</highlight><highlight class="normal">;<sp/>pcl<sp/>=<sp/>dj.<ref refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref>;</highlight></codeline>
<codeline lineno="3633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1a3630ef0b29c45ef8e0c1de639efab754" kindref="member">fs_type</ref><sp/>==<sp/><ref refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" kindref="member">FS_FAT32</ref><sp/>&amp;&amp;<sp/>pcl<sp/>==<sp/>dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1aebfa6556d8f94e951a8b2c1eb740e9a1" kindref="member">dirbase</ref>)</highlight></codeline>
<codeline lineno="3634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pcl<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="3635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a357e5a36452e057d68378c98cd61018c" kindref="member">st_clust</ref>(dir<sp/>+<sp/><ref refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" kindref="member">SZ_DIRE</ref>,<sp/>pcl);</highlight></codeline>
<codeline lineno="3636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(n<sp/>=<sp/>dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" kindref="member">csize</ref>;<sp/>n;<sp/>n--)<sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Write<sp/>dot<sp/>entries<sp/>and<sp/>clear<sp/>following<sp/>sectors<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1a285dc1de6874bb5f0c41c328c9433e14" kindref="member">winsect</ref><sp/>=<sp/>dsc++;</highlight></codeline>
<codeline lineno="3638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" kindref="member">wflag</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="3639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a5e18753404354b210096f9af99e31bc1" kindref="member">sync_window</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>);</highlight></codeline>
<codeline lineno="3640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="3641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a02eb5189e43056a9ddc8a59cbe89be93" kindref="member">mem_set</ref>(dir,<sp/>0,<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>));</highlight></codeline>
<codeline lineno="3642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>res<sp/>=<sp/><ref refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" kindref="member">dir_register</ref>(&amp;dj);<sp/><sp/></highlight><highlight class="comment">/*<sp/>Register<sp/>the<sp/>object<sp/>to<sp/>the<sp/>directoy<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1ab88651d19a5597dec220fe7538cccf23" kindref="member">remove_chain</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>dcl);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Could<sp/>not<sp/>register,<sp/>remove<sp/>cluster<sp/>chain<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dir<sp/>=<sp/>dj.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>;</highlight></codeline>
<codeline lineno="3649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dir[<ref refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" kindref="member">DIR_Attr</ref>]<sp/>=<sp/><ref refid="ff_8h_1a3a9db44e978ed6c13b641e092d4cd7d3" kindref="member">AM_DIR</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Attribute<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(dir<sp/>+<sp/><ref refid="ff_8c_1ab9452d336adeece2a1b0b54ab35b8a59" kindref="member">DIR_WrtTime</ref>,<sp/>tm);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Created<sp/>time<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a357e5a36452e057d68378c98cd61018c" kindref="member">st_clust</ref>(dir,<sp/>dcl);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Table<sp/>start<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" kindref="member">wflag</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="3653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1aec6b108298553219ebb2b960b528459d" kindref="member">sync_fs</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>);</highlight></codeline>
<codeline lineno="3654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1aba6d6942b59f11cf285bdbfb7e38f1fa" kindref="member">FREE_BUF</ref>();</highlight></codeline>
<codeline lineno="3657"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3658"><highlight class="normal"></highlight></codeline>
<codeline lineno="3659"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>res);</highlight></codeline>
<codeline lineno="3660"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3661"><highlight class="normal"></highlight></codeline>
<codeline lineno="3662"><highlight class="normal"></highlight></codeline>
<codeline lineno="3663"><highlight class="normal"></highlight></codeline>
<codeline lineno="3664"><highlight class="normal"></highlight></codeline>
<codeline lineno="3665"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3666"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Change<sp/>Attribute<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3667"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3668"><highlight class="normal"></highlight></codeline>
<codeline lineno="3669" refid="group__filesystem_1ga9ee7e560eec8d82755c636ae41e702cd" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="group__filesystem_1ga9ee7e560eec8d82755c636ae41e702cd" kindref="member">f_chmod</ref><sp/>(</highlight></codeline>
<codeline lineno="3670"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/>path,<sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>file<sp/>path<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3671"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>attr,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Attribute<sp/>bits<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3672"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>mask<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Attribute<sp/>mask<sp/>to<sp/>change<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3673"><highlight class="normal">)</highlight></codeline>
<codeline lineno="3674"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3675"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="3676"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref><sp/>dj;</highlight></codeline>
<codeline lineno="3677"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>*dir;</highlight></codeline>
<codeline lineno="3678"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7cc27142421bd12be623072288599791" kindref="member">DEFINE_NAMEBUF</ref>;</highlight></codeline>
<codeline lineno="3679"><highlight class="normal"></highlight></codeline>
<codeline lineno="3680"><highlight class="normal"></highlight></codeline>
<codeline lineno="3681"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" kindref="member">find_volume</ref>(&amp;dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>&amp;path,<sp/>1);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>logical<sp/>drive<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3682"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a966fe5792671b39db1ccf655a8c1af8d" kindref="member">INIT_BUF</ref>(dj);</highlight></codeline>
<codeline lineno="3684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1af194524672491a522f041278b9b74e94" kindref="member">follow_path</ref>(&amp;dj,<sp/>path);<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Follow<sp/>the<sp/>file<sp/>path<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1aba6d6942b59f11cf285bdbfb7e38f1fa" kindref="member">FREE_BUF</ref>();</highlight></codeline>
<codeline lineno="3686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___f_f_c_o_n_f_i_g_1ga52faf11025401372f71e9d81905b7af4" kindref="member">_FS_RPATH</ref><sp/>&amp;&amp;<sp/>res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref><sp/>&amp;&amp;<sp/>(dj.<ref refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" kindref="member">fn</ref>[<ref refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" kindref="member">NSFLAG</ref>]<sp/>&amp;<sp/><ref refid="ff_8c_1a2db528782a021797b34bdc6e9e9de1c3" kindref="member">NS_DOT</ref>))</highlight></codeline>
<codeline lineno="3687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" kindref="member">FR_INVALID_NAME</ref>;</highlight></codeline>
<codeline lineno="3688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dir<sp/>=<sp/>dj.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>;</highlight></codeline>
<codeline lineno="3690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!dir)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Is<sp/>it<sp/>a<sp/>root<sp/>directory?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" kindref="member">FR_INVALID_NAME</ref>;</highlight></codeline>
<codeline lineno="3692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>File<sp/>or<sp/>sub<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mask<sp/>&amp;=<sp/><ref refid="ff_8h_1add6d85d1e7a02b4f6188783ef91a5f1e" kindref="member">AM_RDO</ref>|<ref refid="ff_8h_1aa90c4c921c1955fd407d8bbf17f1674e" kindref="member">AM_HID</ref>|<ref refid="ff_8h_1a1f25d5c17b5a3a6397b3398add8cdc15" kindref="member">AM_SYS</ref>|<ref refid="ff_8h_1ae8174d00798e34e7c9e95898cb9e1a09" kindref="member">AM_ARC</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Valid<sp/>attribute<sp/>mask<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dir[<ref refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" kindref="member">DIR_Attr</ref>]<sp/>=<sp/>(attr<sp/>&amp;<sp/>mask)<sp/>|<sp/>(dir[<ref refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" kindref="member">DIR_Attr</ref>]<sp/>&amp;<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)~mask);<sp/><sp/></highlight><highlight class="comment">/*<sp/>Apply<sp/>attribute<sp/>change<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" kindref="member">wflag</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="3696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1aec6b108298553219ebb2b960b528459d" kindref="member">sync_fs</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>);</highlight></codeline>
<codeline lineno="3697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3699"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3700"><highlight class="normal"></highlight></codeline>
<codeline lineno="3701"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>res);</highlight></codeline>
<codeline lineno="3702"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3703"><highlight class="normal"></highlight></codeline>
<codeline lineno="3704"><highlight class="normal"></highlight></codeline>
<codeline lineno="3705"><highlight class="normal"></highlight></codeline>
<codeline lineno="3706"><highlight class="normal"></highlight></codeline>
<codeline lineno="3707"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3708"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Rename<sp/>File/Directory<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3709"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3710"><highlight class="normal"></highlight></codeline>
<codeline lineno="3711" refid="group__filesystem_1ga2d0ceea336edd9b05754c8684ea8a72f" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="group__filesystem_1ga2d0ceea336edd9b05754c8684ea8a72f" kindref="member">f_rename</ref><sp/>(</highlight></codeline>
<codeline lineno="3712"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/>path_old,<sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>object<sp/>to<sp/>be<sp/>renamed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3713"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/>path_new<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>new<sp/>name<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3714"><highlight class="normal">)</highlight></codeline>
<codeline lineno="3715"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3716"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="3717"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref><sp/>djo,<sp/>djn;</highlight></codeline>
<codeline lineno="3718"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>buf[21],<sp/>*dir;</highlight></codeline>
<codeline lineno="3719"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>dw;</highlight></codeline>
<codeline lineno="3720"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7cc27142421bd12be623072288599791" kindref="member">DEFINE_NAMEBUF</ref>;</highlight></codeline>
<codeline lineno="3721"><highlight class="normal"></highlight></codeline>
<codeline lineno="3722"><highlight class="normal"></highlight></codeline>
<codeline lineno="3723"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>logical<sp/>drive<sp/>number<sp/>of<sp/>the<sp/>source<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3724"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" kindref="member">find_volume</ref>(&amp;djo.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>&amp;path_old,<sp/>1);</highlight></codeline>
<codeline lineno="3725"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>djn.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref><sp/>=<sp/>djo.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>;</highlight></codeline>
<codeline lineno="3727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a966fe5792671b39db1ccf655a8c1af8d" kindref="member">INIT_BUF</ref>(djo);</highlight></codeline>
<codeline lineno="3728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1af194524672491a522f041278b9b74e94" kindref="member">follow_path</ref>(&amp;djo,<sp/>path_old);<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>old<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___f_f_c_o_n_f_i_g_1ga52faf11025401372f71e9d81905b7af4" kindref="member">_FS_RPATH</ref><sp/>&amp;&amp;<sp/>res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref><sp/>&amp;&amp;<sp/>(djo.<ref refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" kindref="member">fn</ref>[<ref refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" kindref="member">NSFLAG</ref>]<sp/>&amp;<sp/><ref refid="ff_8c_1a2db528782a021797b34bdc6e9e9de1c3" kindref="member">NS_DOT</ref>))</highlight></codeline>
<codeline lineno="3730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" kindref="member">FR_INVALID_NAME</ref>;</highlight></codeline>
<codeline lineno="3731"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_FS_LOCK</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>res<sp/>=<sp/>chk_lock(&amp;djo,<sp/>2);</highlight></codeline>
<codeline lineno="3733"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Old<sp/>object<sp/>is<sp/>found<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!djo.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Is<sp/>root<sp/>dir?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref>;</highlight></codeline>
<codeline lineno="3737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a8941d573d16af92c8570950d53164f30" kindref="member">mem_cpy</ref>(buf,<sp/>djo.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref><sp/>+<sp/><ref refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" kindref="member">DIR_Attr</ref>,<sp/>21);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Save<sp/>information<sp/>about<sp/>object<sp/>except<sp/>name<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a8941d573d16af92c8570950d53164f30" kindref="member">mem_cpy</ref>(&amp;djn,<sp/>&amp;djo,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="struct_d_i_r" kindref="compound">DIR</ref>));<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Duplicate<sp/>the<sp/>directory<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1a88ad7e4b1bc98d1a2673a136283dc7ee" kindref="member">get_ldnumber</ref>(&amp;path_new)<sp/>&gt;=<sp/>0)<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Snip<sp/>drive<sp/>number<sp/>off<sp/>and<sp/>ignore<sp/>it<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1af194524672491a522f041278b9b74e94" kindref="member">follow_path</ref>(&amp;djn,<sp/>path_new);<sp/><sp/></highlight><highlight class="comment">/*<sp/>and<sp/>make<sp/>sure<sp/>if<sp/>new<sp/>object<sp/>name<sp/>is<sp/>not<sp/>conflicting<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca487844af77de15f6932a3b41ef3a2d65" kindref="member">FR_INVALID_DRIVE</ref>;</highlight></codeline>
<codeline lineno="3744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca0d8f024d256df76e84782b95018a2450" kindref="member">FR_EXIST</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>The<sp/>new<sp/>object<sp/>name<sp/>is<sp/>already<sp/>existing<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>It<sp/>is<sp/>a<sp/>valid<sp/>path<sp/>and<sp/>no<sp/>name<sp/>collision<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1aaff1b52e1f7ae47b4aedad795d7e7e64" kindref="member">dir_register</ref>(&amp;djn);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Register<sp/>the<sp/>new<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3748"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Start<sp/>of<sp/>critical<sp/>section<sp/>where<sp/>any<sp/>interruption<sp/>can<sp/>cause<sp/>a<sp/>cross-link<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dir<sp/>=<sp/>djn.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Copy<sp/>information<sp/>about<sp/>object<sp/>except<sp/>name<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a8941d573d16af92c8570950d53164f30" kindref="member">mem_cpy</ref>(dir<sp/>+<sp/>13,<sp/>buf<sp/>+<sp/>2,<sp/>19);</highlight></codeline>
<codeline lineno="3751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dir[<ref refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" kindref="member">DIR_Attr</ref>]<sp/>=<sp/>buf[0]<sp/>|<sp/><ref refid="ff_8h_1ae8174d00798e34e7c9e95898cb9e1a09" kindref="member">AM_ARC</ref>;</highlight></codeline>
<codeline lineno="3752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>djo.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" kindref="member">wflag</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="3753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((dir[<ref refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" kindref="member">DIR_Attr</ref>]<sp/>&amp;<sp/><ref refid="ff_8h_1a3a9db44e978ed6c13b641e092d4cd7d3" kindref="member">AM_DIR</ref>)<sp/>&amp;&amp;<sp/>djo.<ref refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref><sp/>!=<sp/>djn.<ref refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref>)<sp/>{<sp/></highlight><highlight class="comment">/*<sp/>Update<sp/>..<sp/>entry<sp/>in<sp/>the<sp/>sub-directory<sp/>if<sp/>needed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dw<sp/>=<sp/><ref refid="ff_8c_1a7519abb60fe91f6aa1d17f64fbae123a" kindref="member">clust2sect</ref>(djo.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8c_1ad1b3343c92d0f0e58ba448c3c11b1f39" kindref="member">ld_clust</ref>(djo.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>dir));</highlight></codeline>
<codeline lineno="3755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!dw)<sp/>{</highlight></codeline>
<codeline lineno="3756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>;</highlight></codeline>
<codeline lineno="3757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" kindref="member">move_window</ref>(djo.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>dw);</highlight></codeline>
<codeline lineno="3759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dir<sp/>=<sp/>djo.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref><sp/>+<sp/><ref refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" kindref="member">SZ_DIRE</ref><sp/>*<sp/>1;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Ptr<sp/>to<sp/>..<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref><sp/>&amp;&amp;<sp/>dir[1]<sp/>==<sp/></highlight><highlight class="charliteral">&apos;.&apos;</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="3761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a357e5a36452e057d68378c98cd61018c" kindref="member">st_clust</ref>(dir,<sp/>djn.<ref refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref>);</highlight></codeline>
<codeline lineno="3762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>djo.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" kindref="member">wflag</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="3763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a724c260af4783a0ecf0db8d0687e7bd6" kindref="member">dir_remove</ref>(&amp;djo);<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Remove<sp/>old<sp/>entry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)</highlight></codeline>
<codeline lineno="3769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1aec6b108298553219ebb2b960b528459d" kindref="member">sync_fs</ref>(djo.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>);</highlight></codeline>
<codeline lineno="3770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3771"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>End<sp/>of<sp/>critical<sp/>section<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3775"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1aba6d6942b59f11cf285bdbfb7e38f1fa" kindref="member">FREE_BUF</ref>();</highlight></codeline>
<codeline lineno="3777"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3778"><highlight class="normal"></highlight></codeline>
<codeline lineno="3779"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(djo.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>res);</highlight></codeline>
<codeline lineno="3780"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3781"><highlight class="normal"></highlight></codeline>
<codeline lineno="3782"><highlight class="normal"></highlight></codeline>
<codeline lineno="3783"><highlight class="normal"></highlight></codeline>
<codeline lineno="3784"><highlight class="normal"></highlight></codeline>
<codeline lineno="3785"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3786"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Change<sp/>Timestamp<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3787"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3788"><highlight class="normal"></highlight></codeline>
<codeline lineno="3789" refid="group__filesystem_1gaafaa718d1a487e12a8f0087173dba0b9" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="group__filesystem_1gaafaa718d1a487e12a8f0087173dba0b9" kindref="member">f_utime</ref><sp/>(</highlight></codeline>
<codeline lineno="3790"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/>path,<sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>file/directory<sp/>name<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3791"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_f_i_l_i_n_f_o" kindref="compound">FILINFO</ref>*<sp/>fno<sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>time<sp/>stamp<sp/>to<sp/>be<sp/>set<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3792"><highlight class="normal">)</highlight></codeline>
<codeline lineno="3793"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3794"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="3795"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref><sp/>dj;</highlight></codeline>
<codeline lineno="3796"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>*dir;</highlight></codeline>
<codeline lineno="3797"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7cc27142421bd12be623072288599791" kindref="member">DEFINE_NAMEBUF</ref>;</highlight></codeline>
<codeline lineno="3798"><highlight class="normal"></highlight></codeline>
<codeline lineno="3799"><highlight class="normal"></highlight></codeline>
<codeline lineno="3800"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>logical<sp/>drive<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3801"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" kindref="member">find_volume</ref>(&amp;dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>&amp;path,<sp/>1);</highlight></codeline>
<codeline lineno="3802"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a966fe5792671b39db1ccf655a8c1af8d" kindref="member">INIT_BUF</ref>(dj);</highlight></codeline>
<codeline lineno="3804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1af194524672491a522f041278b9b74e94" kindref="member">follow_path</ref>(&amp;dj,<sp/>path);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Follow<sp/>the<sp/>file<sp/>path<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1aba6d6942b59f11cf285bdbfb7e38f1fa" kindref="member">FREE_BUF</ref>();</highlight></codeline>
<codeline lineno="3806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___f_f_c_o_n_f_i_g_1ga52faf11025401372f71e9d81905b7af4" kindref="member">_FS_RPATH</ref><sp/>&amp;&amp;<sp/>res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref><sp/>&amp;&amp;<sp/>(dj.<ref refid="struct_d_i_r_1a34e961714af3bc25c08d5832cca23204" kindref="member">fn</ref>[<ref refid="ff_8c_1ad2306816015e67e72cfd0a20a880b227" kindref="member">NSFLAG</ref>]<sp/>&amp;<sp/><ref refid="ff_8c_1a2db528782a021797b34bdc6e9e9de1c3" kindref="member">NS_DOT</ref>))</highlight></codeline>
<codeline lineno="3807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" kindref="member">FR_INVALID_NAME</ref>;</highlight></codeline>
<codeline lineno="3808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dir<sp/>=<sp/>dj.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>;</highlight></codeline>
<codeline lineno="3810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!dir)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Root<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" kindref="member">FR_INVALID_NAME</ref>;</highlight></codeline>
<codeline lineno="3812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>File<sp/>or<sp/>sub-directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" kindref="member">ST_WORD</ref>(dir<sp/>+<sp/><ref refid="ff_8c_1ab9452d336adeece2a1b0b54ab35b8a59" kindref="member">DIR_WrtTime</ref>,<sp/>fno-&gt;<ref refid="struct_f_i_l_i_n_f_o_1adb685b4c58c087d1cd790afb710001cb" kindref="member">ftime</ref>);</highlight></codeline>
<codeline lineno="3814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" kindref="member">ST_WORD</ref>(dir<sp/>+<sp/><ref refid="ff_8c_1abed17fa699511b09cbf64961373d63a4" kindref="member">DIR_WrtDate</ref>,<sp/>fno-&gt;<ref refid="struct_f_i_l_i_n_f_o_1af49edeb97b10af8854cc15a05947a7d4" kindref="member">fdate</ref>);</highlight></codeline>
<codeline lineno="3815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" kindref="member">wflag</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="3816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1aec6b108298553219ebb2b960b528459d" kindref="member">sync_fs</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>);</highlight></codeline>
<codeline lineno="3817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3819"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3820"><highlight class="normal"></highlight></codeline>
<codeline lineno="3821"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>res);</highlight></codeline>
<codeline lineno="3822"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3823"><highlight class="normal"></highlight></codeline>
<codeline lineno="3824"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>!_FS_READONLY<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3825"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>_FS_MINIMIZE<sp/>==<sp/>0<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3826"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>_FS_MINIMIZE<sp/>&lt;=<sp/>1<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3827"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>_FS_MINIMIZE<sp/>&lt;=<sp/>2<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3828"><highlight class="normal"></highlight></codeline>
<codeline lineno="3829"><highlight class="normal"></highlight></codeline>
<codeline lineno="3830"><highlight class="normal"></highlight></codeline>
<codeline lineno="3831"><highlight class="normal"></highlight></codeline>
<codeline lineno="3832"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LABEL</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3833"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3834"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Get<sp/>volume<sp/>label<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3835"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3836"><highlight class="normal"></highlight></codeline>
<codeline lineno="3837"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="group__filesystem_1gac4ff40a674bcbfe40d81b1e8e54befc6" kindref="member">f_getlabel</ref><sp/>(</highlight></codeline>
<codeline lineno="3838"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/>path,<sp/><sp/></highlight><highlight class="comment">/*<sp/>Path<sp/>name<sp/>of<sp/>the<sp/>logical<sp/>drive<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3839"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/>label,<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>a<sp/>buffer<sp/>to<sp/>return<sp/>the<sp/>volume<sp/>label<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3840"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref>*<sp/>vsn<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>a<sp/>variable<sp/>to<sp/>return<sp/>the<sp/>volume<sp/>serial<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3841"><highlight class="normal">)</highlight></codeline>
<codeline lineno="3842"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3843"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="3844"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref><sp/>dj;</highlight></codeline>
<codeline lineno="3845"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>i,<sp/>j;</highlight></codeline>
<codeline lineno="3846"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN<sp/>&amp;&amp;<sp/>_LFN_UNICODE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3847"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a570001c92f314285ad3e7139d8c58cf7" kindref="member">WCHAR</ref><sp/>w;</highlight></codeline>
<codeline lineno="3848"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3849"><highlight class="normal"></highlight></codeline>
<codeline lineno="3850"><highlight class="normal"></highlight></codeline>
<codeline lineno="3851"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>logical<sp/>drive<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3852"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" kindref="member">find_volume</ref>(&amp;dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>&amp;path,<sp/>0);</highlight></codeline>
<codeline lineno="3853"><highlight class="normal"></highlight></codeline>
<codeline lineno="3854"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>volume<sp/>label<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3855"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref><sp/>&amp;&amp;<sp/>label)<sp/>{</highlight></codeline>
<codeline lineno="3856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dj.<ref refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref><sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Open<sp/>root<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" kindref="member">dir_sdi</ref>(&amp;dj,<sp/>0);</highlight></codeline>
<codeline lineno="3858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a3a47a08609e77266bc1928af812e06df" kindref="member">dir_read</ref>(&amp;dj,<sp/>1);<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>an<sp/>entry<sp/>with<sp/>AM_VOL<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>A<sp/>volume<sp/>label<sp/>is<sp/>exist<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3861"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN<sp/>&amp;&amp;<sp/>_LFN_UNICODE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3862"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/>j<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="3863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3864"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/>(i<sp/>&lt;<sp/>11)<sp/>?<sp/>dj.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>[i++]<sp/>:<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="3865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(<ref refid="ff_8c_1a58d63a832a117f179e41c7373d013dd6" kindref="member">IsDBCS1</ref>(w)<sp/>&amp;&amp;<sp/>i<sp/>&lt;<sp/>11<sp/>&amp;&amp;<sp/><ref refid="ff_8c_1a66a3fa880af6078ef181656c1d7d8ef1" kindref="member">IsDBCS2</ref>(dj.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>[i]))</highlight></codeline>
<codeline lineno="3866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/>w<sp/>&lt;&lt;<sp/>8<sp/>|<sp/>dj.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>[i++];</highlight></codeline>
<codeline lineno="3867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>label[j++]<sp/>=<sp/><ref refid="ff_8h_1ae5146230b88ddb4a6a69340e0fd1eabd" kindref="member">ff_convert</ref>(w,<sp/>1);<sp/><sp/></highlight><highlight class="comment">/*<sp/>OEM<sp/>-&gt;<sp/>Unicode<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(j<sp/>&lt;<sp/>11);</highlight></codeline>
<codeline lineno="3869"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a8941d573d16af92c8570950d53164f30" kindref="member">mem_cpy</ref>(label,<sp/>dj.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>,<sp/>11);</highlight></codeline>
<codeline lineno="3871"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>j<sp/>=<sp/>11;</highlight></codeline>
<codeline lineno="3873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>label[j]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="3875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!j)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="3876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(label[--j]<sp/>==<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="3877"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref>)<sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>No<sp/>label,<sp/>return<sp/>nul<sp/>string<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>label[0]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="3880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>;</highlight></codeline>
<codeline lineno="3881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3883"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3884"><highlight class="normal"></highlight></codeline>
<codeline lineno="3885"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>volume<sp/>serial<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3886"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref><sp/>&amp;&amp;<sp/>vsn)<sp/>{</highlight></codeline>
<codeline lineno="3887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" kindref="member">move_window</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1a3e3472628262823af495681702709e8e" kindref="member">volbase</ref>);</highlight></codeline>
<codeline lineno="3888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/>dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1a3630ef0b29c45ef8e0c1de639efab754" kindref="member">fs_type</ref><sp/>==<sp/><ref refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" kindref="member">FS_FAT32</ref><sp/>?<sp/><ref refid="ff_8c_1abaa3aafdcf5e83f8cb7e2bb373b13525" kindref="member">BS_VolID32</ref><sp/>:<sp/><ref refid="ff_8c_1a383a71bda500a0fb5a37f4edd785acbf" kindref="member">BS_VolID</ref>;</highlight></codeline>
<codeline lineno="3890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*vsn<sp/>=<sp/><ref refid="ff_8h_1a4690304ddc975516f7dc02575c96e34e" kindref="member">LD_DWORD</ref>(&amp;dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>[i]);</highlight></codeline>
<codeline lineno="3891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3892"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3893"><highlight class="normal"></highlight></codeline>
<codeline lineno="3894"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>res);</highlight></codeline>
<codeline lineno="3895"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3896"><highlight class="normal"></highlight></codeline>
<codeline lineno="3897"><highlight class="normal"></highlight></codeline>
<codeline lineno="3898"><highlight class="normal"></highlight></codeline>
<codeline lineno="3899"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3900"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3901"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Set<sp/>volume<sp/>label<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3902"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3903"><highlight class="normal"></highlight></codeline>
<codeline lineno="3904"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="group__filesystem_1gaa82bca64e28bc0d656a7999dd0eadec7" kindref="member">f_setlabel</ref><sp/>(</highlight></codeline>
<codeline lineno="3905"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/>label<sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>volume<sp/>label<sp/>to<sp/>set<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3906"><highlight class="normal">)</highlight></codeline>
<codeline lineno="3907"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3908"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="3909"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_d_i_r" kindref="compound">DIR</ref><sp/>dj;</highlight></codeline>
<codeline lineno="3910"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>vn[11];</highlight></codeline>
<codeline lineno="3911"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>i,<sp/>j,<sp/>sl;</highlight></codeline>
<codeline lineno="3912"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a570001c92f314285ad3e7139d8c58cf7" kindref="member">WCHAR</ref><sp/>w;</highlight></codeline>
<codeline lineno="3913"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>tm;</highlight></codeline>
<codeline lineno="3914"><highlight class="normal"></highlight></codeline>
<codeline lineno="3915"><highlight class="normal"></highlight></codeline>
<codeline lineno="3916"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>logical<sp/>drive<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3917"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a4258e0b66f37b7d5f50b906facc55fb3" kindref="member">find_volume</ref>(&amp;dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>&amp;label,<sp/>1);</highlight></codeline>
<codeline lineno="3918"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res)<sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>res);</highlight></codeline>
<codeline lineno="3919"><highlight class="normal"></highlight></codeline>
<codeline lineno="3920"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>a<sp/>volume<sp/>label<sp/>in<sp/>directory<sp/>form<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3921"><highlight class="normal"><sp/><sp/><sp/><sp/>vn[0]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="3922"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(sl<sp/>=<sp/>0;<sp/>label[sl];<sp/>sl++)<sp/>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>name<sp/>length<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3923"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<sp/>;<sp/>sl<sp/>&amp;&amp;<sp/>label[sl<sp/>-<sp/>1]<sp/>==<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">;<sp/>sl--)<sp/>;<sp/></highlight><highlight class="comment">/*<sp/>Remove<sp/>trailing<sp/>spaces<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3924"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sl)<sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>volume<sp/>label<sp/>in<sp/>directory<sp/>form<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/>j<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="3926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3927"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN<sp/>&amp;&amp;<sp/>_LFN_UNICODE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/><ref refid="ff_8h_1ae5146230b88ddb4a6a69340e0fd1eabd" kindref="member">ff_convert</ref>(<ref refid="ff_8h_1af3555c2976dfadc4f1e5cbacc275a012" kindref="member">ff_wtoupper</ref>(label[i++]),<sp/>0);</highlight></codeline>
<codeline lineno="3929"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)label[i++];</highlight></codeline>
<codeline lineno="3931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1a58d63a832a117f179e41c7373d013dd6" kindref="member">IsDBCS1</ref>(w))</highlight></codeline>
<codeline lineno="3932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/>(j<sp/>&lt;<sp/>10<sp/>&amp;&amp;<sp/>i<sp/>&lt;<sp/>sl<sp/>&amp;&amp;<sp/><ref refid="ff_8c_1a66a3fa880af6078ef181656c1d7d8ef1" kindref="member">IsDBCS2</ref>(label[i]))<sp/>?<sp/>w<sp/>&lt;&lt;<sp/>8<sp/>|<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)label[i++]<sp/>:<sp/>0;</highlight></codeline>
<codeline lineno="3933"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/><ref refid="ff_8h_1ae5146230b88ddb4a6a69340e0fd1eabd" kindref="member">ff_convert</ref>(<ref refid="ff_8h_1af3555c2976dfadc4f1e5cbacc275a012" kindref="member">ff_wtoupper</ref>(<ref refid="ff_8h_1ae5146230b88ddb4a6a69340e0fd1eabd" kindref="member">ff_convert</ref>(w,<sp/>1)),<sp/>0);</highlight></codeline>
<codeline lineno="3935"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1a4a9d454724926bd51a3aed589a97f08b" kindref="member">IsLower</ref>(w))<sp/>w<sp/>-=<sp/>0x20;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>To<sp/>upper<sp/>ASCII<sp/>characters<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3937"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>_EXCVT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(w<sp/>&gt;=<sp/>0x80)<sp/>w<sp/>=<sp/>ExCvt[w<sp/>-<sp/>0x80];<sp/></highlight><highlight class="comment">/*<sp/>To<sp/>upper<sp/>extended<sp/>characters<sp/>(SBCS<sp/>cfg)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3939"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="ff_8c_1a228bfd2cabe490c8567aaf08b8b2cc14" kindref="member">_DF1S</ref><sp/>&amp;&amp;<sp/>w<sp/>&gt;=<sp/>0x80)<sp/>w<sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Reject<sp/>extended<sp/>characters<sp/>(ASCII<sp/>cfg)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3941"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3942"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3943"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!w<sp/>||<sp/><ref refid="ff_8c_1a1a60c4200d040e4f47e87dc927f23d14" kindref="member">chk_chr</ref>(</highlight><highlight class="stringliteral">&quot;\&quot;*+,.:;&lt;=&gt;\?[]|\x7F&quot;</highlight><highlight class="normal">,<sp/>w)<sp/>||<sp/>j<sp/>&gt;=<sp/>(<ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref>)((w<sp/>&gt;=<sp/>0x100)<sp/>?<sp/>10<sp/>:<sp/>11))<sp/></highlight><highlight class="comment">/*<sp/>Reject<sp/>invalid<sp/>characters<sp/>for<sp/>volume<sp/>label<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" kindref="member">FR_INVALID_NAME</ref>);</highlight></codeline>
<codeline lineno="3946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(w<sp/>&gt;=<sp/>0x100)<sp/>vn[j++]<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)(w<sp/>&gt;&gt;<sp/>8);</highlight></codeline>
<codeline lineno="3947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vn[j++]<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)w;</highlight></codeline>
<codeline lineno="3948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(i<sp/>&lt;<sp/>sl);</highlight></codeline>
<codeline lineno="3949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(j<sp/>&lt;<sp/>11)<sp/>vn[j++]<sp/>=<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Fill<sp/>remaining<sp/>name<sp/>field<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(vn[0]<sp/>==<sp/><ref refid="ff_8c_1a0f2455f7318e6d56318c62f5e4048e1e" kindref="member">DDEM</ref>)<sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45" kindref="member">FR_INVALID_NAME</ref>);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Reject<sp/>illegal<sp/>name<sp/>(heading<sp/>DDEM)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3951"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3952"><highlight class="normal"></highlight></codeline>
<codeline lineno="3953"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>volume<sp/>label<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3954"><highlight class="normal"><sp/><sp/><sp/><sp/>dj.<ref refid="struct_d_i_r_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref><sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Open<sp/>root<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3955"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a29ecb9f62a34eadb5af2a42be312c31e" kindref="member">dir_sdi</ref>(&amp;dj,<sp/>0);</highlight></codeline>
<codeline lineno="3956"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a3a47a08609e77266bc1928af812e06df" kindref="member">dir_read</ref>(&amp;dj,<sp/>1);<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>an<sp/>entry<sp/>with<sp/>AM_VOL<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>A<sp/>volume<sp/>label<sp/>is<sp/>found<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(vn[0])<sp/>{</highlight></codeline>
<codeline lineno="3960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a8941d573d16af92c8570950d53164f30" kindref="member">mem_cpy</ref>(dj.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>,<sp/>vn,<sp/>11);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Change<sp/>the<sp/>volume<sp/>label<sp/>name<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tm<sp/>=<sp/><ref refid="ff_8c_1a72589f5bbb514c0b222ab8b292764418" kindref="member">GET_FATTIME</ref>();</highlight></codeline>
<codeline lineno="3962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(dj.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref><sp/>+<sp/><ref refid="ff_8c_1ab9452d336adeece2a1b0b54ab35b8a59" kindref="member">DIR_WrtTime</ref>,<sp/>tm);</highlight></codeline>
<codeline lineno="3963"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3964"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dj.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>[0]<sp/>=<sp/><ref refid="ff_8c_1a0f2455f7318e6d56318c62f5e4048e1e" kindref="member">DDEM</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Remove<sp/>the<sp/>volume<sp/>label<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" kindref="member">wflag</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="3967"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1aec6b108298553219ebb2b960b528459d" kindref="member">sync_fs</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>);</highlight></codeline>
<codeline lineno="3968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>No<sp/>volume<sp/>label<sp/>is<sp/>found<sp/>or<sp/>error<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c" kindref="member">FR_NO_FILE</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>;</highlight></codeline>
<codeline lineno="3971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(vn[0])<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>volume<sp/>label<sp/>as<sp/>new<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1a23ff0594686ccbd8f8d987547931ef04" kindref="member">dir_alloc</ref>(&amp;dj,<sp/>1);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Allocate<sp/>an<sp/>entry<sp/>for<sp/>volume<sp/>label<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a02eb5189e43056a9ddc8a59cbe89be93" kindref="member">mem_set</ref>(dj.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>,<sp/>0,<sp/><ref refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" kindref="member">SZ_DIRE</ref>);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>volume<sp/>label<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a8941d573d16af92c8570950d53164f30" kindref="member">mem_cpy</ref>(dj.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>,<sp/>vn,<sp/>11);</highlight></codeline>
<codeline lineno="3976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dj.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref>[<ref refid="ff_8c_1ad3233e40118ed66095f3c9545b788f8a" kindref="member">DIR_Attr</ref>]<sp/>=<sp/><ref refid="ff_8h_1a5cfae62dabae0a54809e43b36685ce7c" kindref="member">AM_VOL</ref>;</highlight></codeline>
<codeline lineno="3977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tm<sp/>=<sp/><ref refid="ff_8c_1a72589f5bbb514c0b222ab8b292764418" kindref="member">GET_FATTIME</ref>();</highlight></codeline>
<codeline lineno="3978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(dj.<ref refid="struct_d_i_r_1a30fe34a14a6efb4c9c04a522f6cf3378" kindref="member">dir</ref><sp/>+<sp/><ref refid="ff_8c_1ab9452d336adeece2a1b0b54ab35b8a59" kindref="member">DIR_WrtTime</ref>,<sp/>tm);</highlight></codeline>
<codeline lineno="3979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1adb3983f8d19ef9879f30d04b076e9ff2" kindref="member">wflag</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="3980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1aec6b108298553219ebb2b960b528459d" kindref="member">sync_fs</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>);</highlight></codeline>
<codeline lineno="3981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3985"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3986"><highlight class="normal"></highlight></codeline>
<codeline lineno="3987"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(dj.<ref refid="struct_d_i_r_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>res);</highlight></codeline>
<codeline lineno="3988"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3989"><highlight class="normal"></highlight></codeline>
<codeline lineno="3990"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>!_FS_READONLY<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3991"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>_USE_LABEL<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3992"><highlight class="normal"></highlight></codeline>
<codeline lineno="3993"><highlight class="normal"></highlight></codeline>
<codeline lineno="3994"><highlight class="normal"></highlight></codeline>
<codeline lineno="3995"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3996"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Forward<sp/>data<sp/>to<sp/>the<sp/>stream<sp/>directly<sp/>(available<sp/>on<sp/>only<sp/>tiny<sp/>cfg)<sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3997"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3998"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_FORWARD<sp/>&amp;&amp;<sp/>_FS_TINY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3999"><highlight class="normal"></highlight></codeline>
<codeline lineno="4000"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="group__filesystem_1ga6c0c4cd695704aa6d952c90be81d9849" kindref="member">f_forward</ref><sp/>(</highlight></codeline>
<codeline lineno="4001"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_i_l" kindref="compound">FIL</ref>*<sp/>fp,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>file<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4002"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>(*func)(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>*,<ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref>),<sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>streaming<sp/>function<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4003"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>btf,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>bytes<sp/>to<sp/>forward<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4004"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref>*<sp/>bf<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>number<sp/>of<sp/>bytes<sp/>forwarded<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4005"><highlight class="normal">)</highlight></codeline>
<codeline lineno="4006"><highlight class="normal">{</highlight></codeline>
<codeline lineno="4007"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/>res;</highlight></codeline>
<codeline lineno="4008"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>remain,<sp/>clst,<sp/>sect;</highlight></codeline>
<codeline lineno="4009"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>rcnt;</highlight></codeline>
<codeline lineno="4010"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>csect;</highlight></codeline>
<codeline lineno="4011"><highlight class="normal"></highlight></codeline>
<codeline lineno="4012"><highlight class="normal"></highlight></codeline>
<codeline lineno="4013"><highlight class="normal"><sp/><sp/><sp/><sp/>*bf<sp/>=<sp/>0;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Clear<sp/>transfer<sp/>byte<sp/>counter<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4014"><highlight class="normal"></highlight></codeline>
<codeline lineno="4015"><highlight class="normal"><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ff_8c_1aa7193f5b86c3996b5312043a0c26da5f" kindref="member">validate</ref>(fp);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>validity<sp/>of<sp/>the<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4016"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>res);</highlight></codeline>
<codeline lineno="4017"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp-&gt;<ref refid="struct_f_i_l_1a32b2a186af2cab58af8114c05386b9f6" kindref="member">err</ref>)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>error<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>(<ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref>)fp-&gt;<ref refid="struct_f_i_l_1a32b2a186af2cab58af8114c05386b9f6" kindref="member">err</ref>);</highlight></codeline>
<codeline lineno="4019"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!(fp-&gt;<ref refid="struct_f_i_l_1abb2c49aaa8df55e1e1d8cb0c5e04a3bf" kindref="member">flag</ref><sp/>&amp;<sp/><ref refid="ff_8h_1a1f4f3530ff03abbd979b072536e72290" kindref="member">FA_READ</ref>))<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>access<sp/>mode<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d" kindref="member">FR_DENIED</ref>);</highlight></codeline>
<codeline lineno="4021"><highlight class="normal"></highlight></codeline>
<codeline lineno="4022"><highlight class="normal"><sp/><sp/><sp/><sp/>remain<sp/>=<sp/>fp-&gt;<ref refid="struct_f_i_l_1af70a0afd16367837984d6205cbfca308" kindref="member">fsize</ref><sp/>-<sp/>fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref>;</highlight></codeline>
<codeline lineno="4023"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(btf<sp/>&gt;<sp/>remain)<sp/>btf<sp/>=<sp/>(<ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref>)remain;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Truncate<sp/>btf<sp/>by<sp/>remaining<sp/>bytes<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4024"><highlight class="normal"></highlight></codeline>
<codeline lineno="4025"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<sp/>;<sp/><sp/>btf<sp/>&amp;&amp;<sp/>(*func)(0,<sp/>0);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Repeat<sp/>until<sp/>all<sp/>data<sp/>transferred<sp/>or<sp/>stream<sp/>becomes<sp/>busy<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>+=<sp/>rcnt,<sp/>*bf<sp/>+=<sp/>rcnt,<sp/>btf<sp/>-=<sp/>rcnt)<sp/>{</highlight></codeline>
<codeline lineno="4027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>csect<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)(fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>/<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)<sp/>&amp;<sp/>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1ace95d33f1aefff4c3e821cf8eac7ec3e" kindref="member">csize</ref><sp/>-<sp/>1));<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Sector<sp/>offset<sp/>in<sp/>the<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>%<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>))<sp/>==<sp/>0)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>On<sp/>the<sp/>sector<sp/>boundary?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!csect)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>On<sp/>the<sp/>cluster<sp/>boundary?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clst<sp/>=<sp/>(fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>==<sp/>0)<sp/>?<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>On<sp/>the<sp/>top<sp/>of<sp/>the<sp/>file?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1ad5d52f3fde971d2a05ff777a6243c252" kindref="member">sclust</ref><sp/>:<sp/><ref refid="ff_8c_1a65611adf1626e5e08da77cd33a98dd8b" kindref="member">get_fat</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1ac134c1b4645be670eb5207032e714616" kindref="member">clust</ref>);</highlight></codeline>
<codeline lineno="4032"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>&lt;=<sp/>1)<sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>);</highlight></codeline>
<codeline lineno="4033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clst<sp/>==<sp/>0xFFFFFFFF)<sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>);</highlight></codeline>
<codeline lineno="4034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1ac134c1b4645be670eb5207032e714616" kindref="member">clust</ref><sp/>=<sp/>clst;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Update<sp/>current<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sect<sp/>=<sp/><ref refid="ff_8c_1a7519abb60fe91f6aa1d17f64fbae123a" kindref="member">clust2sect</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>fp-&gt;<ref refid="struct_f_i_l_1ac134c1b4645be670eb5207032e714616" kindref="member">clust</ref>);<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>current<sp/>data<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!sect)<sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>);</highlight></codeline>
<codeline lineno="4039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sect<sp/>+=<sp/>csect;</highlight></codeline>
<codeline lineno="4040"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1af2e8986556ee6644b4bf31fa4158d735" kindref="member">move_window</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/>sect)<sp/>!=<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>)<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Move<sp/>sector<sp/>window<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4041"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>);</highlight></codeline>
<codeline lineno="4042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fp-&gt;<ref refid="struct_f_i_l_1a272171f74215002aba31a89428f1d290" kindref="member">dsect</ref><sp/>=<sp/>sect;</highlight></codeline>
<codeline lineno="4043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rcnt<sp/>=<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)<sp/>-<sp/>(<ref refid="integer_8h_1a197942eefa7db30960ae396d68339b97" kindref="member">WORD</ref>)(fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>%<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>));<sp/><sp/></highlight><highlight class="comment">/*<sp/>Forward<sp/>data<sp/>from<sp/>sector<sp/>window<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rcnt<sp/>&gt;<sp/>btf)<sp/>rcnt<sp/>=<sp/>btf;</highlight></codeline>
<codeline lineno="4045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rcnt<sp/>=<sp/>(*func)(&amp;fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>[(<ref refid="integer_8h_1a197942eefa7db30960ae396d68339b97" kindref="member">WORD</ref>)fp-&gt;<ref refid="struct_f_i_l_1a0f65af32a2d036c560e66177961b9b22" kindref="member">fptr</ref><sp/>%<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>)],<sp/>rcnt);</highlight></codeline>
<codeline lineno="4046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!rcnt)<sp/><ref refid="ff_8c_1a41e4c46636679236568cf50b5535847f" kindref="member">ABORT</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76" kindref="member">FR_INT_ERR</ref>);</highlight></codeline>
<codeline lineno="4047"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4048"><highlight class="normal"></highlight></codeline>
<codeline lineno="4049"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a7e653d8ca0ae09faa49cd5b7335fea84" kindref="member">LEAVE_FF</ref>(fp-&gt;<ref refid="struct_f_i_l_1ae363a794e38f3a9aa1d55b8e3c7fcee7" kindref="member">fs</ref>,<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>);</highlight></codeline>
<codeline lineno="4050"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4051"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>_USE_FORWARD<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4052"><highlight class="normal"></highlight></codeline>
<codeline lineno="4053"><highlight class="normal"></highlight></codeline>
<codeline lineno="4054"><highlight class="normal"></highlight></codeline>
<codeline lineno="4055"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_MKFS<sp/>&amp;&amp;<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4056"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4057"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Create<sp/>file<sp/>system<sp/>on<sp/>the<sp/>logical<sp/>drive<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4058"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4059" refid="ff_8c_1a412083bc7d166082045a0111e890b22a" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>N_ROOTDIR<sp/><sp/><sp/>512<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>root<sp/>directory<sp/>entries<sp/>for<sp/>FAT12/16<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4060" refid="ff_8c_1a3f9495abc6071dcfdbd242cc1f9ad9f8" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>N_FATS<sp/><sp/><sp/><sp/><sp/><sp/>1<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>FATs<sp/>(1<sp/>or<sp/>2)<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4061"><highlight class="normal"></highlight></codeline>
<codeline lineno="4062"><highlight class="normal"></highlight></codeline>
<codeline lineno="4063" refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" refkind="member"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="group__filesystem_1ga799aff9594e708c8be357281cf85428b" kindref="member">f_mkfs</ref><sp/>(</highlight></codeline>
<codeline lineno="4064"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/>path,<sp/><sp/></highlight><highlight class="comment">/*<sp/>Logical<sp/>drive<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4065"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>sfd,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Partitioning<sp/>rule<sp/>0:FDISK,<sp/>1:SFD<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4066"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>au<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Size<sp/>of<sp/>allocation<sp/>unit<sp/>in<sp/>unit<sp/>of<sp/>byte<sp/>or<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4067"><highlight class="normal">)</highlight></codeline>
<codeline lineno="4068"><highlight class="normal">{</highlight></codeline>
<codeline lineno="4069"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="integer_8h_1a197942eefa7db30960ae396d68339b97" kindref="member">WORD</ref><sp/>vst[]<sp/>=<sp/>{<sp/>1024,<sp/><sp/><sp/>512,<sp/><sp/>256,<sp/><sp/>128,<sp/><sp/><sp/>64,<sp/><sp/><sp/><sp/>32,<sp/><sp/><sp/>16,<sp/><sp/><sp/><sp/>8,<sp/><sp/><sp/><sp/>4,<sp/><sp/><sp/><sp/>2,<sp/><sp/><sp/>0};</highlight></codeline>
<codeline lineno="4070"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="integer_8h_1a197942eefa7db30960ae396d68339b97" kindref="member">WORD</ref><sp/>cst[]<sp/>=<sp/>{32768,<sp/>16384,<sp/>8192,<sp/>4096,<sp/>2048,<sp/>16384,<sp/>8192,<sp/>4096,<sp/>2048,<sp/>1024,<sp/>512};</highlight></codeline>
<codeline lineno="4071"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>vol;</highlight></codeline>
<codeline lineno="4072"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>fmt,<sp/>md,<sp/>sys,<sp/>*tbl,<sp/>pdrv,<sp/>part;</highlight></codeline>
<codeline lineno="4073"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>n_clst,<sp/>vs,<sp/>n,<sp/>wsect;</highlight></codeline>
<codeline lineno="4074"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>i;</highlight></codeline>
<codeline lineno="4075"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>b_vol,<sp/>b_fat,<sp/>b_dir,<sp/>b_data;<sp/><sp/></highlight><highlight class="comment">/*<sp/>LBA<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4076"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>n_vol,<sp/>n_rsv,<sp/>n_fat,<sp/>n_dir;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Size<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4077"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_a_t_f_s" kindref="compound">FATFS</ref><sp/>*fs;</highlight></codeline>
<codeline lineno="4078"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="diskio_8h_1adba6790898ce4029c20a34b898ce73c1" kindref="member">DSTATUS</ref><sp/>stat;</highlight></codeline>
<codeline lineno="4079"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_TRIM</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4080"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>eb[2];</highlight></codeline>
<codeline lineno="4081"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4082"><highlight class="normal"></highlight></codeline>
<codeline lineno="4083"><highlight class="normal"></highlight></codeline>
<codeline lineno="4084"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>mounted<sp/>drive<sp/>and<sp/>clear<sp/>work<sp/>area<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4085"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sfd<sp/>&gt;<sp/>1)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca3b89faeceab64db277d0fcdeaaa315d6" kindref="member">FR_INVALID_PARAMETER</ref>;</highlight></codeline>
<codeline lineno="4086"><highlight class="normal"><sp/><sp/><sp/><sp/>vol<sp/>=<sp/><ref refid="ff_8c_1a88ad7e4b1bc98d1a2673a136283dc7ee" kindref="member">get_ldnumber</ref>(&amp;path);</highlight></codeline>
<codeline lineno="4087"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(vol<sp/>&lt;<sp/>0)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca487844af77de15f6932a3b41ef3a2d65" kindref="member">FR_INVALID_DRIVE</ref>;</highlight></codeline>
<codeline lineno="4088"><highlight class="normal"><sp/><sp/><sp/><sp/>fs<sp/>=<sp/>FatFs[vol];</highlight></codeline>
<codeline lineno="4089"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!fs)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cafc56605c68aaffab4a428339a8bd600d" kindref="member">FR_NOT_ENABLED</ref>;</highlight></codeline>
<codeline lineno="4090"><highlight class="normal"><sp/><sp/><sp/><sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1a3630ef0b29c45ef8e0c1de639efab754" kindref="member">fs_type</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="4091"><highlight class="normal"><sp/><sp/><sp/><sp/>pdrv<sp/>=<sp/><ref refid="ff_8h_1a6577ed2f95527745bf4d27c53488b9a7" kindref="member">LD2PD</ref>(vol);<sp/><sp/></highlight><highlight class="comment">/*<sp/>Physical<sp/>drive<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4092"><highlight class="normal"><sp/><sp/><sp/><sp/>part<sp/>=<sp/><ref refid="ff_8h_1aadc4a9aefaf2588bdd7565549f5d91e7" kindref="member">LD2PT</ref>(vol);<sp/><sp/></highlight><highlight class="comment">/*<sp/>Partition<sp/>(0:auto<sp/>detect,<sp/>1-4:get<sp/>from<sp/>partition<sp/>table)*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4093"><highlight class="normal"></highlight></codeline>
<codeline lineno="4094"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>disk<sp/>statics<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4095"><highlight class="normal"><sp/><sp/><sp/><sp/>stat<sp/>=<sp/><ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga45e4ba27a706ed2421edd501406a6496" kindref="member">disk_initialize</ref>(pdrv);</highlight></codeline>
<codeline lineno="4096"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(stat<sp/>&amp;<sp/><ref refid="diskio_8h_1abd6503c70d862b979a3f7080a59e9acd" kindref="member">STA_NOINIT</ref>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cac9894bed3e8632ede8d2712235fa8e45" kindref="member">FR_NOT_READY</ref>;</highlight></codeline>
<codeline lineno="4097"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(stat<sp/>&amp;<sp/><ref refid="diskio_8h_1a9ec6dc5f6620a33fabe388d3a111ca8c" kindref="member">STA_PROTECT</ref>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cac3afbb423b1d4497229416812aff383b" kindref="member">FR_WRITE_PROTECTED</ref>;</highlight></codeline>
<codeline lineno="4098"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_MAX_SS<sp/>!=<sp/>_MIN_SS<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>disk<sp/>sector<sp/>size<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4099"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga3051f51f1cccb103d145804d5d91b04d" kindref="member">disk_ioctl</ref>(pdrv,<sp/><ref refid="diskio_8h_1ac73b5cf2135cbd459d109b96c9aa346a" kindref="member">GET_SECTOR_SIZE</ref>,<sp/>&amp;<ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs))<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref><sp/>||<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs)<sp/>&gt;<sp/><ref refid="group___f_f_c_o_n_f_i_g_1gac271b697378912f17132cb9c7d0de024" kindref="member">_MAX_SS</ref><sp/>||<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs)<sp/>&lt;<sp/><ref refid="group___f_f_c_o_n_f_i_g_1gad03aa6d0e294709ae15898ee2c14dc3a" kindref="member">_MIN_SS</ref>)</highlight></codeline>
<codeline lineno="4100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>;</highlight></codeline>
<codeline lineno="4101"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4102"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___f_f_c_o_n_f_i_g_1gadc02609ba893fe8706a2f8af0e3a3bb5" kindref="member">_MULTI_PARTITION</ref><sp/>&amp;&amp;<sp/>part)<sp/>{</highlight></codeline>
<codeline lineno="4103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>partition<sp/>information<sp/>from<sp/>partition<sp/>table<sp/>in<sp/>the<sp/>MBR<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1gae55155170bc9b99f73b440b93cc1c9e2" kindref="member">disk_read</ref>(pdrv,<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>,<sp/>0,<sp/>1)<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>;</highlight></codeline>
<codeline lineno="4105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8h_1a398519bb08da6457e62567d1f0b567e3" kindref="member">LD_WORD</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref><sp/>+<sp/><ref refid="ff_8c_1a74b810b3f3583c1eb54bd4305c0f261a" kindref="member">BS_55AA</ref>)<sp/>!=<sp/>0xAA55)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca4b02760f758f5b1a89f445244fe9fbca" kindref="member">FR_MKFS_ABORTED</ref>;</highlight></codeline>
<codeline lineno="4106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tbl<sp/>=<sp/>&amp;fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>[<ref refid="ff_8c_1ac3f187bf0ba891551f594af6b61f3188" kindref="member">MBR_Table</ref><sp/>+<sp/>(part<sp/>-<sp/>1)<sp/>*<sp/><ref refid="ff_8c_1af133060c47366e7e557d4085d931183f" kindref="member">SZ_PTE</ref>];</highlight></codeline>
<codeline lineno="4107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!tbl[4])<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca4b02760f758f5b1a89f445244fe9fbca" kindref="member">FR_MKFS_ABORTED</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>No<sp/>partition?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>b_vol<sp/>=<sp/><ref refid="ff_8h_1a4690304ddc975516f7dc02575c96e34e" kindref="member">LD_DWORD</ref>(tbl<sp/>+<sp/>8);<sp/><sp/></highlight><highlight class="comment">/*<sp/>Volume<sp/>start<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_vol<sp/>=<sp/><ref refid="ff_8h_1a4690304ddc975516f7dc02575c96e34e" kindref="member">LD_DWORD</ref>(tbl<sp/>+<sp/>12);<sp/></highlight><highlight class="comment">/*<sp/>Volume<sp/>size<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4110"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="4111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>a<sp/>partition<sp/>in<sp/>this<sp/>function<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga3051f51f1cccb103d145804d5d91b04d" kindref="member">disk_ioctl</ref>(pdrv,<sp/><ref refid="diskio_8h_1a570216006f6a8fc4e1698b1bbb2d1dde" kindref="member">GET_SECTOR_COUNT</ref>,<sp/>&amp;n_vol)<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref><sp/>||<sp/>n_vol<sp/>&lt;<sp/>128)</highlight></codeline>
<codeline lineno="4113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>;</highlight></codeline>
<codeline lineno="4114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>b_vol<sp/>=<sp/>(sfd)<sp/>?<sp/>0<sp/>:<sp/>63;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Volume<sp/>start<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_vol<sp/>-=<sp/>b_vol;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Volume<sp/>size<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4116"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4117"><highlight class="normal"></highlight></codeline>
<codeline lineno="4118"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(au<sp/>&amp;<sp/>(au<sp/>-<sp/>1))<sp/>au<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="4119"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!au)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>AU<sp/>auto<sp/>selection<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vs<sp/>=<sp/>n_vol<sp/>/<sp/>(2000<sp/>/<sp/>(<ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs)<sp/>/<sp/>512));</highlight></codeline>
<codeline lineno="4121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>vs<sp/>&lt;<sp/>vst[i];<sp/>i++)<sp/>;</highlight></codeline>
<codeline lineno="4122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>au<sp/>=<sp/>cst[i];</highlight></codeline>
<codeline lineno="4123"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4124"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(au<sp/>&gt;=<sp/><ref refid="group___f_f_c_o_n_f_i_g_1gad03aa6d0e294709ae15898ee2c14dc3a" kindref="member">_MIN_SS</ref>)<sp/>au<sp/>/=<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>sectors<sp/>per<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4125"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!au)<sp/>au<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="4126"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(au<sp/>&gt;<sp/>128)<sp/>au<sp/>=<sp/>128;</highlight></codeline>
<codeline lineno="4127"><highlight class="normal"></highlight></codeline>
<codeline lineno="4128"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pre-compute<sp/>number<sp/>of<sp/>clusters<sp/>and<sp/>FAT<sp/>sub-type<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4129"><highlight class="normal"><sp/><sp/><sp/><sp/>n_clst<sp/>=<sp/>n_vol<sp/>/<sp/>au;</highlight></codeline>
<codeline lineno="4130"><highlight class="normal"><sp/><sp/><sp/><sp/>fmt<sp/>=<sp/><ref refid="ff_8h_1aab755aa1b4f81f4aabee4a5d4738cfb0" kindref="member">FS_FAT12</ref>;</highlight></codeline>
<codeline lineno="4131"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n_clst<sp/>&gt;=<sp/><ref refid="ff_8c_1aeec02d5ae07ede32b7d74155bf0fda15" kindref="member">MIN_FAT16</ref>)<sp/>fmt<sp/>=<sp/><ref refid="ff_8h_1a7ef90a36d99edfc0138a2155a17a79b9" kindref="member">FS_FAT16</ref>;</highlight></codeline>
<codeline lineno="4132"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n_clst<sp/>&gt;=<sp/><ref refid="ff_8c_1a483625319f3e3bd5ac6502b46c375aed" kindref="member">MIN_FAT32</ref>)<sp/>fmt<sp/>=<sp/><ref refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" kindref="member">FS_FAT32</ref>;</highlight></codeline>
<codeline lineno="4133"><highlight class="normal"></highlight></codeline>
<codeline lineno="4134"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Determine<sp/>offset<sp/>and<sp/>size<sp/>of<sp/>FAT<sp/>structure<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4135"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fmt<sp/>==<sp/><ref refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" kindref="member">FS_FAT32</ref>)<sp/>{</highlight></codeline>
<codeline lineno="4136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_fat<sp/>=<sp/>((n_clst<sp/>*<sp/>4)<sp/>+<sp/>8<sp/>+<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs)<sp/>-<sp/>1)<sp/>/<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs);</highlight></codeline>
<codeline lineno="4137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_rsv<sp/>=<sp/>32;</highlight></codeline>
<codeline lineno="4138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_dir<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="4139"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="4140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_fat<sp/>=<sp/>(fmt<sp/>==<sp/><ref refid="ff_8h_1aab755aa1b4f81f4aabee4a5d4738cfb0" kindref="member">FS_FAT12</ref>)<sp/>?<sp/>(n_clst<sp/>*<sp/>3<sp/>+<sp/>1)<sp/>/<sp/>2<sp/>+<sp/>3<sp/>:<sp/>(n_clst<sp/>*<sp/>2)<sp/>+<sp/>4;</highlight></codeline>
<codeline lineno="4141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_fat<sp/>=<sp/>(n_fat<sp/>+<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs)<sp/>-<sp/>1)<sp/>/<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs);</highlight></codeline>
<codeline lineno="4142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_rsv<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="4143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_dir<sp/>=<sp/>(<ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref>)<ref refid="ff_8c_1a412083bc7d166082045a0111e890b22a" kindref="member">N_ROOTDIR</ref><sp/>*<sp/><ref refid="ff_8c_1a51949bb6a3eb30e5a09c48a2ee5a2593" kindref="member">SZ_DIRE</ref><sp/>/<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs);</highlight></codeline>
<codeline lineno="4144"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4145"><highlight class="normal"><sp/><sp/><sp/><sp/>b_fat<sp/>=<sp/>b_vol<sp/>+<sp/>n_rsv;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FAT<sp/>area<sp/>start<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4146"><highlight class="normal"><sp/><sp/><sp/><sp/>b_dir<sp/>=<sp/>b_fat<sp/>+<sp/>n_fat<sp/>*<sp/><ref refid="ff_8c_1a3f9495abc6071dcfdbd242cc1f9ad9f8" kindref="member">N_FATS</ref>;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Directory<sp/>area<sp/>start<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4147"><highlight class="normal"><sp/><sp/><sp/><sp/>b_data<sp/>=<sp/>b_dir<sp/>+<sp/>n_dir;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Data<sp/>area<sp/>start<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4148"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n_vol<sp/>&lt;<sp/>b_data<sp/>+<sp/>au<sp/>-<sp/>b_vol)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca4b02760f758f5b1a89f445244fe9fbca" kindref="member">FR_MKFS_ABORTED</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Too<sp/>small<sp/>volume<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4149"><highlight class="normal"></highlight></codeline>
<codeline lineno="4150"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Align<sp/>data<sp/>start<sp/>sector<sp/>to<sp/>erase<sp/>block<sp/>boundary<sp/>(for<sp/>flash<sp/>memory<sp/>media)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4151"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga3051f51f1cccb103d145804d5d91b04d" kindref="member">disk_ioctl</ref>(pdrv,<sp/><ref refid="diskio_8h_1aec3bb4dfe075d0ba2f3b07b300a95500" kindref="member">GET_BLOCK_SIZE</ref>,<sp/>&amp;n)<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref><sp/>||<sp/>!n<sp/>||<sp/>n<sp/>&gt;<sp/>32768)<sp/>n<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="4152"><highlight class="normal"><sp/><sp/><sp/><sp/>n<sp/>=<sp/>(b_data<sp/>+<sp/>n<sp/>-<sp/>1)<sp/>&amp;<sp/>~(n<sp/>-<sp/>1);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Next<sp/>nearest<sp/>erase<sp/>block<sp/>from<sp/>current<sp/>data<sp/>start<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4153"><highlight class="normal"><sp/><sp/><sp/><sp/>n<sp/>=<sp/>(n<sp/>-<sp/>b_data)<sp/>/<sp/>N_FATS;</highlight></codeline>
<codeline lineno="4154"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fmt<sp/>==<sp/><ref refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" kindref="member">FS_FAT32</ref>)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FAT32:<sp/>Move<sp/>FAT<sp/>offset<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_rsv<sp/>+=<sp/>n;</highlight></codeline>
<codeline lineno="4156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>b_fat<sp/>+=<sp/>n;</highlight></codeline>
<codeline lineno="4157"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FAT12/16:<sp/>Expand<sp/>FAT<sp/>size<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_fat<sp/>+=<sp/>n;</highlight></codeline>
<codeline lineno="4159"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4160"><highlight class="normal"></highlight></codeline>
<codeline lineno="4161"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Determine<sp/>number<sp/>of<sp/>clusters<sp/>and<sp/>final<sp/>check<sp/>of<sp/>validity<sp/>of<sp/>the<sp/>FAT<sp/>sub-type<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4162"><highlight class="normal"><sp/><sp/><sp/><sp/>n_clst<sp/>=<sp/>(n_vol<sp/>-<sp/>n_rsv<sp/>-<sp/>n_fat<sp/>*<sp/>N_FATS<sp/>-<sp/>n_dir)<sp/>/<sp/>au;</highlight></codeline>
<codeline lineno="4163"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/><sp/><sp/>(fmt<sp/>==<sp/><ref refid="ff_8h_1a7ef90a36d99edfc0138a2155a17a79b9" kindref="member">FS_FAT16</ref><sp/>&amp;&amp;<sp/>n_clst<sp/>&lt;<sp/><ref refid="ff_8c_1aeec02d5ae07ede32b7d74155bf0fda15" kindref="member">MIN_FAT16</ref>)</highlight></codeline>
<codeline lineno="4164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>||<sp/>(fmt<sp/>==<sp/><ref refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" kindref="member">FS_FAT32</ref><sp/>&amp;&amp;<sp/>n_clst<sp/>&lt;<sp/><ref refid="ff_8c_1a483625319f3e3bd5ac6502b46c375aed" kindref="member">MIN_FAT32</ref>))</highlight></codeline>
<codeline lineno="4165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca4b02760f758f5b1a89f445244fe9fbca" kindref="member">FR_MKFS_ABORTED</ref>;</highlight></codeline>
<codeline lineno="4166"><highlight class="normal"></highlight></codeline>
<codeline lineno="4167"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Determine<sp/>system<sp/>ID<sp/>in<sp/>the<sp/>partition<sp/>table<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4168"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fmt<sp/>==<sp/><ref refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" kindref="member">FS_FAT32</ref>)<sp/>{</highlight></codeline>
<codeline lineno="4169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sys<sp/>=<sp/>0x0C;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FAT32X<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4170"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="4171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fmt<sp/>==<sp/><ref refid="ff_8h_1aab755aa1b4f81f4aabee4a5d4738cfb0" kindref="member">FS_FAT12</ref><sp/>&amp;&amp;<sp/>n_vol<sp/>&lt;<sp/>0x10000)<sp/>{</highlight></codeline>
<codeline lineno="4172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sys<sp/>=<sp/>0x01;<sp/></highlight><highlight class="comment">/*<sp/>FAT12(&lt;65536)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="4174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sys<sp/>=<sp/>(n_vol<sp/>&lt;<sp/>0x10000)<sp/>?<sp/>0x04<sp/>:<sp/>0x06;<sp/><sp/></highlight><highlight class="comment">/*<sp/>FAT16(&lt;65536)<sp/>:<sp/>FAT12/16(&gt;=65536)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4176"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4177"><highlight class="normal"></highlight></codeline>
<codeline lineno="4178"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___f_f_c_o_n_f_i_g_1gadc02609ba893fe8706a2f8af0e3a3bb5" kindref="member">_MULTI_PARTITION</ref><sp/>&amp;&amp;<sp/>part)<sp/>{</highlight></codeline>
<codeline lineno="4179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Update<sp/>system<sp/>ID<sp/>in<sp/>the<sp/>partition<sp/>table<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tbl<sp/>=<sp/>&amp;fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>[<ref refid="ff_8c_1ac3f187bf0ba891551f594af6b61f3188" kindref="member">MBR_Table</ref><sp/>+<sp/>(part<sp/>-<sp/>1)<sp/>*<sp/><ref refid="ff_8c_1af133060c47366e7e557d4085d931183f" kindref="member">SZ_PTE</ref>];</highlight></codeline>
<codeline lineno="4181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tbl[4]<sp/>=<sp/>sys;</highlight></codeline>
<codeline lineno="4182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" kindref="member">disk_write</ref>(pdrv,<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>,<sp/>0,<sp/>1)<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref>)<sp/><sp/></highlight><highlight class="comment">/*<sp/>Write<sp/>it<sp/>to<sp/>teh<sp/>MBR<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>;</highlight></codeline>
<codeline lineno="4184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>md<sp/>=<sp/>0xF8;</highlight></codeline>
<codeline lineno="4185"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="4186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sfd)<sp/>{<sp/><sp/></highlight><highlight class="comment">/*<sp/>No<sp/>partition<sp/>table<sp/>(SFD)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>md<sp/>=<sp/>0xF0;</highlight></codeline>
<codeline lineno="4188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>partition<sp/>table<sp/>(FDISK)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a02eb5189e43056a9ddc8a59cbe89be93" kindref="member">mem_set</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>,<sp/>0,<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs));</highlight></codeline>
<codeline lineno="4190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tbl<sp/>=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref><sp/>+<sp/><ref refid="ff_8c_1ac3f187bf0ba891551f594af6b61f3188" kindref="member">MBR_Table</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>partition<sp/>table<sp/>for<sp/>single<sp/>partition<sp/>in<sp/>the<sp/>drive<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tbl[1]<sp/>=<sp/>1;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Partition<sp/>start<sp/>head<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tbl[2]<sp/>=<sp/>1;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Partition<sp/>start<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tbl[3]<sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Partition<sp/>start<sp/>cylinder<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tbl[4]<sp/>=<sp/>sys;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>System<sp/>type<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tbl[5]<sp/>=<sp/>254;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Partition<sp/>end<sp/>head<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>=<sp/>(b_vol<sp/>+<sp/>n_vol)<sp/>/<sp/>63<sp/>/<sp/>255;</highlight></codeline>
<codeline lineno="4197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tbl[6]<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)(n<sp/>&gt;&gt;<sp/>2<sp/>|<sp/>63);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Partition<sp/>end<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tbl[7]<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)n;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>End<sp/>cylinder<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(tbl<sp/>+<sp/>8,<sp/>63);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Partition<sp/>start<sp/>in<sp/>LBA<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(tbl<sp/>+<sp/>12,<sp/>n_vol);<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Partition<sp/>size<sp/>in<sp/>LBA<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" kindref="member">ST_WORD</ref>(fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref><sp/>+<sp/><ref refid="ff_8c_1a74b810b3f3583c1eb54bd4305c0f261a" kindref="member">BS_55AA</ref>,<sp/>0xAA55);<sp/></highlight><highlight class="comment">/*<sp/>MBR<sp/>signature<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" kindref="member">disk_write</ref>(pdrv,<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>,<sp/>0,<sp/>1)<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref>)<sp/><sp/></highlight><highlight class="comment">/*<sp/>Write<sp/>it<sp/>to<sp/>the<sp/>MBR<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>;</highlight></codeline>
<codeline lineno="4204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>md<sp/>=<sp/>0xF8;</highlight></codeline>
<codeline lineno="4205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4206"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4207"><highlight class="normal"></highlight></codeline>
<codeline lineno="4208"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>BPB<sp/>in<sp/>the<sp/>VBR<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4209"><highlight class="normal"><sp/><sp/><sp/><sp/>tbl<sp/>=<sp/>fs-&gt;<ref refid="struct_f_a_t_f_s_1aabf9e848c88b78e22df6e09a0626e6f5" kindref="member">win</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Clear<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4210"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a02eb5189e43056a9ddc8a59cbe89be93" kindref="member">mem_set</ref>(tbl,<sp/>0,<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs));</highlight></codeline>
<codeline lineno="4211"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a8941d573d16af92c8570950d53164f30" kindref="member">mem_cpy</ref>(tbl,<sp/></highlight><highlight class="stringliteral">&quot;\xEB\xFE\x90&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;MSDOS5.0&quot;</highlight><highlight class="normal">,<sp/>11);</highlight><highlight class="comment">/*<sp/>Boot<sp/>jump<sp/>code,<sp/>OEM<sp/>name<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4212"><highlight class="normal"><sp/><sp/><sp/><sp/>i<sp/>=<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Sector<sp/>size<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4213"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" kindref="member">ST_WORD</ref>(tbl<sp/>+<sp/><ref refid="ff_8c_1a8551844b4eb4e15aecd8cc9aa3585fa2" kindref="member">BPB_BytsPerSec</ref>,<sp/>i);</highlight></codeline>
<codeline lineno="4214"><highlight class="normal"><sp/><sp/><sp/><sp/>tbl[<ref refid="ff_8c_1aab78e41c617a14b9540c0563d6b957fa" kindref="member">BPB_SecPerClus</ref>]<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)au;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Sectors<sp/>per<sp/>cluster<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4215"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" kindref="member">ST_WORD</ref>(tbl<sp/>+<sp/><ref refid="ff_8c_1ab3ec444c8457c9bc98aa07e846f5c1b7" kindref="member">BPB_RsvdSecCnt</ref>,<sp/>n_rsv);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Reserved<sp/>sectors<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4216"><highlight class="normal"><sp/><sp/><sp/><sp/>tbl[<ref refid="ff_8c_1af44a1e8c89ec5502595f23496d24cbf1" kindref="member">BPB_NumFATs</ref>]<sp/>=<sp/><ref refid="ff_8c_1a3f9495abc6071dcfdbd242cc1f9ad9f8" kindref="member">N_FATS</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>FATs<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4217"><highlight class="normal"><sp/><sp/><sp/><sp/>i<sp/>=<sp/>(fmt<sp/>==<sp/><ref refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" kindref="member">FS_FAT32</ref>)<sp/>?<sp/>0<sp/>:<sp/><ref refid="ff_8c_1a412083bc7d166082045a0111e890b22a" kindref="member">N_ROOTDIR</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>root<sp/>directory<sp/>entries<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4218"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" kindref="member">ST_WORD</ref>(tbl<sp/>+<sp/><ref refid="ff_8c_1aaa667f14c87c45dc128f2ab208e92f98" kindref="member">BPB_RootEntCnt</ref>,<sp/>i);</highlight></codeline>
<codeline lineno="4219"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n_vol<sp/>&lt;<sp/>0x10000)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>total<sp/>sectors<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" kindref="member">ST_WORD</ref>(tbl<sp/>+<sp/><ref refid="ff_8c_1a4eb540eecde0f2df26fa8c7969341d68" kindref="member">BPB_TotSec16</ref>,<sp/>n_vol);</highlight></codeline>
<codeline lineno="4221"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="4222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(tbl<sp/>+<sp/><ref refid="ff_8c_1a7723a9f0da553e8879d60909d85ccb7b" kindref="member">BPB_TotSec32</ref>,<sp/>n_vol);</highlight></codeline>
<codeline lineno="4223"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4224"><highlight class="normal"><sp/><sp/><sp/><sp/>tbl[<ref refid="ff_8c_1a414e054c4b5ea3414ebefa3539e7e554" kindref="member">BPB_Media</ref>]<sp/>=<sp/>md;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Media<sp/>descriptor<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4225"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" kindref="member">ST_WORD</ref>(tbl<sp/>+<sp/><ref refid="ff_8c_1ac71bb771432ea532bc47713a028ebd76" kindref="member">BPB_SecPerTrk</ref>,<sp/>63);<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>sectors<sp/>per<sp/>track<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4226"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" kindref="member">ST_WORD</ref>(tbl<sp/>+<sp/><ref refid="ff_8c_1a9c03603c3be34d4c5cc1b481b0bc6774" kindref="member">BPB_NumHeads</ref>,<sp/>255);<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>heads<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4227"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(tbl<sp/>+<sp/><ref refid="ff_8c_1a449d4ed5c4c8105daf29aad9488277f7" kindref="member">BPB_HiddSec</ref>,<sp/>b_vol);<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Hidden<sp/>sectors<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4228"><highlight class="normal"><sp/><sp/><sp/><sp/>n<sp/>=<sp/><ref refid="ff_8c_1a72589f5bbb514c0b222ab8b292764418" kindref="member">GET_FATTIME</ref>();<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Use<sp/>current<sp/>time<sp/>as<sp/>VSN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4229"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fmt<sp/>==<sp/><ref refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" kindref="member">FS_FAT32</ref>)<sp/>{</highlight></codeline>
<codeline lineno="4230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(tbl<sp/>+<sp/><ref refid="ff_8c_1abaa3aafdcf5e83f8cb7e2bb373b13525" kindref="member">BS_VolID32</ref>,<sp/>n);<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>VSN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(tbl<sp/>+<sp/><ref refid="ff_8c_1a6e6340030dc29e7da2e9f92e472a763d" kindref="member">BPB_FATSz32</ref>,<sp/>n_fat);<sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>sectors<sp/>per<sp/>FAT<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(tbl<sp/>+<sp/><ref refid="ff_8c_1a7add0104bd20083d6940d616faecd45a" kindref="member">BPB_RootClus</ref>,<sp/>2);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Root<sp/>directory<sp/>start<sp/>cluster<sp/>(2)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" kindref="member">ST_WORD</ref>(tbl<sp/>+<sp/><ref refid="ff_8c_1a51c45669282b9ce9da5152231df9f3ac" kindref="member">BPB_FSInfo</ref>,<sp/>1);<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FSINFO<sp/>record<sp/>offset<sp/>(VBR<sp/>+<sp/>1)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" kindref="member">ST_WORD</ref>(tbl<sp/>+<sp/><ref refid="ff_8c_1a383726fb93488d41866028b4f07c90e1" kindref="member">BPB_BkBootSec</ref>,<sp/>6);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Backup<sp/>boot<sp/>record<sp/>offset<sp/>(VBR<sp/>+<sp/>6)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tbl[<ref refid="ff_8c_1aa670c7b495f5b347c442df67b188c58f" kindref="member">BS_DrvNum32</ref>]<sp/>=<sp/>0x80;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Drive<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tbl[<ref refid="ff_8c_1a59c4b2f802ab4bc9319e5bd840e615b8" kindref="member">BS_BootSig32</ref>]<sp/>=<sp/>0x29;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Extended<sp/>boot<sp/>signature<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a8941d573d16af92c8570950d53164f30" kindref="member">mem_cpy</ref>(tbl<sp/>+<sp/><ref refid="ff_8c_1a8241a49bce313184a58617ba1ad9e84c" kindref="member">BS_VolLab32</ref>,<sp/></highlight><highlight class="stringliteral">&quot;NO<sp/>NAME<sp/><sp/><sp/><sp/>&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;FAT32<sp/><sp/><sp/>&quot;</highlight><highlight class="normal">,<sp/>19);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Volume<sp/>label,<sp/>FAT<sp/>signature<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4238"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="4239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(tbl<sp/>+<sp/><ref refid="ff_8c_1a383a71bda500a0fb5a37f4edd785acbf" kindref="member">BS_VolID</ref>,<sp/>n);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>VSN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" kindref="member">ST_WORD</ref>(tbl<sp/>+<sp/><ref refid="ff_8c_1a60a2f6efeb6a4c7cb2da1e5def6ca43b" kindref="member">BPB_FATSz16</ref>,<sp/>n_fat);<sp/><sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>sectors<sp/>per<sp/>FAT<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tbl[<ref refid="ff_8c_1a0c51f7393341b839dfb241c2951f3ef4" kindref="member">BS_DrvNum</ref>]<sp/>=<sp/>0x80;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Drive<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tbl[<ref refid="ff_8c_1a85a92e790602efef4da3a2f141611ce8" kindref="member">BS_BootSig</ref>]<sp/>=<sp/>0x29;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Extended<sp/>boot<sp/>signature<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a8941d573d16af92c8570950d53164f30" kindref="member">mem_cpy</ref>(tbl<sp/>+<sp/><ref refid="ff_8c_1a28498ba4b07ff90aaa9628e81fb89d32" kindref="member">BS_VolLab</ref>,<sp/></highlight><highlight class="stringliteral">&quot;NO<sp/>NAME<sp/><sp/><sp/><sp/>&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;FAT<sp/><sp/><sp/><sp/><sp/>&quot;</highlight><highlight class="normal">,<sp/>19);<sp/></highlight><highlight class="comment">/*<sp/>Volume<sp/>label,<sp/>FAT<sp/>signature<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4244"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4245"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" kindref="member">ST_WORD</ref>(tbl<sp/>+<sp/><ref refid="ff_8c_1a74b810b3f3583c1eb54bd4305c0f261a" kindref="member">BS_55AA</ref>,<sp/>0xAA55);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Signature<sp/>(Offset<sp/>is<sp/>fixed<sp/>here<sp/>regardless<sp/>of<sp/>sector<sp/>size)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4246"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" kindref="member">disk_write</ref>(pdrv,<sp/>tbl,<sp/>b_vol,<sp/>1)<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref>)<sp/><sp/></highlight><highlight class="comment">/*<sp/>Write<sp/>it<sp/>to<sp/>the<sp/>VBR<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>;</highlight></codeline>
<codeline lineno="4248"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fmt<sp/>==<sp/><ref refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" kindref="member">FS_FAT32</ref>)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Write<sp/>it<sp/>to<sp/>the<sp/>backup<sp/>VBR<sp/>if<sp/>needed<sp/>(VBR<sp/>+<sp/>6)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" kindref="member">disk_write</ref>(pdrv,<sp/>tbl,<sp/>b_vol<sp/>+<sp/>6,<sp/>1);</highlight></codeline>
<codeline lineno="4250"><highlight class="normal"></highlight></codeline>
<codeline lineno="4251"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Initialize<sp/>FAT<sp/>area<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4252"><highlight class="normal"><sp/><sp/><sp/><sp/>wsect<sp/>=<sp/>b_fat;</highlight></codeline>
<codeline lineno="4253"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="ff_8c_1a3f9495abc6071dcfdbd242cc1f9ad9f8" kindref="member">N_FATS</ref>;<sp/>i++)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Initialize<sp/>each<sp/>FAT<sp/>copy<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a02eb5189e43056a9ddc8a59cbe89be93" kindref="member">mem_set</ref>(tbl,<sp/>0,<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs));<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>1st<sp/>sector<sp/>of<sp/>the<sp/>FAT<sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>=<sp/>md;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Media<sp/>descriptor<sp/>byte<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fmt<sp/>!=<sp/><ref refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" kindref="member">FS_FAT32</ref>)<sp/>{</highlight></codeline>
<codeline lineno="4257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>|=<sp/>(fmt<sp/>==<sp/><ref refid="ff_8h_1aab755aa1b4f81f4aabee4a5d4738cfb0" kindref="member">FS_FAT12</ref>)<sp/>?<sp/>0x00FFFF00<sp/>:<sp/>0xFFFFFF00;</highlight></codeline>
<codeline lineno="4258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(tbl<sp/>+<sp/>0,<sp/>n);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Reserve<sp/>cluster<sp/>#0-1<sp/>(FAT12/16)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="4260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>|=<sp/>0xFFFFFF00;</highlight></codeline>
<codeline lineno="4261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(tbl<sp/>+<sp/>0,<sp/>n);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Reserve<sp/>cluster<sp/>#0-1<sp/>(FAT32)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(tbl<sp/>+<sp/>4,<sp/>0xFFFFFFFF);</highlight></codeline>
<codeline lineno="4263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(tbl<sp/>+<sp/>8,<sp/>0x0FFFFFFF);<sp/><sp/></highlight><highlight class="comment">/*<sp/>Reserve<sp/>cluster<sp/>#2<sp/>for<sp/>root<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" kindref="member">disk_write</ref>(pdrv,<sp/>tbl,<sp/>wsect++,<sp/>1)<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref>)</highlight></codeline>
<codeline lineno="4266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>;</highlight></codeline>
<codeline lineno="4267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a02eb5189e43056a9ddc8a59cbe89be93" kindref="member">mem_set</ref>(tbl,<sp/>0,<sp/><ref refid="ff_8c_1a42b5140fc5e09a53c8f4cba66dc0e6c1" kindref="member">SS</ref>(fs));<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Fill<sp/>following<sp/>FAT<sp/>entries<sp/>with<sp/>zero<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(n<sp/>=<sp/>1;<sp/>n<sp/>&lt;<sp/>n_fat;<sp/>n++)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>This<sp/>loop<sp/>may<sp/>take<sp/>a<sp/>time<sp/>on<sp/>FAT32<sp/>volume<sp/>due<sp/>to<sp/>many<sp/>single<sp/>sector<sp/>writes<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" kindref="member">disk_write</ref>(pdrv,<sp/>tbl,<sp/>wsect++,<sp/>1)<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref>)</highlight></codeline>
<codeline lineno="4270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>;</highlight></codeline>
<codeline lineno="4271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4272"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4273"><highlight class="normal"></highlight></codeline>
<codeline lineno="4274"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Initialize<sp/>root<sp/>directory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4275"><highlight class="normal"><sp/><sp/><sp/><sp/>i<sp/>=<sp/>(fmt<sp/>==<sp/><ref refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" kindref="member">FS_FAT32</ref>)<sp/>?<sp/>au<sp/>:<sp/>(<ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref>)n_dir;</highlight></codeline>
<codeline lineno="4276"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="4277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" kindref="member">disk_write</ref>(pdrv,<sp/>tbl,<sp/>wsect++,<sp/>1)<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref>)</highlight></codeline>
<codeline lineno="4278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>;</highlight></codeline>
<codeline lineno="4279"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(--i);</highlight></codeline>
<codeline lineno="4280"><highlight class="normal"></highlight></codeline>
<codeline lineno="4281"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_TRIM<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Erase<sp/>data<sp/>area<sp/>if<sp/>needed<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4282"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="4283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eb[0]<sp/>=<sp/>wsect;<sp/>eb[1]<sp/>=<sp/>wsect<sp/>+<sp/>(n_clst<sp/>-<sp/>((fmt<sp/>==<sp/><ref refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" kindref="member">FS_FAT32</ref>)<sp/>?<sp/>1<sp/>:<sp/>0))<sp/>*<sp/>au<sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="4284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga3051f51f1cccb103d145804d5d91b04d" kindref="member">disk_ioctl</ref>(pdrv,<sp/><ref refid="diskio_8h_1af09fd84bea8d4e889e272471f44d60d6" kindref="member">CTRL_TRIM</ref>,<sp/>eb);</highlight></codeline>
<codeline lineno="4285"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4286"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4287"><highlight class="normal"></highlight></codeline>
<codeline lineno="4288"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>FSINFO<sp/>if<sp/>needed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4289"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fmt<sp/>==<sp/><ref refid="ff_8h_1ac63e0796095a789cefdbc3c3c676c9ce" kindref="member">FS_FAT32</ref>)<sp/>{</highlight></codeline>
<codeline lineno="4290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(tbl<sp/>+<sp/><ref refid="ff_8c_1a318e58c1966aba52b90ab98dcb649883" kindref="member">FSI_LeadSig</ref>,<sp/>0x41615252);</highlight></codeline>
<codeline lineno="4291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(tbl<sp/>+<sp/><ref refid="ff_8c_1a3bac0e6ff5907873030db1d0a7c4ebef" kindref="member">FSI_StrucSig</ref>,<sp/>0x61417272);</highlight></codeline>
<codeline lineno="4292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(tbl<sp/>+<sp/><ref refid="ff_8c_1ab711e50459aba01b11c6b46a7cc1410b" kindref="member">FSI_Free_Count</ref>,<sp/>n_clst<sp/>-<sp/>1);<sp/></highlight><highlight class="comment">/*<sp/>Number<sp/>of<sp/>free<sp/>clusters<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(tbl<sp/>+<sp/><ref refid="ff_8c_1a320700cedf300c9b418edf56e5e6b086" kindref="member">FSI_Nxt_Free</ref>,<sp/>2);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Last<sp/>allocated<sp/>cluster#<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" kindref="member">ST_WORD</ref>(tbl<sp/>+<sp/><ref refid="ff_8c_1a74b810b3f3583c1eb54bd4305c0f261a" kindref="member">BS_55AA</ref>,<sp/>0xAA55);</highlight></codeline>
<codeline lineno="4295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" kindref="member">disk_write</ref>(pdrv,<sp/>tbl,<sp/>b_vol<sp/>+<sp/>1,<sp/>1);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Write<sp/>original<sp/>(VBR<sp/>+<sp/>1)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" kindref="member">disk_write</ref>(pdrv,<sp/>tbl,<sp/>b_vol<sp/>+<sp/>7,<sp/>1);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Write<sp/>backup<sp/>(VBR<sp/>+<sp/>7)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4297"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4298"><highlight class="normal"></highlight></codeline>
<codeline lineno="4299"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga3051f51f1cccb103d145804d5d91b04d" kindref="member">disk_ioctl</ref>(pdrv,<sp/><ref refid="diskio_8h_1a1b3c492f9aec325f0655941b75256f3c" kindref="member">CTRL_SYNC</ref>,<sp/>0)<sp/>==<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref>)<sp/>?<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref><sp/>:<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>;</highlight></codeline>
<codeline lineno="4300"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4301"><highlight class="normal"></highlight></codeline>
<codeline lineno="4302"><highlight class="normal"></highlight></codeline>
<codeline lineno="4303"><highlight class="normal"></highlight></codeline>
<codeline lineno="4304"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_MULTI_PARTITION</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4305"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4306"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Create<sp/>partition<sp/>table<sp/>on<sp/>the<sp/>physical<sp/>drive<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4307"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4308"><highlight class="normal"></highlight></codeline>
<codeline lineno="4309"><highlight class="normal"><ref refid="group__filesystem_1ga49d0171ecbd362cda5680a0d360db44c" kindref="member">FRESULT</ref><sp/><ref refid="group__filesystem_1ga0c1bd3e3872abbda0e256e7c73da9f3b" kindref="member">f_fdisk</ref><sp/>(</highlight></codeline>
<codeline lineno="4310"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>pdrv,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Physical<sp/>drive<sp/>number<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4311"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>szt[],<sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>size<sp/>table<sp/>for<sp/>each<sp/>partitions<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4312"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>work<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>working<sp/>buffer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4313"><highlight class="normal">)</highlight></codeline>
<codeline lineno="4314"><highlight class="normal">{</highlight></codeline>
<codeline lineno="4315"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>i,<sp/>n,<sp/>sz_cyl,<sp/>tot_cyl,<sp/>b_cyl,<sp/>e_cyl,<sp/>p_cyl;</highlight></codeline>
<codeline lineno="4316"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>s_hd,<sp/>e_hd,<sp/>*p,<sp/>*buf<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>*)work;</highlight></codeline>
<codeline lineno="4317"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="diskio_8h_1adba6790898ce4029c20a34b898ce73c1" kindref="member">DSTATUS</ref><sp/>stat;</highlight></codeline>
<codeline lineno="4318"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>sz_disk,<sp/>sz_part,<sp/>s_part;</highlight></codeline>
<codeline lineno="4319"><highlight class="normal"></highlight></codeline>
<codeline lineno="4320"><highlight class="normal"></highlight></codeline>
<codeline lineno="4321"><highlight class="normal"><sp/><sp/><sp/><sp/>stat<sp/>=<sp/><ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga45e4ba27a706ed2421edd501406a6496" kindref="member">disk_initialize</ref>(pdrv);</highlight></codeline>
<codeline lineno="4322"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(stat<sp/>&amp;<sp/><ref refid="diskio_8h_1abd6503c70d862b979a3f7080a59e9acd" kindref="member">STA_NOINIT</ref>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cac9894bed3e8632ede8d2712235fa8e45" kindref="member">FR_NOT_READY</ref>;</highlight></codeline>
<codeline lineno="4323"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(stat<sp/>&amp;<sp/><ref refid="diskio_8h_1a9ec6dc5f6620a33fabe388d3a111ca8c" kindref="member">STA_PROTECT</ref>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44cac3afbb423b1d4497229416812aff383b" kindref="member">FR_WRITE_PROTECTED</ref>;</highlight></codeline>
<codeline lineno="4324"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga3051f51f1cccb103d145804d5d91b04d" kindref="member">disk_ioctl</ref>(pdrv,<sp/><ref refid="diskio_8h_1a570216006f6a8fc4e1698b1bbb2d1dde" kindref="member">GET_SECTOR_COUNT</ref>,<sp/>&amp;sz_disk))<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref>;</highlight></codeline>
<codeline lineno="4325"><highlight class="normal"></highlight></codeline>
<codeline lineno="4326"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Determine<sp/>CHS<sp/>in<sp/>the<sp/>table<sp/>regardless<sp/>of<sp/>the<sp/>drive<sp/>geometry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4327"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(n<sp/>=<sp/>16;<sp/>n<sp/>&lt;<sp/>256<sp/>&amp;&amp;<sp/>sz_disk<sp/>/<sp/>n<sp/>/<sp/>63<sp/>&gt;<sp/>1024;<sp/>n<sp/>*=<sp/>2)<sp/>;</highlight></codeline>
<codeline lineno="4328"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n<sp/>==<sp/>256)<sp/>n--;</highlight></codeline>
<codeline lineno="4329"><highlight class="normal"><sp/><sp/><sp/><sp/>e_hd<sp/>=<sp/>n<sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="4330"><highlight class="normal"><sp/><sp/><sp/><sp/>sz_cyl<sp/>=<sp/>63<sp/>*<sp/>n;</highlight></codeline>
<codeline lineno="4331"><highlight class="normal"><sp/><sp/><sp/><sp/>tot_cyl<sp/>=<sp/>sz_disk<sp/>/<sp/>sz_cyl;</highlight></codeline>
<codeline lineno="4332"><highlight class="normal"></highlight></codeline>
<codeline lineno="4333"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>partition<sp/>table<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4334"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a02eb5189e43056a9ddc8a59cbe89be93" kindref="member">mem_set</ref>(buf,<sp/>0,<sp/><ref refid="group___f_f_c_o_n_f_i_g_1gac271b697378912f17132cb9c7d0de024" kindref="member">_MAX_SS</ref>);</highlight></codeline>
<codeline lineno="4335"><highlight class="normal"><sp/><sp/><sp/><sp/>p<sp/>=<sp/>buf<sp/>+<sp/><ref refid="ff_8c_1ac3f187bf0ba891551f594af6b61f3188" kindref="member">MBR_Table</ref>;<sp/>b_cyl<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="4336"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>4;<sp/>i++,<sp/>p<sp/>+=<sp/><ref refid="ff_8c_1af133060c47366e7e557d4085d931183f" kindref="member">SZ_PTE</ref>)<sp/>{</highlight></codeline>
<codeline lineno="4337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p_cyl<sp/>=<sp/>(szt[i]<sp/>&lt;=<sp/>100U)<sp/>?<sp/>(<ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref>)tot_cyl<sp/>*<sp/>szt[i]<sp/>/<sp/>100<sp/>:<sp/>szt[i]<sp/>/<sp/>sz_cyl;</highlight></codeline>
<codeline lineno="4338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!p_cyl)<sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s_part<sp/>=<sp/>(<ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref>)sz_cyl<sp/>*<sp/>b_cyl;</highlight></codeline>
<codeline lineno="4340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sz_part<sp/>=<sp/>(<ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref>)sz_cyl<sp/>*<sp/>p_cyl;</highlight></codeline>
<codeline lineno="4341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>==<sp/>0)<sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Exclude<sp/>first<sp/>track<sp/>of<sp/>cylinder<sp/>0<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s_hd<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="4343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s_part<sp/>+=<sp/>63;<sp/>sz_part<sp/>-=<sp/>63;</highlight></codeline>
<codeline lineno="4344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="4345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s_hd<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="4346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>e_cyl<sp/>=<sp/>b_cyl<sp/>+<sp/>p_cyl<sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="4348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(e_cyl<sp/>&gt;=<sp/>tot_cyl)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca3b89faeceab64db277d0fcdeaaa315d6" kindref="member">FR_INVALID_PARAMETER</ref>;</highlight></codeline>
<codeline lineno="4349"><highlight class="normal"></highlight></codeline>
<codeline lineno="4350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>partition<sp/>table<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p[1]<sp/>=<sp/>s_hd;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Start<sp/>head<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p[2]<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)((b_cyl<sp/>&gt;&gt;<sp/>2)<sp/>+<sp/>1);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Start<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p[3]<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)b_cyl;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Start<sp/>cylinder<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p[4]<sp/>=<sp/>0x06;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>System<sp/>type<sp/>(temporary<sp/>setting)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p[5]<sp/>=<sp/>e_hd;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>End<sp/>head<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p[6]<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)((e_cyl<sp/>&gt;&gt;<sp/>2)<sp/>+<sp/>63);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>End<sp/>sector<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p[7]<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)e_cyl;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>End<sp/>cylinder<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(p<sp/>+<sp/>8,<sp/>s_part);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Start<sp/>sector<sp/>in<sp/>LBA<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8h_1abf5aba973d95ac5843b80aa7379cdd66" kindref="member">ST_DWORD</ref>(p<sp/>+<sp/>12,<sp/>sz_part);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Partition<sp/>size<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4360"><highlight class="normal"></highlight></codeline>
<codeline lineno="4361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Next<sp/>partition<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>b_cyl<sp/>+=<sp/>p_cyl;</highlight></codeline>
<codeline lineno="4363"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4364"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a95ceb4c25b216e71baa7102939edfd0d" kindref="member">ST_WORD</ref>(p,<sp/>0xAA55);</highlight></codeline>
<codeline lineno="4365"><highlight class="normal"></highlight></codeline>
<codeline lineno="4366"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Write<sp/>it<sp/>to<sp/>the<sp/>MBR<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4367"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga006bdd486027cb80272afa8849993f7c" kindref="member">disk_write</ref>(pdrv,<sp/>buf,<sp/>0,<sp/>1)<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref><sp/>||<sp/><ref refid="group___s_d_c_a_r_d___i_n_t_e_r_f_a_c_e_1ga3051f51f1cccb103d145804d5d91b04d" kindref="member">disk_ioctl</ref>(pdrv,<sp/><ref refid="diskio_8h_1a1b3c492f9aec325f0655941b75256f3c" kindref="member">CTRL_SYNC</ref>,<sp/>0)<sp/>!=<sp/><ref refid="diskio_8h_1gaacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737" kindref="member">RES_OK</ref>)<sp/>?<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34" kindref="member">FR_DISK_ERR</ref><sp/>:<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref>;</highlight></codeline>
<codeline lineno="4368"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4369"><highlight class="normal"></highlight></codeline>
<codeline lineno="4370"><highlight class="normal"></highlight></codeline>
<codeline lineno="4371"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>_MULTI_PARTITION<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4372"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>_USE_MKFS<sp/>&amp;&amp;<sp/>!_FS_READONLY<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4373"><highlight class="normal"></highlight></codeline>
<codeline lineno="4374"><highlight class="normal"></highlight></codeline>
<codeline lineno="4375"><highlight class="normal"></highlight></codeline>
<codeline lineno="4376"><highlight class="normal"></highlight></codeline>
<codeline lineno="4377"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_STRFUNC</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4378"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4379"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Get<sp/>a<sp/>string<sp/>from<sp/>the<sp/>file<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4380"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4381"><highlight class="normal"></highlight></codeline>
<codeline lineno="4382" refid="group__filesystem_1ga0fa54bd310785ecdaed19dda8f60dac5" refkind="member"><highlight class="normal"><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/><ref refid="group__filesystem_1ga0fa54bd310785ecdaed19dda8f60dac5" kindref="member">f_gets</ref><sp/>(</highlight></codeline>
<codeline lineno="4383"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/>buff,<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>string<sp/>buffer<sp/>to<sp/>read<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4384"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>len,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Size<sp/>of<sp/>string<sp/>buffer<sp/>(characters)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4385"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_i_l" kindref="compound">FIL</ref>*<sp/>fp<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>file<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4386"><highlight class="normal">)</highlight></codeline>
<codeline lineno="4387"><highlight class="normal">{</highlight></codeline>
<codeline lineno="4388"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="4389"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref><sp/>c,<sp/>*p<sp/>=<sp/>buff;</highlight></codeline>
<codeline lineno="4390"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>s[2];</highlight></codeline>
<codeline lineno="4391"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>rc;</highlight></codeline>
<codeline lineno="4392"><highlight class="normal"></highlight></codeline>
<codeline lineno="4393"><highlight class="normal"></highlight></codeline>
<codeline lineno="4394"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(n<sp/>&lt;<sp/>len<sp/>-<sp/>1)<sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>characters<sp/>until<sp/>buffer<sp/>gets<sp/>filled<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4395"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN<sp/>&amp;&amp;<sp/>_LFN_UNICODE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4396"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_STRF_ENCODE<sp/>==<sp/>3<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>a<sp/>character<sp/>in<sp/>UTF-8<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1gac4c3dcb6869ca252888eebabe39727b3" kindref="member">f_read</ref>(fp,<sp/>s,<sp/>1,<sp/>&amp;rc);</highlight></codeline>
<codeline lineno="4398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rc<sp/>!=<sp/>1)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>=<sp/>s[0];</highlight></codeline>
<codeline lineno="4400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>&gt;=<sp/>0x80)<sp/>{</highlight></codeline>
<codeline lineno="4401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>&lt;<sp/>0xC0)<sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;<sp/></highlight><highlight class="comment">/*<sp/>Skip<sp/>stray<sp/>trailer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>&lt;<sp/>0xE0)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Two-byte<sp/>sequence<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1gac4c3dcb6869ca252888eebabe39727b3" kindref="member">f_read</ref>(fp,<sp/>s,<sp/>1,<sp/>&amp;rc);</highlight></codeline>
<codeline lineno="4404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rc<sp/>!=<sp/>1)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>=<sp/>(c<sp/>&amp;<sp/>0x1F)<sp/>&lt;&lt;<sp/>6<sp/>|<sp/>(s[0]<sp/>&amp;<sp/>0x3F);</highlight></codeline>
<codeline lineno="4406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>&lt;<sp/>0x80)<sp/>c<sp/>=<sp/></highlight><highlight class="charliteral">&apos;?&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="4408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>&lt;<sp/>0xF0)<sp/>{<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Three-byte<sp/>sequence<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1gac4c3dcb6869ca252888eebabe39727b3" kindref="member">f_read</ref>(fp,<sp/>s,<sp/>2,<sp/>&amp;rc);</highlight></codeline>
<codeline lineno="4410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rc<sp/>!=<sp/>2)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>=<sp/>c<sp/>&lt;&lt;<sp/>12<sp/>|<sp/>(s[0]<sp/>&amp;<sp/>0x3F)<sp/>&lt;&lt;<sp/>6<sp/>|<sp/>(s[1]<sp/>&amp;<sp/>0x3F);</highlight></codeline>
<codeline lineno="4412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>&lt;<sp/>0x800)<sp/>c<sp/>=<sp/></highlight><highlight class="charliteral">&apos;?&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Reject<sp/>four-byte<sp/>sequence<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>=<sp/></highlight><highlight class="charliteral">&apos;?&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4418"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_STRF_ENCODE<sp/>==<sp/>2<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>a<sp/>character<sp/>in<sp/>UTF-16BE<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1gac4c3dcb6869ca252888eebabe39727b3" kindref="member">f_read</ref>(fp,<sp/>s,<sp/>2,<sp/>&amp;rc);</highlight></codeline>
<codeline lineno="4420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rc<sp/>!=<sp/>2)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>=<sp/>s[1]<sp/>+<sp/>(s[0]<sp/>&lt;&lt;<sp/>8);</highlight></codeline>
<codeline lineno="4422"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_STRF_ENCODE<sp/>==<sp/>1<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>a<sp/>character<sp/>in<sp/>UTF-16LE<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1gac4c3dcb6869ca252888eebabe39727b3" kindref="member">f_read</ref>(fp,<sp/>s,<sp/>2,<sp/>&amp;rc);</highlight></codeline>
<codeline lineno="4424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rc<sp/>!=<sp/>2)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>=<sp/>s[0]<sp/>+<sp/>(s[1]<sp/>&lt;&lt;<sp/>8);</highlight></codeline>
<codeline lineno="4426"><highlight class="normal"></highlight><highlight class="preprocessor">#else<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>a<sp/>character<sp/>in<sp/>ANSI/OEM<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1gac4c3dcb6869ca252888eebabe39727b3" kindref="member">f_read</ref>(fp,<sp/>s,<sp/>1,<sp/>&amp;rc);</highlight></codeline>
<codeline lineno="4428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rc<sp/>!=<sp/>1)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>=<sp/>s[0];</highlight></codeline>
<codeline lineno="4430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1a58d63a832a117f179e41c7373d013dd6" kindref="member">IsDBCS1</ref>(c))<sp/>{</highlight></codeline>
<codeline lineno="4431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1gac4c3dcb6869ca252888eebabe39727b3" kindref="member">f_read</ref>(fp,<sp/>s,<sp/>1,<sp/>&amp;rc);</highlight></codeline>
<codeline lineno="4432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rc<sp/>!=<sp/>1)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>=<sp/>(c<sp/>&lt;&lt;<sp/>8)<sp/>+<sp/>s[0];</highlight></codeline>
<codeline lineno="4434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>=<sp/><ref refid="ff_8h_1ae5146230b88ddb4a6a69340e0fd1eabd" kindref="member">ff_convert</ref>(c,<sp/>1);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>OEM<sp/>-&gt;<sp/>Unicode<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!c)<sp/>c<sp/>=<sp/></highlight><highlight class="charliteral">&apos;?&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4437"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4438"><highlight class="normal"></highlight><highlight class="preprocessor">#else<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>a<sp/>character<sp/>without<sp/>conversion<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1gac4c3dcb6869ca252888eebabe39727b3" kindref="member">f_read</ref>(fp,<sp/>s,<sp/>1,<sp/>&amp;rc);</highlight></codeline>
<codeline lineno="4440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rc<sp/>!=<sp/>1)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>=<sp/>s[0];</highlight></codeline>
<codeline lineno="4442"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___f_f_c_o_n_f_i_g_1gaaab0313f867bb008b64236239f5c2660" kindref="member">_USE_STRFUNC</ref><sp/>==<sp/>2<sp/>&amp;&amp;<sp/>c<sp/>==<sp/></highlight><highlight class="charliteral">&apos;\r&apos;</highlight><highlight class="normal">)<sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Strip<sp/>&apos;\r&apos;<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*p++<sp/>=<sp/>c;</highlight></codeline>
<codeline lineno="4445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n++;</highlight></codeline>
<codeline lineno="4446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>==<sp/></highlight><highlight class="charliteral">&apos;\n&apos;</highlight><highlight class="normal">)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Break<sp/>on<sp/>EOL<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4447"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4448"><highlight class="normal"><sp/><sp/><sp/><sp/>*p<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="4449"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>n<sp/>?<sp/>buff<sp/>:<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>When<sp/>no<sp/>data<sp/>read<sp/>(eof<sp/>or<sp/>error),<sp/>return<sp/>with<sp/>error.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4450"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4451"><highlight class="normal"></highlight></codeline>
<codeline lineno="4452"><highlight class="normal"></highlight></codeline>
<codeline lineno="4453"><highlight class="normal"></highlight></codeline>
<codeline lineno="4454"><highlight class="normal"></highlight></codeline>
<codeline lineno="4455"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>!_FS_READONLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4456"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdarg.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4457"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4458"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Put<sp/>a<sp/>character<sp/>to<sp/>the<sp/>file<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4459"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4460"><highlight class="normal"></highlight></codeline>
<codeline lineno="4461" refid="structputbuff" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4462" refid="structputbuff_1a8d839bbcaa5e21902d2481c87c4f359f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_i_l" kindref="compound">FIL</ref>*<sp/><ref refid="structputbuff_1a8d839bbcaa5e21902d2481c87c4f359f" kindref="member">fp</ref>;</highlight></codeline>
<codeline lineno="4463" refid="structputbuff_1a1560bca810e056ea71cbf8c667d59580" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>idx,<sp/><ref refid="structputbuff_1a1560bca810e056ea71cbf8c667d59580" kindref="member">nchr</ref>;</highlight></codeline>
<codeline lineno="4464" refid="structputbuff_1a6966cd5c37fc8748361cad1ff6f7f640" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>buf[64];</highlight></codeline>
<codeline lineno="4465"><highlight class="normal">}<sp/><ref refid="structputbuff" kindref="compound">putbuff</ref>;</highlight></codeline>
<codeline lineno="4466"><highlight class="normal"></highlight></codeline>
<codeline lineno="4467"><highlight class="normal"></highlight></codeline>
<codeline lineno="4468"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4469" refid="ff_8c_1a19f72a515ee94dd8a9660d513172ce9b" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ff_8c_1a19f72a515ee94dd8a9660d513172ce9b" kindref="member">putc_bfd</ref><sp/>(</highlight></codeline>
<codeline lineno="4470"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structputbuff" kindref="compound">putbuff</ref>*<sp/>pb,</highlight></codeline>
<codeline lineno="4471"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref><sp/>c</highlight></codeline>
<codeline lineno="4472"><highlight class="normal">)</highlight></codeline>
<codeline lineno="4473"><highlight class="normal">{</highlight></codeline>
<codeline lineno="4474"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>bw;</highlight></codeline>
<codeline lineno="4475"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="4476"><highlight class="normal"></highlight></codeline>
<codeline lineno="4477"><highlight class="normal"></highlight></codeline>
<codeline lineno="4478"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group___f_f_c_o_n_f_i_g_1gaaab0313f867bb008b64236239f5c2660" kindref="member">_USE_STRFUNC</ref><sp/>==<sp/>2<sp/>&amp;&amp;<sp/>c<sp/>==<sp/></highlight><highlight class="charliteral">&apos;\n&apos;</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">/*<sp/>LF<sp/>-&gt;<sp/>CRLF<sp/>conversion<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a19f72a515ee94dd8a9660d513172ce9b" kindref="member">putc_bfd</ref>(pb,<sp/></highlight><highlight class="charliteral">&apos;\r&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="4480"><highlight class="normal"></highlight></codeline>
<codeline lineno="4481"><highlight class="normal"><sp/><sp/><sp/><sp/>i<sp/>=<sp/>pb-&gt;<ref refid="structputbuff_1ae40354a1051342eb5a9db005715dcfa9" kindref="member">idx</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Buffer<sp/>write<sp/>index<sp/>(-1:error)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4482"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>&lt;<sp/>0)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4483"><highlight class="normal"></highlight></codeline>
<codeline lineno="4484"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_USE_LFN<sp/>&amp;&amp;<sp/>_LFN_UNICODE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4485"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>_STRF_ENCODE<sp/>==<sp/>3<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Write<sp/>a<sp/>character<sp/>in<sp/>UTF-8<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4486"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>&lt;<sp/>0x80)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>7-bit<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pb-&gt;<ref refid="structputbuff_1a6966cd5c37fc8748361cad1ff6f7f640" kindref="member">buf</ref>[i++]<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)c;</highlight></codeline>
<codeline lineno="4488"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="4489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>&lt;<sp/>0x800)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>11-bit<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pb-&gt;<ref refid="structputbuff_1a6966cd5c37fc8748361cad1ff6f7f640" kindref="member">buf</ref>[i++]<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)(0xC0<sp/>|<sp/>c<sp/>&gt;&gt;<sp/>6);</highlight></codeline>
<codeline lineno="4491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>16-bit<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pb-&gt;<ref refid="structputbuff_1a6966cd5c37fc8748361cad1ff6f7f640" kindref="member">buf</ref>[i++]<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)(0xE0<sp/>|<sp/>c<sp/>&gt;&gt;<sp/>12);</highlight></codeline>
<codeline lineno="4493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pb-&gt;<ref refid="structputbuff_1a6966cd5c37fc8748361cad1ff6f7f640" kindref="member">buf</ref>[i++]<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)(0x80<sp/>|<sp/>(c<sp/>&gt;&gt;<sp/>6<sp/>&amp;<sp/>0x3F));</highlight></codeline>
<codeline lineno="4494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pb-&gt;<ref refid="structputbuff_1a6966cd5c37fc8748361cad1ff6f7f640" kindref="member">buf</ref>[i++]<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)(0x80<sp/>|<sp/>(c<sp/>&amp;<sp/>0x3F));</highlight></codeline>
<codeline lineno="4496"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4497"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_STRF_ENCODE<sp/>==<sp/>2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Write<sp/>a<sp/>character<sp/>in<sp/>UTF-16BE<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4498"><highlight class="normal"><sp/><sp/><sp/><sp/>pb-&gt;<ref refid="structputbuff_1a6966cd5c37fc8748361cad1ff6f7f640" kindref="member">buf</ref>[i++]<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)(c<sp/>&gt;&gt;<sp/>8);</highlight></codeline>
<codeline lineno="4499"><highlight class="normal"><sp/><sp/><sp/><sp/>pb-&gt;<ref refid="structputbuff_1a6966cd5c37fc8748361cad1ff6f7f640" kindref="member">buf</ref>[i++]<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)c;</highlight></codeline>
<codeline lineno="4500"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>_STRF_ENCODE<sp/>==<sp/>1<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Write<sp/>a<sp/>character<sp/>in<sp/>UTF-16LE<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4501"><highlight class="normal"><sp/><sp/><sp/><sp/>pb-&gt;<ref refid="structputbuff_1a6966cd5c37fc8748361cad1ff6f7f640" kindref="member">buf</ref>[i++]<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)c;</highlight></codeline>
<codeline lineno="4502"><highlight class="normal"><sp/><sp/><sp/><sp/>pb-&gt;<ref refid="structputbuff_1a6966cd5c37fc8748361cad1ff6f7f640" kindref="member">buf</ref>[i++]<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)(c<sp/>&gt;&gt;<sp/>8);</highlight></codeline>
<codeline lineno="4503"><highlight class="normal"></highlight><highlight class="preprocessor">#else<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Write<sp/>a<sp/>character<sp/>in<sp/>ANSI/OEM<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4504"><highlight class="normal"><sp/><sp/><sp/><sp/>c<sp/>=<sp/><ref refid="ff_8h_1ae5146230b88ddb4a6a69340e0fd1eabd" kindref="member">ff_convert</ref>(c,<sp/>0);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Unicode<sp/>-&gt;<sp/>OEM<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4505"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!c)<sp/>c<sp/>=<sp/></highlight><highlight class="charliteral">&apos;?&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4506"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>&gt;=<sp/>0x100)</highlight></codeline>
<codeline lineno="4507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pb-&gt;<ref refid="structputbuff_1a6966cd5c37fc8748361cad1ff6f7f640" kindref="member">buf</ref>[i++]<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)(c<sp/>&gt;&gt;<sp/>8);</highlight></codeline>
<codeline lineno="4508"><highlight class="normal"><sp/><sp/><sp/><sp/>pb-&gt;<ref refid="structputbuff_1a6966cd5c37fc8748361cad1ff6f7f640" kindref="member">buf</ref>[i++]<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)c;</highlight></codeline>
<codeline lineno="4509"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4510"><highlight class="normal"></highlight><highlight class="preprocessor">#else<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Write<sp/>a<sp/>character<sp/>without<sp/>conversion<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4511"><highlight class="normal"><sp/><sp/><sp/><sp/>pb-&gt;<ref refid="structputbuff_1a6966cd5c37fc8748361cad1ff6f7f640" kindref="member">buf</ref>[i++]<sp/>=<sp/>(<ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref>)c;</highlight></codeline>
<codeline lineno="4512"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4513"><highlight class="normal"></highlight></codeline>
<codeline lineno="4514"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>&gt;=<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>pb-&gt;<ref refid="structputbuff_1a6966cd5c37fc8748361cad1ff6f7f640" kindref="member">buf</ref>)<sp/>-<sp/>3)<sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Write<sp/>buffered<sp/>characters<sp/>to<sp/>the<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__filesystem_1gae6a4dfae8a9e308bdb2283a37ef680f2" kindref="member">f_write</ref>(pb-&gt;<ref refid="structputbuff_1a8d839bbcaa5e21902d2481c87c4f359f" kindref="member">fp</ref>,<sp/>pb-&gt;<ref refid="structputbuff_1a6966cd5c37fc8748361cad1ff6f7f640" kindref="member">buf</ref>,<sp/>(<ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref>)i,<sp/>&amp;bw);</highlight></codeline>
<codeline lineno="4516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/>(bw<sp/>==<sp/>(<ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref>)i)<sp/>?<sp/>0<sp/>:<sp/>-1;</highlight></codeline>
<codeline lineno="4517"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4518"><highlight class="normal"><sp/><sp/><sp/><sp/>pb-&gt;<ref refid="structputbuff_1ae40354a1051342eb5a9db005715dcfa9" kindref="member">idx</ref><sp/>=<sp/>i;</highlight></codeline>
<codeline lineno="4519"><highlight class="normal"><sp/><sp/><sp/><sp/>pb-&gt;<ref refid="structputbuff_1a1560bca810e056ea71cbf8c667d59580" kindref="member">nchr</ref>++;</highlight></codeline>
<codeline lineno="4520"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4521"><highlight class="normal"></highlight></codeline>
<codeline lineno="4522"><highlight class="normal"></highlight></codeline>
<codeline lineno="4523"><highlight class="normal"></highlight></codeline>
<codeline lineno="4524" refid="group__filesystem_1ga62a35ee79e4913c1e31ac706241be7da" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__filesystem_1ga62a35ee79e4913c1e31ac706241be7da" kindref="member">f_putc</ref><sp/>(</highlight></codeline>
<codeline lineno="4525"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref><sp/>c,<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>A<sp/>character<sp/>to<sp/>be<sp/>output<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4526"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_i_l" kindref="compound">FIL</ref>*<sp/>fp<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>file<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4527"><highlight class="normal">)</highlight></codeline>
<codeline lineno="4528"><highlight class="normal">{</highlight></codeline>
<codeline lineno="4529"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structputbuff" kindref="compound">putbuff</ref><sp/>pb;</highlight></codeline>
<codeline lineno="4530"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>nw;</highlight></codeline>
<codeline lineno="4531"><highlight class="normal"></highlight></codeline>
<codeline lineno="4532"><highlight class="normal"></highlight></codeline>
<codeline lineno="4533"><highlight class="normal"><sp/><sp/><sp/><sp/>pb.<ref refid="structputbuff_1a8d839bbcaa5e21902d2481c87c4f359f" kindref="member">fp</ref><sp/>=<sp/>fp;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Initialize<sp/>output<sp/>buffer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4534"><highlight class="normal"><sp/><sp/><sp/><sp/>pb.<ref refid="structputbuff_1a1560bca810e056ea71cbf8c667d59580" kindref="member">nchr</ref><sp/>=<sp/>pb.<ref refid="structputbuff_1ae40354a1051342eb5a9db005715dcfa9" kindref="member">idx</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="4535"><highlight class="normal"></highlight></codeline>
<codeline lineno="4536"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a19f72a515ee94dd8a9660d513172ce9b" kindref="member">putc_bfd</ref>(&amp;pb,<sp/>c);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Put<sp/>a<sp/>character<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4537"><highlight class="normal"></highlight></codeline>
<codeline lineno="4538"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/><sp/><sp/>pb.<ref refid="structputbuff_1ae40354a1051342eb5a9db005715dcfa9" kindref="member">idx</ref><sp/>&gt;=<sp/>0<sp/><sp/></highlight><highlight class="comment">/*<sp/>Flush<sp/>buffered<sp/>characters<sp/>to<sp/>the<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/><ref refid="group__filesystem_1gae6a4dfae8a9e308bdb2283a37ef680f2" kindref="member">f_write</ref>(pb.<ref refid="structputbuff_1a8d839bbcaa5e21902d2481c87c4f359f" kindref="member">fp</ref>,<sp/>pb.<ref refid="structputbuff_1a6966cd5c37fc8748361cad1ff6f7f640" kindref="member">buf</ref>,<sp/>(<ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref>)pb.<ref refid="structputbuff_1ae40354a1051342eb5a9db005715dcfa9" kindref="member">idx</ref>,<sp/>&amp;nw)<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref></highlight></codeline>
<codeline lineno="4540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>(<ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref>)pb.<ref refid="structputbuff_1ae40354a1051342eb5a9db005715dcfa9" kindref="member">idx</ref><sp/>==<sp/>nw)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pb.<ref refid="structputbuff_1a1560bca810e056ea71cbf8c667d59580" kindref="member">nchr</ref>;</highlight></codeline>
<codeline lineno="4541"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a59adc4c82490d23754cd39c2fb99b0da" kindref="member">EOF</ref>;</highlight></codeline>
<codeline lineno="4542"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4543"><highlight class="normal"></highlight></codeline>
<codeline lineno="4544"><highlight class="normal"></highlight></codeline>
<codeline lineno="4545"><highlight class="normal"></highlight></codeline>
<codeline lineno="4546"><highlight class="normal"></highlight></codeline>
<codeline lineno="4547"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4548"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Put<sp/>a<sp/>string<sp/>to<sp/>the<sp/>file<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4549"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4550"><highlight class="normal"></highlight></codeline>
<codeline lineno="4551" refid="group__filesystem_1ga9443c00129414fbfc16a5a13ad876ced" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__filesystem_1ga9443c00129414fbfc16a5a13ad876ced" kindref="member">f_puts</ref><sp/>(</highlight></codeline>
<codeline lineno="4552"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/>str,<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>string<sp/>to<sp/>be<sp/>output<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4553"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_i_l" kindref="compound">FIL</ref>*<sp/>fp<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>file<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4554"><highlight class="normal">)</highlight></codeline>
<codeline lineno="4555"><highlight class="normal">{</highlight></codeline>
<codeline lineno="4556"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structputbuff" kindref="compound">putbuff</ref><sp/>pb;</highlight></codeline>
<codeline lineno="4557"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>nw;</highlight></codeline>
<codeline lineno="4558"><highlight class="normal"></highlight></codeline>
<codeline lineno="4559"><highlight class="normal"></highlight></codeline>
<codeline lineno="4560"><highlight class="normal"><sp/><sp/><sp/><sp/>pb.<ref refid="structputbuff_1a8d839bbcaa5e21902d2481c87c4f359f" kindref="member">fp</ref><sp/>=<sp/>fp;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Initialize<sp/>output<sp/>buffer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4561"><highlight class="normal"><sp/><sp/><sp/><sp/>pb.<ref refid="structputbuff_1a1560bca810e056ea71cbf8c667d59580" kindref="member">nchr</ref><sp/>=<sp/>pb.<ref refid="structputbuff_1ae40354a1051342eb5a9db005715dcfa9" kindref="member">idx</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="4562"><highlight class="normal"></highlight></codeline>
<codeline lineno="4563"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(*str)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Put<sp/>the<sp/>string<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a19f72a515ee94dd8a9660d513172ce9b" kindref="member">putc_bfd</ref>(&amp;pb,<sp/>*str++);</highlight></codeline>
<codeline lineno="4565"><highlight class="normal"></highlight></codeline>
<codeline lineno="4566"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/><sp/><sp/>pb.<ref refid="structputbuff_1ae40354a1051342eb5a9db005715dcfa9" kindref="member">idx</ref><sp/>&gt;=<sp/>0<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Flush<sp/>buffered<sp/>characters<sp/>to<sp/>the<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/><ref refid="group__filesystem_1gae6a4dfae8a9e308bdb2283a37ef680f2" kindref="member">f_write</ref>(pb.<ref refid="structputbuff_1a8d839bbcaa5e21902d2481c87c4f359f" kindref="member">fp</ref>,<sp/>pb.<ref refid="structputbuff_1a6966cd5c37fc8748361cad1ff6f7f640" kindref="member">buf</ref>,<sp/>(<ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref>)pb.<ref refid="structputbuff_1ae40354a1051342eb5a9db005715dcfa9" kindref="member">idx</ref>,<sp/>&amp;nw)<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref></highlight></codeline>
<codeline lineno="4568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>(<ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref>)pb.<ref refid="structputbuff_1ae40354a1051342eb5a9db005715dcfa9" kindref="member">idx</ref><sp/>==<sp/>nw)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pb.<ref refid="structputbuff_1a1560bca810e056ea71cbf8c667d59580" kindref="member">nchr</ref>;</highlight></codeline>
<codeline lineno="4569"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a59adc4c82490d23754cd39c2fb99b0da" kindref="member">EOF</ref>;</highlight></codeline>
<codeline lineno="4570"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4571"><highlight class="normal"></highlight></codeline>
<codeline lineno="4572"><highlight class="normal"></highlight></codeline>
<codeline lineno="4573"><highlight class="normal"></highlight></codeline>
<codeline lineno="4574"><highlight class="normal"></highlight></codeline>
<codeline lineno="4575"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4576"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Put<sp/>a<sp/>formatted<sp/>string<sp/>to<sp/>the<sp/>file<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4577"><highlight class="normal"></highlight><highlight class="comment">/*-----------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4578"><highlight class="normal"></highlight></codeline>
<codeline lineno="4579" refid="group__filesystem_1ga49cccab38cd84e2d3357fef2d1df21f9" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__filesystem_1ga49cccab38cd84e2d3357fef2d1df21f9" kindref="member">f_printf</ref><sp/>(</highlight></codeline>
<codeline lineno="4580"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_f_i_l" kindref="compound">FIL</ref>*<sp/>fp,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>file<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4581"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*<sp/>fmt,<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pointer<sp/>to<sp/>the<sp/>format<sp/>string<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4582"><highlight class="normal"><sp/><sp/><sp/><sp/>...<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Optional<sp/>arguments...<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4583"><highlight class="normal">)</highlight></codeline>
<codeline lineno="4584"><highlight class="normal">{</highlight></codeline>
<codeline lineno="4585"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group___l_o_g_g_i_n_g_1gaf53f622e3b6c080daeb167c1955d7ec1" kindref="member">va_list</ref><sp/>arp;</highlight></codeline>
<codeline lineno="4586"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a4ae1dab0fb4b072a66584546209e7d58" kindref="member">BYTE</ref><sp/>f,<sp/>r;</highlight></codeline>
<codeline lineno="4587"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref><sp/>nw,<sp/>i,<sp/>j,<sp/>w;</highlight></codeline>
<codeline lineno="4588"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref><sp/>v;</highlight></codeline>
<codeline lineno="4589"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref><sp/>c,<sp/>d,<sp/>s[16],<sp/>*p;</highlight></codeline>
<codeline lineno="4590"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structputbuff" kindref="compound">putbuff</ref><sp/>pb;</highlight></codeline>
<codeline lineno="4591"><highlight class="normal"></highlight></codeline>
<codeline lineno="4592"><highlight class="normal"></highlight></codeline>
<codeline lineno="4593"><highlight class="normal"><sp/><sp/><sp/><sp/>pb.<ref refid="structputbuff_1a8d839bbcaa5e21902d2481c87c4f359f" kindref="member">fp</ref><sp/>=<sp/>fp;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Initialize<sp/>output<sp/>buffer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4594"><highlight class="normal"><sp/><sp/><sp/><sp/>pb.<ref refid="structputbuff_1a1560bca810e056ea71cbf8c667d59580" kindref="member">nchr</ref><sp/>=<sp/>pb.<ref refid="structputbuff_1ae40354a1051342eb5a9db005715dcfa9" kindref="member">idx</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="4595"><highlight class="normal"></highlight></codeline>
<codeline lineno="4596"><highlight class="normal"><sp/><sp/><sp/><sp/>va_start(arp,<sp/>fmt);</highlight></codeline>
<codeline lineno="4597"><highlight class="normal"></highlight></codeline>
<codeline lineno="4598"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(;;)<sp/>{</highlight></codeline>
<codeline lineno="4599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>=<sp/>*fmt++;</highlight></codeline>
<codeline lineno="4600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>==<sp/>0)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>End<sp/>of<sp/>string<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>!=<sp/></highlight><highlight class="charliteral">&apos;%&apos;</highlight><highlight class="normal">)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Non<sp/>escape<sp/>character<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a19f72a515ee94dd8a9660d513172ce9b" kindref="member">putc_bfd</ref>(&amp;pb,<sp/>c);</highlight></codeline>
<codeline lineno="4603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/>f<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="4606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>=<sp/>*fmt++;</highlight></codeline>
<codeline lineno="4607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>==<sp/></highlight><highlight class="charliteral">&apos;0&apos;</highlight><highlight class="normal">)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Flag:<sp/>&apos;0&apos;<sp/>padding<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>=<sp/>1;<sp/>c<sp/>=<sp/>*fmt++;</highlight></codeline>
<codeline lineno="4609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="4610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>==<sp/></highlight><highlight class="charliteral">&apos;-&apos;</highlight><highlight class="normal">)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Flag:<sp/>left<sp/>justified<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>=<sp/>2;<sp/>c<sp/>=<sp/>*fmt++;</highlight></codeline>
<codeline lineno="4612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1a65dee564f69f2ec27f25b67a348018b9" kindref="member">IsDigit</ref>(c))<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Precision<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/>w<sp/>*<sp/>10<sp/>+<sp/>c<sp/>-<sp/></highlight><highlight class="charliteral">&apos;0&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>=<sp/>*fmt++;</highlight></codeline>
<codeline lineno="4617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>==<sp/></highlight><highlight class="charliteral">&apos;l&apos;</highlight><highlight class="normal"><sp/>||<sp/>c<sp/>==<sp/></highlight><highlight class="charliteral">&apos;L&apos;</highlight><highlight class="normal">)<sp/>{<sp/></highlight><highlight class="comment">/*<sp/>Prefix:<sp/>Size<sp/>is<sp/>long<sp/>int<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>|=<sp/>4;<sp/>c<sp/>=<sp/>*fmt++;</highlight></codeline>
<codeline lineno="4620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!c)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d<sp/>=<sp/>c;</highlight></codeline>
<codeline lineno="4623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ff_8c_1a4a9d454724926bd51a3aed589a97f08b" kindref="member">IsLower</ref>(d))<sp/>d<sp/>-=<sp/>0x20;</highlight></codeline>
<codeline lineno="4624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(d)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Type<sp/>is...<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/></highlight><highlight class="charliteral">&apos;S&apos;</highlight><highlight class="normal"><sp/>:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>String<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/>va_arg(arp,<sp/><ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>*);</highlight></codeline>
<codeline lineno="4627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j<sp/>=<sp/>0;<sp/>p[j];<sp/>j++)<sp/>;</highlight></codeline>
<codeline lineno="4628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!(f<sp/>&amp;<sp/>2))<sp/>{</highlight></codeline>
<codeline lineno="4629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(j++<sp/>&lt;<sp/>w)<sp/><ref refid="ff_8c_1a19f72a515ee94dd8a9660d513172ce9b" kindref="member">putc_bfd</ref>(&amp;pb,<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="4630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(*p)<sp/><ref refid="ff_8c_1a19f72a515ee94dd8a9660d513172ce9b" kindref="member">putc_bfd</ref>(&amp;pb,<sp/>*p++);</highlight></codeline>
<codeline lineno="4632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(j++<sp/>&lt;<sp/>w)<sp/><ref refid="ff_8c_1a19f72a515ee94dd8a9660d513172ce9b" kindref="member">putc_bfd</ref>(&amp;pb,<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="4633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/></highlight><highlight class="charliteral">&apos;C&apos;</highlight><highlight class="normal"><sp/>:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Character<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a19f72a515ee94dd8a9660d513172ce9b" kindref="member">putc_bfd</ref>(&amp;pb,<sp/>(<ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>)va_arg(arp,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">));<sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/></highlight><highlight class="charliteral">&apos;B&apos;</highlight><highlight class="normal"><sp/>:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Binary<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r<sp/>=<sp/>2;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/></highlight><highlight class="charliteral">&apos;O&apos;</highlight><highlight class="normal"><sp/>:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Octal<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r<sp/>=<sp/>8;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/></highlight><highlight class="charliteral">&apos;D&apos;</highlight><highlight class="normal"><sp/>:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Signed<sp/>decimal<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/></highlight><highlight class="charliteral">&apos;U&apos;</highlight><highlight class="normal"><sp/>:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Unsigned<sp/>decimal<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r<sp/>=<sp/>10;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/></highlight><highlight class="charliteral">&apos;X&apos;</highlight><highlight class="normal"><sp/>:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Hexdecimal<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r<sp/>=<sp/>16;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Unknown<sp/>type<sp/>(pass-through)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ff_8c_1a19f72a515ee94dd8a9660d513172ce9b" kindref="member">putc_bfd</ref>(&amp;pb,<sp/>c);<sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4648"><highlight class="normal"></highlight></codeline>
<codeline lineno="4649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>an<sp/>argument<sp/>and<sp/>put<sp/>it<sp/>in<sp/>numeral<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v<sp/>=<sp/>(f<sp/>&amp;<sp/>4)<sp/>?<sp/>(<ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref>)va_arg(arp,<sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal">)<sp/>:<sp/>((d<sp/>==<sp/></highlight><highlight class="charliteral">&apos;D&apos;</highlight><highlight class="normal">)<sp/>?<sp/>(<ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref>)(<ref refid="group___b_c_d_s___w_l_a_n___c_o_n_n_e_c_t_1ga9d725caefd919a8a7011fc5065608fc6" kindref="member">long</ref>)va_arg(arp,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<sp/>:<sp/>(<ref refid="integer_8h_1ad342ac907eb044443153a22f964bf0af" kindref="member">DWORD</ref>)va_arg(arp,<sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="4651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(d<sp/>==<sp/></highlight><highlight class="charliteral">&apos;D&apos;</highlight><highlight class="normal"><sp/>&amp;&amp;<sp/>(v<sp/>&amp;<sp/>0x80000000))<sp/>{</highlight></codeline>
<codeline lineno="4652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v<sp/>=<sp/>0<sp/>-<sp/>v;</highlight></codeline>
<codeline lineno="4653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>|=<sp/>8;</highlight></codeline>
<codeline lineno="4654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="4656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="4657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d<sp/>=<sp/>(<ref refid="ff_8h_1a03bdb8ce5895c7e261aadc2529637546" kindref="member">TCHAR</ref>)(v<sp/>%<sp/>r);<sp/>v<sp/>/=<sp/>r;</highlight></codeline>
<codeline lineno="4658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(d<sp/>&gt;<sp/>9)<sp/>d<sp/>+=<sp/>(c<sp/>==<sp/></highlight><highlight class="charliteral">&apos;x&apos;</highlight><highlight class="normal">)<sp/>?<sp/>0x27<sp/>:<sp/>0x07;</highlight></codeline>
<codeline lineno="4659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s[i++]<sp/>=<sp/>d<sp/>+<sp/></highlight><highlight class="charliteral">&apos;0&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(v<sp/>&amp;&amp;<sp/>i<sp/>&lt;<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>s<sp/>/<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>s[0]);</highlight></codeline>
<codeline lineno="4661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(f<sp/>&amp;<sp/>8)<sp/>s[i++]<sp/>=<sp/></highlight><highlight class="charliteral">&apos;-&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>j<sp/>=<sp/>i;<sp/>d<sp/>=<sp/>(f<sp/>&amp;<sp/>1)<sp/>?<sp/></highlight><highlight class="charliteral">&apos;0&apos;</highlight><highlight class="normal"><sp/>:<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!(f<sp/>&amp;<sp/>2)<sp/>&amp;&amp;<sp/>j++<sp/>&lt;<sp/>w)<sp/><ref refid="ff_8c_1a19f72a515ee94dd8a9660d513172ce9b" kindref="member">putc_bfd</ref>(&amp;pb,<sp/>d);</highlight></codeline>
<codeline lineno="4664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/><ref refid="ff_8c_1a19f72a515ee94dd8a9660d513172ce9b" kindref="member">putc_bfd</ref>(&amp;pb,<sp/>s[--i]);<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(i);</highlight></codeline>
<codeline lineno="4665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(j++<sp/>&lt;<sp/>w)<sp/><ref refid="ff_8c_1a19f72a515ee94dd8a9660d513172ce9b" kindref="member">putc_bfd</ref>(&amp;pb,<sp/>d);</highlight></codeline>
<codeline lineno="4666"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4667"><highlight class="normal"></highlight></codeline>
<codeline lineno="4668"><highlight class="normal"><sp/><sp/><sp/><sp/>va_end(arp);</highlight></codeline>
<codeline lineno="4669"><highlight class="normal"></highlight></codeline>
<codeline lineno="4670"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/><sp/><sp/>pb.<ref refid="structputbuff_1ae40354a1051342eb5a9db005715dcfa9" kindref="member">idx</ref><sp/>&gt;=<sp/>0<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Flush<sp/>buffered<sp/>characters<sp/>to<sp/>the<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/><ref refid="group__filesystem_1gae6a4dfae8a9e308bdb2283a37ef680f2" kindref="member">f_write</ref>(pb.<ref refid="structputbuff_1a8d839bbcaa5e21902d2481c87c4f359f" kindref="member">fp</ref>,<sp/>pb.<ref refid="structputbuff_1a6966cd5c37fc8748361cad1ff6f7f640" kindref="member">buf</ref>,<sp/>(<ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref>)pb.<ref refid="structputbuff_1ae40354a1051342eb5a9db005715dcfa9" kindref="member">idx</ref>,<sp/>&amp;nw)<sp/>==<sp/><ref refid="ff_8h_1ga49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1" kindref="member">FR_OK</ref></highlight></codeline>
<codeline lineno="4672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>(<ref refid="integer_8h_1a36cb3b01d81ffd844bbbfb54003e06ec" kindref="member">UINT</ref>)pb.<ref refid="structputbuff_1ae40354a1051342eb5a9db005715dcfa9" kindref="member">idx</ref><sp/>==<sp/>nw)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pb.<ref refid="structputbuff_1a1560bca810e056ea71cbf8c667d59580" kindref="member">nchr</ref>;</highlight></codeline>
<codeline lineno="4673"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ff_8h_1a59adc4c82490d23754cd39c2fb99b0da" kindref="member">EOF</ref>;</highlight></codeline>
<codeline lineno="4674"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4675"><highlight class="normal"></highlight></codeline>
<codeline lineno="4676"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>!_FS_READONLY<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4677"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>_USE_STRFUNC<sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
    </programlisting>
    <location file="C:/Jenkins/XDK/Pipeline/xdk110/SDK/xdk110/Libraries/FATfs/3rd-party/fatfs/src/ff.c"/>
  </compounddef>
</doxygen>
